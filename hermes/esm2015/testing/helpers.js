export function assertDomainEvents(actualEvents, expectedEvents) {
    expect(actualEvents.length).toEqual(expectedEvents.length);
    for (const actualEvent of actualEvents) {
        const expectedEvent = expectedEvents.find((event) => {
            return event.equalsByType(actualEvent);
        });
        expect(expectedEvent).toBeDefined();
        expect(actualEvent.equalsByType(expectedEvent)).toBeTruthy();
        // expect(actualEvent.aggregateId).toEqual(expectedEvent.aggregateId, 'Events aggregateId should be the same');
        expect(actualEvent.getPayload()).toEqual(expectedEvent.getPayload(), 'Events payload should be the same');
    }
}
export function assertAggregateEvents(actualEvents, expectedEvents) {
    expect(actualEvents.length).toEqual(expectedEvents.length, 'Aggregate events');
    for (const actualEvent of actualEvents) {
        const expectedEvent = expectedEvents.find((event) => {
            return event.equals(actualEvent);
        });
        expect(expectedEvent).toBeDefined();
    }
}
export function testEventRepositoryIsEmptyOnStart(createStream, desc) {
    it('should be no ' + desc + ' events on start', () => {
        expect.assertions(3);
        // given
        const nextFn = jest.fn(), errorFn = jest.fn(), completeFn = jest.fn();
        // when
        createStream()
            .subscribe(() => nextFn(), (err) => errorFn(err), () => completeFn());
        // then
        expect(nextFn).not.toHaveBeenCalled();
        expect(errorFn).not.toHaveBeenCalled();
        expect(completeFn).not.toHaveBeenCalled();
    });
}
export function testWarehouseDefaultValueOnStart(createStream, defaultValue, desc) {
    it('should have default value ' + desc, () => {
        expect.assertions(4);
        // given
        const nextFn = jest.fn(), errorFn = jest.fn(), completeFn = jest.fn();
        // when
        createStream()
            .subscribe((value) => nextFn(value), (err) => errorFn(err), () => completeFn());
        // then
        expect(nextFn).toHaveBeenCalledWith(defaultValue);
        expect(nextFn).toHaveBeenCalledTimes(1);
        expect(errorFn).not.toHaveBeenCalled();
        expect(completeFn).not.toHaveBeenCalled();
    });
}
export function testWarehouseDefaultValueOnStartOnce(createStream, defaultValue, desc) {
    it('should have default value ' + desc, () => {
        expect.assertions(4);
        // given
        const nextFn = jest.fn(), errorFn = jest.fn(), completeFn = jest.fn();
        // when
        createStream()
            .subscribe((value) => nextFn(value), (err) => errorFn(err), () => completeFn());
        // then
        expect(nextFn).toHaveBeenCalledWith(defaultValue);
        expect(nextFn).toHaveBeenCalledTimes(1);
        expect(errorFn).not.toHaveBeenCalled();
        expect(completeFn).toHaveBeenCalledTimes(1);
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVscGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2J1aWxkLWNsaS9wcm9qZWN0cy9ndWktaGVybWVzL3NyYy90ZXN0aW5nL2hlbHBlcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBVUEsTUFBTSxVQUFVLGtCQUFrQixDQUF3QixZQUEyQyxFQUFFLGNBQXFDO0lBRTNJLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUUzRCxLQUFLLE1BQU0sV0FBVyxJQUFJLFlBQVksRUFBRTtRQUV2QyxNQUFNLGFBQWEsR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBcUIsRUFBRSxFQUFFO1lBQ25FLE9BQU8sS0FBSyxDQUFDLFlBQVksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztRQUVILE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUNwQyxNQUFNLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQzdELCtHQUErRztRQUMvRyxNQUFNLENBQUMsV0FBVyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxVQUFVLEVBQUUsRUFBRSxtQ0FBbUMsQ0FBQyxDQUFDO0tBQzFHO0FBRUYsQ0FBQztBQUVELE1BQU0sVUFBVSxxQkFBcUIsQ0FBd0IsWUFBOEMsRUFBRSxjQUF3QztJQUVwSixNQUFNLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLGtCQUFrQixDQUFDLENBQUM7SUFFL0UsS0FBSyxNQUFNLFdBQVcsSUFBSSxZQUFZLEVBQUU7UUFFdkMsTUFBTSxhQUFhLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQXdCLEVB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U0FBUyxDQUNULENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQ3hCLENBQUMsR0FBUSxFQUFFLEVBQUUsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQzFCLEdBQUcsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUNsQixDQUFDO1FBRUgsT0FBTztRQUNQLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUNsRCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDeEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3ZDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM3QyxDQUFDLENBQUMsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBZ2dyZWdhdGVJZCB9IGZyb20gJy4uL2NvcmUvZG9tYWluL3RhY3RpY2FsL2FnZ3JlZ2F0ZS9hZ2dyZWdhdGUtaWQnO1xuXG5pbXBvcnQgeyBBZ2dyZWdhdGVFdmVudCB9IGZyb20gJy4uL2NvcmUvZG9tYWluL3RhY3RpY2FsL2FnZ3JlZ2F0ZS9hZ2dyZWdhdGUtZXZlbnQnO1xuaW1wb3J0IHsgRG9tYWluRXZlbnQgfSBmcm9tICcuLi9jb3JlL2RvbWFpbi9ldmVudC9kb21haW4tZXZlbnQnO1xuaW1wb3J0IHsgSGVybWVzT2JzZXJ2YWJsZSB9IGZyb20gJy4uL2NvbW1vbi9zdHJlYW0vb2JzZXJ2YWJsZS9oZXJtZXMub2JzZXJ2YWJsZSc7XG5cbmRlY2xhcmUgY29uc3QgZXhwZWN0OiBhbnk7XG5kZWNsYXJlIGNvbnN0IGl0OiBhbnk7XG5kZWNsYXJlIGNvbnN0IGplc3Q6IGFueTtcblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydERvbWFpbkV2ZW50czxJIGV4dGVuZHMgQWdncmVnYXRlSWQ+KGFjdHVhbEV2ZW50czogUmVhZG9ubHlBcnJheTxEb21haW5FdmVudDxJPj4sIGV4cGVjdGVkRXZlbnRzOiBBcnJheTxEb21haW5FdmVudDxJPj4pOiB2b2lkIHtcblxuXHRleHBlY3QoYWN0dWFsRXZlbnRzLmxlbmd0aCkudG9FcXVhbChleHBlY3RlZEV2ZW50cy5sZW5ndGgpO1xuXG5cdGZvciAoY29uc3QgYWN0dWFsRXZlbnQgb2YgYWN0dWFsRXZlbnRzKSB7XG5cblx0XHRjb25zdCBleHBlY3RlZEV2ZW50ID0gZXhwZWN0ZWRFdmVudHMuZmluZCgoZXZlbnQ6IERvbWFpbkV2ZW50PEk+KSA9PiB7XG5cdFx0XHRyZXR1cm4gZXZlbnQuZXF1YWxzQnlUeXBlKGFjdHVhbEV2ZW50KTtcblx0XHR9KTtcblxuXHRcdGV4cGVjdChleHBlY3RlZEV2ZW50KS50b0JlRGVmaW5lZCgpO1xuXHRcdGV4cGVjdChhY3R1YWxFdmVudC5lcXVhbHNCeVR5cGUoZXhwZWN0ZWRFdmVudCkpLnRvQmVUcnV0aHkoKTtcblx0XHQvLyBleHBlY3QoYWN0dWFsRXZlbnQuYWdncmVnYXRlSWQpLnRvRXF1YWwoZXhwZWN0ZWRFdmVudC5hZ2dyZWdhdGVJZCwgJ0V2ZW50cyBhZ2dyZWdhdGVJZCBzaG91bGQgYmUgdGhlIHNhbWUnKTtcblx0XHRleHBlY3QoYWN0dWFsRXZlbnQuZ2V0UGF5bG9hZCgpKS50b0VxdWFsKGV4cGVjdGVkRXZlbnQuZ2V0UGF5bG9hZCgpLCAnRXZlbnRzIHBheWxvYWQgc2hvdWxkIGJlIHRoZSBzYW1lJyk7XG5cdH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0QWdncmVnYXRlRXZlbnRzPFQgZXh0ZW5kcyBBZ2dyZWdhdGVJZD4oYWN0dWFsRXZlbnRzOiBSZWFkb25seUFycmF5PEFnZ3JlZ2F0ZUV2ZW50PFQ+PiwgZXhwZWN0ZWRFdmVudHM6IEFycmF5PEFnZ3JlZ2F0ZUV2ZW50PFQ+Pik6IHZvaWQge1xuXG5cdGV4cGVjdChhY3R1YWxFdmVudHMubGVuZ3RoKS50b0VxdWFsKGV4cGVjdGVkRXZlbnRzLmxlbmd0aCwgJ0FnZ3JlZ2F0ZSBldmVudHMnKTtcblxuXHRmb3IgKGNvbnN0IGFjdHVhbEV2ZW50IG9mIGFjdHVhbEV2ZW50cykge1xuXG5cdFx0Y29uc3QgZXhwZWN0ZWRFdmVudCA9IGV4cGVjdGVkRXZlbnRzLmZpbmQoKGV2ZW50OiBBZ2dyZWdhdGVFdmVudDxUPikgPT4ge1xuXHRcdFx0cmV0dXJuIGV2ZW50LmVxdWFscyhhY3R1YWxFdmVudCk7XG5cdFx0fSk7XG5cblx0XHRleHBlY3QoZXhwZWN0ZWRFdmVudCkudG9CZURlZmluZWQoKTtcblx0fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdGVzdEV2ZW50UmVwb3NpdG9yeUlzRW1wdHlPblN0YXJ0PFQ+KGNyZWF0ZVN0cmVhbTogKCkgPT4gSGVybWVzT2JzZXJ2YWJsZTxUPiwgZGVzYzogc3RyaW5nKTogdm9pZCB7XG5cblx0aXQoJ3Nob3VsZCBiZSBubyAnICsgZGVzYyArICcgZXZlbnRzIG9uIHN0YXJ0JywgKCkgPT4ge1xuXG5cdFx0ZXhwZWN0LmFzc2VydGlvbnMoMyk7XG5cblx0XHQvLyBnaXZlblxuXHRcdGNvbnN0IG5leHRGbiA9IGplc3QuZm4oKSxcblx0XHRcdGVycm9yRm4gPSBqZXN0LmZuKCksXG5cdFx0XHRjb21wbGV0ZUZuID0gamVzdC5mbigpO1xuXG5cdFx0Ly8gd2hlblxuXHRcdGNyZWF0ZVN0cmVhbSgpXG5cdFx0XHQuc3Vic2NyaWJlKFxuXHRcdFx0XHQoKSA9PiBuZXh0Rm4oKSxcblx0XHRcdFx0KGVycjogYW55KSA9PiBlcnJvckZuKGVyciksXG5cdFx0XHRcdCgpID0+IGNvbXBsZXRlRm4oKVxuXHRcdFx0KTtcblxuXHRcdC8vIHRoZW5cblx0XHRleHBlY3QobmV4dEZuKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuXHRcdGV4cGVjdChlcnJvckZuKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuXHRcdGV4cGVjdChjb21wbGV0ZUZuKS5ub3QudG9IYXZlQmVlbkNhbGxlZCgpO1xuXHR9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRlc3RXYXJlaG91c2VEZWZhdWx0VmFsdWVPblN0YXJ0PFQ+KGNyZWF0ZVN0cmVhbTogKCkgPT4gSGVybWVzT2JzZXJ2YWJsZTxUPiwgZGVmYXVsdFZhbHVlOiBULCBkZXNjOiBzdHJpbmcpOiB2b2lkIHtcblxuXHRpdCgnc2hvdWxkIGhhdmUgZGVmYXVsdCB2YWx1ZSAnICsgZGVzYywgKCkgPT4ge1xuXG5cdFx0ZXhwZWN0LmFzc2VydGlvbnMoNCk7XG5cblx0XHQvLyBnaXZlblxuXHRcdGNvbnN0IG5leHRGbiA9IGplc3QuZm4oKSxcblx0XHRcdGVycm9yRm4gPSBqZXN0LmZuKCksXG5cdFx0XHRjb21wbGV0ZUZuID0gamVzdC5mbigpO1xuXG5cdFx0Ly8gd2hlblxuXHRcdGNyZWF0ZVN0cmVhbSgpXG5cdFx0XHQuc3Vic2NyaWJlKFxuXHRcdFx0XHQodmFsdWUpID0+IG5leHRGbih2YWx1ZSksXG5cdFx0XHRcdChlcnI6IGFueSkgPT4gZXJyb3JGbihlcnIpLFxuXHRcdFx0XHQoKSA9PiBjb21wbGV0ZUZuKClcblx0XHRcdCk7XG5cblx0XHQvLyB0aGVuXG5cdFx0ZXhwZWN0KG5leHRGbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoZGVmYXVsdFZhbHVlKTtcblx0XHRleHBlY3QobmV4dEZuKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG5cdFx0ZXhwZWN0KGVycm9yRm4pLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cdFx0ZXhwZWN0KGNvbXBsZXRlRm4pLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cdH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdGVzdFdhcmVob3VzZURlZmF1bHRWYWx1ZU9uU3RhcnRPbmNlPFQ+KGNyZWF0ZVN0cmVhbTogKCkgPT4gSGVybWVzT2JzZXJ2YWJsZTxUPiwgZGVmYXVsdFZhbHVlOiBULCBkZXNjOiBzdHJpbmcpOiB2b2lkIHtcblxuXHRpdCgnc2hvdWxkIGhhdmUgZGVmYXVsdCB2YWx1ZSAnICsgZGVzYywgKCkgPT4ge1xuXG5cdFx0ZXhwZWN0LmFzc2VydGlvbnMoNCk7XG5cblx0XHQvLyBnaXZlblxuXHRcdGNvbnN0IG5leHRGbiA9IGplc3QuZm4oKSxcblx0XHRcdGVycm9yRm4gPSBqZXN0LmZuKCksXG5cdFx0XHRjb21wbGV0ZUZuID0gamVzdC5mbigpO1xuXG5cdFx0Ly8gd2hlblxuXHRcdGNyZWF0ZVN0cmVhbSgpXG5cdFx0XHQuc3Vic2NyaWJlKFxuXHRcdFx0XHQodmFsdWUpID0+IG5leHRGbih2YWx1ZSksXG5cdFx0XHRcdChlcnI6IGFueSkgPT4gZXJyb3JGbihlcnIpLFxuXHRcdFx0XHQoKSA9PiBjb21wbGV0ZUZuKClcblx0XHRcdCk7XG5cblx0XHQvLyB0aGVuXG5cdFx0ZXhwZWN0KG5leHRGbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoZGVmYXVsdFZhbHVlKTtcblx0XHRleHBlY3QobmV4dEZuKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG5cdFx0ZXhwZWN0KGVycm9yRm4pLm5vdC50b0hhdmVCZWVuQ2FsbGVkKCk7XG5cdFx0ZXhwZWN0KGNvbXBsZXRlRm4pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcblx0fSk7XG59XG4iXX0=