import * as i0 from '@angular/core';
import { TemplateRef, Component, ContentChild, EventEmitter, Directive, Input, Output, Injectable, Pipe, ChangeDetectionStrategy, ViewEncapsulation, NgModule, InjectionToken, ViewChild, PLATFORM_ID, Inject, Injector, Optional as Optional$1, ElementRef, Attribute } from '@angular/core';
import * as i4 from '@angular/common';
import { CommonModule, isPlatformBrowser } from '@angular/common';
import * as i1$1 from '@generic-ui/hermes';
import { ReadModelRootId, AggregateId, Archive, HermesSubject, hermesTakeUntil, EventRepository, DomainEvent, AggregateEvent, Command, AggregateRepository, DomainModule, HermesModule, ReadModelObject, Reactive, hermesFilter, hermesMap, hermesTake, hermesSwitchMap, ApiModule, HermesReplaySubject, FeatureModule, CreateAggregateCommand, AggregateArchive, fromRxJsObservable, AggregateRoot, AggregateFactory, InMemoryStore, InMemoryAggregateStore, RandomStringGenerator, Optional, Entity, EntityId, hermesDistinctUntilChanged, toRxJsObservable, EventDrivenRepository, hermesEmpty, ReadModelRoot, InMemoryReadModelStore, hermesTimer, hermesFromEvent, KeyMap, DomainObject, HermesId, ReadModelEntity, ReadModelEntityId, ReadModelRootRepository, COMMAND_LOGGER_ENABLED, EVENT_LOGGER_ENABLED } from '@generic-ui/hermes';
import * as i1 from '@generic-ui/fabric';
import { FabricModule, FabricSelectModule, FabricBadgeModule, FabricButtonModule, FabricButtonGroupModule, FabricCheckboxModule, FabricChipModule, FabricDrawerModule, FabricDropdownModule, FabricRadioButtonModule, FabricRadioGroupModule, FabricProgressBarModule, FabricProgressSpinnerModule, FabricSpinnerModule, FabricTabModule, FabricTooltipModule, FabricToggleButtonModule, FabricInputModule, FabricDialogModule, FabricInlineDialogModule, Theme, Placement, FabricPlacement, FabricDatePickerModule, FabricChipComponent, FabricCheckboxComponent, FabricButtonComponent, FabricInputComponent } from '@generic-ui/fabric';
import { __decorate } from 'tslib';
import { debounceTime, throttleTime, flatMap } from 'rxjs/operators';
import * as i1$2 from '@angular/forms';
import { ReactiveFormsModule } from '@angular/forms';
import * as i1$3 from '@angular/platform-browser';
import { zip, Observable, combineLatest } from 'rxjs';

class GuiListItemComponent {
}
GuiListItemComponent.ɵfac = function GuiListItemComponent_Factory(t) { return new (t || GuiListItemComponent)(); };
GuiListItemComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: GuiListItemComponent, selectors: [["gui-list-item"]], contentQueries: function GuiListItemComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        i0.ɵɵcontentQuery(dirIndex, TemplateRef, 7);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.templateRef = _t.first);
    } }, decls: 0, vars: 0, template: function GuiListItemComponent_Template(rf, ctx) { }, encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(GuiListItemComponent, [{
        type: Component,
        args: [{
                selector: 'gui-list-item',
                template: ''
            }]
    }], null, { templateRef: [{
            type: ContentChild,
            args: [TemplateRef, { static: true }]
        }] }); })();

var PagingDisplayMode;
(function (PagingDisplayMode) {
    PagingDisplayMode[PagingDisplayMode["BASIC"] = 0] = "BASIC";
    PagingDisplayMode[PagingDisplayMode["ADVANCED"] = 1] = "ADVANCED";
})(PagingDisplayMode || (PagingDisplayMode = {}));

class GuiListPagingConverter {
    convert(guiListPaging) {
        const pagingConfig = {};
        if (guiListPaging.enabled !== undefined && guiListPaging.enabled !== null) {
            pagingConfig.enabled = guiListPaging.enabled;
        }
        if (guiListPaging.page !== undefined && guiListPaging.page !== null) {
            pagingConfig.page = guiListPaging.page;
        }
        if (guiListPaging.pageSize !== undefined && guiListPaging.pageSize !== null) {
            pagingConfig.pageSize = guiListPaging.pageSize;
        }
        if (guiListPaging.pageSizes !== undefined && guiListPaging.pageSizes !== null) {
            pagingConfig.pageSizes = guiListPaging.pageSizes;
        }
        if (guiListPaging.pagerTop !== undefined && guiListPaging.pagerTop !== null) {
            pagingConfig.pagerTop = guiListPaging.pagerTop;
        }
        else {
            pagingConfig.pagerTop = true;
        }
        if (guiListPaging.pagerBottom !== undefined && guiListPaging.pagerBottom !== null) {
            pagingConfig.pagerBottom = guiListPaging.pagerBottom;
        }
        pagingConfig.displayMode = PagingDisplayMode.BASIC;
        return pagingConfig;
    }
}

class GuiListCardComponent {
}
GuiListCardComponent.ɵfac = function GuiListCardComponent_Factory(t) { return new (t || GuiListCardComponent)(); };
GuiListCardComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: GuiListCardComponent, selectors: [["gui-list-card"]], contentQueries: function GuiListCardComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        i0.ɵɵcontentQuery(dirIndex, TemplateRef, 7);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.templateRef = _t.first);
    } }, decls: 0, vars: 0, template: function GuiListCardComponent_Template(rf, ctx) { }, encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(GuiListCardComponent, [{
        type: Component,
        args: [{
                selector: 'gui-list-card',
                template: ''
            }]
    }], null, { templateRef: [{
            type: ContentChild,
            args: [TemplateRef, { static: true }]
        }] }); })();

var ListViewMode;
(function (ListViewMode) {
    ListViewMode["LIST"] = "List";
    ListViewMode["CARD"] = "Card";
})(ListViewMode || (ListViewMode = {}));

const enTranslation = {
    sourceEmpty: 'There are no items to show.',
    pagingItemsPerPage: 'Items per page:',
    pagingOf: 'of',
    pagingNextPage: 'Next',
    pagingPrevPage: 'Prev',
    pagingNoItems: 'There is no items.',
    infoPanelShowing: 'Showing',
    infoPanelItems: 'items',
    infoPanelOutOf: 'out of',
    infoPanelThemeMangerTooltipText: 'Theme manager',
    infoPanelColumnManagerTooltipText: 'Column manager',
    infoPanelInfoTooltipText: 'info',
    themeManagerModalTitle: 'Theme manager',
    themeManagerModalTheme: 'Theme:',
    themeManagerModalRowColoring: 'Row coloring:',
    themeManagerModalVerticalGrid: 'Vertical grid',
    themeManagerModalHorizontalGrid: 'HorizontalGrid',
    columnManagerModalTitle: 'Manage columns',
    headerMenuMainTab: 'Menu',
    headerMenuMainTabColumnSort: 'Column sort',
    headerMenuMainTabHideColumn: 'Hide column',
    headerMenuMainTabHighlightColumn: 'Highlight',
    headerMenuMainTabMoveLeft: 'Move left',
    headerMenuMainTabMoveRight: 'Move right',
    headerMenuMainTabColumnSortAscending: 'Ascending',
    headerMenuMainTabColumnSortDescending: 'Descending',
    headerMenuMainTabColumnSortNone: 'None',
    headerMenuFilterTab: 'Filter',
    headerMenuColumnsTab: 'Columns',
    summariesCount: 'Count',
    summariesDist: 'Dist',
    summariesSum: 'Sum',
    summariesAvg: 'Avg',
    summariesMin: 'Min',
    summariesMax: 'Max',
    summariesMed: 'Med',
    summariesTruthy: 'Truthy',
    summariesFalsy: 'Falsy',
    summariesDistinctValuesTooltip: 'Distinct values',
    summariesAverageTooltip: 'Average',
    summariesMinTooltip: 'Min',
    summariesMaxTooltip: 'Max',
    summariesMedTooltip: 'Median',
    summariesCountTooltip: 'Number of items in the grid'
};

const defaultTranslation = enTranslation;

var GuiListMode;
(function (GuiListMode) {
    GuiListMode[GuiListMode["LIST"] = 0] = "LIST";
    GuiListMode[GuiListMode["CARD"] = 1] = "CARD";
})(GuiListMode || (GuiListMode = {}));
var GuiListFieldType;
(function (GuiListFieldType) {
    GuiListFieldType[GuiListFieldType["UNKNOWN"] = 0] = "UNKNOWN";
    GuiListFieldType[GuiListFieldType["NUMBER"] = 1] = "NUMBER";
    GuiListFieldType[GuiListFieldType["STRING"] = 2] = "STRING";
    GuiListFieldType[GuiListFieldType["BOOLEAN"] = 3] = "BOOLEAN";
    GuiListFieldType[GuiListFieldType["DATE"] = 4] = "DATE";
    GuiListFieldType[GuiListFieldType["CUSTOM"] = 5] = "CUSTOM";
})(GuiListFieldType || (GuiListFieldType = {}));
const GuiListDefaultTranslation = defaultTranslation;

class GuiListModeConverter {
    convert(mode) {
        if (mode === GuiListMode.LIST) {
            return ListViewMode.LIST;
        }
        else {
            return ListViewMode.CARD;
        }
    }
}

class ListViewCardTemplate {
    constructor(template, templRef) {
        this.template = template;
        this.templRef = templRef;
    }
    hasTemplateRef() {
        return !!this.templRef;
    }
    getTemplateRef() {
        return this.templRef;
    }
    getTemplateMethod() {
        return this.template;
    }
}

class ListViewTemplate {
    constructor(template, templRef) {
        this.template = template;
        this.templRef = templRef;
    }
    hasTemplateRef() {
        return !!this.templRef;
    }
    getTemplateRef() {
        return this.templRef;
    }
    getTemplateMethod() {
        return this.template;
    }
}

class GuiListGateway {
    constructor() {
        this.pageChanged = new EventEmitter();
        this.pageSizeChanged = new EventEmitter();
        this.searchPhraseChanged = new EventEmitter();
        this.guiListPagingConverter = new GuiListPagingConverter();
        this.guiListModeConverter = new GuiListModeConverter();
    }
    ngOnChanges(changes) {
        const templateRef = this.listItem ? this.listItem.templateRef : null;
        this.containerTemplate = new ListViewTemplate(this.template, templateRef);
        const cardTemplateRef = this.listCard ? this.listCard.templateRef : null;
        this.listCardTemplate = new ListViewCardTemplate(this.cardTemplate, cardTemplateRef);
        if (changes.paging !== undefined && changes.paging.currentValue !== undefined) {
            if (typeof this.paging !== 'boolean') {
                this.paging = this.guiListPagingConverter.convert(this.paging);
            }
        }
        if (changes.view !== undefined && changes.view.currentValue !== undefined) {
            if (this.view.active !== undefined) {
                this.listViewMode = this.guiListModeConverter.convert(this.view.active);
            }
            if (this.view.selector !== undefined) {
                this.listViewModeSelector = this.view.selector;
            }
        }
        if (changes.fields !== undefined && changes.fields.currentValue !== undefined) {
            this.listFields = this.fields.map((f) => {
                return {
                    field: f.field,
                    type: f.type // DataType
                };
            });
        }
        if (changes.searching !== undefined && changes.searching.currentValue !== undefined) {
            this.searchConfig = this.searching;
        }
    }
}
GuiListGateway.ɵfac = function GuiListGateway_Factory(t) { return new (t || GuiListGateway)(); };
GuiListGateway.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: GuiListGateway, contentQueries: function GuiListGateway_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        i0.ɵɵcontentQuery(dirIndex, GuiListItemComponent, 7);
        i0.ɵɵcontentQuery(dirIndex, GuiListCardComponent, 7);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.listItem = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.listCard = _t.first);
    } }, inputs: { source: "source", template: "template", cardTemplate: "cardTemplate", paging: "paging", view: "view", fields: "fields", searching: "searching", localization: "localization" }, outputs: { pageChanged: "pageChanged", pageSizeChanged: "pageSizeChanged", searchPhraseChanged: "searchPhraseChanged" }, features: [i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(GuiListGateway, [{
        type: Directive
    }], null, { listItem: [{
            type: ContentChild,
            args: [GuiListItemComponent, { static: true }]
        }], listCard: [{
            type: ContentChild,
            args: [GuiListCardComponent, { static: true }]
        }], source: [{
            type: Input
        }], template: [{
            type: Input
        }], cardTemplate: [{
            type: Input
        }], paging: [{
            type: Input
        }], view: [{
            type: Input
        }], fields: [{
            type: Input
        }], searching: [{
            type: Input
        }], localization: [{
            type: Input
        }], pageChanged: [{
            type: Output
        }], pageSizeChanged: [{
            type: Output
        }], searchPhraseChanged: [{
            type: Output
        }] }); })();

const guiListProviders = [];

class StructureReadModelRootId extends ReadModelRootId {
    constructor(id) {
        super(id);
    }
    toAggregateId() {
        return new StructureId(this.toString());
    }
}

class StructureId extends AggregateId {
    constructor(id) {
        super(id);
    }
    toReadModelRootId() {
        return new StructureReadModelRootId(this.getId());
    }
}

class StructureIdGenerator {
    constructor() {
        this.increment = 0;
    }
    generateId() {
        this.increment++;
        return this.increment;
    }
}

class ListViewTemplateArchive extends Archive {
    constructor() {
        super();
    }
}
ListViewTemplateArchive.ɵfac = function ListViewTemplateArchive_Factory(t) { return new (t || ListViewTemplateArchive)(); };
ListViewTemplateArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewTemplateArchive, factory: ListViewTemplateArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewTemplateArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ListViewCardTemplateArchive extends Archive {
    constructor() {
        super();
    }
}
ListViewCardTemplateArchive.ɵfac = function ListViewCardTemplateArchive_Factory(t) { return new (t || ListViewCardTemplateArchive)(); };
ListViewCardTemplateArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewCardTemplateArchive, factory: ListViewCardTemplateArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewCardTemplateArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

const listViewProviders = [
    ListViewTemplateArchive,
    ListViewCardTemplateArchive
];

class Modifier {
    constructor(hostElement) {
        this.hostElement = hostElement;
    }
    getElement(htmlElement) {
        return this.createModifier(htmlElement);
    }
    getHost() {
        if (!this.hostElement) {
            throw new Error('Missing host element in DomRenderer constructor.');
        }
        return this.createModifier(this.hostElement);
    }
}

var _a$1;
class ClassModifier extends Modifier {
    constructor(htmlElement) {
        super(htmlElement);
        this.htmlElement = htmlElement;
    }
    createModifier(htmlElement) {
        return new ClassModifier.ClassModifier(htmlElement);
    }
}
ClassModifier.ClassModifier = (_a$1 = class {
        constructor(htmlElement) {
            this.htmlElement = htmlElement;
        }
        add(...classes) {
            this.addClassToDomElement(this.htmlElement, classes);
        }
        remove(...classes) {
            this.removeClassFromDomElement(this.htmlElement, classes);
        }
        clear() {
            this.htmlElement.removeAttribute(ClassModifier.ClassModifier.CLASS);
        }
        addClassToDomElement(htmlElement, classes) {
            for (let i = 0; i < classes.length; i++) {
                htmlElement.classList.add(classes[i]);
            }
        }
        removeClassFromDomElement(htmlElement, classes) {
            for (let i = 0; i < classes.length; i++) {
                htmlElement.classList.remove(classes[i]);
            }
        }
    },
    _a$1.CLASS = 'class',
    _a$1);

class GuiComponent {
    constructor(innerElementRef) {
        this.innerElementRef = innerElementRef;
        this.innerClassModifier = new ClassModifier(this.innerElementRef.nativeElement);
        this.addHostClass();
    }
    addClassToHost(className) {
        this.innerClassModifier.getHost().add(className);
    }
    removeClassFromHost(className) {
        this.innerClassModifier.getHost().remove(className);
    }
    hasChanged(prop) {
        return prop !== undefined && prop.currentValue !== undefined;
    }
    addHostClass() {
        this.innerClassModifier.getHost().add(this.getSelectorName());
    }
}
GuiComponent.ɵfac = function GuiComponent_Factory(t) { return new (t || GuiComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
GuiComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: GuiComponent });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(GuiComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ElementRef }]; }, null); })();

class SmartComponent extends GuiComponent {
    constructor(detector, elementRef) {
        super(elementRef);
        this.detector = detector;
        this.viewInDom = false;
        this.hermesUnsubscribe$ = new HermesSubject();
    }
    ngAfterViewInit() {
        this.viewInDom = true;
    }
    ngOnDestroy() {
        this.hermesUnsubscribe();
    }
    reRender() {
        if (this.isViewInDom()) {
            this.detector.detectChanges();
        }
    }
    isViewInDom() {
        return this.viewInDom;
    }
    hermesSubscribe(stream$, callback) {
        stream$
            .pipe(this.hermesTakeUntil())
            .subscribe((streamValues) => {
            callback(streamValues);
            this.reRender();
        });
    }
    hermesSubscribeWithoutRender(stream$, callback) {
        stream$
            .pipe(this.hermesTakeUntil())
            .subscribe((streamValues) => {
            callback(streamValues);
        });
    }
    // for gate
    subscribeAndEmit(stream$, emitter, mapper = (value) => value) {
        stream$
            .pipe(this.hermesTakeUntil())
            .subscribe((value) => {
            emitter.emit(mapper(value));
        });
    }
    unsubscribe() {
        this.hermesUnsubscribe();
    }
    hermesUnsubscribe() {
        this.hermesUnsubscribe$.next();
        this.hermesUnsubscribe$.complete();
    }
    hermesTakeUntil() {
        return hermesTakeUntil(this.hermesUnsubscribe$);
    }
}
SmartComponent.ɵfac = function SmartComponent_Factory(t) { return new (t || SmartComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
SmartComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: SmartComponent, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SmartComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, null); })();

var PagingPosition;
(function (PagingPosition) {
    PagingPosition[PagingPosition["TOP"] = 0] = "TOP";
    PagingPosition[PagingPosition["BOTTOM"] = 1] = "BOTTOM";
})(PagingPosition || (PagingPosition = {}));

class StreamCloser {
    constructor() {
        this.unsubscribe$ = new HermesSubject();
    }
    takeUntil() {
        return hermesTakeUntil(this.unsubscribe$);
    }
    unsubscribe() {
        if (this.unsubscribe$.isCompleted) {
            return;
        }
        this.unsubscribe$.next();
        this.unsubscribe$.complete();
    }
}

var CssClass;
(function (CssClass) {
    CssClass["SELECTED"] = "selected";
    CssClass["PAGING_TOP_CLASS_NAME"] = "gui-paging-top";
    CssClass["PAGING_BOTTOM_CLASS_NAME"] = "gui-paging-bottom";
})(CssClass || (CssClass = {}));

class CssClassModifier {
    constructor() {
        this.classModifier = new ClassModifier();
    }
    select(htmlElement) {
        this.classModifier.getElement(htmlElement).add(CssClass.SELECTED);
    }
    unselect(htmlElement) {
        this.classModifier.getElement(htmlElement).remove(CssClass.SELECTED);
    }
    add(htmlElement, clazzName) {
        this.classModifier.getElement(htmlElement).add(clazzName);
    }
    remove(htmlElement, clazzName) {
        this.classModifier.getElement(htmlElement).remove(clazzName);
    }
    toggle(htmlElement) {
    }
}
CssClassModifier.ɵfac = function CssClassModifier_Factory(t) { return new (t || CssClassModifier)(); };
CssClassModifier.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CssClassModifier, factory: CssClassModifier.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CssClassModifier, [{
        type: Injectable
    }], null, null); })();

class PagingWarehouse {
    constructor() {
    }
}
PagingWarehouse.ɵfac = function PagingWarehouse_Factory(t) { return new (t || PagingWarehouse)(); };
PagingWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingWarehouse, factory: PagingWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingWarehouse, [{
        type: Injectable
    }], function () { return []; }, null); })();

class PagingCommandInvoker {
    constructor() {
    }
}
PagingCommandInvoker.ɵfac = function PagingCommandInvoker_Factory(t) { return new (t || PagingCommandInvoker)(); };
PagingCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingCommandInvoker, factory: PagingCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingCommandInvoker, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SourceWarehouse {
    constructor() {
    }
}
SourceWarehouse.ɵfac = function SourceWarehouse_Factory(t) { return new (t || SourceWarehouse)(); };
SourceWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceWarehouse, factory: SourceWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceWarehouse, [{
        type: Injectable
    }], function () { return []; }, null); })();

class PagingDisplayModeArchive extends Archive {
    constructor() {
        super(PagingDisplayMode.BASIC);
    }
}
PagingDisplayModeArchive.ɵfac = function PagingDisplayModeArchive_Factory(t) { return new (t || PagingDisplayModeArchive)(); };
PagingDisplayModeArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingDisplayModeArchive, factory: PagingDisplayModeArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingDisplayModeArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class PureComponent extends GuiComponent {
    constructor(elementRef) {
        super(elementRef);
        this.subClassConstructor = this.constructor;
        this.subClassNgOnInit = this.ngOnInit;
        if (!this.hasConstructorOnlyElementRefInjected(arguments)) {
            this.throwError('it should not inject services');
        }
        if (this.subClassNgOnInit) {
            this.throwError('it should not use ngOnInit');
        }
    }
    hasConstructorOnlyElementRefInjected(args) {
        if (arguments.length > 1) {
            return false;
        }
        if (arguments.length === 1) {
            return this.isElementRef(arguments[0]);
        }
        return false;
    }
    isElementRef(elRef) {
        return elRef.nativeElement !== null;
    }
    throwError(reason) {
        throw new Error(`Component "${this.subClassConstructor.name}" is a PureComponent, ${reason}.`);
    }
}
PureComponent.ɵfac = function PureComponent_Factory(t) { return new (t || PureComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
PureComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: PureComponent, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PureComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ElementRef }]; }, null); })();

class TranslationFacade {
}

class TranslationPipe {
    constructor(changeDetectorRef, translationService) {
        this.changeDetectorRef = changeDetectorRef;
        this.translationService = translationService;
        this.actualTranslationValue = '';
    }
    ngOnDestroy() {
        if (this.subscription) {
            this.subscription.unsubscribe();
        }
    }
    transform(key) {
        if (this.subscription) {
            this.subscription.unsubscribe();
        }
        this.subscription =
            this.translationService
                .onTranslation()
                .subscribe((translation) => {
                const value = translation[key];
                if (!value) {
                    this.actualTranslationValue = key;
                }
                this.actualTranslationValue = value;
                this.changeDetectorRef.markForCheck();
            });
        return this.actualTranslationValue;
    }
}
TranslationPipe.ɵfac = function TranslationPipe_Factory(t) { return new (t || TranslationPipe)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef, 16), i0.ɵɵdirectiveInject(TranslationFacade, 16)); };
TranslationPipe.ɵpipe = /*@__PURE__*/ i0.ɵɵdefinePipe({ name: "guiTranslate", type: TranslationPipe, pure: false });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TranslationPipe, [{
        type: Pipe,
        args: [{
                name: 'guiTranslate',
                pure: false
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: TranslationFacade }]; }, null); })();

const _c0$16 = ["gui-paging-select", "", "paging", ""];
class PagingSelectComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.pageSizeChanged = new EventEmitter();
    }
    ngOnChanges(changes) {
        if (changes.paging) {
            if (this.paging) {
                this.selectPageSizes = this.getSelectPageSizes();
                this.selectPageSize = this.getSelectPageSize(this.paging.getPageSize());
            }
        }
    }
    changePageSize(pageSize) {
        this.pageSizeChanged.emit(+pageSize.value);
    }
    getSelectPageSizes() {
        const selectPageSizes = [], pageSizes = this.paging.getPageSizes();
        pageSizes.forEach((pageSize) => {
            const selectOption = this.getSelectPageSize(pageSize);
            selectPageSizes.push(selectOption);
        });
        return selectPageSizes;
    }
    getSelectPageSize(pageSize) {
        return { name: pageSize.toString(), value: pageSize.toString() };
    }
    getSelectorName() {
        return 'gui-paging-select';
    }
}
PagingSelectComponent.ɵfac = function PagingSelectComponent_Factory(t) { return new (t || PagingSelectComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
PagingSelectComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PagingSelectComponent, selectors: [["div", "gui-paging-select", "", "paging", ""]], inputs: { paging: "paging" }, outputs: { pageSizeChanged: "pageSizeChanged" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$16, decls: 4, vars: 6, consts: [[1, "gui-inline-block", "gui-mr-5"], [3, "options", "selected", "width", "optionChanged"]], template: function PagingSelectComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "span", 0);
        i0.ɵɵtext(1);
        i0.ɵɵpipe(2, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(3, "gui-select", 1);
        i0.ɵɵlistener("optionChanged", function PagingSelectComponent_Template_gui_select_optionChanged_3_listener($event) { return ctx.changePageSize($event); });
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(2, 4, "pagingItemsPerPage"), "\n");
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("options", ctx.selectPageSizes)("selected", ctx.selectPageSize)("width", 25);
    } }, directives: [i1.FabricSelectComponent], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingSelectComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-paging-select][paging]',
                templateUrl: './paging-select.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { paging: [{
            type: Input
        }], pageSizeChanged: [{
            type: Output
        }] }); })();

const _c0$15 = ["gui-paging-stats", "", "paging", ""];
function PagingStatsComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "span", 2);
    i0.ɵɵelementStart(2, "span");
    i0.ɵɵtext(3);
    i0.ɵɵelementEnd();
    i0.ɵɵtext(4, " - ");
    i0.ɵɵelementStart(5, "span");
    i0.ɵɵtext(6);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(7, "span");
    i0.ɵɵtext(8);
    i0.ɵɵpipe(9, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(10, "span", 3);
    i0.ɵɵtext(11);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r0.firstItemIndex);
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r0.lastItemIndex);
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(9, 4, "pagingOf"), " ");
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate1(" ", ctx_r0.sourceSize, " ");
} }
function PagingStatsComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 4);
    i0.ɵɵtext(1);
    i0.ɵɵpipe(2, "guiTranslate");
    i0.ɵɵelementEnd();
} if (rf & 2) {
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(2, 1, "pagingNoItems"), " ");
} }
class PagingStatsComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.addClassToHost('gui-mx-6');
    }
    ngOnChanges() {
        this.calculate();
    }
    calculate() {
        if (this.paging) {
            this.firstItemIndex = this.paging.getStart();
            this.lastItemIndex = this.paging.getEnd();
            this.sourceSize = this.paging.getSourceSize();
        }
    }
    isSourceNotEmpty() {
        return this.sourceSize > 0;
    }
    getSelectorName() {
        return 'gui-paging-stats';
    }
}
PagingStatsComponent.ɵfac = function PagingStatsComponent_Factory(t) { return new (t || PagingStatsComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
PagingStatsComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PagingStatsComponent, selectors: [["div", "gui-paging-stats", "", "paging", ""]], inputs: { paging: "paging" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$15, decls: 3, vars: 2, consts: [[4, "ngIf", "ngIfElse"], ["noSource", ""], [1, "gui-paging-source-stats"], [1, "gui-paging-source-size"], [1, "gui-paging-source-stats", "gui-paging-no-items"]], template: function PagingStatsComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, PagingStatsComponent_ng_container_0_Template, 12, 6, "ng-container", 0);
        i0.ɵɵtemplate(1, PagingStatsComponent_ng_template_1_Template, 3, 3, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = i0.ɵɵreference(2);
        i0.ɵɵproperty("ngIf", ctx.isSourceNotEmpty())("ngIfElse", _r1);
    } }, directives: [i4.NgIf], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingStatsComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-paging-stats][paging]',
                templateUrl: './paging-stats.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { paging: [{
            type: Input
        }] }); })();

const _c0$14 = ["gui-paging-navigator", "", "paging", ""];
class PagingNavigatorComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.nextPageChanged = new EventEmitter();
        this.prevPageChanged = new EventEmitter();
        this.prevDisabled = false;
        this.nextDisabled = false;
    }
    ngOnChanges() {
        this.calculatePrev();
        this.calculateNext();
    }
    prevPage() {
        this.prevPageChanged.emit();
    }
    nextPage() {
        this.nextPageChanged.emit();
    }
    getSelectorName() {
        return 'gui-paging-navigator';
    }
    calculatePrev() {
        if (!this.paging) {
            return;
        }
        this.prevDisabled = this.paging.isPrevPageDisabled();
    }
    calculateNext() {
        if (!this.paging && !this.sourceSize) {
            return;
        }
        this.nextDisabled = this.paging.isNextPageDisabled();
    }
}
PagingNavigatorComponent.ɵfac = function PagingNavigatorComponent_Factory(t) { return new (t || PagingNavigatorComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
PagingNavigatorComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PagingNavigatorComponent, selectors: [["div", "gui-paging-navigator", "", "paging", ""]], inputs: { paging: "paging", sourceSize: "sourceSize" }, outputs: { nextPageChanged: "nextPageChanged", prevPageChanged: "prevPageChanged" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$14, decls: 7, vars: 8, consts: [["gui-button", "", 1, "gui-paging-navigator-prev", "gui-mr-5", 3, "disabled", "click"], ["gui-button", "", 1, "gui-paging-navigator-next", "gui-mr-0", 3, "disabled", "click"]], template: function PagingNavigatorComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "gui-button-group");
        i0.ɵɵelementStart(1, "button", 0);
        i0.ɵɵlistener("click", function PagingNavigatorComponent_Template_button_click_1_listener() { return ctx.prevPage(); });
        i0.ɵɵtext(2);
        i0.ɵɵpipe(3, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(4, "button", 1);
        i0.ɵɵlistener("click", function PagingNavigatorComponent_Template_button_click_4_listener() { return ctx.nextPage(); });
        i0.ɵɵtext(5);
        i0.ɵɵpipe(6, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("disabled", ctx.prevDisabled);
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(3, 4, "pagingPrevPage"), " ");
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("disabled", ctx.nextDisabled);
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(6, 6, "pagingNextPage"), " ");
    } }, directives: [i1.FabricButtonGroupComponent, i1.FabricButtonComponent], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingNavigatorComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-paging-navigator][paging]',
                templateUrl: './paging-navigator.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { paging: [{
            type: Input
        }], sourceSize: [{
            type: Input
        }], nextPageChanged: [{
            type: Output
        }], prevPageChanged: [{
            type: Output
        }] }); })();

const _c0$13 = ["gui-paging-alternative-navigator", "", "paging", "", "sourceSize", ""];
const _c1$f = ["*"];
class AlternativePagingNavigatorComponent extends PureComponent {
    constructor(elRef, structureId, pagingCommandInvoker) {
        super(elRef);
        this.structureId = structureId;
        this.pagingCommandInvoker = pagingCommandInvoker;
        this.nextPageChanged = new EventEmitter();
        this.prevPageChanged = new EventEmitter();
        this.prevDisabled = false;
        this.nextDisabled = false;
    }
    ngOnChanges() {
        this.calculatePrev();
        this.calculateNext();
    }
    prevPage() {
        this.prevPageChanged.emit();
    }
    nextPage() {
        this.nextPageChanged.emit();
    }
    firstPage() {
        this.pagingCommandInvoker.goToPage(1, this.paging.getPage(), this.structureId);
    }
    lastPage() {
        const numberOfPages = Math.ceil(this.sourceSize / this.paging.getPageSize());
        this.pagingCommandInvoker.goToPage(numberOfPages, this.paging.getPage(), this.structureId);
    }
    calculatePrev() {
        if (!this.paging) {
            return;
        }
        this.prevDisabled = this.paging.isPrevPageDisabled();
    }
    calculateNext() {
        if (!this.paging && !this.sourceSize) {
            return;
        }
        this.nextDisabled = this.paging.isNextPageDisabled();
    }
    getSelectorName() {
        return 'gui-paging-alternative-navigator';
    }
}
AlternativePagingNavigatorComponent.ɵfac = function AlternativePagingNavigatorComponent_Factory(t) { return new (t || AlternativePagingNavigatorComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(PagingCommandInvoker)); };
AlternativePagingNavigatorComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AlternativePagingNavigatorComponent, selectors: [["div", "gui-paging-alternative-navigator", "", "paging", "", "sourceSize", ""]], inputs: { paging: "paging", sourceSize: "sourceSize" }, outputs: { nextPageChanged: "nextPageChanged", prevPageChanged: "prevPageChanged" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$13, ngContentSelectors: _c1$f, decls: 17, vars: 4, consts: [["gui-button", "", 3, "disabled", "click"], ["height", "10.661", "viewBox", "0 0 11.081 10.661", "width", "11.081", "xmlns", "http://www.w3.org/2000/svg"], ["transform", "translate(-522.98 669.601) rotate(180)"], ["d", "M.75.75,5.02,5.02.75,9.29", "fill", "none", "stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "1.5", "transform", "translate(-533.75 659.25)"], ["d", "M.75.75,5.02,5.02.75,9.29", "fill", "none", "stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "1.5", "transform", "translate(-528.75 659.25)"], ["gui-button", "", 1, "gui-paging-navigator-prev", 3, "disabled", "click"], ["height", "10.661", "viewBox", "0 0 6.081 10.661", "width", "6.081", "xmlns", "http://www.w3.org/2000/svg"], ["d", "M.75.75,5.02,5.02.75,9.29", "fill", "none", "stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "1.5", "transform", "translate(5.77 10.351) rotate(180)"], ["gui-button", "", 1, "gui-paging-navigator-next", 3, "disabled", "click"], ["d", "M.75.75,5.02,5.02.75,9.29", "fill", "none", "stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "1.5", "transform", "translate(0.311 0.311)"], ["transform", "translate(534.061 -658.939)"]], template: function AlternativePagingNavigatorComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵprojectionDef();
        i0.ɵɵelementStart(0, "button", 0);
        i0.ɵɵlistener("click", function AlternativePagingNavigatorComponent_Template_button_click_0_listener() { return ctx.firstPage(); });
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(1, "svg", 1);
        i0.ɵɵelementStart(2, "g", 2);
        i0.ɵɵelement(3, "path", 3);
        i0.ɵɵelement(4, "path", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵnamespaceHTML();
        i0.ɵɵelementStart(5, "button", 5);
        i0.ɵɵlistener("click", function AlternativePagingNavigatorComponent_Template_button_click_5_listener() { return ctx.prevPage(); });
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(6, "svg", 6);
        i0.ɵɵelement(7, "path", 7);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵprojection(8);
        i0.ɵɵnamespaceHTML();
        i0.ɵɵelementStart(9, "button", 8);
        i0.ɵɵlistener("click", function AlternativePagingNavigatorComponent_Template_button_click_9_listener() { return ctx.nextPage(); });
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(10, "svg", 6);
        i0.ɵɵelement(11, "path", 9);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵnamespaceHTML();
        i0.ɵɵelementStart(12, "button", 0);
        i0.ɵɵlistener("click", function AlternativePagingNavigatorComponent_Template_button_click_12_listener() { return ctx.lastPage(); });
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(13, "svg", 1);
        i0.ɵɵelementStart(14, "g", 10);
        i0.ɵɵelement(15, "path", 3);
        i0.ɵɵelement(16, "path", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("disabled", ctx.prevDisabled);
        i0.ɵɵadvance(5);
        i0.ɵɵproperty("disabled", ctx.prevDisabled);
        i0.ɵɵadvance(4);
        i0.ɵɵproperty("disabled", ctx.nextDisabled);
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("disabled", ctx.nextDisabled);
    } }, directives: [i1.FabricButtonComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(AlternativePagingNavigatorComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-paging-alternative-navigator][paging][sourceSize]',
                templateUrl: './alternative-paging-navigator.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: StructureId }, { type: PagingCommandInvoker }]; }, { paging: [{
            type: Input
        }], sourceSize: [{
            type: Input
        }], nextPageChanged: [{
            type: Output
        }], prevPageChanged: [{
            type: Output
        }] }); })();

const _c0$12 = ["gui-paging-alternative-pages", "", "paging", ""];
function AlternativePagingPagesComponent_ng_container_0_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r6 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div");
    i0.ɵɵelementStart(1, "div", 3);
    i0.ɵɵelementStart(2, "div", 4);
    i0.ɵɵlistener("click", function AlternativePagingPagesComponent_ng_container_0_div_1_Template_div_click_2_listener() { const restoredCtx = i0.ɵɵrestoreView(_r6); const page_r4 = restoredCtx.$implicit; const ctx_r5 = i0.ɵɵnextContext(2); return ctx_r5.goToPage(page_r4); });
    i0.ɵɵtext(3);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const page_r4 = ctx.$implicit;
    const ctx_r3 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵclassProp("gui-paging-active-page", ctx_r3.activePage(page_r4))("gui-paging-visible-page", ctx_r3.calculateVisiblePages(page_r4));
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", page_r4, " ");
} }
function AlternativePagingPagesComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, AlternativePagingPagesComponent_ng_container_0_div_1_Template, 4, 5, "div", 2);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngForOf", ctx_r0.pages);
} }
function AlternativePagingPagesComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 5);
    i0.ɵɵtext(1);
    i0.ɵɵpipe(2, "guiTranslate");
    i0.ɵɵelementEnd();
} if (rf & 2) {
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(2, 1, "pagingNoItems"), " ");
} }
class AlternativePagingPagesComponent extends PureComponent {
    constructor(elRef, structureId, pagingCommandService) {
        super(elRef);
        this.structureId = structureId;
        this.pagingCommandService = pagingCommandService;
        this.sourceSize = 0;
        this.numberOfVisiblePages = 3;
    }
    ngOnChanges(changes) {
        this.calculate();
    }
    calculate() {
        if (this.paging && this.sourceSize) {
            const numberOfPages = Math.ceil(this.sourceSize / this.paging.getPageSize());
            this.currentPage = this.paging.getPage();
            this.pages = [];
            if (this.pages.length <= numberOfPages) {
                for (let i = 1; i <= numberOfPages; i++) {
                    this.pages.push(i);
                }
            }
        }
    }
    isSourceNotEmpty() {
        return this.sourceSize > 0;
    }
    goToPage(pageNumber) {
        const currentPage = this.paging.getPage();
        this.pagingCommandService.goToPage(pageNumber, currentPage, this.structureId);
    }
    calculateVisiblePages(page) {
        return this.paging.calculateVisiblePages(this.currentPage, this.numberOfVisiblePages, page);
    }
    activePage(page) {
        return this.currentPage === page;
    }
    getSelectorName() {
        return 'gui-paging-alternative-pages';
    }
}
AlternativePagingPagesComponent.ɵfac = function AlternativePagingPagesComponent_Factory(t) { return new (t || AlternativePagingPagesComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(PagingCommandInvoker)); };
AlternativePagingPagesComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AlternativePagingPagesComponent, selectors: [["div", "gui-paging-alternative-pages", "", "paging", ""]], inputs: { paging: "paging", sourceSize: "sourceSize" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$12, decls: 3, vars: 2, consts: [[4, "ngIf", "ngIfElse"], ["noSource", ""], [4, "ngFor", "ngForOf"], [1, "relative"], [1, "gui-paging-page", "gui-select-none", "gui-cursor-pointer", "gui-py-0", "gui-px-6", "gui-font-base", 3, "click"], [1, "gui-paging-source-stats", "gui-paging-no-items"]], template: function AlternativePagingPagesComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, AlternativePagingPagesComponent_ng_container_0_Template, 2, 1, "ng-container", 0);
        i0.ɵɵtemplate(1, AlternativePagingPagesComponent_ng_template_1_Template, 3, 3, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = i0.ɵɵreference(2);
        i0.ɵɵproperty("ngIf", ctx.isSourceNotEmpty())("ngIfElse", _r1);
    } }, directives: [i4.NgIf, i4.NgForOf], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(AlternativePagingPagesComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-paging-alternative-pages][paging]',
                templateUrl: './alternative-paging-pages.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: StructureId }, { type: PagingCommandInvoker }]; }, { paging: [{
            type: Input
        }], sourceSize: [{
            type: Input
        }] }); })();

const _c0$11 = ["gui-paging", "", "position", ""];
function PagingComponent_ng_container_0_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r6 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "div", 3);
    i0.ɵɵlistener("pageSizeChanged", function PagingComponent_ng_container_0_ng_container_1_Template_div_pageSizeChanged_1_listener($event) { i0.ɵɵrestoreView(_r6); const ctx_r5 = i0.ɵɵnextContext(2); return ctx_r5.changePageSize($event); });
    i0.ɵɵelementEnd();
    i0.ɵɵelement(2, "div", 4);
    i0.ɵɵelementStart(3, "div", 5);
    i0.ɵɵlistener("nextPageChanged", function PagingComponent_ng_container_0_ng_container_1_Template_div_nextPageChanged_3_listener() { i0.ɵɵrestoreView(_r6); const ctx_r7 = i0.ɵɵnextContext(2); return ctx_r7.nextPage(); })("prevPageChanged", function PagingComponent_ng_container_0_ng_container_1_Template_div_prevPageChanged_3_listener() { i0.ɵɵrestoreView(_r6); const ctx_r8 = i0.ɵɵnextContext(2); return ctx_r8.prevPage(); });
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("paging", ctx_r2.paging);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("paging", ctx_r2.paging);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("paging", ctx_r2.paging)("sourceSize", ctx_r2.sourceSize);
} }
function PagingComponent_ng_container_0_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    const _r10 = i0.ɵɵgetCurrentView();
    i0.ɵɵelement(0, "div", 4);
    i0.ɵɵelementStart(1, "div", 5);
    i0.ɵɵlistener("nextPageChanged", function PagingComponent_ng_container_0_ng_template_2_Template_div_nextPageChanged_1_listener() { i0.ɵɵrestoreView(_r10); const ctx_r9 = i0.ɵɵnextContext(2); return ctx_r9.nextPage(); })("prevPageChanged", function PagingComponent_ng_container_0_ng_template_2_Template_div_prevPageChanged_1_listener() { i0.ɵɵrestoreView(_r10); const ctx_r11 = i0.ɵɵnextContext(2); return ctx_r11.prevPage(); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext(2);
    i0.ɵɵproperty("paging", ctx_r4.paging);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("paging", ctx_r4.paging)("sourceSize", ctx_r4.sourceSize);
} }
function PagingComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, PagingComponent_ng_container_0_ng_container_1_Template, 4, 4, "ng-container", 1);
    i0.ɵɵtemplate(2, PagingComponent_ng_container_0_ng_template_2_Template, 2, 3, "ng-template", null, 2, i0.ɵɵtemplateRefExtractor);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const _r3 = i0.ɵɵreference(3);
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", !ctx_r0.minimal)("ngIfElse", _r3);
} }
function PagingComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r13 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "div", 3);
    i0.ɵɵlistener("pageSizeChanged", function PagingComponent_ng_container_1_Template_div_pageSizeChanged_1_listener($event) { i0.ɵɵrestoreView(_r13); const ctx_r12 = i0.ɵɵnextContext(); return ctx_r12.changePageSize($event); });
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(2, "div", 6);
    i0.ɵɵlistener("nextPageChanged", function PagingComponent_ng_container_1_Template_div_nextPageChanged_2_listener() { i0.ɵɵrestoreView(_r13); const ctx_r14 = i0.ɵɵnextContext(); return ctx_r14.nextPage(); })("prevPageChanged", function PagingComponent_ng_container_1_Template_div_prevPageChanged_2_listener() { i0.ɵɵrestoreView(_r13); const ctx_r15 = i0.ɵɵnextContext(); return ctx_r15.prevPage(); });
    i0.ɵɵelement(3, "div", 7);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("paging", ctx_r1.paging);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("paging", ctx_r1.paging)("sourceSize", ctx_r1.sourceSize);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("paging", ctx_r1.paging)("sourceSize", ctx_r1.sourceSize);
} }
class PagingComponent extends SmartComponent {
    constructor(elRef, changeDetectorRef, cssClassModifier, structureId, pagingWarehouse, pagingCommandInvoker, sourceWarehouse, pagingDisplayModeArchive) {
        super(changeDetectorRef, elRef);
        this.elRef = elRef;
        this.changeDetectorRef = changeDetectorRef;
        this.cssClassModifier = cssClassModifier;
        this.structureId = structureId;
        this.pagingWarehouse = pagingWarehouse;
        this.pagingCommandInvoker = pagingCommandInvoker;
        this.sourceWarehouse = sourceWarehouse;
        this.pagingDisplayModeArchive = pagingDisplayModeArchive;
        this.alternativeDisplay = false;
        this.isPagingVisible = false;
        this.localStreamCloser = new StreamCloser();
        this.addClassToHost('gui-flex');
        this.addClassToHost('gui-justify-end');
        this.addClassToHost('gui-items-center');
        this.addClassToHost('gui-p-4');
    }
    ngOnChanges(changes) {
        if (changes.position) {
            if (this.position === PagingPosition.BOTTOM) {
                this.cssClassModifier.remove(this.elRef.nativeElement, CssClass.PAGING_TOP_CLASS_NAME);
                this.cssClassModifier.add(this.elRef.nativeElement, CssClass.PAGING_BOTTOM_CLASS_NAME);
            }
            else {
                this.cssClassModifier.remove(this.elRef.nativeElement, CssClass.PAGING_BOTTOM_CLASS_NAME);
                this.cssClassModifier.add(this.elRef.nativeElement, CssClass.PAGING_TOP_CLASS_NAME);
            }
        }
    }
    ngOnInit() {
        this.hermesSubscribe(this.pagingDisplayModeArchive.on(), (mode) => {
            this.alternativeDisplay = mode === PagingDisplayMode.ADVANCED;
        });
        this.hermesSubscribe(this.pagingWarehouse.onPaging(this.structureId), (paging) => {
            this.paging = paging;
            this.calculatePagingVisibility();
        });
        this.hermesSubscribe(this.sourceWarehouse.onOriginSize(this.structureId), (size) => {
            this.sourceSize = size;
        });
    }
    ngOnDestroy() {
        this.localStreamCloser.unsubscribe();
        super.ngOnDestroy();
    }
    changePageSize(pageSize) {
        this.pagingCommandInvoker.changePageSize(pageSize, this.structureId);
    }
    nextPage() {
        if (!this.sourceSize) {
            return;
        }
        this.pagingCommandInvoker.nextPage(this.structureId);
    }
    prevPage() {
        this.pagingCommandInvoker.prevPage(this.structureId);
    }
    calculatePagingVisibility() {
        this.isPagingVisible = this.paging && this.paging.isEnabled() &&
            (((this.position === PagingPosition.TOP) && this.paging.isPagerTop()) ||
                ((this.position === PagingPosition.BOTTOM) && this.paging.isPagerBottom()));
    }
    getSelectorName() {
        return 'gui-paging';
    }
}
PagingComponent.ɵfac = function PagingComponent_Factory(t) { return new (t || PagingComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(CssClassModifier), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(PagingWarehouse), i0.ɵɵdirectiveInject(PagingCommandInvoker), i0.ɵɵdirectiveInject(SourceWarehouse), i0.ɵɵdirectiveInject(PagingDisplayModeArchive)); };
PagingComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PagingComponent, selectors: [["div", "gui-paging", "", "position", ""]], inputs: { position: "position", minimal: "minimal" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$11, decls: 2, vars: 2, consts: [[4, "ngIf"], [4, "ngIf", "ngIfElse"], ["minimalTemplate", ""], ["gui-paging-select", "", 3, "paging", "pageSizeChanged"], ["gui-paging-stats", "", 3, "paging"], ["gui-paging-navigator", "", 3, "paging", "sourceSize", "nextPageChanged", "prevPageChanged"], ["gui-paging-alternative-navigator", "", 1, "gui-flex", "gui-p-0", 3, "paging", "sourceSize", "nextPageChanged", "prevPageChanged"], ["gui-paging-alternative-pages", "", 1, "gui-flex", "gui-justify-center", 3, "paging", "sourceSize"]], template: function PagingComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, PagingComponent_ng_container_0_Template, 4, 2, "ng-container", 0);
        i0.ɵɵtemplate(1, PagingComponent_ng_container_1_Template, 4, 5, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.isPagingVisible && !ctx.alternativeDisplay);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.isPagingVisible && ctx.alternativeDisplay);
    } }, directives: [i4.NgIf, PagingSelectComponent, PagingStatsComponent, PagingNavigatorComponent, AlternativePagingNavigatorComponent, AlternativePagingPagesComponent], styles: [".gui-paging-alternative-navigator .gui-button{-ms-flex-line-pack:center;align-content:center;background:transparent;display:-ms-flexbox;display:flex;font-size:14px;line-height:21px;margin:0 2px;padding:0}.gui-paging-alternative-navigator .gui-button svg{-ms-flex-item-align:center;align-self:center;height:12px;margin:-1px 2px 0;width:auto}.gui-paging-alternative-navigator .gui-button svg path{stroke:#ccc;transition:stroke .3s ease-in-out}.gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-paging-alternative-navigator .gui-button:hover svg path{stroke:#333}.gui-paging-alternative-navigator .gui-button:disabled svg{opacity:.4}.gui-paging-alternative-navigator .gui-material .gui-button{padding:2px 16px}.gui-paging-alternative-pages{line-height:21px}.gui-paging-alternative-pages .gui-paging-page{display:none}.gui-paging-alternative-pages .gui-paging-visible-page .gui-paging-page{display:block;font-family:Arial,serif}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page{color:#333}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page .gui-paging-page{font-weight:bold}.gui-paging-bottom{border-top:1px solid;border-top-color:inherit}.gui-paging-top{border-bottom:1px solid;border-bottom-color:inherit}\n", ".gui-generic .gui-paging{border-color:rgba(34,36,38,.102);font-size:14px}.gui-generic .gui-paging *{border-color:rgba(34,36,38,.102);font-size:14px}\n"], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-paging][position]',
                templateUrl: './paging.component.html',
                styleUrls: [
                    './style/paging.ngx.scss',
                    './style/theme/generic.paging.ngx.scss'
                ],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: CssClassModifier }, { type: StructureId }, { type: PagingWarehouse }, { type: PagingCommandInvoker }, { type: SourceWarehouse }, { type: PagingDisplayModeArchive }]; }, { position: [{
            type: Input
        }], minimal: [{
            type: Input
        }] }); })();

class PagingEventRepository extends EventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
}
PagingEventRepository.ɵfac = function PagingEventRepository_Factory(t) { return new (t || PagingEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
PagingEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingEventRepository, factory: PagingEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class StructureDomainEvent extends DomainEvent {
}

class PageChangedEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'PageChangedEvent');
    }
}

class StructureAggregateEvent extends AggregateEvent {
}

class PageChangedAggregateEvent extends StructureAggregateEvent {
    constructor(structureId) {
        super(structureId, 'PageChangedAggregateEvent');
    }
    toDomainEvent() {
        return new PageChangedEvent(this.getAggregateId());
    }
}

class PagesizeChangedEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'PagesizeChangedEvent');
    }
}

class PagesizeChangedAggregateEvent extends StructureAggregateEvent {
    constructor(structureId) {
        super(structureId, 'PagesizeChangedAggregateEvent');
    }
    toDomainEvent() {
        return new PagesizeChangedEvent(this.getAggregateId());
    }
}

class PagingManager {
    constructor(enabled, page, pageSize, pageSizes, pagerTop, pagerBottom, sourceSize, logger) {
        this.enabled = enabled;
        this.page = page;
        this.pageSize = pageSize;
        this.pageSizes = pageSizes;
        this.pagerTop = pagerTop;
        this.pagerBottom = pagerBottom;
        this.sourceSize = sourceSize;
        // TODO
        this.events = [];
        this.logger = logger;
    }
    // TODO Remove
    static default(logger) {
        return new PagingManager(false, 1, 25, [10, 25, 50, 100], false, true, 0, logger);
    }
    // TODO Remove
    static fromConfig(paging, logger) {
        const defaultPagingDefinition = PagingManager.default(logger), enabled = paging.enabled || defaultPagingDefinition.isEnabled(), page = paging.page || defaultPagingDefinition.getPage(), pageSize = paging.pageSize || defaultPagingDefinition.getPageSize(), pageSizes = paging.pageSizes || defaultPagingDefinition.getPageSizes(), pagerTop = paging.pagerTop || defaultPagingDefinition.isPagerTop(), pagerBottom = paging.pagerBottom || defaultPagingDefinition.isPagerBottom();
        return new PagingManager(enabled, page, pageSize, pageSizes, pagerTop, pagerBottom, 0, logger);
    }
    isEnabled() {
        return this.enabled;
    }
    isDisabled() {
        return !this.enabled;
    }
    getPage() {
        return this.page;
    }
    getPageSize() {
        return this.pageSize;
    }
    getPageSizes() {
        return this.pageSizes;
    }
    isPagerTop() {
        if (this.isDisabled()) {
            return false;
        }
        return this.pagerTop;
    }
    isPagerBottom() {
        if (this.isDisabled()) {
            return false;
        }
        return this.pagerBottom;
    }
    getSourceSize() {
        return this.sourceSize;
    }
    change(pagingConfig) {
        if (pagingConfig.enabled !== undefined) {
            this.enabled = pagingConfig.enabled;
        }
        if (pagingConfig.page !== undefined) {
            this.page = pagingConfig.page;
            if (pagingConfig.enabled === undefined) {
                this.enabled = true;
            }
        }
        if (pagingConfig.pageSize !== undefined) {
            this.pageSize = pagingConfig.pageSize;
            if (pagingConfig.enabled === undefined) {
                this.enabled = true;
            }
        }
        if (pagingConfig.pageSizes !== undefined) {
            this.pageSizes = pagingConfig.pageSizes;
            if (pagingConfig.enabled === undefined) {
                this.enabled = true;
            }
        }
        if (pagingConfig.pagerTop !== undefined) {
            this.pagerTop = pagingConfig.pagerTop;
            if (pagingConfig.enabled === undefined) {
                this.enabled = true;
            }
        }
        if (pagingConfig.pagerBottom !== undefined) {
            this.pagerBottom = pagingConfig.pagerBottom;
            if (pagingConfig.enabled === undefined) {
                this.enabled = true;
            }
        }
        if (this.enabled === true &&
            pagingConfig.pagerTop === false &&
            pagingConfig.pagerBottom === false) {
            this.pagerBottom = true;
            this.logger.warn('Pagers cannot be turn off when paging is enabled.');
        }
    }
    setSourceSize(size) {
        this.sourceSize = size;
    }
    nextPage() {
        let nextPage = this.page;
        if (!this.isNextPageDisabled()) {
            nextPage += 1;
        }
        this.page = nextPage;
    }
    prevPage() {
        let prevPage = this.page;
        if (!this.isPrevPageDisabled()) {
            prevPage -= 1;
        }
        this.page = prevPage;
    }
    changePageSize(pageSize) {
        if (this.pageSizes.find((ps) => ps === pageSize)) {
            this.setPage(1);
            this.setPageSize(pageSize);
        }
        return this.events;
    }
    isNextPageDisabled() {
        if (this.sourceSize === 0) {
            return true;
        }
        return this.page === Math.ceil(this.sourceSize / this.pageSize);
    }
    isPrevPageDisabled() {
        return this.page === 1;
    }
    calculateStart() {
        const firstItem = 1 + ((this.page - 1) * this.pageSize);
        if (this.sourceSize < firstItem) {
            return 0;
        }
        return firstItem;
    }
    calculateEnd() {
        const lastItem = this.page * this.pageSize;
        if (this.sourceSize < lastItem) {
            return this.sourceSize;
        }
        return lastItem;
    }
    sample(source) {
        if (this.isDisabled()) {
            return source;
        }
        let start = this.calculateStart();
        if (start !== 0) {
            start -= 1;
        }
        return source.slice(start, this.calculateEnd());
    }
    clearEvents() {
        this.events.length = 0;
    }
    setPage(page) {
        this.page = page;
        this.events.push(new PageChangedAggregateEvent(new StructureId('TODO need to be changed')));
    }
    setPageSize(pageSize) {
        this.pageSize = pageSize;
        this.events.push(new PagesizeChangedAggregateEvent(new StructureId('TODO need to be changed')));
    }
}

class Logger {
}

class PagingManagerFactory {
    constructor(logger) {
        this.logger = logger;
    }
    createDefault() {
        return PagingManager.default(this.logger);
    }
    createFromConfig(config) {
        return PagingManager.fromConfig(config, this.logger);
    }
}
PagingManagerFactory.ɵfac = function PagingManagerFactory_Factory(t) { return new (t || PagingManagerFactory)(i0.ɵɵinject(Logger)); };
PagingManagerFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingManagerFactory, factory: PagingManagerFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingManagerFactory, [{
        type: Injectable
    }], function () { return [{ type: Logger }]; }, null); })();

class StructureCommand extends Command {
}

class SetPagingCommand extends StructureCommand {
    constructor(structureId, config) {
        super(structureId, 'SetPagingCommand');
        this.config = config;
    }
    getPagingConfig() {
        return this.config;
    }
}

class ChangePagesizeCommand extends StructureCommand {
    constructor(structureId, pageSize) {
        super(structureId, 'ChangePagesizeCommand');
        this.pageSize = pageSize;
    }
    getPageSize() {
        return this.pageSize;
    }
}

class NextPageCommand extends StructureCommand {
    constructor(structureId) {
        super(structureId, 'NextPageCommand');
    }
}

class PrevPageCommand extends StructureCommand {
    constructor(structureId) {
        super(structureId, 'PrevPageCommand');
    }
}

class PagingDispatcher {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    setPaging(structureId, paging) {
        this.commandDispatcher.dispatch(new SetPagingCommand(structureId, paging));
    }
    changePageSize(structureId, pageSize) {
        this.commandDispatcher.dispatch(new ChangePagesizeCommand(structureId, pageSize));
    }
    nextPage(structureId) {
        this.commandDispatcher.dispatch(new NextPageCommand(structureId));
    }
    prevPage(structureId) {
        this.commandDispatcher.dispatch(new PrevPageCommand(structureId));
    }
}
PagingDispatcher.ɵfac = function PagingDispatcher_Factory(t) { return new (t || PagingDispatcher)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
PagingDispatcher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingDispatcher, factory: PagingDispatcher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingDispatcher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class PagingSetEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'PagingSetEvent');
    }
}

class StructureAggregateRepository extends AggregateRepository {
}

class SetPagingCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetPagingCommand;
    }
    handle(structureAggregate, command) {
        const pagingConfig = command.getPagingConfig();
        structureAggregate.changePaging(pagingConfig);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new PagingSetEvent(command.getAggregateId()));
    }
}
SetPagingCommandHandler.ɵfac = function SetPagingCommandHandler_Factory(t) { return new (t || SetPagingCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetPagingCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetPagingCommandHandler, factory: SetPagingCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetPagingCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class NextPageEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'NextPageEvent');
    }
}

class NextPageCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return NextPageCommand;
    }
    handle(aggregate, command) {
        // missing implementation
        aggregate.nextPage();
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new NextPageEvent(command.getAggregateId()));
    }
}
NextPageCommandHandler.ɵfac = function NextPageCommandHandler_Factory(t) { return new (t || NextPageCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
NextPageCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: NextPageCommandHandler, factory: NextPageCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(NextPageCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class PrevPageEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'PrevPageEvent');
    }
}

class PrevPageCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return PrevPageCommand;
    }
    handle(structure, command) {
        structure.prevPage();
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new PrevPageEvent(command.getAggregateId()));
    }
}
PrevPageCommandHandler.ɵfac = function PrevPageCommandHandler_Factory(t) { return new (t || PrevPageCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
PrevPageCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PrevPageCommandHandler, factory: PrevPageCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PrevPageCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class ChangePagesizeCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return ChangePagesizeCommand;
    }
    handle(structureAggregate, command) {
        const pageSize = command.getPageSize();
        structureAggregate.changePageSize(pageSize);
    }
    publish(aggregate, command) {
        const aggregateEvents = aggregate.getEvents();
        aggregateEvents.forEach((event) => {
            event.aggregateId = aggregate.getId();
        });
        this.publishAggregateEvents(aggregateEvents, command);
        aggregate.clearEvents();
    }
    publishAggregateEvents(events, command) {
        for (const event of events) {
            this.publishAggregateEvent(event, command);
        }
    }
    publishAggregateEvent(event, command) {
        switch (event.getType()) {
            case 'PageChangedAggregateEvent':
                const pageChangedEvent = new PageChangedEvent(command.getAggregateId());
                this.domainEventPublisher.publish(pageChangedEvent);
                break;
            case 'PagesizeChangedAggregateEvent':
                const pagesizeChangedEvent = new PagesizeChangedEvent(command.getAggregateId());
                this.domainEventPublisher.publish(pagesizeChangedEvent);
                break;
            case 'StructurePreparedEntitiesSetAggregateEvent':
                this.domainEventPublisher.publish(event.toDomainEvent());
                break;
            default:
                break;
        }
    }
}
ChangePagesizeCommandHandler.ɵfac = function ChangePagesizeCommandHandler_Factory(t) { return new (t || ChangePagesizeCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
ChangePagesizeCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ChangePagesizeCommandHandler, factory: ChangePagesizeCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ChangePagesizeCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

const structureKey = 'StructureAggregate';

class PagingDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SetPagingCommandHandler, structureKey),
            HermesModule.registerCommandHandler(NextPageCommandHandler, structureKey),
            HermesModule.registerCommandHandler(PrevPageCommandHandler, structureKey),
            HermesModule.registerCommandHandler(ChangePagesizeCommandHandler, structureKey)
        ];
    }
}
PagingDomainModule.ɵfac = function PagingDomainModule_Factory(t) { return new (t || PagingDomainModule)(); };
PagingDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: PagingDomainModule });
PagingDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        PagingDispatcher,
        PagingManagerFactory
    ], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [
                    PagingDispatcher,
                    PagingManagerFactory
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(PagingDomainModule, { imports: [CommonModule] }); })();

let Paging = class Paging {
    constructor(enabled, page, pageSize, pageSizes, pagerTop, pagerBottom, isNextDisabled, isPrevDisabled, start, end, sourceSize) {
        this.enabled = enabled;
        this.page = page;
        this.pageSize = pageSize;
        this.pageSizes = pageSizes;
        this.pagerTop = pagerTop;
        this.pagerBottom = pagerBottom;
        this.isNextDisabled = isNextDisabled;
        this.isPrevDisabled = isPrevDisabled;
        this.start = start;
        this.end = end;
        this.sourceSize = sourceSize;
    }
    isEnabled() {
        return this.enabled;
    }
    getPage() {
        return this.page;
    }
    getPageSize() {
        return this.pageSize;
    }
    getPageSizes() {
        return this.pageSizes;
    }
    isPagerTop() {
        return this.pagerTop;
    }
    isPagerBottom() {
        return this.pagerBottom;
    }
    isNextPageDisabled() {
        return this.isNextDisabled;
    }
    isPrevPageDisabled() {
        return this.isPrevDisabled;
    }
    getStart() {
        return this.start;
    }
    getEnd() {
        return this.end;
    }
    getSourceSize() {
        return this.sourceSize;
    }
    calculateVisiblePages(currentPage, numberOfVisiblePages, page) {
        return currentPage - numberOfVisiblePages < page && page < currentPage + numberOfVisiblePages;
    }
    sample(source) {
        let start = this.getStart();
        if (start !== 0) {
            start -= 1;
        }
        return source.slice(start, this.getEnd());
    }
    // TODO
    compare(target) {
        return JSON.stringify(this) === JSON.stringify(target);
    }
};
Paging = __decorate([
    ReadModelObject
], Paging);

class PagingConverter {
    convert(aggregate) {
        return new Paging(aggregate.isEnabled(), aggregate.getPage(), aggregate.getPageSize(), aggregate.getPageSizes(), aggregate.isPagerTop(), aggregate.isPagerBottom(), aggregate.isNextPageDisabled(), aggregate.isPrevPageDisabled(), aggregate.calculateStart(), aggregate.calculateEnd(), aggregate.getSourceSize());
    }
}
PagingConverter.ɵfac = function PagingConverter_Factory(t) { return new (t || PagingConverter)(); };
PagingConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingConverter, factory: PagingConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingConverter, [{
        type: Injectable
    }], null, null); })();

class StructureReadModelRepository extends Reactive {
    constructor(domainEventBus) {
        super();
        domainEventBus
            .ofEvents(this.forEvents())
            .pipe(this.hermesTakeUntil())
            .subscribe((event) => {
            try {
                this.subs(event);
            }
            catch (e) {
                // eslint-disable-next-line no-console
                console.error(e);
            }
        });
    }
}

class PagingRepository {
    constructor(structureRepository) {
        this.structureRepository = structureRepository;
    }
    on(structureId) {
        return this.structureRepository
            .on(structureId)
            .pipe(hermesFilter((structure) => structure.getId().toString() === structureId.toString()), hermesMap((structure) => structure.getPaging()));
    }
}
PagingRepository.ɵfac = function PagingRepository_Factory(t) { return new (t || PagingRepository)(i0.ɵɵinject(StructureReadModelRepository)); };
PagingRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingRepository, factory: PagingRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingRepository, [{
        type: Injectable
    }], function () { return [{ type: StructureReadModelRepository }]; }, null); })();

class PagingDomainWarehouse extends PagingWarehouse {
    constructor(pagingRepository) {
        super();
        this.pagingRepository = pagingRepository;
    }
    onPaging(structureId) {
        return this.pagingRepository.on(structureId);
    }
    oncePaging(structureId) {
        return this.pagingRepository
            .on(structureId)
            .pipe(hermesTake(1));
    }
}
PagingDomainWarehouse.ɵfac = function PagingDomainWarehouse_Factory(t) { return new (t || PagingDomainWarehouse)(i0.ɵɵinject(PagingRepository)); };
PagingDomainWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingDomainWarehouse, factory: PagingDomainWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingDomainWarehouse, [{
        type: Injectable
    }], function () { return [{ type: PagingRepository }]; }, null); })();

class PagingDomainCommandInvoker extends PagingCommandInvoker {
    constructor(pagingDispatcher) {
        super();
        this.pagingDispatcher = pagingDispatcher;
    }
    enable(structureId) {
        this.pagingDispatcher.setPaging(structureId, { enabled: true });
    }
    disable(structureId) {
        this.pagingDispatcher.setPaging(structureId, { enabled: false });
    }
    setPaging(paging, structureId) {
        this.pagingDispatcher.setPaging(structureId, paging);
    }
    changePageSize(pageSize, structureId) {
        this.pagingDispatcher.changePageSize(structureId, pageSize);
    }
    nextPage(structureId) {
        this.pagingDispatcher.nextPage(structureId);
    }
    prevPage(structureId) {
        this.pagingDispatcher.prevPage(structureId);
    }
    goToPage(pageNumber, currentPage, structureId) {
        if (currentPage < pageNumber) {
            while (currentPage !== pageNumber) {
                this.nextPage(structureId);
                currentPage += 1;
            }
        }
        else {
            while (currentPage !== pageNumber) {
                this.prevPage(structureId);
                currentPage -= 1;
            }
        }
    }
    changePagerTop(enabled, structureId) {
        this.pagingDispatcher.setPaging(structureId, { pagerTop: enabled });
    }
    changePagerBottom(enabled, structureId) {
        this.pagingDispatcher.setPaging(structureId, { pagerBottom: enabled });
    }
}
PagingDomainCommandInvoker.ɵfac = function PagingDomainCommandInvoker_Factory(t) { return new (t || PagingDomainCommandInvoker)(i0.ɵɵinject(PagingDispatcher)); };
PagingDomainCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingDomainCommandInvoker, factory: PagingDomainCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingDomainCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: PagingDispatcher }]; }, null); })();

class PagingDomainEventRepository extends PagingEventRepository {
    constructor(eventBus, pagingWarehouse) {
        super(eventBus);
        this.eventBus = eventBus;
        this.pagingWarehouse = pagingWarehouse;
    }
    onPageChange(structureId) {
        return this.eventBus
            .ofEvents([
            PrevPageEvent,
            NextPageEvent,
            PageChangedEvent
        ])
            .pipe(hermesFilter((event) => event.getAggregateId().toString() === structureId.toAggregateId().toString()), hermesSwitchMap((event) => {
            return this.pagingWarehouse
                .oncePaging(structureId.toAggregateId())
                .pipe(hermesMap((paging) => paging.getPage()));
        }));
    }
    onPageSizeChange(structureId) {
        return this.eventBus
            .ofEvents([
            PagesizeChangedEvent
        ])
            .pipe(hermesFilter((event) => event.getAggregateId().toString() === structureId.toAggregateId().toString()), hermesSwitchMap((event) => {
            return this.pagingWarehouse
                .oncePaging(structureId.toAggregateId())
                .pipe(hermesMap((paging) => paging.getPageSize()));
        }));
    }
}
PagingDomainEventRepository.ɵfac = function PagingDomainEventRepository_Factory(t) { return new (t || PagingDomainEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus), i0.ɵɵinject(PagingWarehouse)); };
PagingDomainEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PagingDomainEventRepository, factory: PagingDomainEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingDomainEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }, { type: PagingWarehouse }]; }, null); })();

class PagingApiModule extends ApiModule {
}
PagingApiModule.ɵfac = /*@__PURE__*/ function () { let ɵPagingApiModule_BaseFactory; return function PagingApiModule_Factory(t) { return (ɵPagingApiModule_BaseFactory || (ɵPagingApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(PagingApiModule)))(t || PagingApiModule); }; }();
PagingApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: PagingApiModule });
PagingApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        {
            provide: PagingCommandInvoker,
            useClass: PagingDomainCommandInvoker
        },
        {
            provide: PagingWarehouse,
            useClass: PagingDomainWarehouse
        },
        {
            provide: PagingEventRepository,
            useClass: PagingDomainEventRepository
        },
        PagingRepository,
        PagingConverter
    ], imports: [[
            CommonModule,
            PagingDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    PagingDomainModule
                ],
                providers: [
                    {
                        provide: PagingCommandInvoker,
                        useClass: PagingDomainCommandInvoker
                    },
                    {
                        provide: PagingWarehouse,
                        useClass: PagingDomainWarehouse
                    },
                    {
                        provide: PagingEventRepository,
                        useClass: PagingDomainEventRepository
                    },
                    PagingRepository,
                    PagingConverter
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(PagingApiModule, { imports: [CommonModule,
        PagingDomainModule] }); })();

class TranslationApiModule extends ApiModule {
}
TranslationApiModule.ɵfac = /*@__PURE__*/ function () { let ɵTranslationApiModule_BaseFactory; return function TranslationApiModule_Factory(t) { return (ɵTranslationApiModule_BaseFactory || (ɵTranslationApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(TranslationApiModule)))(t || TranslationApiModule); }; }();
TranslationApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: TranslationApiModule });
TranslationApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TranslationApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(TranslationApiModule, { imports: [CommonModule] }); })();

class Dictionary {
    constructor() {
        this.translation = new Map();
        this.resolver = (key, value) => value;
    }
    changeTranslation(change) {
        for (const key of Object.keys(change)) {
            this.translation.set(key, change[key]);
        }
    }
    getTranslation() {
        return Array.from(this.translation)
            .reduce((obj, [key, value]) => (Object.assign(obj, { [key]: this.resolver(key, value) })), {});
    }
    setResolver(resolver) {
        this.resolver = resolver;
    }
}

class TranslationDomainFacade extends TranslationFacade {
    constructor() {
        super();
        this.defaultTranslation = enTranslation;
        this.dictionary = new Dictionary();
        this.dictionary$ = new HermesReplaySubject(1);
    }
    getTranslation() {
        return this.dictionary.getTranslation();
    }
    onTranslation() {
        return this.dictionary$.toObservable();
    }
    setDefaultTranslation() {
        this.changeTranslationAndPropagate(this.defaultTranslation);
    }
    changeTranslation(change) {
        this.changeTranslationAndPropagate(change);
    }
    setResolver(resolver) {
        this.setResolverAndPropagate(resolver);
    }
    changeTranslationAndPropagate(change) {
        this.dictionary.changeTranslation(change);
        this.dictionary$.next(this.dictionary.getTranslation());
    }
    setResolverAndPropagate(resolver) {
        this.dictionary.setResolver(resolver);
        this.dictionary$.next(this.dictionary.getTranslation());
    }
}
TranslationDomainFacade.ɵfac = function TranslationDomainFacade_Factory(t) { return new (t || TranslationDomainFacade)(); };
TranslationDomainFacade.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: TranslationDomainFacade, factory: TranslationDomainFacade.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TranslationDomainFacade, [{
        type: Injectable
    }], function () { return []; }, null); })();

class TranslationFeatureModule extends FeatureModule {
    static forComponent() {
        return [{ provide: TranslationFacade, useClass: TranslationDomainFacade }];
    }
}
TranslationFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵTranslationFeatureModule_BaseFactory; return function TranslationFeatureModule_Factory(t) { return (ɵTranslationFeatureModule_BaseFactory || (ɵTranslationFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(TranslationFeatureModule)))(t || TranslationFeatureModule); }; }();
TranslationFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: TranslationFeatureModule });
TranslationFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            TranslationApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TranslationFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    TranslationApiModule
                ],
                declarations: [
                    TranslationPipe
                ],
                exports: [
                    TranslationPipe
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(TranslationFeatureModule, { declarations: [TranslationPipe], imports: [CommonModule,
        TranslationApiModule], exports: [TranslationPipe] }); })();

class PagingFeatureModule extends FeatureModule {
    static forComponent() {
        return [
            PagingDisplayModeArchive
        ];
    }
}
PagingFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵPagingFeatureModule_BaseFactory; return function PagingFeatureModule_Factory(t) { return (ɵPagingFeatureModule_BaseFactory || (ɵPagingFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(PagingFeatureModule)))(t || PagingFeatureModule); }; }();
PagingFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: PagingFeatureModule });
PagingFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            FabricModule,
            PagingApiModule,
            TranslationFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FabricModule,
                    PagingApiModule,
                    TranslationFeatureModule
                ],
                declarations: [
                    PagingComponent,
                    PagingNavigatorComponent,
                    PagingSelectComponent,
                    PagingStatsComponent,
                    AlternativePagingNavigatorComponent,
                    AlternativePagingPagesComponent
                ],
                exports: [
                    PagingComponent,
                    PagingNavigatorComponent,
                    PagingSelectComponent,
                    PagingStatsComponent,
                    AlternativePagingNavigatorComponent,
                    AlternativePagingPagesComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(PagingFeatureModule, { declarations: [PagingComponent,
        PagingNavigatorComponent,
        PagingSelectComponent,
        PagingStatsComponent,
        AlternativePagingNavigatorComponent,
        AlternativePagingPagesComponent], imports: [CommonModule,
        FabricModule,
        PagingApiModule,
        TranslationFeatureModule], exports: [PagingComponent,
        PagingNavigatorComponent,
        PagingSelectComponent,
        PagingStatsComponent,
        AlternativePagingNavigatorComponent,
        AlternativePagingPagesComponent] }); })();

class ListViewId extends AggregateId {
    constructor(id) {
        super(id);
    }
    toReadModelRootId() {
        return new ListViewReadModelRootId(this.getId());
    }
}

class ListViewReadModelRootId extends ReadModelRootId {
    constructor(id) {
        super(id);
    }
    toAggregateId() {
        return new ListViewId(this.getId());
    }
}

const filterContainerToken = new InjectionToken('Filter container token');

class CompositionReadModelRootId extends ReadModelRootId {
    constructor(id) {
        super(id);
    }
    toAggregateId() {
        return new CompositionId(this.toString());
    }
}

class CompositionId extends AggregateId {
    constructor(id) {
        super(id);
    }
    toReadModelRootId() {
        return new CompositionReadModelRootId(this.getId());
    }
}

class SchemaId extends AggregateId {
    constructor(id) {
        super(id);
    }
    toReadModelRootId() {
        return new SchemaReadModelRootId(this.getId());
    }
}

class SchemaReadModelRootId extends ReadModelRootId {
    constructor(id) {
        super(id);
    }
    toAggregateId() {
        return new SchemaId(this.getId());
    }
}

class LayoutComponent extends GuiComponent {
    constructor(elRef) {
        super(elRef);
    }
}
LayoutComponent.ɵfac = function LayoutComponent_Factory(t) { return new (t || LayoutComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
LayoutComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: LayoutComponent, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(LayoutComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ElementRef }]; }, null); })();

class StructureCommandInvoker {
    constructor() {
    }
}
StructureCommandInvoker.ɵfac = function StructureCommandInvoker_Factory(t) { return new (t || StructureCommandInvoker)(); };
StructureCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureCommandInvoker, factory: StructureCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCommandInvoker, [{
        type: Injectable
    }], function () { return []; }, null); })();

const listViewGlobalId = new ListViewReadModelRootId('-1');

class CreateListViewCommand extends CreateAggregateCommand {
    constructor(listViewId) {
        super(listViewId, 'CreateListViewCommand');
    }
}

class ListViewCommand extends Command {
}

class SetListViewModeCommand extends ListViewCommand {
    constructor(listViewId, mode) {
        super(listViewId, 'SetListViewModeCommand');
        this.mode = mode;
    }
    getMode() {
        return this.mode;
    }
}

class ToggleListViewSelectorCommand extends ListViewCommand {
    constructor(listViewId, enabled) {
        super(listViewId, 'ToggleListViewSelectorCommand');
        this.enabled = enabled;
    }
    iseEnabled() {
        return this.enabled;
    }
}

class ListViewDispatcher {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    create(listViewId) {
        this.commandDispatcher.dispatch(new CreateListViewCommand(listViewId));
    }
    setMode(mode, listViewId) {
        this.commandDispatcher.dispatch(new SetListViewModeCommand(listViewId, mode));
    }
    toggleSelector(enabled, listViewId) {
        this.commandDispatcher.dispatch(new ToggleListViewSelectorCommand(listViewId, enabled));
    }
}
ListViewDispatcher.ɵfac = function ListViewDispatcher_Factory(t) { return new (t || ListViewDispatcher)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
ListViewDispatcher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewDispatcher, factory: ListViewDispatcher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewDispatcher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class ListViewCommandInvoker {
    constructor(listViewDispatcher) {
        this.listViewDispatcher = listViewDispatcher;
    }
    create(listViewReadModelRootId = listViewGlobalId) {
        this.listViewDispatcher.create(listViewReadModelRootId.toAggregateId());
    }
    setMode(mode, listViewReadModelRootId = listViewGlobalId) {
        this.listViewDispatcher.setMode(mode, listViewReadModelRootId.toAggregateId());
    }
    toggleSelector(enabled, listViewReadModelRootId = listViewGlobalId) {
        this.listViewDispatcher.toggleSelector(enabled, listViewReadModelRootId.toAggregateId());
    }
}
ListViewCommandInvoker.ɵfac = function ListViewCommandInvoker_Factory(t) { return new (t || ListViewCommandInvoker)(i0.ɵɵinject(ListViewDispatcher)); };
ListViewCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewCommandInvoker, factory: ListViewCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: ListViewDispatcher }]; }, null); })();

class ListViewModeArchive extends AggregateArchive {
    constructor() {
        super(ListViewModeArchive.default);
    }
}
ListViewModeArchive.default = ListViewMode.LIST;
ListViewModeArchive.ɵfac = function ListViewModeArchive_Factory(t) { return new (t || ListViewModeArchive)(); };
ListViewModeArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewModeArchive, factory: ListViewModeArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewModeArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ListViewSelectorArchive extends AggregateArchive {
    constructor() {
        super(ListViewSelectorArchive.default);
    }
}
ListViewSelectorArchive.default = false;
ListViewSelectorArchive.ɵfac = function ListViewSelectorArchive_Factory(t) { return new (t || ListViewSelectorArchive)(); };
ListViewSelectorArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewSelectorArchive, factory: ListViewSelectorArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewSelectorArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ListViewWarehouse {
    constructor(listViewModeArchive, listViewSelectorArchive) {
        this.listViewModeArchive = listViewModeArchive;
        this.listViewSelectorArchive = listViewSelectorArchive;
    }
    onMode(id) {
        return this.listViewModeArchive.on(id);
    }
    onSelector(id) {
        return this.listViewSelectorArchive.on(id);
    }
}
ListViewWarehouse.ɵfac = function ListViewWarehouse_Factory(t) { return new (t || ListViewWarehouse)(i0.ɵɵinject(ListViewModeArchive), i0.ɵɵinject(ListViewSelectorArchive)); };
ListViewWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewWarehouse, factory: ListViewWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewWarehouse, [{
        type: Injectable
    }], function () { return [{ type: ListViewModeArchive }, { type: ListViewSelectorArchive }]; }, null); })();

class SearchCommandInvoker {
    constructor() {
    }
}
SearchCommandInvoker.ɵfac = function SearchCommandInvoker_Factory(t) { return new (t || SearchCommandInvoker)(); };
SearchCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchCommandInvoker, factory: SearchCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchCommandInvoker, [{
        type: Injectable
    }], function () { return []; }, null); })();

class CellEditorManager {
    constructor(config) {
        this.enabled = false;
        this.rowEdit = () => true;
        this.cellEdit = () => true;
        if (config.enabled !== undefined) {
            this.enabled = config.enabled;
        }
        if (config.rowEdit !== undefined) {
            this.rowEdit = config.rowEdit;
        }
        if (config.cellEdit !== undefined) {
            this.cellEdit = config.cellEdit;
        }
    }
    isEnabled(value, item, index) {
        return this.enabled && this.rowEdit(value, item, index) && this.cellEdit(value, item, index);
    }
}

class StructureCellEditArchive extends AggregateArchive {
    constructor() {
        super(StructureCellEditArchive.default);
    }
}
StructureCellEditArchive.default = new CellEditorManager({ enabled: false });
StructureCellEditArchive.ɵfac = function StructureCellEditArchive_Factory(t) { return new (t || StructureCellEditArchive)(); };
StructureCellEditArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureCellEditArchive, factory: StructureCellEditArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCellEditArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructureWarehouse {
    constructor(structureRepository, structureCellEditArchive) {
        this.structureRepository = structureRepository;
        this.structureCellEditArchive = structureCellEditArchive;
    }
    on(structureId) {
        return this.structureRepository.on(structureId);
    }
    onEditManager(structureId) {
        return this.structureCellEditArchive
            .on(structureId);
    }
}
StructureWarehouse.ɵfac = function StructureWarehouse_Factory(t) { return new (t || StructureWarehouse)(i0.ɵɵinject(StructureReadModelRepository), i0.ɵɵinject(StructureCellEditArchive)); };
StructureWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureWarehouse, factory: StructureWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureWarehouse, [{
        type: Injectable
    }], function () { return [{ type: StructureReadModelRepository }, { type: StructureCellEditArchive }]; }, null); })();

class SearchWarehouse {
    constructor() {
    }
}
SearchWarehouse.ɵfac = function SearchWarehouse_Factory(t) { return new (t || SearchWarehouse)(); };
SearchWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchWarehouse, factory: SearchWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchWarehouse, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StaticComponent extends GuiComponent {
    constructor(elementRef, changeDetectorRef) {
        super(elementRef);
        this.changeDetectorRef = changeDetectorRef;
    }
    ngOnInit() {
        this.changeDetectorRef.detach();
    }
}
StaticComponent.ɵfac = function StaticComponent_Factory(t) { return new (t || StaticComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
StaticComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StaticComponent, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StaticComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

class IconComponent extends StaticComponent {
    constructor(elementRef, changeDetectorRef) {
        super(elementRef, changeDetectorRef);
        this.addClassToHost('gui-icon');
    }
}
IconComponent.ɵfac = function IconComponent_Factory(t) { return new (t || IconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
IconComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: IconComponent, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(IconComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

const _c0$10 = ["gui-search-icon", ""];
class SearchIconComponent extends IconComponent {
    constructor(elementRef, changeDetectorRef) {
        super(elementRef, changeDetectorRef);
    }
    getSelectorName() {
        return 'gui-search-icon';
    }
}
SearchIconComponent.ɵfac = function SearchIconComponent_Factory(t) { return new (t || SearchIconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
SearchIconComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: SearchIconComponent, selectors: [["div", "gui-search-icon", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$10, decls: 3, vars: 0, consts: [["xmlns", "http://www.w3.org/2000/svg", "width", "10.231", "height", "10.601", "viewBox", "0 0 10.231 10.601", 1, "gui-search-icon-svg"], ["x2", "1.77", "y2", "1.77", "transform", "translate(7.4 7.77)", "fill", "none", "stroke-linecap", "round", "stroke-linejoin", "round", "stroke-width", "1.5"], ["cx", "4.02", "cy", "4.02", "r", "4.02", "transform", "translate(0.5 0.5)", "stroke-width", "1", "stroke-linecap", "round", "stroke-linejoin", "round", "fill", "none"]], template: function SearchIconComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(0, "svg", 0);
        i0.ɵɵelement(1, "line", 1);
        i0.ɵɵelement(2, "circle", 2);
        i0.ɵɵelementEnd();
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchIconComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-search-icon]',
                template: `
		<svg class="gui-search-icon-svg" xmlns="http://www.w3.org/2000/svg" width="10.231" height="10.601" viewBox="0 0 10.231 10.601">
			<line x2="1.77" y2="1.77" transform="translate(7.4 7.77)" fill="none" stroke-linecap="round"
				  stroke-linejoin="round" stroke-width="1.5"/>
			<circle cx="4.02" cy="4.02" r="4.02" transform="translate(0.5 0.5)" stroke-width="1"
					stroke-linecap="round" stroke-linejoin="round" fill="none"/>
		</svg>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

const _c0$$ = ["formRef"];
const _c1$e = ["gui-search-bar", ""];
function SearchComponent_ng_container_0_span_5_Template(rf, ctx) { if (rf & 1) {
    const _r4 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "span", 6);
    i0.ɵɵlistener("click", function SearchComponent_ng_container_0_span_5_Template_span_click_0_listener() { i0.ɵɵrestoreView(_r4); const ctx_r3 = i0.ɵɵnextContext(2); return ctx_r3.clear(); });
    i0.ɵɵelementEnd();
} }
function SearchComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "form", 1, 2);
    i0.ɵɵelement(3, "div", 3);
    i0.ɵɵelement(4, "input", 4);
    i0.ɵɵtemplate(5, SearchComponent_ng_container_0_span_5_Template, 1, 0, "span", 5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("formGroup", ctx_r0.searchForm);
    i0.ɵɵadvance(3);
    i0.ɵɵproperty("placeholder", ctx_r0.placeholder);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r0.searchForm.controls["searchPhrase"].value);
} }
class SearchComponent extends SmartComponent {
    constructor(formBuilder, changeDetectorRef, elementRef, structureId, searchCommandDispatcher, structureWarehouse, searchWarehouse) {
        super(changeDetectorRef, elementRef);
        this.formBuilder = formBuilder;
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.searchCommandDispatcher = searchCommandDispatcher;
        this.structureWarehouse = structureWarehouse;
        this.searchWarehouse = searchWarehouse;
        const controlsConfig = {};
        controlsConfig[SearchComponent.FORM_SEARCH_NAME] = '';
        this.searchForm = this.formBuilder.group(controlsConfig);
    }
    ngOnInit() {
        this.observeChanges();
        this.hermesSubscribe(this.searchWarehouse.onPlaceholder(this.structureId), (placeholder) => {
            this.placeholder = placeholder;
        });
        this.hermesSubscribe(this.searchWarehouse.onSearchEnabled(this.structureId), (searchingEnabled) => {
            this.searchingEnabled = searchingEnabled;
        });
        this.hermesSubscribeWithoutRender(this.searchWarehouse.onPhrase(this.structureId), (phrase) => {
            if (phrase === undefined) {
                phrase = null;
            }
            const controlsConfig = {};
            controlsConfig[SearchComponent.FORM_SEARCH_NAME] = phrase;
            if (phrase !== this.searchForm.get([SearchComponent.FORM_SEARCH_NAME]).value) {
                this.stopObserveChanges();
                this.searchForm.setValue(controlsConfig);
                this.observeChanges();
            }
        });
    }
    clear() {
        this.searchForm.reset();
    }
    getSelectorName() {
        return 'gui-search-bar';
    }
    observeChanges() {
        this.searchInputSubscription =
            fromRxJsObservable(this.searchForm
                .controls[SearchComponent.FORM_SEARCH_NAME]
                .valueChanges
                .pipe(debounceTime(200)))
                .pipe(this.hermesTakeUntil())
                .subscribe((phrase) => {
                this.searchCommandDispatcher.search(phrase, this.structureId);
            });
    }
    stopObserveChanges() {
        this.searchInputSubscription.unsubscribe();
    }
}
SearchComponent.FORM_SEARCH_NAME = 'searchPhrase';
SearchComponent.ɵfac = function SearchComponent_Factory(t) { return new (t || SearchComponent)(i0.ɵɵdirectiveInject(i1$2.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SearchCommandInvoker), i0.ɵɵdirectiveInject(StructureWarehouse), i0.ɵɵdirectiveInject(SearchWarehouse)); };
SearchComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: SearchComponent, selectors: [["div", "gui-search-bar", ""]], viewQuery: function SearchComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$$, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.formRef = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c1$e, decls: 1, vars: 1, consts: [[4, "ngIf"], [1, "gui-flex", "gui-relative", "gui-w-full", 3, "formGroup"], ["formRef", ""], ["gui-search-icon", ""], ["formControlName", "searchPhrase", 1, "gui-border-0", "gui-w-full", "gui-h-full", "gui-py-5", "gui-pr-5", "gui-pl-21", 3, "placeholder"], ["class", "gui-clear-search-icon", 3, "click", 4, "ngIf"], [1, "gui-clear-search-icon", 3, "click"]], template: function SearchComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, SearchComponent_ng_container_0_Template, 6, 3, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.searchingEnabled);
    } }, directives: [i4.NgIf, i1$2.ɵNgNoValidate, i1$2.NgControlStatusGroup, i1$2.FormGroupDirective, SearchIconComponent, i1$2.DefaultValueAccessor, i1$2.NgControlStatus, i1$2.FormControlName], styles: [".gui-search-bar form{background:#fff}.gui-search-bar form:hover .gui-search-icon-svg line,.gui-search-bar form:hover .gui-search-icon-svg circle{stroke:#333}.gui-search-bar .gui-search-icon-svg{height:17px;left:10px;position:absolute;top:6px;width:17px}.gui-search-bar .gui-search-icon-svg line,.gui-search-bar .gui-search-icon-svg circle{stroke:#ccc;transition:stroke .3s ease-in-out}\n"], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-search-bar]',
                templateUrl: './search.component.html',
                styleUrls: [
                    './style/searching.ngx.scss'
                ],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i1$2.FormBuilder }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: SearchCommandInvoker }, { type: StructureWarehouse }, { type: SearchWarehouse }]; }, { formRef: [{
            type: ViewChild,
            args: ['formRef', { static: false }]
        }] }); })();

const _c0$_ = ["gui-list-mode-select", ""];
class ListViewContainerModeSelectComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, listViewReadModelRootId, listViewWarehouse, listViewModeRepository) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.listViewReadModelRootId = listViewReadModelRootId;
        this.listViewWarehouse = listViewWarehouse;
        this.listViewModeRepository = listViewModeRepository;
        this.options = Object.keys(ListViewMode)
            .map((key) => ListViewMode[key])
            .filter((val) => !Number.isInteger(val))
            .map((val) => {
            return this.toGuiSelectOption(val);
        });
    }
    ngOnInit() {
        this.hermesSubscribe(this.listViewWarehouse.onMode(this.listViewReadModelRootId.toAggregateId()), (mode) => {
            this.listContainerMode = this.toGuiSelectOption(mode);
        });
    }
    changeContainerMode(mode) {
        const selectedMode = this.toListViewMode(mode.value);
        this.listViewModeRepository.next(this.listViewReadModelRootId.toAggregateId(), selectedMode);
    }
    toGuiSelectOption(value) {
        return { value, name: value };
    }
    toListViewMode(mode) {
        switch (mode) {
            case 'List':
                return ListViewMode.LIST;
            case 'Card':
                return ListViewMode.CARD;
            default:
                return ListViewMode.LIST;
        }
    }
    getSelectorName() {
        return 'gui-list-mode-select';
    }
}
ListViewContainerModeSelectComponent.ɵfac = function ListViewContainerModeSelectComponent_Factory(t) { return new (t || ListViewContainerModeSelectComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(ListViewReadModelRootId), i0.ɵɵdirectiveInject(ListViewWarehouse), i0.ɵɵdirectiveInject(ListViewModeArchive)); };
ListViewContainerModeSelectComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ListViewContainerModeSelectComponent, selectors: [["div", "gui-list-mode-select", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$_, decls: 1, vars: 2, consts: [[3, "options", "selected", "optionChanged"]], template: function ListViewContainerModeSelectComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "gui-select", 0);
        i0.ɵɵlistener("optionChanged", function ListViewContainerModeSelectComponent_Template_gui_select_optionChanged_0_listener($event) { return ctx.changeContainerMode($event); });
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("options", ctx.options)("selected", ctx.listContainerMode);
    } }, directives: [i1.FabricSelectComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewContainerModeSelectComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-list-mode-select]',
                templateUrl: './list-view.container-mode-select.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: ListViewReadModelRootId }, { type: ListViewWarehouse }, { type: ListViewModeArchive }]; }, null); })();

const _c0$Z = ["gui-empty-source", "", "items", ""];
function EmptySourceComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵpipe(2, "guiTranslate");
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(2, 1, "sourceEmpty"), "\n");
} }
class EmptySourceComponent extends PureComponent {
    constructor(elRef) {
        super(elRef);
        this.addClassToHost('gui-py-23');
        this.addClassToHost('gui-px-6');
    }
    ngOnChanges(changes) {
        if (this.hasChanged(changes.items)) {
            if (this.items.length === 0) {
                this.removeClassFromHost('gui-hidden');
                this.addClassToHost('gui-block');
            }
            else {
                this.removeClassFromHost('gui-block');
                this.addClassToHost('gui-hidden');
            }
        }
    }
    getSelectorName() {
        return 'gui-empty-source';
    }
}
EmptySourceComponent.ɵfac = function EmptySourceComponent_Factory(t) { return new (t || EmptySourceComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
EmptySourceComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: EmptySourceComponent, selectors: [["div", "gui-empty-source", "", "items", ""]], inputs: { items: "items" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$Z, decls: 1, vars: 1, consts: [[4, "ngIf"]], template: function EmptySourceComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, EmptySourceComponent_ng_container_0_Template, 3, 3, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.items.length === 0);
    } }, directives: [i4.NgIf], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(EmptySourceComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-empty-source][items]',
                templateUrl: './empty-source.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { items: [{
            type: Input
        }] }); })();

const _c0$Y = ["gui-list-view-item", "", "item", "", "template", ""];
function ListViewItemComponent_ng_container_0_2_ng_template_0_Template(rf, ctx) { }
function ListViewItemComponent_ng_container_0_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵtemplate(0, ListViewItemComponent_ng_container_0_2_ng_template_0_Template, 0, 0, "ng-template");
} }
const _c1$d = function (a0) { return { item: a0 }; };
function ListViewItemComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "div", 2);
    i0.ɵɵtemplate(2, ListViewItemComponent_ng_container_0_2_Template, 1, 0, undefined, 3);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("ngTemplateOutlet", ctx_r0.template.getTemplateRef())("ngTemplateOutletContext", i0.ɵɵpureFunction1(2, _c1$d, ctx_r0.item));
} }
function ListViewItemComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 4);
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵproperty("innerHTML", ctx_r2.context, i0.ɵɵsanitizeHtml);
} }
class ListViewItemComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.context = 'Template not provided';
        this.addClassToHost('gui-w-full');
        this.addClassToHost('gui-my-6');
        this.addClassToHost('gui-mx-0');
        this.addClassToHost('gui-block');
    }
    ngOnChanges() {
        if (this.template && this.item) {
            this.hasTemplateRef = this.template.hasTemplateRef();
            if (!this.hasTemplateRef) {
                this.context = this.template.getTemplateMethod()(this.item);
            }
        }
    }
    getSelectorName() {
        return 'gui-list-item';
    }
}
ListViewItemComponent.ɵfac = function ListViewItemComponent_Factory(t) { return new (t || ListViewItemComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
ListViewItemComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ListViewItemComponent, selectors: [["div", "gui-list-view-item", "", "item", "", "template", ""]], inputs: { item: "item", template: "template" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$Y, decls: 3, vars: 2, consts: [[4, "ngIf", "ngIfElse"], ["templateMethod", ""], [1, "gui-list-item-container", "gui-py-8"], [4, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "gui-list-item-container", "gui-py-8", 3, "innerHTML"]], template: function ListViewItemComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, ListViewItemComponent_ng_container_0_Template, 3, 4, "ng-container", 0);
        i0.ɵɵtemplate(1, ListViewItemComponent_ng_template_1_Template, 1, 1, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = i0.ɵɵreference(2);
        i0.ɵɵproperty("ngIf", ctx.hasTemplateRef)("ngIfElse", _r1);
    } }, directives: [i4.NgIf, i4.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewItemComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-list-view-item][item][template]',
                templateUrl: './list-view-item.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { item: [{
            type: Input
        }], template: [{
            type: Input
        }] }); })();

const _c0$X = ["gui-list-view-source", ""];
function ListViewSourceComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 2);
} if (rf & 2) {
    const element_r1 = ctx.$implicit;
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵproperty("item", element_r1)("template", ctx_r0.template);
} }
class ListViewSourceComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, structureSourceWarehouse, containerTemplateArchive) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.structureSourceWarehouse = structureSourceWarehouse;
        this.containerTemplateArchive = containerTemplateArchive;
        this.source = [];
        this.addClassToHost('gui-block');
    }
    ngOnInit() {
        this.hermesSubscribe(this.structureSourceWarehouse.onEntities(this.structureId), (items) => {
            this.source = items.map(i => i.getSourceItem());
        });
        this.hermesSubscribe(this.containerTemplateArchive.on(), (template) => {
            this.template = template;
        });
    }
    getSelectorName() {
        return 'gui-list-view-source';
    }
}
ListViewSourceComponent.ɵfac = function ListViewSourceComponent_Factory(t) { return new (t || ListViewSourceComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SourceWarehouse), i0.ɵɵdirectiveInject(ListViewTemplateArchive)); };
ListViewSourceComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ListViewSourceComponent, selectors: [["div", "gui-list-view-source", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$X, decls: 2, vars: 2, consts: [["gui-list-view-item", "", 3, "item", "template", 4, "ngFor", "ngForOf"], ["gui-empty-source", "", 3, "items"], ["gui-list-view-item", "", 3, "item", "template"]], template: function ListViewSourceComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, ListViewSourceComponent_div_0_Template, 1, 2, "div", 0);
        i0.ɵɵelement(1, "div", 1);
    } if (rf & 2) {
        i0.ɵɵproperty("ngForOf", ctx.source);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("items", ctx.source);
    } }, directives: [i4.NgForOf, EmptySourceComponent, ListViewItemComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewSourceComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-list-view-source]',
                templateUrl: './list-view-source.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: SourceWarehouse }, { type: ListViewTemplateArchive }]; }, null); })();

const _c0$W = ["gui-list-card-item", "", "item", "", "template", ""];
function ListViewCardItemComponent_ng_container_0_2_ng_template_0_Template(rf, ctx) { }
function ListViewCardItemComponent_ng_container_0_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵtemplate(0, ListViewCardItemComponent_ng_container_0_2_ng_template_0_Template, 0, 0, "ng-template");
} }
const _c1$c = function (a0) { return { item: a0 }; };
function ListViewCardItemComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "div", 2);
    i0.ɵɵtemplate(2, ListViewCardItemComponent_ng_container_0_2_Template, 1, 0, undefined, 3);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("ngTemplateOutlet", ctx_r0.template.getTemplateRef())("ngTemplateOutletContext", i0.ɵɵpureFunction1(2, _c1$c, ctx_r0.item));
} }
function ListViewCardItemComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 4);
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵproperty("innerHTML", ctx_r2.context, i0.ɵɵsanitizeHtml);
} }
class ListViewCardItemComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.context = 'Template not provided';
        this.addClassToHost('gui-cursor-pointer');
        this.addClassToHost('gui-block');
        this.addClassToHost('gui-m-0');
        this.addClassToHost('gui-p-0');
        this.addClassToHost('gui-relative');
    }
    ngOnChanges() {
        if (this.template && this.item) {
            this.hasTemplateRef = this.template.hasTemplateRef();
            if (!this.hasTemplateRef) {
                this.context = this.template.getTemplateMethod()(this.item);
            }
        }
    }
    getSelectorName() {
        return 'gui-list-card';
    }
}
ListViewCardItemComponent.ɵfac = function ListViewCardItemComponent_Factory(t) { return new (t || ListViewCardItemComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
ListViewCardItemComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ListViewCardItemComponent, selectors: [["div", "gui-list-card-item", "", "item", "", "template", ""]], inputs: { item: "item", template: "template" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$W, decls: 3, vars: 2, consts: [[4, "ngIf", "ngIfElse"], ["templateMethod", ""], [1, "gui-list-card-wrapper", "gui-h-full", "gui-m-0", "gui-py-0", "gui-px-8", "gui-relative"], [4, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "gui-list-card-wrapper", "gui-h-full", "gui-m-0", "gui-py-0", "gui-px-8", "gui-relative", 3, "innerHTML"]], template: function ListViewCardItemComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, ListViewCardItemComponent_ng_container_0_Template, 3, 4, "ng-container", 0);
        i0.ɵɵtemplate(1, ListViewCardItemComponent_ng_template_1_Template, 1, 1, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = i0.ɵɵreference(2);
        i0.ɵɵproperty("ngIf", ctx.hasTemplateRef)("ngIfElse", _r1);
    } }, directives: [i4.NgIf, i4.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewCardItemComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-list-card-item][item][template]',
                templateUrl: './list-view.card-item.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { item: [{
            type: Input
        }], template: [{
            type: Input
        }] }); })();

const _c0$V = ["gui-list-container-card", ""];
function ListViewContainerCardComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 2);
} if (rf & 2) {
    const element_r1 = ctx.$implicit;
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵproperty("item", element_r1)("template", ctx_r0.cardTemplate);
} }
class ListViewContainerCardComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, structureSourceWarehouse, listCardTemplateArchive) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.structureSourceWarehouse = structureSourceWarehouse;
        this.listCardTemplateArchive = listCardTemplateArchive;
        this.items = [];
        this.addClassToHost('gui-flex');
        this.addClassToHost('gui-flex-wrap');
        this.addClassToHost('gui-m-0');
        this.addClassToHost('gui-p-0');
        this.addClassToHost('gui-rounded');
    }
    ngOnInit() {
        this.hermesSubscribe(this.structureSourceWarehouse.onEntities(this.structureId), (items) => {
            this.items = items.map(i => i.getSourceItem());
        });
        this.hermesSubscribe(this.listCardTemplateArchive.on(), (template) => {
            this.cardTemplate = template;
            this.changeDetectorRef.detectChanges();
        });
    }
    getSelectorName() {
        return 'gui-list-container-card';
    }
}
ListViewContainerCardComponent.ɵfac = function ListViewContainerCardComponent_Factory(t) { return new (t || ListViewContainerCardComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SourceWarehouse), i0.ɵɵdirectiveInject(ListViewCardTemplateArchive)); };
ListViewContainerCardComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ListViewContainerCardComponent, selectors: [["div", "gui-list-container-card", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$V, decls: 2, vars: 2, consts: [["gui-list-card-item", "", 3, "item", "template", 4, "ngFor", "ngForOf"], ["gui-empty-source", "", 3, "items"], ["gui-list-card-item", "", 3, "item", "template"]], template: function ListViewContainerCardComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, ListViewContainerCardComponent_div_0_Template, 1, 2, "div", 0);
        i0.ɵɵelement(1, "div", 1);
    } if (rf & 2) {
        i0.ɵɵproperty("ngForOf", ctx.items);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("items", ctx.items);
    } }, directives: [i4.NgForOf, EmptySourceComponent, ListViewCardItemComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewContainerCardComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-list-container-card]',
                templateUrl: './list-view.container-card.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: SourceWarehouse }, { type: ListViewCardTemplateArchive }]; }, null); })();

const _c0$U = ["gui-list-view-layout", ""];
function ListViewLayoutComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 8);
} }
function ListViewLayoutComponent_div_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 9);
} }
function ListViewLayoutComponent_div_5_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 10);
} }
function ListViewLayoutComponent_div_6_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 11);
} }
class ListViewLayoutComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, listViewReadModelRootId, listViewWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.listViewReadModelRootId = listViewReadModelRootId;
        this.listViewWarehouse = listViewWarehouse;
        this.listModeEnabled = false;
        this.cardModeEnabled = false;
        this.selectorEnabled = false;
        this.searchBarEnabled = true;
    }
    ngOnInit() {
        this.hermesSubscribe(this.listViewWarehouse.onMode(this.listViewReadModelRootId.toAggregateId()), (mode) => {
            this.listModeEnabled = mode === ListViewMode.LIST;
            this.cardModeEnabled = mode === ListViewMode.CARD;
        });
        this.hermesSubscribe(this.listViewWarehouse.onSelector(this.listViewReadModelRootId.toAggregateId()), (enabled) => {
            this.selectorEnabled = enabled;
        });
    }
    getSelectorName() {
        return 'gui-list-view-layout';
    }
}
ListViewLayoutComponent.ɵfac = function ListViewLayoutComponent_Factory(t) { return new (t || ListViewLayoutComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(ListViewReadModelRootId), i0.ɵɵdirectiveInject(ListViewWarehouse)); };
ListViewLayoutComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ListViewLayoutComponent, selectors: [["div", "gui-list-view-layout", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$U, decls: 8, vars: 7, consts: [[1, "gui-flex"], ["class", "gui-flex gui-items-center gui-h-full gui-w-3/5 gui-mr-auto", "gui-search-bar", "", 4, "ngIf"], [1, "gui-list-panel-top", "gui-items-center", "gui-flex", "gui-px-6"], ["gui-list-mode-select", "", 4, "ngIf"], ["gui-paging", "", 1, "gui-ml-auto", 3, "minimal", "position"], ["gui-list-view-source", "", 4, "ngIf"], ["gui-list-container-card", "", 4, "ngIf"], ["gui-paging", "", 1, "gui-ml-auto", 3, "position"], ["gui-search-bar", "", 1, "gui-flex", "gui-items-center", "gui-h-full", "gui-w-3/5", "gui-mr-auto"], ["gui-list-mode-select", ""], ["gui-list-view-source", ""], ["gui-list-container-card", ""]], template: function ListViewLayoutComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵtemplate(1, ListViewLayoutComponent_div_1_Template, 1, 0, "div", 1);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(2, "div", 2);
        i0.ɵɵtemplate(3, ListViewLayoutComponent_div_3_Template, 1, 0, "div", 3);
        i0.ɵɵelement(4, "div", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵtemplate(5, ListViewLayoutComponent_div_5_Template, 1, 0, "div", 5);
        i0.ɵɵtemplate(6, ListViewLayoutComponent_div_6_Template, 1, 0, "div", 6);
        i0.ɵɵelement(7, "div", 7);
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.searchBarEnabled);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngIf", ctx.selectorEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("minimal", true)("position", 0);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.listModeEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.cardModeEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("position", 1);
    } }, directives: [i4.NgIf, PagingComponent, SearchComponent, ListViewContainerModeSelectComponent, ListViewSourceComponent, ListViewContainerCardComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewLayoutComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-list-view-layout]',
                templateUrl: './list-view-layout.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: ListViewReadModelRootId }, { type: ListViewWarehouse }]; }, null); })();

/** @internal */
function listViewIdFactoryForList(generator) {
    return new ListViewReadModelRootId('gui-list-' + generator.generateId());
}
/** @internal */
function structureIdFactoryForList(generator) {
    return new StructureId('gui-list-' + generator.generateId());
}
/** @internal */
function compositionIdFactoryForList(generator) {
    return new CompositionId('gui-list-' + generator.generateId());
}
/** @internal */
function schemaIdFactoryForList(generator) {
    return new SchemaReadModelRootId('gui-list-' + generator.generateId());
}
const componentListProviders = [
    {
        provide: StructureId,
        useFactory: structureIdFactoryForList,
        deps: [
            StructureIdGenerator
        ]
    },
    {
        provide: CompositionId,
        useFactory: compositionIdFactoryForList,
        deps: [
            StructureIdGenerator
        ]
    },
    {
        provide: SchemaReadModelRootId,
        useFactory: schemaIdFactoryForList,
        deps: [
            StructureIdGenerator
        ]
    },
    {
        provide: ListViewReadModelRootId,
        useFactory: listViewIdFactoryForList,
        deps: [
            StructureIdGenerator
        ]
    },
    listViewProviders,
    PagingFeatureModule.forComponent(),
    TranslationFeatureModule.forComponent()
];
class ListViewComponent extends LayoutComponent {
    constructor(structureId, listViewReadModelRootId, elementRef, structureCommandService, listViewCommandDispatcher, translationService) {
        super(elementRef);
        this.structureId = structureId;
        this.listViewReadModelRootId = listViewReadModelRootId;
        this.elementRef = elementRef;
        this.addClassToHost('gui-generic');
        translationService.setDefaultTranslation();
        structureCommandService.create(this.structureId);
        listViewCommandDispatcher.create(this.listViewReadModelRootId);
    }
    getElementRef() {
        return this.elementRef;
    }
    getSelectorName() {
        return 'gui-list-view';
    }
}
ListViewComponent.ɵfac = function ListViewComponent_Factory(t) { return new (t || ListViewComponent)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(ListViewReadModelRootId), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureCommandInvoker), i0.ɵɵdirectiveInject(ListViewCommandInvoker), i0.ɵɵdirectiveInject(TranslationFacade)); };
ListViewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ListViewComponent, selectors: [["gui-list-view"]], hostVars: 1, hostBindings: function ListViewComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵhostProperty("id", ctx.structureId.toString());
    } }, features: [i0.ɵɵProvidersFeature([
            {
                provide: StructureId,
                useFactory: structureIdFactoryForList,
                deps: [
                    StructureIdGenerator
                ]
            },
            {
                provide: CompositionId,
                useFactory: compositionIdFactoryForList,
                deps: [
                    StructureIdGenerator
                ]
            },
            {
                provide: SchemaReadModelRootId,
                useFactory: schemaIdFactoryForList,
                deps: [
                    StructureIdGenerator
                ]
            },
            {
                provide: ListViewReadModelRootId,
                useFactory: listViewIdFactoryForList,
                deps: [
                    StructureIdGenerator
                ]
            },
            listViewProviders,
            PagingFeatureModule.forComponent(),
            TranslationFeatureModule.forComponent(),
            {
                provide: filterContainerToken,
                useExisting: ListViewComponent
            }
        ]), i0.ɵɵInheritDefinitionFeature], decls: 1, vars: 0, consts: [["gui-list-view-layout", ""]], template: function ListViewComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
    } }, directives: [ListViewLayoutComponent], styles: [".gui-box-border{box-sizing:border-box}.gui-bg-transparent{background-color:transparent}.gui-border{border-width:1px}.gui-border-0{border-width:0}.gui-border-b{border-bottom-width:1px}.gui-border-t{border-top-width:1px}.gui-border-solid{border-style:solid}.gui-border-b-solid{border-bottom-style:solid}.gui-border-t-solid{border-top-style:solid}.gui-border-none{border-style:none}.gui-rounded{border-radius:4px}.gui-cursor-pointer{cursor:pointer}.gui-block{display:block}.gui-inline-block{display:inline-block}.gui-inline{display:inline}.gui-flex{display:-ms-flexbox;display:flex}.gui-hidden{display:none}.gui-display-grid{display:grid}.gui-flex-row{-ms-flex-direction:row;flex-direction:row}.gui-flex-row-reverse{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.gui-flex-col{-ms-flex-direction:column;flex-direction:column}.gui-flex-col-reverse{-ms-flex-direction:column-reverse;flex-direction:column-reverse}.gui-justify-start{-ms-flex-pack:start;justify-content:flex-start}.gui-justify-end{-ms-flex-pack:end;justify-content:flex-end}.gui-justify-center{-ms-flex-pack:center;justify-content:center}.gui-justify-between{-ms-flex-pack:justify;justify-content:space-between}.gui-justify-around{-ms-flex-pack:distribute;justify-content:space-around}.gui-justify-evenly{-ms-flex-pack:space-evenly;justify-content:space-evenly}.gui-items-start{-ms-flex-align:start;align-items:flex-start}.gui-items-end{-ms-flex-align:end;align-items:flex-end}.gui-items-center{-ms-flex-align:center;align-items:center}.gui-items-between{-ms-flex-align:space-between;align-items:space-between}.gui-items-around{-ms-flex-align:space-around;align-items:space-around}.gui-items-evenly{-ms-flex-align:space-evenly;align-items:space-evenly}.gui-flex-wrap{-ms-flex-wrap:wrap;flex-wrap:wrap}.gui-flex-wrap-reverse{-ms-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse}.gui-flex-nowrap{-ms-flex-wrap:nowrap;flex-wrap:nowrap}.gui-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.gui-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.gui-grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.gui-grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.gui-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.gui-grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}.gui-grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.gui-grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))}.gui-grid-cols-9{grid-template-columns:repeat(9,minmax(0,1fr))}.gui-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.gui-grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.gui-grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))}.gui-grid-rows-4{grid-template-rows:repeat(4,minmax(0,1fr))}.gui-grid-rows-5{grid-template-rows:repeat(5,minmax(0,1fr))}.gui-grid-rows-6{grid-template-rows:repeat(6,minmax(0,1fr))}.gui-grid-rows-7{grid-template-rows:repeat(7,minmax(0,1fr))}.gui-grid-rows-8{grid-template-rows:repeat(8,minmax(0,1fr))}.gui-grid-rows-9{grid-template-rows:repeat(9,minmax(0,1fr))}.gui-grid-rows-gap-0{grid-row-gap:0}.gui-grid-rows-gap-1{grid-row-gap:1px}.gui-grid-rows-gap-2{grid-row-gap:2px}.gui-grid-rows-gap-3{grid-row-gap:3px}.gui-grid-rows-gap-4{grid-row-gap:4px}.gui-grid-rows-gap-5{grid-row-gap:6px}.gui-grid-rows-gap-6{grid-row-gap:8px}.gui-grid-rows-gap-7{grid-row-gap:10px}.gui-grid-rows-gap-8{grid-row-gap:12px}.gui-grid-rows-gap-23{grid-row-gap:42px}.gui-grid-cols-gap-0{grid-column-gap:0}.gui-grid-cols-gap-1{grid-column-gap:1px}.gui-grid-cols-gap-2{grid-column-gap:2px}.gui-grid-cols-gap-3{grid-column-gap:3px}.gui-grid-cols-gap-4{grid-column-gap:4px}.gui-grid-cols-gap-5{grid-column-gap:6px}.gui-grid-cols-gap-6{grid-column-gap:8px}.gui-grid-cols-gap-7{grid-column-gap:10px}.gui-grid-cols-gap-8{grid-column-gap:12px}.gui-grid-cols-gap-23{grid-column-gap:42px}.gui-h-full{height:100%}.gui-list-none{list-style-type:none}.gui-m-0{margin:0}.gui-mx-0{margin-left:0;margin-right:0}.gui-my-0{margin-bottom:0;margin-top:0}.gui-m-1{margin:1px}.gui-mx-1{margin-left:1px;margin-right:1px}.gui-my-1{margin-bottom:1px;margin-top:1px}.gui-m-2{margin:2px}.gui-mx-2{margin-left:2px;margin-right:2px}.gui-my-2{margin-bottom:2px;margin-top:2px}.gui-m-3{margin:3px}.gui-mx-3{margin-left:3px;margin-right:3px}.gui-my-3{margin-bottom:3px;margin-top:3px}.gui-m-4{margin:4px}.gui-mx-4{margin-left:4px;margin-right:4px}.gui-my-4{margin-bottom:4px;margin-top:4px}.gui-m-5{margin:6px}.gui-mx-5{margin-left:6px;margin-right:6px}.gui-my-5{margin-bottom:6px;margin-top:6px}.gui-m-6{margin:8px}.gui-mx-6{margin-left:8px;margin-right:8px}.gui-my-6{margin-bottom:8px;margin-top:8px}.gui-m-7{margin:10px}.gui-mx-7{margin-left:10px;margin-right:10px}.gui-my-7{margin-bottom:10px;margin-top:10px}.gui-m-8{margin:12px}.gui-mx-8{margin-left:12px;margin-right:12px}.gui-my-8{margin-bottom:12px;margin-top:12px}.gui-m-23{margin:42px}.gui-mx-23{margin-left:42px;margin-right:42px}.gui-my-23{margin-bottom:42px;margin-top:42px}.gui-mb-4{margin-bottom:4px}.gui-mb-6{margin-bottom:8px}.gui-mb-8{margin-bottom:12px}.gui-mb-10{margin-bottom:16px}.gui-mb-18{margin-bottom:32px}.gui-mr-0{margin-right:0}.gui-mr-5{margin-right:6px}.gui-mr-auto{margin-right:auto}.gui-ml-auto{margin-left:auto}.gui-mt-4{margin-top:4px}.gui-mt-6{margin-top:8px}.gui-mt-10{margin-top:16px}.gui-mt-14{margin-top:24px}.gui-overflow-hidden{overflow:hidden}.gui-overflow-y-scroll{overflow-y:scroll}.gui-overflow-x-hidden{overflow-x:hidden}.gui-overflow-auto{overflow:auto}@use \"common/variables\";.gui-p-0{padding:0}.gui-px-0{padding-left:0;padding-right:0}.gui-py-0{padding-bottom:0;padding-top:0}.gui-p-1{padding:1px}.gui-px-1{padding-left:1px;padding-right:1px}.gui-py-1{padding-bottom:1px;padding-top:1px}.gui-p-2{padding:2px}.gui-px-2{padding-left:2px;padding-right:2px}.gui-py-2{padding-bottom:2px;padding-top:2px}.gui-p-3{padding:3px}.gui-px-3{padding-left:3px;padding-right:3px}.gui-py-3{padding-bottom:3px;padding-top:3px}.gui-p-4{padding:4px}.gui-px-4{padding-left:4px;padding-right:4px}.gui-py-4{padding-bottom:4px;padding-top:4px}.gui-p-5{padding:6px}.gui-px-5{padding-left:6px;padding-right:6px}.gui-py-5{padding-bottom:6px;padding-top:6px}.gui-p-6{padding:8px}.gui-px-6{padding-left:8px;padding-right:8px}.gui-py-6{padding-bottom:8px;padding-top:8px}.gui-p-7{padding:10px}.gui-px-7{padding-left:10px;padding-right:10px}.gui-py-7{padding-bottom:10px;padding-top:10px}.gui-p-8{padding:12px}.gui-px-8{padding-left:12px;padding-right:12px}.gui-py-8{padding-bottom:12px;padding-top:12px}.gui-p-23{padding:42px}.gui-px-23{padding-left:42px;padding-right:42px}.gui-py-23{padding-bottom:42px;padding-top:42px}.gui-pr-10{padding-right:16px}.gui-pl-9{padding-right:10px}.gui-pb-6{padding-bottom:8px}.gui-pl-21{padding-left:38px}.gui-pt-4{padding-top:4px}.gui-pt-6{padding-top:8px}.gui-pt-10{padding-top:16px}.gui-pt-14{padding-top:24px}.gui-static{position:static}.gui-fixed{position:fixed}.gui-relative{position:relative}.gui-absolute{position:absolute}.gui-text-xxs{font-size:11px}.gui-text-xs{font-size:12px}.gui-text-sm{font-size:13px}.gui-text-base{font-size:14px}.gui-text-lg{font-size:16px}.gui-text-xl{font-size:18px}.gui-text-2xl{font-size:20px}.gui-text-3xl{font-size:22px}.gui-leading-4{line-height:16px}.gui-leading-6{line-height:24px}.gui-font-thin{font-weight:100}.gui-font-extralight{font-weight:200}.gui-font-light{font-weight:300}.gui-font-normal{font-weight:400}.gui-font-medium{font-weight:500}.gui-font-semibold{font-weight:600}.gui-font-bold{font-weight:700}.gui-font-extrabold{font-weight:800}.gui-font-black{font-weight:900}.gui-italic{font-style:italic}.gui-not-italic{font-style:normal}.gui-whitespace-nowrap{white-space:nowrap}.gui-overflow-ellipsis{text-overflow:ellipsis}.gui-no-underline{text-decoration:none}.gui-w-full{width:100%}.gui-w-96{width:384px}.gui-w-3\\/5{width:60%}.gui-list-view{border-color:#d6d6d6}.gui-list-view *,.gui-list-view *:after,.gui-list-view *:before{box-sizing:border-box}.gui-list-view input{font-size:13px;outline:0}.gui-list-view *{border-color:#d6d6d6}.gui-list-view .gui-search-bar form .gui-search-icon-svg{top:10px}.gui-list-view .gui-search-bar form input{font-size:14px;padding:10px 6px 10px 38px}.gui-list-card-wrapper{border:1px solid transparent;min-height:100px;transition:.2s all}.gui-list-card-wrapper:hover{border:1px solid #d6d6d6;box-shadow:0 2px 6px rgba(0,0,0,.149)}.gui-list-container-card{border-top:1px solid #d6d6d6}\n", ".gui-list-item{border:1px solid rgba(0,0,0,.1);box-shadow:0 2px 6px rgba(0,0,0,.149)}@media (min-width: 480px){.gui-list-card{width:100%}.gui-list-item-container{padding-left:8px;padding-right:8px}}@media (min-width: 768px){.gui-list-card{width:50%}.gui-list-item-container{padding-left:12px;padding-right:12px}}@media (min-width: 992px){.gui-list-card{width:33.3333%}.gui-list-item-container{padding-left:12px;padding-right:12px}}@media (min-width: 1200px){.gui-list-card{width:33.3333%}.gui-list-item-container{padding-left:16px;padding-right:16px}}\n", ".gui-list-view.gui-generic .gui-paging{border:0}\n"], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewComponent, [{
        type: Component,
        args: [{
                selector: 'gui-list-view',
                templateUrl: './list-view.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                providers: [
                    {
                        provide: StructureId,
                        useFactory: structureIdFactoryForList,
                        deps: [
                            StructureIdGenerator
                        ]
                    },
                    {
                        provide: CompositionId,
                        useFactory: compositionIdFactoryForList,
                        deps: [
                            StructureIdGenerator
                        ]
                    },
                    {
                        provide: SchemaReadModelRootId,
                        useFactory: schemaIdFactoryForList,
                        deps: [
                            StructureIdGenerator
                        ]
                    },
                    {
                        provide: ListViewReadModelRootId,
                        useFactory: listViewIdFactoryForList,
                        deps: [
                            StructureIdGenerator
                        ]
                    },
                    listViewProviders,
                    PagingFeatureModule.forComponent(),
                    TranslationFeatureModule.forComponent(),
                    {
                        provide: filterContainerToken,
                        useExisting: ListViewComponent
                    }
                ],
                styleUrls: [
                    './style/list-view.ngx.scss',
                    './source/list-view-source.component.ngx.scss',
                    './style/theme/generic.list.ngx.scss'
                ],
                host: {
                    '[id]': 'structureId.toString()'
                }
            }]
    }], function () { return [{ type: StructureId }, { type: ListViewReadModelRootId }, { type: i0.ElementRef }, { type: StructureCommandInvoker }, { type: ListViewCommandInvoker }, { type: TranslationFacade }]; }, null); })();

class Gate {
    constructor() {
        this.streamCloser = new StreamCloser();
        this.hermesUnsubscribe$ = new HermesSubject();
    }
    ngOnDestroy() {
        this.streamCloser.unsubscribe();
        this.hermesUnsubscribe();
    }
    isDefined(propertyName, changes) {
        return changes[propertyName] !== undefined && changes[propertyName].currentValue !== undefined;
    }
    subscribeAndEmit(stream$, emitter) {
        stream$
            .pipe(this.hermesTakeUntil())
            .subscribe((value) => {
            emitter.emit(value);
        });
    }
    unsubscribe() {
        this.streamCloser.unsubscribe();
    }
    hermesUnsubscribe() {
        this.hermesUnsubscribe$.next();
        this.hermesUnsubscribe$.complete();
    }
    hermesTakeUntil() {
        return hermesTakeUntil(this.hermesUnsubscribe$);
    }
    takeUntil() {
        return this.streamCloser.takeUntil();
    }
}
Gate.ɵfac = function Gate_Factory(t) { return new (t || Gate)(); };
Gate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: Gate });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(Gate, [{
        type: Directive
    }], function () { return []; }, null); })();

class InitFieldsCommand extends StructureCommand {
    constructor(structureId, fieldConfigs) {
        super(structureId, 'InitFieldsCommand');
        this.fieldConfigs = fieldConfigs;
    }
    getFieldConfigs() {
        return this.fieldConfigs;
    }
}

class FieldCommandInvoker {
    constructor(domainEventBus, commandDispatcher) {
        this.domainEventBus = domainEventBus;
        this.commandDispatcher = commandDispatcher;
    }
    initFields(fieldConfigs, structureId) {
        this.commandDispatcher.dispatch(new InitFieldsCommand(structureId, fieldConfigs));
    }
}
FieldCommandInvoker.ɵfac = function FieldCommandInvoker_Factory(t) { return new (t || FieldCommandInvoker)(i0.ɵɵinject(i1$1.DomainEventBus), i0.ɵɵinject(i1$1.CommandDispatcher)); };
FieldCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FieldCommandInvoker, factory: FieldCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }, { type: i1$1.CommandDispatcher }]; }, null); })();

class ListViewFieldGate extends Gate {
    constructor(structureId, fieldCommandDispatcher) {
        super();
        this.structureId = structureId;
        this.fieldCommandDispatcher = fieldCommandDispatcher;
    }
    ngOnChanges(changes) {
        if (this.isDefined('fields', changes)) {
            this.fieldCommandDispatcher.initFields(this.fields, this.structureId);
        }
    }
}
ListViewFieldGate.ɵfac = function ListViewFieldGate_Factory(t) { return new (t || ListViewFieldGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FieldCommandInvoker)); };
ListViewFieldGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ListViewFieldGate, selectors: [["gui-list-view", "fields", ""]], inputs: { fields: "fields" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewFieldGate, [{
        type: Directive,
        args: [{
                selector: 'gui-list-view[fields]'
            }]
    }], function () { return [{ type: StructureId }, { type: FieldCommandInvoker }]; }, { fields: [{
            type: Input
        }] }); })();

class SourceCommandInvoker {
    constructor() {
    }
}
SourceCommandInvoker.ɵfac = function SourceCommandInvoker_Factory(t) { return new (t || SourceCommandInvoker)(); };
SourceCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceCommandInvoker, factory: SourceCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceCommandInvoker, [{
        type: Injectable
    }], function () { return []; }, null); })();

class EditemItemValues {
    constructor(after, before) {
        this.after = after;
        this.before = before;
    }
}

class StructureSourceItemEditedEvent extends StructureDomainEvent {
    constructor(aggregateId, beforeItem, afterItem) {
        super(aggregateId, { beforeItem, afterItem }, 'StructureSourceItemEditedEvent');
        this.beforeItem = beforeItem;
        this.afterItem = afterItem;
    }
    getBeforeItem() {
        return this.beforeItem;
    }
    getAfterItem() {
        return this.afterItem;
    }
}

class SourceEventService {
    constructor(domainEventBus) {
        this.domainEventBus = domainEventBus;
    }
    onSourceEdited(structureId) {
        return this.domainEventBus
            .ofEvents([
            StructureSourceItemEditedEvent
        ])
            .pipe(hermesFilter((event) => event.getAggregateId().toString() === structureId.toString()), hermesMap((event) => {
            const afterItem = event.getAfterItem().getSourceItem(), beforeItem = event.getBeforeItem().getSourceItem();
            return new EditemItemValues(afterItem, beforeItem);
        }));
    }
}
SourceEventService.ɵfac = function SourceEventService_Factory(t) { return new (t || SourceEventService)(i0.ɵɵinject(i1$1.DomainEventBus)); };
SourceEventService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceEventService, factory: SourceEventService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceEventService, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class SourceGate extends Gate {
    constructor(structureId, sourceCommandInvoker, sourceEventService) {
        super();
        this.structureId = structureId;
        this.sourceCommandInvoker = sourceCommandInvoker;
        this.sourceEventService = sourceEventService;
        this.source = [];
        this.items = [];
        this.sourceEdited = new EventEmitter();
    }
    ngOnChanges(changes) {
        /**
         * Setting source should be last step
         */
        if (this.isDefined('source', changes)) {
            this.sourceCommandInvoker.setOrigin(this.source, this.structureId);
        }
        if (this.isDefined('items', changes)) {
            this.sourceCommandInvoker.setOrigin(this.items, this.structureId);
        }
    }
    ngOnInit() {
        this.subscribeAndEmit(this.sourceEventService.onSourceEdited(this.structureId), this.sourceEdited);
    }
    ngOnDestroy() {
        super.ngOnDestroy();
    }
}
SourceGate.ɵfac = function SourceGate_Factory(t) { return new (t || SourceGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SourceCommandInvoker), i0.ɵɵdirectiveInject(SourceEventService)); };
SourceGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: SourceGate, inputs: { source: "source", items: "items" }, outputs: { sourceEdited: "sourceEdited" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceGate, [{
        type: Directive
    }], function () { return [{ type: StructureId }, { type: SourceCommandInvoker }, { type: SourceEventService }]; }, { source: [{
            type: Input
        }], items: [{
            type: Input
        }], sourceEdited: [{
            type: Output
        }] }); })();

class ListViewSourceGate extends SourceGate {
    constructor(structureId, sourceCommandService, sourceEventService) {
        super(structureId, sourceCommandService, sourceEventService);
        this.sourceCommandService = sourceCommandService;
        this.sourceEventService = sourceEventService;
    }
}
ListViewSourceGate.ɵfac = function ListViewSourceGate_Factory(t) { return new (t || ListViewSourceGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SourceCommandInvoker), i0.ɵɵdirectiveInject(SourceEventService)); };
ListViewSourceGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ListViewSourceGate, selectors: [["gui-list-view", "items", ""]], features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewSourceGate, [{
        type: Directive,
        args: [{
                selector: 'gui-list-view[items]'
            }]
    }], function () { return [{ type: StructureId }, { type: SourceCommandInvoker }, { type: SourceEventService }]; }, null); })();

class ListViewL10nGate extends Gate {
    constructor(translationService) {
        super();
        this.translationService = translationService;
    }
    ngOnChanges(changes) {
        if (this.isDefined('localization', changes)) {
            if (this.localization.translationResolver) {
                this.translationService.setResolver(this.localization.translationResolver);
            }
            if (this.localization.translation) {
                this.translationService.changeTranslation(this.localization.translation);
            }
        }
    }
}
ListViewL10nGate.ɵfac = function ListViewL10nGate_Factory(t) { return new (t || ListViewL10nGate)(i0.ɵɵdirectiveInject(TranslationFacade)); };
ListViewL10nGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ListViewL10nGate, selectors: [["gui-list-view", "localization", ""]], inputs: { localization: "localization" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewL10nGate, [{
        type: Directive,
        args: [{
                selector: 'gui-list-view[localization]'
            }]
    }], function () { return [{ type: TranslationFacade }]; }, { localization: [{
            type: Input
        }] }); })();

class ListViewModeGate extends Gate {
    constructor(listViewReadModelRootId, listViewCommandDispatcher) {
        super();
        this.listViewReadModelRootId = listViewReadModelRootId;
        this.listViewCommandDispatcher = listViewCommandDispatcher;
    }
    ngOnChanges(changes) {
        if (this.isDefined('mode', changes)) {
            this.listViewCommandDispatcher.setMode(this.mode, this.listViewReadModelRootId);
        }
        if (this.isDefined('modeSelector', changes)) {
            this.listViewCommandDispatcher.toggleSelector(this.modeSelector, this.listViewReadModelRootId);
        }
    }
}
ListViewModeGate.ɵfac = function ListViewModeGate_Factory(t) { return new (t || ListViewModeGate)(i0.ɵɵdirectiveInject(ListViewReadModelRootId), i0.ɵɵdirectiveInject(ListViewCommandInvoker)); };
ListViewModeGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ListViewModeGate, selectors: [["gui-list-view", "mode", ""]], inputs: { mode: "mode", modeSelector: "modeSelector" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewModeGate, [{
        type: Directive,
        args: [{
                selector: 'gui-list-view[mode]'
            }]
    }], function () { return [{ type: ListViewReadModelRootId }, { type: ListViewCommandInvoker }]; }, { mode: [{
            type: Input
        }], modeSelector: [{
            type: Input
        }] }); })();

class ListViewTemplateGate extends Gate {
    constructor(containerTemplateArchive, listCardTemplateArchive) {
        super();
        this.containerTemplateArchive = containerTemplateArchive;
        this.listCardTemplateArchive = listCardTemplateArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('template', changes)) {
            this.containerTemplateArchive.next(this.template);
        }
        if (this.isDefined('cardTemplate', changes)) {
            this.listCardTemplateArchive.next(this.cardTemplate);
        }
    }
}
ListViewTemplateGate.ɵfac = function ListViewTemplateGate_Factory(t) { return new (t || ListViewTemplateGate)(i0.ɵɵdirectiveInject(ListViewTemplateArchive), i0.ɵɵdirectiveInject(ListViewCardTemplateArchive)); };
ListViewTemplateGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ListViewTemplateGate, selectors: [["gui-list-view", "mode", ""]], inputs: { template: "template", cardTemplate: "cardTemplate" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewTemplateGate, [{
        type: Directive,
        args: [{
                selector: 'gui-list-view[mode]'
            }]
    }], function () { return [{ type: ListViewTemplateArchive }, { type: ListViewCardTemplateArchive }]; }, { template: [{
            type: Input
        }], cardTemplate: [{
            type: Input
        }] }); })();

class PagingGate extends Gate {
    constructor(structureId, compositionId, pagingCommandInvoker, pagingEventRepository) {
        super();
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.pagingCommandInvoker = pagingCommandInvoker;
        this.pagingEventRepository = pagingEventRepository;
        this.pageChanged = new EventEmitter();
        this.pageSizeChanged = new EventEmitter();
    }
    ngOnChanges(changes) {
        if (this.isDefined('paging', changes)) {
            let pagingConfig;
            if (typeof this.paging === 'boolean') {
                pagingConfig = {
                    enabled: this.paging
                };
            }
            else {
                pagingConfig = this.paging;
            }
            this.pagingCommandInvoker.setPaging(pagingConfig, this.compositionId);
        }
    }
    ngOnInit() {
        this.subscribeAndEmit(this.pagingEventRepository.onPageChange(this.structureId.toReadModelRootId()), this.pageChanged);
        this.subscribeAndEmit(this.pagingEventRepository.onPageSizeChange(this.structureId.toReadModelRootId()), this.pageSizeChanged);
    }
    onPageChange(page) {
        this.pageChanged.emit(page);
    }
}
PagingGate.ɵfac = function PagingGate_Factory(t) { return new (t || PagingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(PagingCommandInvoker), i0.ɵɵdirectiveInject(PagingEventRepository)); };
PagingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: PagingGate, inputs: { paging: "paging" }, outputs: { pageChanged: "pageChanged", pageSizeChanged: "pageSizeChanged" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PagingGate, [{
        type: Directive
    }], function () { return [{ type: StructureId }, { type: CompositionId }, { type: PagingCommandInvoker }, { type: PagingEventRepository }]; }, { paging: [{
            type: Input
        }], pageChanged: [{
            type: Output
        }], pageSizeChanged: [{
            type: Output
        }] }); })();

class ListViewPagingGate extends PagingGate {
    constructor(structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository) {
        super(structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository);
    }
}
ListViewPagingGate.ɵfac = function ListViewPagingGate_Factory(t) { return new (t || ListViewPagingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(PagingCommandInvoker), i0.ɵɵdirectiveInject(PagingEventRepository)); };
ListViewPagingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ListViewPagingGate, selectors: [["gui-list-view", "paging", ""]], features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewPagingGate, [{
        type: Directive,
        args: [{
                selector: 'gui-list-view[paging]'
            }]
    }], function () { return [{ type: StructureId }, { type: CompositionId }, { type: PagingCommandInvoker }, { type: PagingEventRepository }]; }, null); })();

class SearchEventRepository extends EventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
}
SearchEventRepository.ɵfac = function SearchEventRepository_Factory(t) { return new (t || SearchEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
SearchEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchEventRepository, factory: SearchEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class SearchingGate extends Gate {
    constructor(structureId, searchEventRepository, searchCommandInvoker) {
        super();
        this.structureId = structureId;
        this.searchEventRepository = searchEventRepository;
        this.searchCommandInvoker = searchCommandInvoker;
        this.searchPhraseChanged = new EventEmitter();
    }
    ngOnChanges(changes) {
        if (this.isDefined('searching', changes)) {
            let searching;
            if (typeof this.searching === 'boolean') {
                searching = {
                    enabled: this.searching
                };
            }
            else {
                searching = this.searching;
            }
            this.searchCommandInvoker.setSearchingConfig(searching, this.structureId);
        }
    }
    ngOnInit() {
        this.subscribeAndEmit(this.searchEventRepository.onSearchPhrase(this.structureId.toReadModelRootId()), this.searchPhraseChanged);
    }
}
SearchingGate.ɵfac = function SearchingGate_Factory(t) { return new (t || SearchingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SearchEventRepository), i0.ɵɵdirectiveInject(SearchCommandInvoker)); };
SearchingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: SearchingGate, inputs: { searching: "searching" }, outputs: { searchPhraseChanged: "searchPhraseChanged" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchingGate, [{
        type: Directive
    }], function () { return [{ type: StructureId }, { type: SearchEventRepository }, { type: SearchCommandInvoker }]; }, { searching: [{
            type: Input
        }], searchPhraseChanged: [{
            type: Output
        }] }); })();

class ListViewSearchingGate extends SearchingGate {
    constructor(structureId, searchEventRepository, searchCommandInvoker) {
        super(structureId, searchEventRepository, searchCommandInvoker);
    }
}
ListViewSearchingGate.ɵfac = function ListViewSearchingGate_Factory(t) { return new (t || ListViewSearchingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SearchEventRepository), i0.ɵɵdirectiveInject(SearchCommandInvoker)); };
ListViewSearchingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ListViewSearchingGate, selectors: [["gui-list-view", "searching", ""]], features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewSearchingGate, [{
        type: Directive,
        args: [{
                selector: 'gui-list-view[searching]'
            }]
    }], function () { return [{ type: StructureId }, { type: SearchEventRepository }, { type: SearchCommandInvoker }]; }, null); })();

class GuiListComponent extends GuiListGateway {
    constructor(platformId) {
        super();
        this.platformId = platformId;
    }
    onPageChange(page) {
        this.pageChanged.emit(page);
    }
    onPageSizeChange(pageSize) {
        this.pageSizeChanged.emit(pageSize);
    }
    onSearchPhraseChange(phrase) {
        this.searchPhraseChanged.emit(phrase);
    }
}
GuiListComponent.ɵfac = function GuiListComponent_Factory(t) { return new (t || GuiListComponent)(i0.ɵɵdirectiveInject(PLATFORM_ID)); };
GuiListComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: GuiListComponent, selectors: [["gui-list"]], hostVars: 2, hostBindings: function GuiListComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵclassProp("gui-list", "true");
    } }, features: [i0.ɵɵProvidersFeature(guiListProviders), i0.ɵɵInheritDefinitionFeature], decls: 1, vars: 9, consts: [[3, "cardTemplate", "fields", "items", "localization", "modeSelector", "mode", "paging", "searching", "template", "pageChanged", "pageSizeChanged", "searchPhraseChanged"]], template: function GuiListComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "gui-list-view", 0);
        i0.ɵɵlistener("pageChanged", function GuiListComponent_Template_gui_list_view_pageChanged_0_listener($event) { return ctx.onPageChange($event); })("pageSizeChanged", function GuiListComponent_Template_gui_list_view_pageSizeChanged_0_listener($event) { return ctx.onPageSizeChange($event); })("searchPhraseChanged", function GuiListComponent_Template_gui_list_view_searchPhraseChanged_0_listener($event) { return ctx.onSearchPhraseChange($event); });
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("cardTemplate", ctx.listCardTemplate)("fields", ctx.listFields)("items", ctx.source)("localization", ctx.localization)("modeSelector", ctx.listViewModeSelector)("mode", ctx.listViewMode)("paging", ctx.paging)("searching", ctx.searchConfig)("template", ctx.containerTemplate);
    } }, directives: [ListViewComponent, ListViewFieldGate, ListViewSourceGate, ListViewL10nGate, ListViewModeGate, ListViewTemplateGate, ListViewPagingGate, ListViewSearchingGate], styles: [""], encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(GuiListComponent, [{
        type: Component,
        args: [{
                selector: 'gui-list',
                templateUrl: './gui.list.component.html',
                styleUrls: [
                    './gui.list.ngx.scss'
                ],
                providers: guiListProviders,
                host: {
                    '[class.gui-list]': '"true"'
                },
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: Inject,
                args: [PLATFORM_ID]
            }] }]; }, null); })();

class EmptySourceFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
EmptySourceFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵEmptySourceFeatureModule_BaseFactory; return function EmptySourceFeatureModule_Factory(t) { return (ɵEmptySourceFeatureModule_BaseFactory || (ɵEmptySourceFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(EmptySourceFeatureModule)))(t || EmptySourceFeatureModule); }; }();
EmptySourceFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: EmptySourceFeatureModule });
EmptySourceFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            TranslationFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(EmptySourceFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    TranslationFeatureModule
                ],
                declarations: [
                    EmptySourceComponent
                ],
                exports: [
                    EmptySourceComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(EmptySourceFeatureModule, { declarations: [EmptySourceComponent], imports: [CommonModule,
        TranslationFeatureModule], exports: [EmptySourceComponent] }); })();

class ListViewDomainEvent extends DomainEvent {
}

class ListViewCreatedEvent extends ListViewDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'ListViewCreatedEvent');
    }
}

class ListViewAggregateEvent extends AggregateEvent {
}

class ListViewCreatedAggregateEvent extends ListViewAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'ListViewCreatedAggregateEvent');
    }
    toDomainEvent() {
        return new ListViewCreatedEvent(this.getAggregateId());
    }
}

class ListViewModeSetEvent extends ListViewDomainEvent {
    constructor(schemaId, mode) {
        super(schemaId, mode, 'ListViewModeSetEvent');
        this.mode = mode;
    }
    getTheme() {
        return this.mode;
    }
}

class ListViewModeSetAggregateEvent extends ListViewAggregateEvent {
    constructor(listViewId, mode) {
        super(listViewId, 'ListViewModeSetAggregateEvent');
        this.mode = mode;
    }
    toDomainEvent() {
        return new ListViewModeSetEvent(this.getAggregateId(), this.mode);
    }
}

class SelectorVisibility {
    constructor() {
        this.enabled = null;
        this.visible = false;
    }
    isVisible() {
        if (this.enabled !== null) {
            return this.enabled;
        }
        return this.visible;
    }
    setEnabled(enabled) {
        this.enabled = enabled;
    }
    setVisible(visible) {
        this.visible = visible;
    }
}

class ListViewSelectorToggledEvent extends ListViewDomainEvent {
    constructor(schemaId, enabled) {
        super(schemaId, enabled, 'ListViewSelectorToggledEvent');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class ListViewSelectorToggledAggregateEvent extends ListViewAggregateEvent {
    constructor(listViewId, enabled) {
        super(listViewId, 'ListViewSelectorToggledAggregateEvent');
        this.enabled = enabled;
    }
    toDomainEvent() {
        return new ListViewSelectorToggledEvent(this.getAggregateId(), this.enabled);
    }
}

class ListViewAggregate extends AggregateRoot {
    constructor(listViewId) {
        super(listViewId, 'ListViewAggregate');
        this.setMode(ListViewMode.LIST);
        this.initSelectorVisibility();
    }
    createEvent() {
        return ListViewCreatedAggregateEvent;
    }
    setMode(mode) {
        this.mode = mode;
        this.addEvent(new ListViewModeSetAggregateEvent(this.getId(), this.mode));
    }
    toggleModeSelector(enabled) {
        this.selectorVisibility.setEnabled(enabled);
        this.emitEventAfterSelectorVisibilityChange();
    }
    initSelectorVisibility() {
        this.selectorVisibility = new SelectorVisibility();
        this.emitEventAfterSelectorVisibilityChange();
    }
    emitEventAfterSelectorVisibilityChange() {
        this.addEvent(new ListViewSelectorToggledAggregateEvent(this.getId(), this.selectorVisibility.isVisible()));
    }
}

class ListViewAggregateFactory extends AggregateFactory {
    constructor() {
        super();
    }
    create(id) {
        return new ListViewAggregate(id);
    }
}
ListViewAggregateFactory.ɵfac = function ListViewAggregateFactory_Factory(t) { return new (t || ListViewAggregateFactory)(); };
ListViewAggregateFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewAggregateFactory, factory: ListViewAggregateFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewAggregateFactory, [{
        type: Injectable
    }], function () { return []; }, null); })();

class CreateListViewCommandHandler {
    forCommand() {
        return CreateListViewCommand;
    }
}
CreateListViewCommandHandler.ɵfac = function CreateListViewCommandHandler_Factory(t) { return new (t || CreateListViewCommandHandler)(); };
CreateListViewCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CreateListViewCommandHandler, factory: CreateListViewCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CreateListViewCommandHandler, [{
        type: Injectable
    }], null, null); })();

class ListViewAggregateRepository extends AggregateRepository {
}

class InMemoryListViewStore extends InMemoryStore {
}
InMemoryListViewStore.ɵfac = /*@__PURE__*/ function () { let ɵInMemoryListViewStore_BaseFactory; return function InMemoryListViewStore_Factory(t) { return (ɵInMemoryListViewStore_BaseFactory || (ɵInMemoryListViewStore_BaseFactory = i0.ɵɵgetInheritedFactory(InMemoryListViewStore)))(t || InMemoryListViewStore); }; }();
InMemoryListViewStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryListViewStore, factory: InMemoryListViewStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryListViewStore, [{
        type: Injectable
    }], null, null); })();

class InMemoryListViewAggregateStore extends InMemoryAggregateStore {
    constructor(inMemorySchemaStore, aggregateStoreRegister) {
        super(inMemorySchemaStore, aggregateStoreRegister);
    }
}
InMemoryListViewAggregateStore.ɵfac = function InMemoryListViewAggregateStore_Factory(t) { return new (t || InMemoryListViewAggregateStore)(i0.ɵɵinject(InMemoryListViewStore), i0.ɵɵinject(i1$1.AggregateStoreRegister)); };
InMemoryListViewAggregateStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryListViewAggregateStore, factory: InMemoryListViewAggregateStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryListViewAggregateStore, [{
        type: Injectable
    }], function () { return [{ type: InMemoryListViewStore }, { type: i1$1.AggregateStoreRegister }]; }, null); })();

class InMemoryListViewAggregateRepository extends ListViewAggregateRepository {
    constructor(inMemorySchemaAggregateStore) {
        super();
        this.inMemorySchemaAggregateStore = inMemorySchemaAggregateStore;
    }
    findById(listViewId) {
        return this.inMemorySchemaAggregateStore.findById(listViewId);
    }
    save(listViewAggregate) {
        this.inMemorySchemaAggregateStore.save(listViewAggregate);
    }
}
InMemoryListViewAggregateRepository.ɵfac = function InMemoryListViewAggregateRepository_Factory(t) { return new (t || InMemoryListViewAggregateRepository)(i0.ɵɵinject(InMemoryListViewAggregateStore)); };
InMemoryListViewAggregateRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryListViewAggregateRepository, factory: InMemoryListViewAggregateRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryListViewAggregateRepository, [{
        type: Injectable
    }], function () { return [{ type: InMemoryListViewAggregateStore }]; }, null); })();

class ListViewEventRepository extends EventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
    onModeChange(listViewReadModelRootId) {
        return this.onEvent(listViewReadModelRootId, ListViewModeSetEvent);
    }
}
ListViewEventRepository.ɵfac = function ListViewEventRepository_Factory(t) { return new (t || ListViewEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
ListViewEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewEventRepository, factory: ListViewEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class SetListViewModeCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetListViewModeCommand;
    }
    handle(listViewAggregate, command) {
        const mode = command.getMode();
        listViewAggregate.setMode(mode);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SetListViewModeCommandHandler.ɵfac = function SetListViewModeCommandHandler_Factory(t) { return new (t || SetListViewModeCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetListViewModeCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetListViewModeCommandHandler, factory: SetListViewModeCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetListViewModeCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class ToggleListViewSelectorCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return ToggleListViewSelectorCommand;
    }
    handle(listViewAggregate, command) {
        const enabled = command.iseEnabled();
        listViewAggregate.toggleModeSelector(enabled);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
ToggleListViewSelectorCommandHandler.ɵfac = function ToggleListViewSelectorCommandHandler_Factory(t) { return new (t || ToggleListViewSelectorCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
ToggleListViewSelectorCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ToggleListViewSelectorCommandHandler, factory: ToggleListViewSelectorCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ToggleListViewSelectorCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class ListViewDomainModule {
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SetListViewModeCommandHandler, listViewKey),
            HermesModule.registerCommandHandler(ToggleListViewSelectorCommandHandler, listViewKey)
        ];
    }
}
ListViewDomainModule.ɵfac = function ListViewDomainModule_Factory(t) { return new (t || ListViewDomainModule)(); };
ListViewDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: ListViewDomainModule });
ListViewDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        ListViewDispatcher
    ], imports: [[]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewDomainModule, [{
        type: NgModule,
        args: [{
                imports: [],
                providers: [
                    ListViewDispatcher
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();

class ListViewModeSetEventHandler {
    constructor(listViewModeRepository) {
        this.listViewModeRepository = listViewModeRepository;
    }
    forEvent() {
        return ListViewModeSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('ListViewModeSetEvent')) {
            this.listViewModeRepository.next(event.getAggregateId(), event.getTheme());
        }
    }
}
ListViewModeSetEventHandler.ɵfac = function ListViewModeSetEventHandler_Factory(t) { return new (t || ListViewModeSetEventHandler)(i0.ɵɵinject(ListViewModeArchive)); };
ListViewModeSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewModeSetEventHandler, factory: ListViewModeSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewModeSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: ListViewModeArchive }]; }, null); })();

class ListViewSelectorToggledEventHandler {
    constructor(listViewSelectorRepository) {
        this.listViewSelectorRepository = listViewSelectorRepository;
    }
    forEvent() {
        return ListViewSelectorToggledEvent;
    }
    handle(event) {
        if (event.ofMessageType('ListViewSelectorToggledEvent')) {
            this.listViewSelectorRepository.next(event.getAggregateId(), event.isEnabled());
        }
    }
}
ListViewSelectorToggledEventHandler.ɵfac = function ListViewSelectorToggledEventHandler_Factory(t) { return new (t || ListViewSelectorToggledEventHandler)(i0.ɵɵinject(ListViewSelectorArchive)); };
ListViewSelectorToggledEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ListViewSelectorToggledEventHandler, factory: ListViewSelectorToggledEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewSelectorToggledEventHandler, [{
        type: Injectable
    }], function () { return [{ type: ListViewSelectorArchive }]; }, null); })();

const listViewKey = 'ListViewKey';
class ListViewApiModule {
}
ListViewApiModule.ɵfac = function ListViewApiModule_Factory(t) { return new (t || ListViewApiModule)(); };
ListViewApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: ListViewApiModule });
ListViewApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        ListViewCommandInvoker,
        ListViewEventRepository,
        ListViewWarehouse,
        ListViewModeArchive,
        ListViewSelectorArchive,
        InMemoryListViewAggregateStore,
        InMemoryListViewStore
    ], imports: [[
            HermesModule,
            HermesModule.defineAggregate(listViewKey, ListViewAggregateFactory, InMemoryListViewAggregateRepository, CreateListViewCommandHandler, [
                ListViewDomainModule.commandHandlers()
            ], [
                HermesModule.registerDomainEventHandler(ListViewModeSetEventHandler),
                HermesModule.registerDomainEventHandler(ListViewSelectorToggledEventHandler)
            ]),
            ListViewDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    HermesModule,
                    HermesModule.defineAggregate(listViewKey, ListViewAggregateFactory, InMemoryListViewAggregateRepository, CreateListViewCommandHandler, [
                        ListViewDomainModule.commandHandlers()
                    ], [
                        HermesModule.registerDomainEventHandler(ListViewModeSetEventHandler),
                        HermesModule.registerDomainEventHandler(ListViewSelectorToggledEventHandler)
                    ]),
                    ListViewDomainModule
                ],
                providers: [
                    ListViewCommandInvoker,
                    ListViewEventRepository,
                    ListViewWarehouse,
                    ListViewModeArchive,
                    ListViewSelectorArchive,
                    InMemoryListViewAggregateStore,
                    InMemoryListViewStore
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(ListViewApiModule, { imports: [HermesModule, i1$1.HermesDomainModule, ListViewDomainModule] }); })();

const listViewGatewayDeclarations = [
    ListViewPagingGate,
    ListViewModeGate,
    ListViewTemplateGate,
    ListViewFieldGate,
    ListViewSearchingGate,
    ListViewL10nGate,
    ListViewSourceGate
];

class SetConfigSearchingCommand extends StructureCommand {
    constructor(structureId, searchConfig) {
        super(structureId, 'SetConfigSearchingCommand');
        this.searchConfig = searchConfig;
    }
    getConfig() {
        return this.searchConfig;
    }
}

class ConfigSearchingSetEvent extends StructureDomainEvent {
    constructor(aggregateId, enabled) {
        super(aggregateId, enabled, 'ConfigSearchingSetEvent');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class SetConfigSearchingCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetConfigSearchingCommand;
    }
    handle(aggregate, command) {
        const searchingConfig = command.getConfig();
        aggregate.setSearchingConfig(searchingConfig);
    }
    publish(aggregate, command) {
        const searchingConfig = command.getConfig();
        this.domainEventPublisher.publish(new ConfigSearchingSetEvent(command.getAggregateId(), searchingConfig.enabled));
    }
}
SetConfigSearchingCommandHandler.ɵfac = function SetConfigSearchingCommandHandler_Factory(t) { return new (t || SetConfigSearchingCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetConfigSearchingCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetConfigSearchingCommandHandler, factory: SetConfigSearchingCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetConfigSearchingCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetSearchPhraseCommand extends StructureCommand {
    constructor(structureId, phrase, initial) {
        super(structureId, 'SetSearchPhraseCommand');
        this.phrase = phrase;
        this.initial = initial;
    }
    getPhrase() {
        return this.phrase;
    }
    isInitial() {
        return this.initial;
    }
}

class SearchPhraseSetDomainEvent extends StructureDomainEvent {
    constructor(aggregateId, phrase, initial) {
        super(aggregateId, { phrase, initial }, 'SearchPhraseSetDomainEvent');
        this.phrase = phrase;
        this.initial = initial;
    }
    getPhrase() {
        return this.phrase;
    }
    isInitial() {
        return this.initial;
    }
}

class OriginSetEvent extends StructureDomainEvent {
    constructor(aggregateId, origin) {
        super(aggregateId, origin, 'OriginSetEvent');
        this.origin = origin;
    }
    getOrigin() {
        return this.origin;
    }
}

class StructureSummariesChangedEvent extends StructureDomainEvent {
    constructor(structureId, values) {
        super(structureId, values, 'StructureSummariesChangedEvent');
        this.values = values;
    }
    getSummaries() {
        return this.values;
    }
}

class StructurePreparedEntitiesSetEvent extends StructureDomainEvent {
    constructor(aggregateId, preparedItems) {
        super(aggregateId, preparedItems, 'StructurePreparedEntitiesSetEvent');
        this.preparedItems = preparedItems;
    }
    getPreparedItems() {
        return this.preparedItems;
    }
}

class SourceDomainEventPublisher {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    publish(events) {
        events.forEach((event) => {
            this.publishEvent(event);
        });
    }
    publishEvent(event) {
        if (event.getType() === 'StructureOriginChangedAggregateEvent') {
            const structureOriginChangedAggregateEvent = event;
            const domainEvent = new OriginSetEvent(structureOriginChangedAggregateEvent.getAggregateId(), structureOriginChangedAggregateEvent.getOrigin());
            this.domainEventPublisher.publish(domainEvent);
        }
        if (event.getType() === 'StructureSourceItemEditedAggregateEvent') {
            const structureSourceItemEditedAggregateEvent = event;
            const domainEvent = new StructureSourceItemEditedEvent(structureSourceItemEditedAggregateEvent.getAggregateId(), structureSourceItemEditedAggregateEvent.getBeforeItem(), structureSourceItemEditedAggregateEvent.getAfterItem());
            this.domainEventPublisher.publish(domainEvent);
        }
        if (event.getType() === 'StructureSummariesChangedAggregateEvent') {
            const structureSummariesChangedAggregateEvent = event;
            const domainEvent = new StructureSummariesChangedEvent(structureSummariesChangedAggregateEvent.getAggregateId(), structureSummariesChangedAggregateEvent.getSummaries());
            this.domainEventPublisher.publish(domainEvent);
        }
        if (event.getType() === 'StructurePreparedEntitiesSetAggregateEvent') {
            const structurePreparedEntitiesSetAggregateEvent = event;
            const domainEvent = new StructurePreparedEntitiesSetEvent(structurePreparedEntitiesSetAggregateEvent.getAggregateId(), structurePreparedEntitiesSetAggregateEvent.getPreparedItems());
            this.domainEventPublisher.publish(domainEvent);
        }
        if (event.getType() === 'UniqueFilterCalculatedAggregateEvent') {
            const uniqueFilterCalculatedAggregateEvent = event;
            const domainEvent = uniqueFilterCalculatedAggregateEvent.toDomainEvent();
            this.domainEventPublisher.publish(domainEvent);
        }
    }
}
SourceDomainEventPublisher.ɵfac = function SourceDomainEventPublisher_Factory(t) { return new (t || SourceDomainEventPublisher)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SourceDomainEventPublisher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceDomainEventPublisher, factory: SourceDomainEventPublisher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceDomainEventPublisher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class StructureSetSearchPhraseCommandHandler {
    constructor(structureSourceDomainEventPublisher, domainEventPublisher) {
        this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetSearchPhraseCommand;
    }
    handle(aggregate, command) {
        const phrase = command.getPhrase();
        aggregate.addSearchPhrase(phrase);
    }
    publish(aggregate, command) {
        const phrase = command.getPhrase(), initial = command.isInitial();
        this.domainEventPublisher.publish(new SearchPhraseSetDomainEvent(command.getAggregateId(), phrase, initial));
        this.structureSourceDomainEventPublisher.publish(aggregate.getEvents());
    }
}
StructureSetSearchPhraseCommandHandler.ɵfac = function StructureSetSearchPhraseCommandHandler_Factory(t) { return new (t || StructureSetSearchPhraseCommandHandler)(i0.ɵɵinject(SourceDomainEventPublisher), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
StructureSetSearchPhraseCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureSetSearchPhraseCommandHandler, factory: StructureSetSearchPhraseCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSetSearchPhraseCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: SourceDomainEventPublisher }, { type: i1$1.DomainEventPublisher }]; }, null); })();

var DataType;
(function (DataType) {
    DataType[DataType["UNKNOWN"] = 0] = "UNKNOWN";
    DataType[DataType["NUMBER"] = 1] = "NUMBER";
    DataType[DataType["STRING"] = 2] = "STRING";
    DataType[DataType["BOOLEAN"] = 3] = "BOOLEAN";
    DataType[DataType["DATE"] = 4] = "DATE";
    DataType[DataType["CUSTOM"] = 5] = "CUSTOM";
})(DataType || (DataType = {}));

class SearchManager {
    constructor() {
        this.searchFields = [];
        this.enabledDataTypes = [
            DataType.STRING
        ];
    }
    addSearchPhrase(fields, searchPhrase) {
        if (!searchPhrase) {
            this.searchFields = [];
            return;
        }
        const searchableFields = fields.filter((field) => {
            return this.enabledDataTypes.some((dt) => dt === field.getDataType());
        });
        if (searchableFields.length === 0) {
            return;
        }
        this.searchFields = searchableFields;
        this.searchPhrase = searchPhrase;
    }
    removeSearchFilters() {
        this.searchFields = [];
    }
    search(entities) {
        if (entities.length === 0 || this.searchFields.length === 0) {
            return entities;
        }
        const searchedItems = new Set();
        for (let i = 0; i < entities.length; i += 1) {
            this.searchFields
                .filter((field) => field.search(entities[i], this.searchPhrase))
                .forEach(() => {
                searchedItems.add(entities[i]);
            });
        }
        return Array.from(searchedItems);
    }
}

class SearchManagerFactory {
    create() {
        return new SearchManager();
    }
}
SearchManagerFactory.ɵfac = function SearchManagerFactory_Factory(t) { return new (t || SearchManagerFactory)(); };
SearchManagerFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchManagerFactory, factory: SearchManagerFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchManagerFactory, [{
        type: Injectable
    }], null, null); })();

class SearchHighlightArchive extends AggregateArchive {
    constructor() {
        super(SearchHighlightArchive.HIGHLIGHTING);
    }
}
SearchHighlightArchive.HIGHLIGHTING = true;
SearchHighlightArchive.ɵfac = function SearchHighlightArchive_Factory(t) { return new (t || SearchHighlightArchive)(); };
SearchHighlightArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchHighlightArchive, factory: SearchHighlightArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchHighlightArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SearchPlaceholderArchive extends AggregateArchive {
    constructor() {
        super(SearchPlaceholderArchive.PLACEHOLDER);
    }
}
SearchPlaceholderArchive.PLACEHOLDER = 'Search...';
SearchPlaceholderArchive.ɵfac = function SearchPlaceholderArchive_Factory(t) { return new (t || SearchPlaceholderArchive)(); };
SearchPlaceholderArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchPlaceholderArchive, factory: SearchPlaceholderArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchPlaceholderArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SearchDispatcher {
    constructor(commandDispatcher, searchHighlightArchive, searchPlaceholderArchive) {
        this.commandDispatcher = commandDispatcher;
        this.searchHighlightArchive = searchHighlightArchive;
        this.searchPlaceholderArchive = searchPlaceholderArchive;
    }
    setSearchingConfig(config, structureId) {
        if (config.highlighting !== undefined && config.highlighting !== null) {
            this.searchHighlightArchive.next(structureId, config.highlighting);
        }
        if (config.placeholder !== undefined && config.placeholder !== null) {
            this.searchPlaceholderArchive.next(structureId, config.placeholder);
        }
        if (config.phrase !== undefined && config.phrase !== null) {
            this.searchOnInit(config.phrase, structureId);
        }
        this.commandDispatcher.dispatch(new SetConfigSearchingCommand(structureId, config));
    }
    search(phrase, structureId) {
        this.commandDispatcher.dispatch(new SetSearchPhraseCommand(structureId, phrase, false));
    }
    searchOnInit(phrase, structureId) {
        this.commandDispatcher.dispatch(new SetSearchPhraseCommand(structureId, phrase, true));
    }
}
SearchDispatcher.ɵfac = function SearchDispatcher_Factory(t) { return new (t || SearchDispatcher)(i0.ɵɵinject(i1$1.CommandDispatcher), i0.ɵɵinject(SearchHighlightArchive), i0.ɵɵinject(SearchPlaceholderArchive)); };
SearchDispatcher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchDispatcher, factory: SearchDispatcher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchDispatcher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }, { type: SearchHighlightArchive }, { type: SearchPlaceholderArchive }]; }, null); })();

class SearchPhraseArchive extends AggregateArchive {
    constructor() {
        super(SearchPhraseArchive.SEARCH_PHRASE);
    }
}
SearchPhraseArchive.SEARCH_PHRASE = '';
SearchPhraseArchive.ɵfac = function SearchPhraseArchive_Factory(t) { return new (t || SearchPhraseArchive)(); };
SearchPhraseArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchPhraseArchive, factory: SearchPhraseArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchPhraseArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SearchPhraseSetEventHandler {
    constructor(searchPhraseRepository) {
        this.searchPhraseRepository = searchPhraseRepository;
    }
    forEvent() {
        return SearchPhraseSetDomainEvent;
    }
    handle(event) {
        if (event.ofMessageType('SearchPhraseSetDomainEvent')) {
            this.searchPhraseRepository.next(event.getAggregateId(), event.getPhrase());
        }
    }
}
SearchPhraseSetEventHandler.ɵfac = function SearchPhraseSetEventHandler_Factory(t) { return new (t || SearchPhraseSetEventHandler)(i0.ɵɵinject(SearchPhraseArchive)); };
SearchPhraseSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchPhraseSetEventHandler, factory: SearchPhraseSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchPhraseSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: SearchPhraseArchive }]; }, null); })();

class SearchingEnabledArchive extends AggregateArchive {
    constructor() {
        super(SearchingEnabledArchive.ENABLED);
    }
}
SearchingEnabledArchive.ENABLED = false;
SearchingEnabledArchive.ɵfac = function SearchingEnabledArchive_Factory(t) { return new (t || SearchingEnabledArchive)(); };
SearchingEnabledArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchingEnabledArchive, factory: SearchingEnabledArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchingEnabledArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ConfigSearchingSetEventHandler {
    constructor(structureSearchingRepository) {
        this.structureSearchingRepository = structureSearchingRepository;
    }
    forEvent() {
        return ConfigSearchingSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('ConfigSearchingSetEvent')) {
            this.structureSearchingRepository.next(event.getAggregateId(), event.isEnabled());
        }
    }
}
ConfigSearchingSetEventHandler.ɵfac = function ConfigSearchingSetEventHandler_Factory(t) { return new (t || ConfigSearchingSetEventHandler)(i0.ɵɵinject(SearchingEnabledArchive)); };
ConfigSearchingSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ConfigSearchingSetEventHandler, factory: ConfigSearchingSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ConfigSearchingSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: SearchingEnabledArchive }]; }, null); })();

class SearchDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SetConfigSearchingCommandHandler, structureKey),
            HermesModule.registerCommandHandler(StructureSetSearchPhraseCommandHandler, structureKey)
        ];
    }
    static domainEventHandlers() {
        return [
            HermesModule.registerDomainEventHandler(SearchPhraseSetEventHandler),
            HermesModule.registerDomainEventHandler(ConfigSearchingSetEventHandler)
        ];
    }
}
SearchDomainModule.ɵfac = function SearchDomainModule_Factory(t) { return new (t || SearchDomainModule)(); };
SearchDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SearchDomainModule });
SearchDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        SearchManagerFactory,
        SearchDispatcher
    ], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [
                    SearchManagerFactory,
                    SearchDispatcher
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SearchDomainModule, { imports: [CommonModule] }); })();

class SearchDomainWarehouse extends SearchWarehouse {
    constructor(searchingEnabledArchive, searchPhraseArchive, searchHighlightArchive, searchPlaceholderArchive) {
        super();
        this.searchingEnabledArchive = searchingEnabledArchive;
        this.searchPhraseArchive = searchPhraseArchive;
        this.searchHighlightArchive = searchHighlightArchive;
        this.searchPlaceholderArchive = searchPlaceholderArchive;
    }
    onSearchEnabled(structureId) {
        return this.searchingEnabledArchive.on(structureId);
    }
    onPhrase(structureId) {
        return this.searchPhraseArchive.on(structureId);
    }
    onHighlight(structureId) {
        return this.searchHighlightArchive.on(structureId);
    }
    onPlaceholder(structureId) {
        return this.searchPlaceholderArchive.on(structureId);
    }
}
SearchDomainWarehouse.ɵfac = function SearchDomainWarehouse_Factory(t) { return new (t || SearchDomainWarehouse)(i0.ɵɵinject(SearchingEnabledArchive), i0.ɵɵinject(SearchPhraseArchive), i0.ɵɵinject(SearchHighlightArchive), i0.ɵɵinject(SearchPlaceholderArchive)); };
SearchDomainWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchDomainWarehouse, factory: SearchDomainWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchDomainWarehouse, [{
        type: Injectable
    }], function () { return [{ type: SearchingEnabledArchive }, { type: SearchPhraseArchive }, { type: SearchHighlightArchive }, { type: SearchPlaceholderArchive }]; }, null); })();

class SearchDomainEventRepository extends SearchEventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
    onSearchPhrase(structureId) {
        return this.onEvent(structureId, SearchPhraseSetDomainEvent)
            .pipe(hermesFilter((event) => event.isInitial() === false), hermesMap((event) => event.getPhrase()), hermesFilter((phrase) => phrase !== null));
    }
}
SearchDomainEventRepository.ɵfac = function SearchDomainEventRepository_Factory(t) { return new (t || SearchDomainEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
SearchDomainEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchDomainEventRepository, factory: SearchDomainEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchDomainEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class SearchDomainCommandInvoker extends SearchCommandInvoker {
    constructor(searchDispatcher) {
        super();
        this.searchDispatcher = searchDispatcher;
    }
    setSearchingConfig(config, structureId) {
        this.searchDispatcher.setSearchingConfig(config, structureId);
    }
    search(phrase, structureId) {
        this.searchDispatcher.search(phrase, structureId);
    }
}
SearchDomainCommandInvoker.ɵfac = function SearchDomainCommandInvoker_Factory(t) { return new (t || SearchDomainCommandInvoker)(i0.ɵɵinject(SearchDispatcher)); };
SearchDomainCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SearchDomainCommandInvoker, factory: SearchDomainCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchDomainCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: SearchDispatcher }]; }, null); })();

class SearchApiModule extends ApiModule {
    constructor() {
        super();
    }
}
SearchApiModule.ɵfac = function SearchApiModule_Factory(t) { return new (t || SearchApiModule)(); };
SearchApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SearchApiModule });
SearchApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        {
            provide: SearchCommandInvoker,
            useClass: SearchDomainCommandInvoker
        },
        {
            provide: SearchWarehouse,
            useClass: SearchDomainWarehouse
        },
        {
            provide: SearchEventRepository,
            useClass: SearchDomainEventRepository
        },
        SearchPhraseArchive,
        SearchHighlightArchive,
        SearchPlaceholderArchive,
        SearchingEnabledArchive
    ], imports: [[
            CommonModule,
            SearchDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    SearchDomainModule
                ],
                providers: [
                    {
                        provide: SearchCommandInvoker,
                        useClass: SearchDomainCommandInvoker
                    },
                    {
                        provide: SearchWarehouse,
                        useClass: SearchDomainWarehouse
                    },
                    {
                        provide: SearchEventRepository,
                        useClass: SearchDomainEventRepository
                    },
                    SearchPhraseArchive,
                    SearchHighlightArchive,
                    SearchPlaceholderArchive,
                    SearchingEnabledArchive
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SearchApiModule, { imports: [CommonModule,
        SearchDomainModule] }); })();

class SearchFeatureModule extends FeatureModule {
    constructor(searchApiModule) {
        super();
        if (searchApiModule === null) {
            throw new Error('SearchApiModule is required');
        }
    }
    static forComponent() {
        return [];
    }
}
SearchFeatureModule.ɵfac = function SearchFeatureModule_Factory(t) { return new (t || SearchFeatureModule)(i0.ɵɵinject(SearchApiModule)); };
SearchFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SearchFeatureModule });
SearchFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            FabricModule,
            SearchApiModule,
            ReactiveFormsModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SearchFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FabricModule,
                    SearchApiModule,
                    ReactiveFormsModule
                ],
                declarations: [
                    SearchIconComponent,
                    SearchComponent
                ],
                exports: [
                    SearchIconComponent,
                    SearchComponent
                ]
            }]
    }], function () { return [{ type: SearchApiModule }]; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SearchFeatureModule, { declarations: [SearchIconComponent,
        SearchComponent], imports: [CommonModule,
        FabricModule,
        SearchApiModule,
        ReactiveFormsModule], exports: [SearchIconComponent,
        SearchComponent] }); })();

const _c0$T = ["gui-sorting-selector", ""];
class SortingSelectorComponent extends SmartComponent {
    constructor(detector, elementRef) {
        super(detector, elementRef);
        this.sortingOptions = [
            'Name: A-Z',
            'Name: Z-A',
            'Price: Low to High',
            'Price: High to Low',
            'None'
        ];
        this.selectedSorting = this.sortingOptions[0];
    }
    changeSorting(sorting) {
    }
    getSelectorName() {
        return 'gui-sorting-selector';
    }
}
SortingSelectorComponent.ɵfac = function SortingSelectorComponent_Factory(t) { return new (t || SortingSelectorComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
SortingSelectorComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: SortingSelectorComponent, selectors: [["div", "gui-sorting-selector", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$T, decls: 1, vars: 3, consts: [[3, "options", "selected", "width", "optionChanged"]], template: function SortingSelectorComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "gui-select", 0);
        i0.ɵɵlistener("optionChanged", function SortingSelectorComponent_Template_gui_select_optionChanged_0_listener($event) { return ctx.changeSorting($event); });
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("options", ctx.sortingOptions)("selected", ctx.selectedSorting)("width", 200);
    } }, directives: [i1.FabricSelectComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SortingSelectorComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-sorting-selector]',
                templateUrl: './sorting-selector.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, null); })();

class SortingSelectorFeatureModule {
}
SortingSelectorFeatureModule.ɵfac = function SortingSelectorFeatureModule_Factory(t) { return new (t || SortingSelectorFeatureModule)(); };
SortingSelectorFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SortingSelectorFeatureModule });
SortingSelectorFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            FabricSelectModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SortingSelectorFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FabricSelectModule
                ],
                declarations: [
                    SortingSelectorComponent
                ],
                exports: [
                    SortingSelectorComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SortingSelectorFeatureModule, { declarations: [SortingSelectorComponent], imports: [CommonModule,
        FabricSelectModule], exports: [SortingSelectorComponent] }); })();

const _c0$S = ["gui-filter-icon", ""];
class FilterIconComponent extends IconComponent {
    constructor(elementRef, changeDetectorRef) {
        super(elementRef, changeDetectorRef);
    }
    getSelectorName() {
        return 'gui-filter-icon';
    }
}
FilterIconComponent.ɵfac = function FilterIconComponent_Factory(t) { return new (t || FilterIconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
FilterIconComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FilterIconComponent, selectors: [["div", "gui-filter-icon", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$S, decls: 4, vars: 0, consts: [["xmlns", "http://www.w3.org/2000/svg", "viewBox", "0 0 10.32 7.23"], ["x1", "9.57", "y1", "0.75", "x2", "0.75", "y2", "0.75", 1, "cls-1"], ["x1", "8.14", "y1", "3.62", "x2", "2.18", "y2", "3.62", 1, "cls-1"], ["x1", "6.71", "y1", "6.48", "x2", "3.62", "y2", "6.48", 1, "cls-1"]], template: function FilterIconComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(0, "svg", 0);
        i0.ɵɵelement(1, "line", 1);
        i0.ɵɵelement(2, "line", 2);
        i0.ɵɵelement(3, "line", 3);
        i0.ɵɵelementEnd();
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterIconComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-filter-icon]',
                template: `
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10.32 7.23">
			<line class="cls-1" x1="9.57" y1="0.75" x2="0.75" y2="0.75"/>
			<line class="cls-1" x1="8.14" y1="3.62" x2="2.18" y2="3.62"/>
			<line class="cls-1" x1="6.71" y1="6.48" x2="3.62" y2="6.48"/>
		</svg>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

class FieldReadModelArchive extends AggregateArchive {
    constructor() {
        super(FieldReadModelArchive.default);
    }
}
FieldReadModelArchive.default = [];
FieldReadModelArchive.ɵfac = function FieldReadModelArchive_Factory(t) { return new (t || FieldReadModelArchive)(); };
FieldReadModelArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FieldReadModelArchive, factory: FieldReadModelArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldReadModelArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class FieldWarehouse {
    constructor(fieldReadModelArchive) {
        this.fieldReadModelArchive = fieldReadModelArchive;
    }
    onFields(structureId) {
        return this.fieldReadModelArchive.on(structureId);
    }
}
FieldWarehouse.ɵfac = function FieldWarehouse_Factory(t) { return new (t || FieldWarehouse)(i0.ɵɵinject(FieldReadModelArchive)); };
FieldWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FieldWarehouse, factory: FieldWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldWarehouse, [{
        type: Injectable
    }], function () { return [{ type: FieldReadModelArchive }]; }, null); })();

class FilterEnabledArchive extends AggregateArchive {
    constructor() {
        super(FilterEnabledArchive.default);
    }
}
FilterEnabledArchive.default = false;
FilterEnabledArchive.ɵfac = function FilterEnabledArchive_Factory(t) { return new (t || FilterEnabledArchive)(); };
FilterEnabledArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FilterEnabledArchive, factory: FilterEnabledArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterEnabledArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class QuickFilterEnabledArchive extends AggregateArchive {
    constructor() {
        super(QuickFilterEnabledArchive.default);
    }
}
QuickFilterEnabledArchive.default = false;
QuickFilterEnabledArchive.ɵfac = function QuickFilterEnabledArchive_Factory(t) { return new (t || QuickFilterEnabledArchive)(); };
QuickFilterEnabledArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: QuickFilterEnabledArchive, factory: QuickFilterEnabledArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(QuickFilterEnabledArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class FilterTypeMap {
    constructor(map) {
        this.map = map;
    }
    getFilterTypes(fieldId) {
        return this.map.get(fieldId.toString());
    }
}

class FilterTypeArchive extends AggregateArchive {
    constructor() {
        super(FilterTypeArchive.default);
    }
}
FilterTypeArchive.default = new FilterTypeMap(new Map());
FilterTypeArchive.ɵfac = function FilterTypeArchive_Factory(t) { return new (t || FilterTypeArchive)(); };
FilterTypeArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FilterTypeArchive, factory: FilterTypeArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterTypeArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class UniqueValuesReadModel {
    constructor(map) {
        this.map = new Map();
        this.allSelected = new Map();
        this.allDisabled = new Map();
        this.map = map;
        this.calculateSelection();
    }
    getValues(fieldId) {
        return this.map.get(fieldId.toString());
    }
    areAllSelected(fieldId) {
        return this.allSelected.get(fieldId.toString());
    }
    areAllDisabled(fieldId) {
        return this.allDisabled.get(fieldId.toString());
    }
    isSelectAllChecked(fieldId) {
        return this.areAllSelected(fieldId);
    }
    isIndeterminate(fieldId) {
        return !(this.areAllSelected(fieldId) || this.areAllDisabled(fieldId));
    }
    calculateSelection() {
        for (const key of Array.from(this.map.keys())) {
            const values = this.map.get(key);
            this.allSelected.set(key, !values.some((r) => !r.isEnabled()));
            this.allDisabled.set(key, !values.some((r) => r.isEnabled()));
        }
    }
}

class UniqueValuesArchive extends AggregateArchive {
    constructor() {
        super(UniqueValuesArchive.default);
    }
}
UniqueValuesArchive.default = new UniqueValuesReadModel(new Map());
UniqueValuesArchive.ɵfac = function UniqueValuesArchive_Factory(t) { return new (t || UniqueValuesArchive)(); };
UniqueValuesArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: UniqueValuesArchive, factory: UniqueValuesArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UniqueValuesArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ActiveFilterArchive extends AggregateArchive {
    constructor() {
        super(ActiveFilterArchive.default);
    }
}
ActiveFilterArchive.default = [];
ActiveFilterArchive.ɵfac = function ActiveFilterArchive_Factory(t) { return new (t || ActiveFilterArchive)(); };
ActiveFilterArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ActiveFilterArchive, factory: ActiveFilterArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveFilterArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class FilterWarehouse {
    constructor(filterEnabledArchive, structureQuickFilterRepository, filterTypeArchive, uniqueValuesArchive, activeFilterArchive) {
        this.filterEnabledArchive = filterEnabledArchive;
        this.structureQuickFilterRepository = structureQuickFilterRepository;
        this.filterTypeArchive = filterTypeArchive;
        this.uniqueValuesArchive = uniqueValuesArchive;
        this.activeFilterArchive = activeFilterArchive;
    }
    onFilteringEnabled(structureId) {
        return this.filterEnabledArchive.on(structureId);
    }
    onQuickFiltersEnabled(structureId) {
        return this.structureQuickFilterRepository.on(structureId);
    }
    onFilterTypes(structureId) {
        return this.filterTypeArchive.on(structureId);
    }
    onActiveFilters(structureId) {
        return this.activeFilterArchive.on(structureId);
    }
    onUniqueValues(structureId) {
        return this.uniqueValuesArchive.on(structureId);
    }
}
FilterWarehouse.ɵfac = function FilterWarehouse_Factory(t) { return new (t || FilterWarehouse)(i0.ɵɵinject(FilterEnabledArchive), i0.ɵɵinject(QuickFilterEnabledArchive), i0.ɵɵinject(FilterTypeArchive), i0.ɵɵinject(UniqueValuesArchive), i0.ɵɵinject(ActiveFilterArchive)); };
FilterWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FilterWarehouse, factory: FilterWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterWarehouse, [{
        type: Injectable
    }], function () { return [{ type: FilterEnabledArchive }, { type: QuickFilterEnabledArchive }, { type: FilterTypeArchive }, { type: UniqueValuesArchive }, { type: ActiveFilterArchive }]; }, null); })();

class SetConfigFilterCommand extends StructureCommand {
    constructor(structureId, filterConfig) {
        super(structureId, 'SetConfigFilterCommand');
        this.filterConfig = filterConfig;
    }
    getConfig() {
        return this.filterConfig;
    }
}

class RemoveAllFiltersCommand extends StructureCommand {
    constructor(structureId) {
        super(structureId, 'RemoveAllFiltersCommand');
    }
}

class AddFilterCommand extends StructureCommand {
    constructor(structureId, fieldId, filterTypeId, value) {
        super(structureId, 'AddFilterCommand');
        this.fieldId = fieldId;
        this.filterTypeId = filterTypeId;
        this.value = value;
    }
    getFieldId() {
        return this.fieldId;
    }
    getFilterTypeId() {
        return this.filterTypeId;
    }
    getValue() {
        return this.value;
    }
}

class RemoveFilterCommand extends StructureCommand {
    constructor(structureId, filterId) {
        super(structureId, 'RemoveFilterCommand');
        this.filterId = filterId;
    }
    getFilterId() {
        return this.filterId;
    }
}

class SelectAllUniqueFilterCommand extends StructureCommand {
    constructor(structureId, fieldId) {
        super(structureId, 'SelectAllUniqueFilterCommand');
        this.fieldId = fieldId;
    }
    getFieldId() {
        return this.fieldId;
    }
}

class UnselectAllUniqueFilterCommand extends StructureCommand {
    constructor(structureId, fieldId) {
        super(structureId, 'UnselectAllUniqueFilterCommand');
        this.fieldId = fieldId;
    }
    getFieldId() {
        return this.fieldId;
    }
}

class SelectUniqueFilterCommand extends StructureCommand {
    constructor(structureId, fieldId, uniqueValueId) {
        super(structureId, 'SelectUniqueFilterCommand');
        this.fieldId = fieldId;
        this.uniqueValueId = uniqueValueId;
    }
    getFieldId() {
        return this.fieldId;
    }
    getUniqueValueId() {
        return this.uniqueValueId;
    }
}

class UnselectUniqueFilterCommand extends StructureCommand {
    constructor(structureId, fieldId, uniqueValueId) {
        super(structureId, 'UnselectUniqueFilterCommand');
        this.fieldId = fieldId;
        this.uniqueValueId = uniqueValueId;
    }
    getFieldId() {
        return this.fieldId;
    }
    getUniqueValueId() {
        return this.uniqueValueId;
    }
}

class FilterCommandInvoker {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    setFilteringEnabled(config, structureId) {
        this.commandDispatcher.dispatch(new SetConfigFilterCommand(structureId, config));
    }
    add(fieldId, filterTypeId, value, structureId) {
        this.commandDispatcher.dispatch(new AddFilterCommand(structureId, fieldId, filterTypeId, value));
    }
    removeAllFilters(structureId) {
        this.commandDispatcher.dispatch(new RemoveAllFiltersCommand(structureId));
    }
    removeFilter(filterId, structureId) {
        this.commandDispatcher.dispatch(new RemoveFilterCommand(structureId, filterId));
    }
    selectAllUniqueFilter(fieldId, structureId) {
        this.commandDispatcher.dispatch(new SelectAllUniqueFilterCommand(structureId, fieldId));
    }
    unselectAllUniqueFilter(fieldId, structureId) {
        this.commandDispatcher.dispatch(new UnselectAllUniqueFilterCommand(structureId, fieldId));
    }
    selectUniqueFilter(fieldId, uniqueValueId, structureId) {
        this.commandDispatcher.dispatch(new SelectUniqueFilterCommand(structureId, fieldId, uniqueValueId));
    }
    unselectUniqueFilter(fieldId, uniqueValueId, structureId) {
        this.commandDispatcher.dispatch(new UnselectUniqueFilterCommand(structureId, fieldId, uniqueValueId));
    }
}
FilterCommandInvoker.ɵfac = function FilterCommandInvoker_Factory(t) { return new (t || FilterCommandInvoker)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
FilterCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FilterCommandInvoker, factory: FilterCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class CompositionWarehouse {
    constructor() {
    }
}
CompositionWarehouse.ɵfac = function CompositionWarehouse_Factory(t) { return new (t || CompositionWarehouse)(); };
CompositionWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionWarehouse, factory: CompositionWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionWarehouse, [{
        type: Injectable
    }], function () { return []; }, null); })();

const _c0$R = ["gui-active-search", ""];
function ActiveSearchComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    const _r2 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "div");
    i0.ɵɵtext(2, " Active search by: ");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(3, "div");
    i0.ɵɵelementStart(4, "gui-chip");
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(6, "div");
    i0.ɵɵelementStart(7, "button", 1);
    i0.ɵɵlistener("click", function ActiveSearchComponent_ng_container_0_Template_button_click_7_listener() { i0.ɵɵrestoreView(_r2); const ctx_r1 = i0.ɵɵnextContext(); return ctx_r1.clearSearch(); });
    i0.ɵɵtext(8, " Clear search ");
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(5);
    i0.ɵɵtextInterpolate(ctx_r0.phrase);
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("outline", true)("primary", true);
} }
class ActiveSearchComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, searchCommandDispatcher, searchWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.searchCommandDispatcher = searchCommandDispatcher;
        this.searchWarehouse = searchWarehouse;
    }
    ngOnInit() {
        this.hermesSubscribe(this.searchWarehouse.onPhrase(this.structureId), (phrase) => {
            this.phrase = phrase;
        });
    }
    clearSearch() {
        event.stopPropagation();
        this.searchCommandDispatcher.search('', this.structureId);
    }
    getSelectorName() {
        return 'gui-active-search';
    }
}
ActiveSearchComponent.ɵfac = function ActiveSearchComponent_Factory(t) { return new (t || ActiveSearchComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SearchCommandInvoker), i0.ɵɵdirectiveInject(SearchWarehouse)); };
ActiveSearchComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ActiveSearchComponent, selectors: [["div", "gui-active-search", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$R, decls: 1, vars: 1, consts: [[4, "ngIf"], ["gui-button", "", 3, "outline", "primary", "click"]], template: function ActiveSearchComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, ActiveSearchComponent_ng_container_0_Template, 9, 3, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.phrase);
    } }, directives: [i4.NgIf, i1.FabricChipComponent, i1.FabricButtonComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveSearchComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-active-search]',
                templateUrl: './active-search.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: SearchCommandInvoker }, { type: SearchWarehouse }]; }, null); })();

const _c0$Q = ["gui-active-filter-list", ""];
function ActiveFilterListComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div");
    i0.ɵɵtext(1);
    i0.ɵɵelementStart(2, "span", 2);
    i0.ɵɵlistener("click", function ActiveFilterListComponent_div_0_Template_span_click_2_listener() { const restoredCtx = i0.ɵɵrestoreView(_r3); const filter_r1 = restoredCtx.$implicit; const ctx_r2 = i0.ɵɵnextContext(); return ctx_r2.removeFilter(filter_r1); });
    i0.ɵɵtext(3, "X");
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const filter_r1 = ctx.$implicit;
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", filter_r1.getText(), " ");
} }
class ActiveFilterListComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, filterWarehouse, filterCommandDispatcher) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.filterWarehouse = filterWarehouse;
        this.filterCommandDispatcher = filterCommandDispatcher;
        this.activeFilters = [];
    }
    ngOnInit() {
        this.hermesSubscribe(this.filterWarehouse.onActiveFilters(this.structureId), (activeFilters) => {
            this.activeFilters = activeFilters;
        });
    }
    removeFilter(filter) {
        this.filterCommandDispatcher.removeFilter(filter.getFilterId(), this.structureId);
    }
    getSelectorName() {
        return 'gui-active-filter-list';
    }
}
ActiveFilterListComponent.ɵfac = function ActiveFilterListComponent_Factory(t) { return new (t || ActiveFilterListComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FilterWarehouse), i0.ɵɵdirectiveInject(FilterCommandInvoker)); };
ActiveFilterListComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ActiveFilterListComponent, selectors: [["div", "gui-active-filter-list", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$Q, decls: 2, vars: 1, consts: [[4, "ngFor", "ngForOf"], ["gui-active-search", ""], [3, "click"]], template: function ActiveFilterListComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, ActiveFilterListComponent_div_0_Template, 4, 1, "div", 0);
        i0.ɵɵelement(1, "div", 1);
    } if (rf & 2) {
        i0.ɵɵproperty("ngForOf", ctx.activeFilters);
    } }, directives: [i4.NgForOf, ActiveSearchComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveFilterListComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-active-filter-list]',
                templateUrl: './active-filter-list.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: FilterWarehouse }, { type: FilterCommandInvoker }]; }, null); })();

const _c0$P = ["gui-field-selector", "", "fields", ""];
function FieldSelectorComponent_gui_dropdown_item_2_Template(rf, ctx) { if (rf & 1) {
    const _r3 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "gui-dropdown-item", 1);
    i0.ɵɵlistener("click", function FieldSelectorComponent_gui_dropdown_item_2_Template_gui_dropdown_item_click_0_listener() { const restoredCtx = i0.ɵɵrestoreView(_r3); const field_r1 = restoredCtx.$implicit; const ctx_r2 = i0.ɵɵnextContext(); return ctx_r2.onSelectChange(field_r1); });
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const field_r1 = ctx.$implicit;
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", field_r1.getName(), " ");
} }
class FieldSelectorComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.fieldSelected = new EventEmitter();
    }
    onSelectChange(field) {
        this.fieldSelected.emit(field);
    }
    getSelectorName() {
        return 'gui-field-selector';
    }
}
FieldSelectorComponent.ɵfac = function FieldSelectorComponent_Factory(t) { return new (t || FieldSelectorComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
FieldSelectorComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FieldSelectorComponent, selectors: [["div", "gui-field-selector", "", "fields", ""]], inputs: { fields: "fields" }, outputs: { fieldSelected: "fieldSelected" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$P, decls: 3, vars: 1, consts: [[3, "click", 4, "ngFor", "ngForOf"], [3, "click"]], template: function FieldSelectorComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtext(0, " Field: ");
        i0.ɵɵelementStart(1, "gui-dropdown");
        i0.ɵɵtemplate(2, FieldSelectorComponent_gui_dropdown_item_2_Template, 2, 1, "gui-dropdown-item", 0);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngForOf", ctx.fields);
    } }, directives: [i1.FabricDropdownComponent, i4.NgForOf, i1.DropdownItemComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldSelectorComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-field-selector][fields]',
                template: `

		Field:

		<gui-dropdown>
			<gui-dropdown-item *ngFor="let field of fields"
							   (click)="onSelectChange(field)">
				{{field.getName()}}
			</gui-dropdown-item>
		</gui-dropdown>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { fields: [{
            type: Input
        }], fieldSelected: [{
            type: Output
        }] }); })();

const _c0$O = ["gui-filter-type-selector", "", "filterTypes", ""];
function FilterTypeSelectorComponent_gui_dropdown_item_3_Template(rf, ctx) { if (rf & 1) {
    const _r3 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "gui-dropdown-item", 1);
    i0.ɵɵlistener("click", function FilterTypeSelectorComponent_gui_dropdown_item_3_Template_gui_dropdown_item_click_0_listener() { const restoredCtx = i0.ɵɵrestoreView(_r3); const filterType_r1 = restoredCtx.$implicit; const ctx_r2 = i0.ɵɵnextContext(); return ctx_r2.onSelectChange(filterType_r1); });
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const filterType_r1 = ctx.$implicit;
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", filterType_r1.getName(), " ");
} }
class FilterTypeSelectorComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.filterTypeSelected = new EventEmitter();
    }
    onSelectChange(filterType) {
        this.filterTypeSelected.emit(filterType.getId());
    }
    getSelectorName() {
        return 'gui-filter-type-selector';
    }
}
FilterTypeSelectorComponent.ɵfac = function FilterTypeSelectorComponent_Factory(t) { return new (t || FilterTypeSelectorComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
FilterTypeSelectorComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FilterTypeSelectorComponent, selectors: [["div", "gui-filter-type-selector", "", "filterTypes", ""]], inputs: { filterTypes: "filterTypes" }, outputs: { filterTypeSelected: "filterTypeSelected" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$O, decls: 4, vars: 1, consts: [[3, "click", 4, "ngFor", "ngForOf"], [3, "click"]], template: function FilterTypeSelectorComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementContainerStart(0);
        i0.ɵɵtext(1, " Filter Type:\n");
        i0.ɵɵelementContainerEnd();
        i0.ɵɵelementStart(2, "gui-dropdown");
        i0.ɵɵtemplate(3, FilterTypeSelectorComponent_gui_dropdown_item_3_Template, 2, 1, "gui-dropdown-item", 0);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("ngForOf", ctx.filterTypes);
    } }, directives: [i1.FabricDropdownComponent, i4.NgForOf, i1.DropdownItemComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterTypeSelectorComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-filter-type-selector][filterTypes]',
                templateUrl: './filter-type-selector.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { filterTypes: [{
            type: Input
        }], filterTypeSelected: [{
            type: Output
        }] }); })();

const _c0$N = ["formRef"];
const _c1$b = ["gui-filter-value", ""];
class FilterValueComponent extends SmartComponent {
    constructor(detector, elementRef, formBuilder) {
        super(detector, elementRef);
        this.formBuilder = formBuilder;
        this.valueChanged = new EventEmitter();
        const controlsConfig = {};
        controlsConfig[FilterValueComponent.FORM_FILTER_VALUE] = '';
        this.filterForm = this.formBuilder.group(controlsConfig);
    }
    ngOnInit() {
        this.filterForm
            .controls[FilterValueComponent.FORM_FILTER_VALUE]
            .valueChanges
            // .pipe(
            // 	this.takeUntil()
            // )
            .subscribe((value) => {
            this.valueChanged.emit(value);
        });
    }
    getSelectorName() {
        return 'gui-filter-value';
    }
}
FilterValueComponent.FORM_FILTER_VALUE = 'filterValue';
FilterValueComponent.ɵfac = function FilterValueComponent_Factory(t) { return new (t || FilterValueComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1$2.FormBuilder)); };
FilterValueComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FilterValueComponent, selectors: [["div", "gui-filter-value", ""]], viewQuery: function FilterValueComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$N, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.formRef = _t.first);
    } }, outputs: { valueChanged: "valueChanged" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c1$b, decls: 3, vars: 1, consts: [[3, "formGroup"], ["formRef", ""], ["formControlName", "filterValue"]], template: function FilterValueComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "form", 0, 1);
        i0.ɵɵelement(2, "input", 2);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("formGroup", ctx.filterForm);
    } }, directives: [i1$2.ɵNgNoValidate, i1$2.NgControlStatusGroup, i1$2.FormGroupDirective, i1$2.DefaultValueAccessor, i1$2.NgControlStatus, i1$2.FormControlName], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterValueComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-filter-value]',
                templateUrl: './filter-value.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i1$2.FormBuilder }]; }, { formRef: [{
            type: ViewChild,
            args: ['formRef', { static: false }]
        }], valueChanged: [{
            type: Output
        }] }); })();

const _c0$M = ["gui-filter-menu", ""];
function FilterMenuComponent_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", ctx_r0.selectedColumn.getFieldId(), " ");
} }
function FilterMenuComponent_ng_container_7_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", ctx_r1.selectedFilterTypeId.toString(), " ");
} }
function FilterMenuComponent_div_9_Template(rf, ctx) { if (rf & 1) {
    const _r4 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 7);
    i0.ɵɵlistener("valueChanged", function FilterMenuComponent_div_9_Template_div_valueChanged_0_listener($event) { i0.ɵɵrestoreView(_r4); const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.onValueChanged($event); });
    i0.ɵɵelementEnd();
} }
class FilterMenuComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, compositionId, fieldWarehouse, filterWarehouse, filterCommandDispatcher, compositionWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.fieldWarehouse = fieldWarehouse;
        this.filterWarehouse = filterWarehouse;
        this.filterCommandDispatcher = filterCommandDispatcher;
        this.compositionWarehouse = compositionWarehouse;
        this.columns = [];
        this.fields = [];
        this.activeFilters = [];
        this.addClassToHost('gui-block');
    }
    ngOnInit() {
        this.hermesSubscribe(this.filterWarehouse.onActiveFilters(this.structureId), (activeFilters) => {
            this.activeFilters = activeFilters;
        });
        this.hermesSubscribe(this.filterWarehouse.onFilterTypes(this.structureId), (filterTypeMap) => {
            this.filterTypeMap = filterTypeMap;
        });
        this.hermesSubscribe(this.fieldWarehouse.onFields(this.structureId), (fieldReadModels) => {
            this.fields = fieldReadModels;
        });
        this.hermesSubscribe(this.compositionWarehouse.onHeaderColumns(this.compositionId), (columns) => {
            this.columns = columns;
        });
    }
    onColumnSelect(selectedColumn) {
        this.selectedColumn = selectedColumn;
        this.filterTypes = this.filterTypeMap.getFilterTypes(this.selectedColumn.getFieldId());
        this.changeDetectorRef.detectChanges();
    }
    onFieldSelect(field) {
        this.selectedField = field;
        this.filterTypes = this.filterTypeMap.getFilterTypes(this.selectedField.getFieldId());
        this.changeDetectorRef.detectChanges();
    }
    onFilterTypeSelect(filterTypeId) {
        this.selectedFilterTypeId = filterTypeId;
        this.changeDetectorRef.detectChanges();
    }
    removeAllFilters() {
        this.filterCommandDispatcher.removeAllFilters(this.structureId);
    }
    addFilter() {
        const fieldId = this.selectedField.getFieldId(), filterTypeId = this.selectedFilterTypeId, value = this.selectedValue;
        this.filterCommandDispatcher.add(fieldId, filterTypeId, value, this.structureId);
        this.clearAddFilterForm();
    }
    onValueChanged(value) {
        this.selectedValue = value;
    }
    clearAddFilterForm() {
        this.selectedColumn = null;
        this.selectedField = null;
        this.selectedFilterTypeId = null;
        this.selectedValue = null;
        this.changeDetectorRef.detectChanges();
    }
    getSelectorName() {
        return 'gui-filter-menu';
    }
}
FilterMenuComponent.ɵfac = function FilterMenuComponent_Factory(t) { return new (t || FilterMenuComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(FieldWarehouse), i0.ɵɵdirectiveInject(FilterWarehouse), i0.ɵɵdirectiveInject(FilterCommandInvoker), i0.ɵɵdirectiveInject(CompositionWarehouse)); };
FilterMenuComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FilterMenuComponent, selectors: [["div", "gui-filter-menu", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$M, decls: 16, vars: 8, consts: [["gui-active-filter-list", ""], ["gui-field-selector", "", 3, "fields", "fieldSelected"], [4, "ngIf"], ["gui-filter-type-selector", "", 3, "filterTypes", "filterTypeSelected"], ["gui-filter-value", "", 3, "valueChanged", 4, "ngIf"], ["gui-button", "", 3, "disabled", "primary", "click"], ["gui-button", "", 3, "secondary", "click"], ["gui-filter-value", "", 3, "valueChanged"]], template: function FilterMenuComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div");
        i0.ɵɵelement(1, "div", 0);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(2, "div");
        i0.ɵɵelementStart(3, "div", 1);
        i0.ɵɵlistener("fieldSelected", function FilterMenuComponent_Template_div_fieldSelected_3_listener($event) { return ctx.onFieldSelect($event); });
        i0.ɵɵelementEnd();
        i0.ɵɵtemplate(4, FilterMenuComponent_ng_container_4_Template, 2, 1, "ng-container", 2);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(5, "div");
        i0.ɵɵelementStart(6, "div", 3);
        i0.ɵɵlistener("filterTypeSelected", function FilterMenuComponent_Template_div_filterTypeSelected_6_listener($event) { return ctx.onFilterTypeSelect($event); });
        i0.ɵɵelementEnd();
        i0.ɵɵtemplate(7, FilterMenuComponent_ng_container_7_Template, 2, 1, "ng-container", 2);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(8, "div");
        i0.ɵɵtemplate(9, FilterMenuComponent_div_9_Template, 1, 0, "div", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(10, "div");
        i0.ɵɵelementStart(11, "button", 5);
        i0.ɵɵlistener("click", function FilterMenuComponent_Template_button_click_11_listener() { return ctx.addFilter(); });
        i0.ɵɵtext(12, " Filter ");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(13, "div");
        i0.ɵɵelementStart(14, "button", 6);
        i0.ɵɵlistener("click", function FilterMenuComponent_Template_button_click_14_listener() { return ctx.removeAllFilters(); });
        i0.ɵɵtext(15, " Clear filters ");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("fields", ctx.fields);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.selectedColumn);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("filterTypes", ctx.filterTypes);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.selectedFilterTypeId);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngIf", ctx.selectedFilterTypeId);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("disabled", !ctx.selectedFilterTypeId)("primary", true);
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("secondary", true);
    } }, directives: [ActiveFilterListComponent, FieldSelectorComponent, i4.NgIf, FilterTypeSelectorComponent, i1.FabricButtonComponent, FilterValueComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterMenuComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-filter-menu]',
                templateUrl: './filter-menu.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: CompositionId }, { type: FieldWarehouse }, { type: FilterWarehouse }, { type: FilterCommandInvoker }, { type: CompositionWarehouse }]; }, null); })();

const _c0$L = ["gui-filter-menu-trigger", ""];
class FilterMenuTriggerComponent extends SmartComponent {
    constructor(detector, elementRef, injector, drawerService, filterContainerRef) {
        super(detector, elementRef);
        this.injector = injector;
        this.drawerService = drawerService;
        this.filterContainerRef = filterContainerRef;
    }
    openDrawer() {
        const elementRef = this.filterContainerRef.getElementRef();
        this.drawerService.open(elementRef, FilterMenuComponent, { injector: this.injector });
    }
    getSelectorName() {
        return 'gui-filter-menu-trigger';
    }
}
FilterMenuTriggerComponent.ɵfac = function FilterMenuTriggerComponent_Factory(t) { return new (t || FilterMenuTriggerComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(i1.FabricDrawerService), i0.ɵɵdirectiveInject(filterContainerToken)); };
FilterMenuTriggerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FilterMenuTriggerComponent, selectors: [["div", "gui-filter-menu-trigger", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$L, decls: 2, vars: 1, consts: [[1, "gui-filter-icon-wrapper", 3, "gui-tooltip", "click"], ["gui-filter-icon", ""]], template: function FilterMenuTriggerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵlistener("click", function FilterMenuTriggerComponent_Template_div_click_0_listener() { return ctx.openDrawer(); });
        i0.ɵɵelement(1, "div", 1);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("gui-tooltip", "Filters");
    } }, directives: [i1.FabricTooltipDirective, FilterIconComponent], styles: [".gui-filter-icon-wrapper{margin-right:24px}.gui-filter-menu{width:400px}.gui-filter-icon svg{height:16px;width:16px}.gui-filter-icon svg .cls-1{fill:none;stroke:#aaa;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;transition:stroke .3s ease-in-out}.gui-filter-icon:hover .cls-1{stroke:#464646}\n"], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterMenuTriggerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-filter-menu-trigger]',
                templateUrl: './filter-menu-trigger.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush,
                styleUrls: [
                    '../style/filter.ngx.scss'
                ]
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.Injector }, { type: i1.FabricDrawerService }, { type: undefined, decorators: [{
                type: Inject,
                args: [filterContainerToken]
            }] }]; }, null); })();

const _c0$K = ["gui-column-selector", "", "columns", ""];
function ColumnSelectorComponent_gui_dropdown_item_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function ColumnSelectorComponent_gui_dropdown_item_2_Template(rf, ctx) { if (rf & 1) {
    const _r4 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "gui-dropdown-item", 1);
    i0.ɵɵlistener("click", function ColumnSelectorComponent_gui_dropdown_item_2_Template_gui_dropdown_item_click_0_listener() { const restoredCtx = i0.ɵɵrestoreView(_r4); const column_r1 = restoredCtx.$implicit; const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.onSelectChange(column_r1); });
    i0.ɵɵtemplate(1, ColumnSelectorComponent_gui_dropdown_item_2_ng_container_1_Template, 1, 0, "ng-container", 2);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r1 = ctx.$implicit;
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", column_r1.viewTemplate)("ngTemplateOutletContext", column_r1.context);
} }
class ColumnSelectorComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.columnSelected = new EventEmitter();
    }
    onSelectChange(column) {
        this.columnSelected.emit(column);
    }
    getSelectorName() {
        return 'gui-column-selector';
    }
}
ColumnSelectorComponent.ɵfac = function ColumnSelectorComponent_Factory(t) { return new (t || ColumnSelectorComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
ColumnSelectorComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ColumnSelectorComponent, selectors: [["div", "gui-column-selector", "", "columns", ""]], inputs: { columns: "columns" }, outputs: { columnSelected: "columnSelected" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$K, decls: 3, vars: 1, consts: [[3, "click", 4, "ngFor", "ngForOf"], [3, "click"], [4, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function ColumnSelectorComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtext(0, " Column: ");
        i0.ɵɵelementStart(1, "gui-dropdown");
        i0.ɵɵtemplate(2, ColumnSelectorComponent_gui_dropdown_item_2_Template, 2, 2, "gui-dropdown-item", 0);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngForOf", ctx.columns);
    } }, directives: [i1.FabricDropdownComponent, i4.NgForOf, i1.DropdownItemComponent, i4.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnSelectorComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-column-selector][columns]',
                template: `

		Column:

		<gui-dropdown>
			<gui-dropdown-item *ngFor="let column of columns"
							   (click)="onSelectChange(column)">
				<ng-container
					*ngTemplateOutlet="column.viewTemplate;
						   context: column.context">
				</ng-container>
			</gui-dropdown-item>
		</gui-dropdown>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { columns: [{
            type: Input
        }], columnSelected: [{
            type: Output
        }] }); })();

class ToggleFilterCommand extends StructureCommand {
    constructor(structureId, fieldId, externalFilterId, filterValue) {
        super(structureId, 'ToggleFilterCommand');
        this.fieldId = fieldId;
        this.externalFilterId = externalFilterId;
        this.filterValue = filterValue;
    }
    getFieldId() {
        return this.fieldId;
    }
    getExternalFilterId() {
        return this.externalFilterId;
    }
    getFilterValue() {
        return this.filterValue;
    }
}

class FilterToggledEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'FilterToggledEvent');
    }
}

class ToggleFilterCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return ToggleFilterCommand;
    }
    handle(aggregate, command) {
        const fieldId = command.getFieldId(), externalFieldId = command.getExternalFilterId(), filterValue = command.getFilterValue();
        aggregate.toggleFilter(fieldId, externalFieldId, filterValue);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new FilterToggledEvent(command.getAggregateId()));
    }
}
ToggleFilterCommandHandler.ɵfac = function ToggleFilterCommandHandler_Factory(t) { return new (t || ToggleFilterCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
ToggleFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ToggleFilterCommandHandler, factory: ToggleFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ToggleFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class AddFilterCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return AddFilterCommand;
    }
    handle(structure, command) {
        const fieldId = command.getFieldId(), filterTypeId = command.getFilterTypeId(), value = command.getValue();
        structure.addFilter(fieldId, filterTypeId, value);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
AddFilterCommandHandler.ɵfac = function AddFilterCommandHandler_Factory(t) { return new (t || AddFilterCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
AddFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: AddFilterCommandHandler, factory: AddFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(AddFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class RemoveAllFiltersCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return RemoveAllFiltersCommand;
    }
    handle(structure, command) {
        structure.removeAllFilters();
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
RemoveAllFiltersCommandHandler.ɵfac = function RemoveAllFiltersCommandHandler_Factory(t) { return new (t || RemoveAllFiltersCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
RemoveAllFiltersCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: RemoveAllFiltersCommandHandler, factory: RemoveAllFiltersCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(RemoveAllFiltersCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class RemoveFilterCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return RemoveFilterCommand;
    }
    handle(structure, command) {
        const filterId = command.getFilterId();
        structure.removeFilter(filterId);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
RemoveFilterCommandHandler.ɵfac = function RemoveFilterCommandHandler_Factory(t) { return new (t || RemoveFilterCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
RemoveFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: RemoveFilterCommandHandler, factory: RemoveFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(RemoveFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class ConfigFilterSetEvent extends StructureDomainEvent {
    constructor(aggregateId, enabled) {
        super(aggregateId, enabled, 'ConfigFilterSetEvent');
        this.enabled = enabled;
    }
    getEnabled() {
        return this.enabled;
    }
}

class SetConfigFilterCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetConfigFilterCommand;
    }
    handle(aggregate, command) {
        const filterConfig = command.getConfig();
        aggregate.setFilterConfig(filterConfig);
    }
    publish(aggregate, command) {
        const filterConfig = command.getConfig();
        this.domainEventPublisher.publish(new ConfigFilterSetEvent(command.getAggregateId(), filterConfig.enabled));
    }
}
SetConfigFilterCommandHandler.ɵfac = function SetConfigFilterCommandHandler_Factory(t) { return new (t || SetConfigFilterCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetConfigFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetConfigFilterCommandHandler, factory: SetConfigFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetConfigFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetConfigQuickFilterCommand extends StructureCommand {
    constructor(structureId, quickFiltersConfig) {
        super(structureId, 'SetConfigQuickFilterCommand');
        this.quickFiltersConfig = quickFiltersConfig;
    }
    getConfig() {
        return this.quickFiltersConfig;
    }
}

class ConfigQuickFilterSetEvent extends StructureDomainEvent {
    constructor(aggregateId, enabled) {
        super(aggregateId, enabled, 'ConfigQuickFilterSetEvent');
        this.enabled = enabled;
    }
    getEnabled() {
        return this.enabled;
    }
}

class SetConfigQuickFilterCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetConfigQuickFilterCommand;
    }
    handle(aggregate, command) {
        const quickFiltersConfig = command.getConfig();
        aggregate.setQuickFiltersConfig(quickFiltersConfig);
    }
    publish(aggregate, command) {
        const structureId = command.getAggregateId(), quickFiltersConfig = command.getConfig();
        this.domainEventPublisher.publish(new ConfigQuickFilterSetEvent(structureId, quickFiltersConfig.enabled));
    }
}
SetConfigQuickFilterCommandHandler.ɵfac = function SetConfigQuickFilterCommandHandler_Factory(t) { return new (t || SetConfigQuickFilterCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetConfigQuickFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetConfigQuickFilterCommandHandler, factory: SetConfigQuickFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetConfigQuickFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class Filter {
    constructor(filterId, fieldId, filterTypeId, filterValue) {
        this.filterId = filterId;
        this.fieldId = fieldId;
        this.filterTypeId = filterTypeId;
        this.filterValue = filterValue;
    }
    getFilterId() {
        return this.filterId;
    }
    getFilterTypeId() {
        return this.filterTypeId;
    }
    getFieldId() {
        return this.fieldId;
    }
    getFilterValue() {
        return this.filterValue;
    }
}

class FilterSettings {
    constructor(filteringEnabled = false, searchEnabled = false, quickFiltersEnabled = false) {
        this.filteringEnabled = false;
        this.searchEnabled = false;
        this.quickFiltersEnabled = false;
        this.filteringEnabled = filteringEnabled;
        this.searchEnabled = searchEnabled;
        this.quickFiltersEnabled = quickFiltersEnabled;
    }
    isFilteringEnabled() {
        return this.filteringEnabled;
    }
    isQuickFilteringEnabled() {
        return this.quickFiltersEnabled;
    }
    isSearchingEnabled() {
        return this.searchEnabled;
    }
    setFilterConfig(config) {
        if (config && config.enabled !== undefined && config.enabled !== null) {
            this.filteringEnabled = config.enabled;
        }
    }
    setSearchingConfig(config) {
        if (config && config.enabled !== undefined && config.enabled !== null) {
            this.searchEnabled = config.enabled;
        }
    }
    setQuickFiltersConfig(config) {
        if (config && config.enabled !== undefined && config.enabled !== null) {
            this.quickFiltersEnabled = config.enabled;
        }
    }
}

class BaseFilterType {
    constructor(filterTypeId) {
        this.filterTypeId = filterTypeId;
    }
    getId() {
        return this.filterTypeId;
    }
    filterMany(entities, field, value) {
        if (entities.length === 0) {
            return entities;
        }
        return entities.filter((item) => {
            return this.filterEntity(item, field, value);
        });
    }
    filterOne(entity, field, value) {
        return this.filterEntity(entity, field, value);
    }
}

class ContainsFilterType extends BaseFilterType {
    constructor(filterTypeId) {
        super(filterTypeId);
    }
    getName() {
        return 'Contains';
    }
    filterEntity(entity, field, value) {
        const fieldValue = field.getValue(entity);
        return !!fieldValue.includes(value);
    }
}

class FilterTypeId {
    constructor(id) {
        this.id = id;
    }
    toString() {
        return this.id;
    }
}

class FilterTypeIdGenerator {
    generate() {
        FilterTypeIdGenerator.index += 1;
        return new FilterTypeId(`${FilterTypeIdGenerator.index}`);
    }
}
FilterTypeIdGenerator.index = 0;

class FilterTypeReadModel {
    constructor(id, name) {
        this.filterTypeId = id;
        this.name = name;
    }
    getId() {
        return this.filterTypeId;
    }
    getName() {
        return this.name;
    }
}

class FilterTypeManager {
    constructor(fields) {
        this.fieldIds = [];
        this.map = new WeakMap();
        this.filterTypeMap = new WeakMap();
        this.dataTypeToFilterType = new Map();
        this.filterTypeIdGenerator = new FilterTypeIdGenerator();
        this.assignFilterTypes();
        this.addFields(fields);
    }
    getFilterType(filterTypeId) {
        return this.filterTypeMap.get(filterTypeId);
    }
    getFieldIdsToFilterTypes() {
        const map = new Map();
        for (const fieldId of this.fieldIds) {
            const filterTypes = this.map.get(fieldId), readModels = filterTypes.map(f => {
                return new FilterTypeReadModel(f.getId(), f.getName());
            });
            map.set(fieldId.toString(), readModels);
        }
        return map;
    }
    addFields(fields) {
        for (const field of fields) {
            this.addField(field);
        }
    }
    addField(field) {
        const fieldId = field.getId(), dataType = field.getDataType();
        const filterTypesFromDataType = this.dataTypeToFilterType.get(dataType);
        this.fieldIds.push(fieldId);
        this.map.set(fieldId, Array.from(filterTypesFromDataType));
    }
    assignFilterTypes() {
        this.assignFilterTypesForDataTypeUnknown();
        this.assignFilterTypesForDataTypeNumber();
        this.assignFilterTypesForDataTypeString();
        this.assignFilterTypesForDataTypeBoolean();
        this.assignFilterTypesForDataTypeDate();
        this.assignFilterTypesForDataTypeCustom();
    }
    assignFilterTypesForDataTypeUnknown() {
        this.dataTypeToFilterType.set(DataType.UNKNOWN, []);
    }
    assignFilterTypesForDataTypeNumber() {
        this.dataTypeToFilterType.set(DataType.NUMBER, []);
    }
    assignFilterTypesForDataTypeString() {
        const filterTypes = [
            new ContainsFilterType(this.generateId())
        ];
        this.dataTypeToFilterType.set(DataType.STRING, filterTypes);
        this.addFilterTypes(filterTypes);
    }
    assignFilterTypesForDataTypeBoolean() {
        this.dataTypeToFilterType.set(DataType.BOOLEAN, []);
    }
    assignFilterTypesForDataTypeDate() {
        this.dataTypeToFilterType.set(DataType.DATE, []);
    }
    assignFilterTypesForDataTypeCustom() {
        this.dataTypeToFilterType.set(DataType.CUSTOM, []);
    }
    generateId() {
        return this.filterTypeIdGenerator.generate();
    }
    addFilterTypes(filterTypes) {
        for (const filterType of filterTypes) {
            this.filterTypeMap.set(filterType.getId(), filterType);
        }
    }
}

class FilterId {
    constructor(filterId) {
        this.id = filterId;
    }
    toString() {
        return this.id;
    }
}

class FilterIdGenerator {
    static generateId() {
        return new FilterId(`${FilterIdGenerator.index}`);
    }
}
FilterIdGenerator.index = 0;

class ActiveFilterReadModel {
    constructor(filterId, fieldName, filterTypeName, value) {
        this.filterId = filterId;
        this.fieldName = fieldName;
        this.filterTypeName = filterTypeName;
        this.value = value;
    }
    getText() {
        return `${this.fieldName}: ${this.filterTypeName}: ${this.value}`;
    }
    getFilterId() {
        return this.filterId;
    }
}

class FilterManager {
    constructor() {
        this.filterSettings = new FilterSettings();
        // string -> FilterId
        this.filters = new Map();
        this.activeFilters = [];
    }
    getSettings() {
        return this.filterSettings;
    }
    getAll() {
        return Array.from(this.filters)
            .map((arr) => arr[1]);
    }
    getAllActiveFilters(fields) {
        return this.activeFilters
            .map((af) => {
            return new ActiveFilterReadModel(af.getFilterId(), (fields.get(af.getFieldId().toString())).getName(), this.filterTypeManager.getFilterType(af.getFilterTypeId()).getName(), af.getFilterValue());
        });
    }
    getFilterTypes() {
        return this.filterTypeManager.getFieldIdsToFilterTypes();
    }
    assignFilterTypes(fields) {
        this.filterTypeManager = new FilterTypeManager(fields);
    }
    add(fieldId, filterTypeId, value) {
        const filter = new Filter(FilterIdGenerator.generateId(), fieldId, filterTypeId, value);
        this.activeFilters.push(filter);
    }
    filter(entities, fields) {
        let filteredEntities = Array.from(entities);
        for (const filter of this.activeFilters) {
            const filterTypeId = filter.getFilterTypeId(), filterType = this.getFilterType(filterTypeId), value = filter.getFilterValue();
            filteredEntities = filterType.filterMany(filteredEntities, fields.get(filter.getFieldId().toString()), value);
        }
        return filteredEntities;
    }
    removeAll() {
        this.activeFilters.length = 0;
    }
    remove(filterId) {
        this.activeFilters =
            this.activeFilters.filter((filter) => {
                return filter.getFilterId() !== filterId;
            });
    }
    getFilterType(filterTypeId) {
        return this.filterTypeManager.getFilterType(filterTypeId);
    }
}

class FilterManagerFactory {
    create(enabled = false) {
        return new FilterManager();
    }
}
FilterManagerFactory.ɵfac = function FilterManagerFactory_Factory(t) { return new (t || FilterManagerFactory)(); };
FilterManagerFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FilterManagerFactory, factory: FilterManagerFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterManagerFactory, [{
        type: Injectable
    }], null, null); })();

class ConfigQuickFilterSetEventHandler {
    constructor(structureQuickFilterRepository) {
        this.structureQuickFilterRepository = structureQuickFilterRepository;
    }
    forEvent() {
        return ConfigQuickFilterSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('ConfigQuickFilterSetEvent')) {
            this.structureQuickFilterRepository.next(event.getAggregateId(), event.getEnabled());
        }
    }
}
ConfigQuickFilterSetEventHandler.ɵfac = function ConfigQuickFilterSetEventHandler_Factory(t) { return new (t || ConfigQuickFilterSetEventHandler)(i0.ɵɵinject(QuickFilterEnabledArchive)); };
ConfigQuickFilterSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ConfigQuickFilterSetEventHandler, factory: ConfigQuickFilterSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ConfigQuickFilterSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: QuickFilterEnabledArchive }]; }, null); })();

class ConfigFilterSetEventHandler {
    constructor(structureFilterRepository) {
        this.structureFilterRepository = structureFilterRepository;
    }
    forEvent() {
        return ConfigFilterSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('ConfigFilterSetEvent')) {
            this.structureFilterRepository.next(event.getAggregateId(), event.getEnabled());
        }
    }
}
ConfigFilterSetEventHandler.ɵfac = function ConfigFilterSetEventHandler_Factory(t) { return new (t || ConfigFilterSetEventHandler)(i0.ɵɵinject(FilterEnabledArchive)); };
ConfigFilterSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ConfigFilterSetEventHandler, factory: ConfigFilterSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ConfigFilterSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: FilterEnabledArchive }]; }, null); })();

class FilterTypesInitedEvent extends StructureDomainEvent {
    constructor(aggregateId, map) {
        super(aggregateId, map, 'FilterTypesInitedEvent');
        this.map = map;
    }
    getMap() {
        return this.map;
    }
}

class FilterTypeConfigFilterSetEventHandler {
    constructor(filterTypeArchive) {
        this.filterTypeArchive = filterTypeArchive;
    }
    forEvent() {
        return FilterTypesInitedEvent;
    }
    handle(filterTypesInitedEvent) {
        if (filterTypesInitedEvent.ofMessageType('FilterTypesInitedEvent')) {
            const map = filterTypesInitedEvent.getMap();
            this.filterTypeArchive.next(filterTypesInitedEvent.getAggregateId(), new FilterTypeMap(map));
        }
    }
}
FilterTypeConfigFilterSetEventHandler.ɵfac = function FilterTypeConfigFilterSetEventHandler_Factory(t) { return new (t || FilterTypeConfigFilterSetEventHandler)(i0.ɵɵinject(FilterTypeArchive)); };
FilterTypeConfigFilterSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FilterTypeConfigFilterSetEventHandler, factory: FilterTypeConfigFilterSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterTypeConfigFilterSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: FilterTypeArchive }]; }, null); })();

class ActiveFiltersSetEvent extends StructureDomainEvent {
    constructor(structureId, filters) {
        super(structureId, filters, 'ActiveFiltersSetEvent');
        this.filters = filters;
    }
    getFilters() {
        return this.filters;
    }
}

class ActiveFiltersSetEventHandler {
    constructor(activeFilterRepository) {
        this.activeFilterRepository = activeFilterRepository;
    }
    forEvent() {
        return ActiveFiltersSetEvent;
    }
    handle(activeFiltersSetEvent) {
        if (activeFiltersSetEvent.ofMessageType('ActiveFiltersSetEvent')) {
            const activeFilters = activeFiltersSetEvent.getFilters();
            this.activeFilterRepository.next(activeFiltersSetEvent.getAggregateId(), activeFilters);
        }
    }
}
ActiveFiltersSetEventHandler.ɵfac = function ActiveFiltersSetEventHandler_Factory(t) { return new (t || ActiveFiltersSetEventHandler)(i0.ɵɵinject(ActiveFilterArchive)); };
ActiveFiltersSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ActiveFiltersSetEventHandler, factory: ActiveFiltersSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveFiltersSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: ActiveFilterArchive }]; }, null); })();

class UniqueFilterCalculatedEvent extends StructureDomainEvent {
    constructor(aggregateId, map) {
        super(aggregateId, map, 'UniqueFilterCalculatedEvent');
        this.map = map;
    }
    getUniqueValues() {
        return this.map;
    }
}

class UniqueValueReadModel {
    constructor(id, value, enabled) {
        this.id = id;
        this.value = value;
        this.enabled = enabled;
    }
    getId() {
        return this.id;
    }
    getValue() {
        return this.value;
    }
    geDisplayValue() {
        return this.displayValue;
    }
    isEnabled() {
        return this.enabled;
    }
}

class UniqueFilterCalculatedEventHandler {
    constructor(uniqueValuesRepository) {
        this.uniqueValuesRepository = uniqueValuesRepository;
    }
    forEvent() {
        return UniqueFilterCalculatedEvent;
    }
    handle(calculatedEvent) {
        if (calculatedEvent.ofMessageType('UniqueFilterCalculatedEvent')) {
            const uvRM = new Map();
            calculatedEvent.getUniqueValues()
                .forEach((values, key) => {
                const valuesRM = values.map((uv) => {
                    return new UniqueValueReadModel(uv.getId(), uv.getDisplayValue(), uv.isEnabled());
                });
                uvRM.set(key, valuesRM);
            });
            const uniqueValues = new UniqueValuesReadModel(uvRM);
            this.uniqueValuesRepository.next(calculatedEvent.getAggregateId(), uniqueValues);
        }
    }
}
UniqueFilterCalculatedEventHandler.ɵfac = function UniqueFilterCalculatedEventHandler_Factory(t) { return new (t || UniqueFilterCalculatedEventHandler)(i0.ɵɵinject(UniqueValuesArchive)); };
UniqueFilterCalculatedEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: UniqueFilterCalculatedEventHandler, factory: UniqueFilterCalculatedEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UniqueFilterCalculatedEventHandler, [{
        type: Injectable
    }], function () { return [{ type: UniqueValuesArchive }]; }, null); })();

class FieldsInitedEvent extends StructureDomainEvent {
    constructor(aggregateId, fieldConfigs, // TODO merge
    fields) {
        super(aggregateId, { fieldConfigs, fields }, 'FieldsInitedEvent');
        this.fieldConfigs = fieldConfigs;
        this.fields = fields;
    }
    getFields() {
        return this.fields;
    }
}

// TODO Remove
class FilterTypeFieldsInitedEventHandler {
    // constructor(private readonly filterTypeManagerRepository: FilterTypeManagerRepository,
    // 			private readonly domainEventPublisher: DomainEventPublisher) {
    // }
    forEvent() {
        return FieldsInitedEvent;
    }
    handle(fieldsInitedEvent) {
        // if (fieldsInitedEvent.ofMessageType('FieldsInitedEvent')) {
        //
        // 	const fields = fieldsInitedEvent.getFields();
        //
        // 	const manager = new FilterTypeManager(fields);
        //
        // 	this.filterTypeManagerRepository.next(fieldsInitedEvent.getAggregateId(), manager);
        //
        // 	this.domainEventPublisher.publish(new FilterTypesInitedEvent(fieldsInitedEvent.getAggregateId(), manager.getFieldIdsToFieldTypes()));
        // }
    }
}
FilterTypeFieldsInitedEventHandler.ɵfac = function FilterTypeFieldsInitedEventHandler_Factory(t) { return new (t || FilterTypeFieldsInitedEventHandler)(); };
FilterTypeFieldsInitedEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FilterTypeFieldsInitedEventHandler, factory: FilterTypeFieldsInitedEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterTypeFieldsInitedEventHandler, [{
        type: Injectable
    }], null, null); })();

class UnselectAllUniqueFilterCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return UnselectAllUniqueFilterCommand;
    }
    handle(structure, command) {
        const fieldId = command.getFieldId();
        structure.unselectAllUniqueFilter(fieldId);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
UnselectAllUniqueFilterCommandHandler.ɵfac = function UnselectAllUniqueFilterCommandHandler_Factory(t) { return new (t || UnselectAllUniqueFilterCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
UnselectAllUniqueFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: UnselectAllUniqueFilterCommandHandler, factory: UnselectAllUniqueFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UnselectAllUniqueFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class UnselectUniqueFilterCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return UnselectUniqueFilterCommand;
    }
    handle(structure, command) {
        const fieldId = command.getFieldId(), uniqueValueId = command.getUniqueValueId();
        structure.unselectUniqueFilter(fieldId, uniqueValueId);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
UnselectUniqueFilterCommandHandler.ɵfac = function UnselectUniqueFilterCommandHandler_Factory(t) { return new (t || UnselectUniqueFilterCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
UnselectUniqueFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: UnselectUniqueFilterCommandHandler, factory: UnselectUniqueFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UnselectUniqueFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SelectAllUniqueFilterCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SelectAllUniqueFilterCommand;
    }
    handle(structure, command) {
        const fieldId = command.getFieldId();
        structure.selectAllUniqueFilter(fieldId);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SelectAllUniqueFilterCommandHandler.ɵfac = function SelectAllUniqueFilterCommandHandler_Factory(t) { return new (t || SelectAllUniqueFilterCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SelectAllUniqueFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SelectAllUniqueFilterCommandHandler, factory: SelectAllUniqueFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SelectAllUniqueFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SelectUniqueFilterCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SelectUniqueFilterCommand;
    }
    handle(structure, command) {
        const fieldId = command.getFieldId(), uniqueValueId = command.getUniqueValueId();
        structure.selectUniqueFilter(fieldId, uniqueValueId);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SelectUniqueFilterCommandHandler.ɵfac = function SelectUniqueFilterCommandHandler_Factory(t) { return new (t || SelectUniqueFilterCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SelectUniqueFilterCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SelectUniqueFilterCommandHandler, factory: SelectUniqueFilterCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SelectUniqueFilterCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class FilterDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SetConfigFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetConfigQuickFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(ToggleFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(AddFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(RemoveAllFiltersCommandHandler, structureKey),
            HermesModule.registerCommandHandler(RemoveFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SelectUniqueFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SelectAllUniqueFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(UnselectUniqueFilterCommandHandler, structureKey),
            HermesModule.registerCommandHandler(UnselectAllUniqueFilterCommandHandler, structureKey)
        ];
    }
    static domainEventHandlers() {
        return [
            HermesModule.registerDomainEventHandler(ConfigQuickFilterSetEventHandler),
            HermesModule.registerDomainEventHandler(ConfigFilterSetEventHandler),
            HermesModule.registerDomainEventHandler(FilterTypeConfigFilterSetEventHandler),
            HermesModule.registerDomainEventHandler(ActiveFiltersSetEventHandler),
            HermesModule.registerDomainEventHandler(UniqueFilterCalculatedEventHandler),
            HermesModule.registerDomainEventHandler(FilterTypeFieldsInitedEventHandler)
        ];
    }
}
FilterDomainModule.ɵfac = function FilterDomainModule_Factory(t) { return new (t || FilterDomainModule)(); };
FilterDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: FilterDomainModule });
FilterDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        FilterManagerFactory
    ], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [
                    FilterManagerFactory
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(FilterDomainModule, { imports: [CommonModule] }); })();

class FilterApiModule extends ApiModule {
}
FilterApiModule.ɵfac = /*@__PURE__*/ function () { let ɵFilterApiModule_BaseFactory; return function FilterApiModule_Factory(t) { return (ɵFilterApiModule_BaseFactory || (ɵFilterApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(FilterApiModule)))(t || FilterApiModule); }; }();
FilterApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: FilterApiModule });
FilterApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        FilterCommandInvoker,
        FilterWarehouse,
        FilterTypeArchive,
        ActiveFilterArchive,
        UniqueValuesArchive,
        FilterEnabledArchive,
        QuickFilterEnabledArchive
    ], imports: [[
            CommonModule,
            FilterDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FilterDomainModule
                ],
                providers: [
                    FilterCommandInvoker,
                    FilterWarehouse,
                    FilterTypeArchive,
                    ActiveFilterArchive,
                    UniqueValuesArchive,
                    FilterEnabledArchive,
                    QuickFilterEnabledArchive
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(FilterApiModule, { imports: [CommonModule,
        FilterDomainModule] }); })();

const fabricImports = [
    FabricBadgeModule,
    FabricButtonModule,
    FabricButtonGroupModule,
    FabricCheckboxModule,
    FabricChipModule,
    FabricDrawerModule,
    FabricDropdownModule,
    FabricRadioButtonModule,
    FabricRadioGroupModule,
    FabricProgressBarModule,
    FabricProgressSpinnerModule,
    FabricSelectModule,
    FabricSpinnerModule,
    FabricTabModule,
    FabricTooltipModule,
    FabricToggleButtonModule,
    FabricInputModule,
    FabricDialogModule,
    FabricInlineDialogModule,
    FabricTabModule
];

class ActiveFilterListModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
ActiveFilterListModule.ɵfac = /*@__PURE__*/ function () { let ɵActiveFilterListModule_BaseFactory; return function ActiveFilterListModule_Factory(t) { return (ɵActiveFilterListModule_BaseFactory || (ɵActiveFilterListModule_BaseFactory = i0.ɵɵgetInheritedFactory(ActiveFilterListModule)))(t || ActiveFilterListModule); }; }();
ActiveFilterListModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: ActiveFilterListModule });
ActiveFilterListModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            fabricImports,
            FilterApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveFilterListModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    fabricImports,
                    FilterApiModule
                ],
                declarations: [
                    ActiveFilterListComponent,
                    ActiveSearchComponent
                ],
                exports: [
                    ActiveFilterListComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(ActiveFilterListModule, { declarations: [ActiveFilterListComponent,
        ActiveSearchComponent], imports: [CommonModule, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, FilterApiModule], exports: [ActiveFilterListComponent] }); })();

class FilterMenuFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
FilterMenuFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵFilterMenuFeatureModule_BaseFactory; return function FilterMenuFeatureModule_Factory(t) { return (ɵFilterMenuFeatureModule_BaseFactory || (ɵFilterMenuFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(FilterMenuFeatureModule)))(t || FilterMenuFeatureModule); }; }();
FilterMenuFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: FilterMenuFeatureModule });
FilterMenuFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            FabricModule,
            ReactiveFormsModule,
            FilterApiModule,
            ActiveFilterListModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FilterMenuFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FabricModule,
                    ReactiveFormsModule,
                    FilterApiModule,
                    ActiveFilterListModule
                ],
                declarations: [
                    FilterIconComponent,
                    FilterMenuComponent,
                    FilterMenuTriggerComponent,
                    ColumnSelectorComponent,
                    FilterTypeSelectorComponent,
                    FilterValueComponent,
                    FieldSelectorComponent
                ],
                exports: [
                    FilterMenuTriggerComponent
                ],
                entryComponents: [
                    FilterMenuComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(FilterMenuFeatureModule, { declarations: [FilterIconComponent,
        FilterMenuComponent,
        FilterMenuTriggerComponent,
        ColumnSelectorComponent,
        FilterTypeSelectorComponent,
        FilterValueComponent,
        FieldSelectorComponent], imports: [CommonModule,
        FabricModule,
        ReactiveFormsModule,
        FilterApiModule,
        ActiveFilterListModule], exports: [FilterMenuTriggerComponent] }); })();

const exportDeclarations$3 = [
    ListViewComponent,
    listViewGatewayDeclarations
];
class ListViewFeatureModule {
}
ListViewFeatureModule.exportDeclarations = Array.from(exportDeclarations$3);
ListViewFeatureModule.ɵfac = function ListViewFeatureModule_Factory(t) { return new (t || ListViewFeatureModule)(); };
ListViewFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: ListViewFeatureModule });
ListViewFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [], imports: [[
            CommonModule,
            ListViewApiModule,
            FabricSelectModule,
            PagingFeatureModule,
            SearchFeatureModule,
            EmptySourceFeatureModule,
            SortingSelectorFeatureModule,
            FilterMenuFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ListViewFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    ListViewApiModule,
                    FabricSelectModule,
                    PagingFeatureModule,
                    SearchFeatureModule,
                    EmptySourceFeatureModule,
                    SortingSelectorFeatureModule,
                    FilterMenuFeatureModule
                ],
                declarations: [
                    ListViewComponent,
                    ListViewItemComponent,
                    ListViewLayoutComponent,
                    ListViewSourceComponent,
                    ListViewContainerCardComponent,
                    ListViewCardItemComponent,
                    ListViewContainerModeSelectComponent,
                    listViewGatewayDeclarations
                ],
                exports: exportDeclarations$3,
                providers: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(ListViewFeatureModule, { declarations: [ListViewComponent,
        ListViewItemComponent,
        ListViewLayoutComponent,
        ListViewSourceComponent,
        ListViewContainerCardComponent,
        ListViewCardItemComponent,
        ListViewContainerModeSelectComponent, ListViewPagingGate, ListViewModeGate, ListViewTemplateGate, ListViewFieldGate, ListViewSearchingGate, ListViewL10nGate, ListViewSourceGate], imports: [CommonModule,
        ListViewApiModule,
        FabricSelectModule,
        PagingFeatureModule,
        SearchFeatureModule,
        EmptySourceFeatureModule,
        SortingSelectorFeatureModule,
        FilterMenuFeatureModule], exports: [ListViewComponent, ListViewPagingGate, ListViewModeGate, ListViewTemplateGate, ListViewFieldGate, ListViewSearchingGate, ListViewL10nGate, ListViewSourceGate] }); })();

class NumberFormatterPipe {
    transform(number) {
        return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
    }
}
NumberFormatterPipe.ɵfac = function NumberFormatterPipe_Factory(t) { return new (t || NumberFormatterPipe)(); };
NumberFormatterPipe.ɵpipe = /*@__PURE__*/ i0.ɵɵdefinePipe({ name: "numberFormatter", type: NumberFormatterPipe, pure: true });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(NumberFormatterPipe, [{
        type: Pipe,
        args: [{ name: 'numberFormatter' }]
    }], null, null); })();

class NumberFormatterModule {
}
NumberFormatterModule.ɵfac = function NumberFormatterModule_Factory(t) { return new (t || NumberFormatterModule)(); };
NumberFormatterModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: NumberFormatterModule });
NumberFormatterModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({});
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(NumberFormatterModule, [{
        type: NgModule,
        args: [{
                declarations: [
                    NumberFormatterPipe
                ],
                exports: [
                    NumberFormatterPipe
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(NumberFormatterModule, { declarations: [NumberFormatterPipe], exports: [NumberFormatterPipe] }); })();

const _c0$J = ["gui-info-dialog", ""];
class StructureInfoModalComponent extends StaticComponent {
    constructor(elementRef, changeDetectorRef) {
        super(elementRef, changeDetectorRef);
    }
    getSelectorName() {
        return 'gui-info-dialog';
    }
}
StructureInfoModalComponent.ɵfac = function StructureInfoModalComponent_Factory(t) { return new (t || StructureInfoModalComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
StructureInfoModalComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureInfoModalComponent, selectors: [["div", "gui-info-dialog", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$J, decls: 31, vars: 0, consts: [[1, "gui-structure-info-modal", "gui-flex", "gui-flex-col", "gui-p-0", "gui-text-lg", "gui-w-full"], [1, "gui-dialog-title", "gui-text-3xl", "gui-mb-8", "gui-font-bold"], [1, "gui-text-xl", "gui-mb-18", "gui-font-bold"], [1, "gui-quote", "gui-text-2xl", "gui-italic", "gui-font-light"], [1, "gui-m-0", "gui-px-0", "gui-pt-10", "gui-pb-6"], [1, "gui-font-bold"], [1, "gui-m-0", "gui-pl-9", "gui-list-none"], ["href", "https://generic-ui.com/", 1, "gui-mb-6", "gui-no-underline", "gui-leading-6"], ["href", "https://generic-ui.com/guide/", 1, "gui-mb-6", "gui-no-underline", "gui-leading-6"], ["href", "https://github.com/generic-ui/generic-ui/tree/master/ngx-grid", 1, "gui-mb-6", "gui-no-underline", "gui-leading-6"], ["href", "https://github.com/generic-ui/generic-ui/issues", 1, "gui-mb-6", "gui-no-underline", "gui-leading-6"]], template: function StructureInfoModalComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵelementStart(1, "p", 1);
        i0.ɵɵtext(2, " Generic UI Grid ");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(3, "p", 2);
        i0.ɵɵtext(4, " ver. 0.16.0 ");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(5, "p", 3);
        i0.ɵɵtext(6, " \"The best way to success is to help others succeed.\" ");
        i0.ɵɵelementEnd();
        i0.ɵɵelement(7, "br");
        i0.ɵɵelementStart(8, "section", 4);
        i0.ɵɵelementStart(9, "p", 5);
        i0.ɵɵtext(10, "Links:");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(11, "ul", 6);
        i0.ɵɵelementStart(12, "li");
        i0.ɵɵelementStart(13, "a", 7);
        i0.ɵɵtext(14, "Website");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(15, "li");
        i0.ɵɵelementStart(16, "a", 8);
        i0.ɵɵtext(17, "Documentation");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(18, "li");
        i0.ɵɵelementStart(19, "a", 9);
        i0.ɵɵtext(20, "Github");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelement(21, "br");
        i0.ɵɵelementStart(22, "p", 5);
        i0.ɵɵtext(23, "Feedback:");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(24, "ul", 6);
        i0.ɵɵelementStart(25, "li");
        i0.ɵɵelementStart(26, "a", 10);
        i0.ɵɵtext(27, "Report a bug");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(28, "li");
        i0.ɵɵelementStart(29, "a", 10);
        i0.ɵɵtext(30, "Suggest an idea");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoModalComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-info-dialog]',
                templateUrl: './structure-info-modal.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

class CompositionCommandInvoker {
    constructor() {
    }
}
CompositionCommandInvoker.ɵfac = function CompositionCommandInvoker_Factory(t) { return new (t || CompositionCommandInvoker)(); };
CompositionCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionCommandInvoker, factory: CompositionCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionCommandInvoker, [{
        type: Injectable
    }], function () { return []; }, null); })();

const _c0$I = ["gui-structure-column-manager", ""];
function StructureColumnManagerComponent_li_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function StructureColumnManagerComponent_li_1_Template(rf, ctx) { if (rf & 1) {
    const _r4 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "li", 2);
    i0.ɵɵlistener("click", function StructureColumnManagerComponent_li_1_Template_li_click_0_listener() { const restoredCtx = i0.ɵɵrestoreView(_r4); const column_r1 = restoredCtx.$implicit; const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.toggleColumn(column_r1); });
    i0.ɵɵelementStart(1, "gui-checkbox", 3);
    i0.ɵɵtemplate(2, StructureColumnManagerComponent_li_1_ng_container_2_Template, 1, 0, "ng-container", 4);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r1 = ctx.$implicit;
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("checked", column_r1.isEnabled())("disabled", ctx_r0.enabledColumnsCount === 1 && column_r1.isEnabled());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", column_r1.viewTemplate)("ngTemplateOutletContext", column_r1.context);
} }
class StructureColumnManagerComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, compositionId, compositionCommandInvoker, compositionWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.compositionId = compositionId;
        this.compositionCommandInvoker = compositionCommandInvoker;
        this.compositionWarehouse = compositionWarehouse;
        this.addClassToHost('gui-block');
    }
    ngOnInit() {
        this.hermesSubscribe(this.compositionWarehouse.onAllColumns(this.compositionId), (columns) => {
            this.columns = columns;
            this.enabledColumnsCount = this.columns
                .map((c) => +c.isEnabled())
                .reduce((accumulator, currentValue) => accumulator + currentValue);
        });
    }
    toggleColumn(column) {
        event.stopPropagation();
        if (column.isEnabled()) {
            this.compositionCommandInvoker.disableColumn(column.getColumnDefinitionId(), this.compositionId);
        }
        else {
            this.compositionCommandInvoker.enableColumn(column.getColumnDefinitionId(), this.compositionId);
        }
    }
    getSelectorName() {
        return 'gui-structure-column-manager';
    }
}
StructureColumnManagerComponent.ɵfac = function StructureColumnManagerComponent_Factory(t) { return new (t || StructureColumnManagerComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(CompositionCommandInvoker), i0.ɵɵdirectiveInject(CompositionWarehouse)); };
StructureColumnManagerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnManagerComponent, selectors: [["div", "gui-structure-column-manager", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$I, decls: 2, vars: 1, consts: [[1, "gui-p-0", "gui-my-4", "gui-mx-0", "gui-list-none", "gui-overflow-auto"], ["class", "gui-p-6 gui-cursor-pointer", 3, "click", 4, "ngFor", "ngForOf"], [1, "gui-p-6", "gui-cursor-pointer", 3, "click"], [3, "checked", "disabled"], [4, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function StructureColumnManagerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "ol", 0);
        i0.ɵɵtemplate(1, StructureColumnManagerComponent_li_1_Template, 3, 4, "li", 1);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngForOf", ctx.columns);
    } }, directives: [i4.NgForOf, i1.FabricCheckboxComponent, i4.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnManagerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-manager]',
                template: `

		<ol class="gui-p-0 gui-my-4 gui-mx-0 gui-list-none gui-overflow-auto">
			<li *ngFor="let column of columns"
				(click)="toggleColumn(column)"
				class="gui-p-6 gui-cursor-pointer">

				<gui-checkbox [checked]="column.isEnabled()"
							  [disabled]="enabledColumnsCount === 1 && column.isEnabled()">

					<ng-container
						*ngTemplateOutlet="column.viewTemplate;
											context: column.context">
					</ng-container>
				</gui-checkbox>

			</li>
		</ol>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: CompositionId }, { type: CompositionCommandInvoker }, { type: CompositionWarehouse }]; }, null); })();

const _c0$H = ["gui-structure-dialog-column-manager", ""];
class StructureDialogColumnManagerComponent extends SmartComponent {
    constructor(detector, elementRef) {
        super(detector, elementRef);
    }
    getSelectorName() {
        return 'gui-structure-dialog-column-manager';
    }
}
StructureDialogColumnManagerComponent.ɵfac = function StructureDialogColumnManagerComponent_Factory(t) { return new (t || StructureDialogColumnManagerComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureDialogColumnManagerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureDialogColumnManagerComponent, selectors: [["div", "gui-structure-dialog-column-manager", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$H, decls: 4, vars: 3, consts: [[1, "gui-dialog-title"], ["gui-structure-column-manager", ""]], template: function StructureDialogColumnManagerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵtext(1);
        i0.ɵɵpipe(2, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelement(3, "div", 1);
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 1, "columnManagerModalTitle"));
    } }, directives: [StructureColumnManagerComponent], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureDialogColumnManagerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-dialog-column-manager]',
                templateUrl: './structure.dialog-column-manager.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, null); })();

class SchemaWarehouse {
}
SchemaWarehouse.ɵfac = function SchemaWarehouse_Factory(t) { return new (t || SchemaWarehouse)(); };
SchemaWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaWarehouse, factory: SchemaWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaWarehouse, [{
        type: Injectable
    }], null, null); })();

var SchemaTheme;
(function (SchemaTheme) {
    SchemaTheme[SchemaTheme["FABRIC"] = 0] = "FABRIC";
    SchemaTheme[SchemaTheme["MATERIAL"] = 1] = "MATERIAL";
    SchemaTheme[SchemaTheme["LIGHT"] = 2] = "LIGHT";
    SchemaTheme[SchemaTheme["DARK"] = 3] = "DARK";
    SchemaTheme[SchemaTheme["GENERIC"] = 4] = "GENERIC";
})(SchemaTheme || (SchemaTheme = {}));

class StructureThemeConverter {
    convertTheme(schemaTheme) {
        switch (schemaTheme) {
            case SchemaTheme.FABRIC:
                return Theme.FABRIC;
            case SchemaTheme.MATERIAL:
                return Theme.MATERIAL;
            case SchemaTheme.GENERIC:
                return Theme.GENERIC;
            case SchemaTheme.LIGHT:
                return Theme.LIGHT;
            case SchemaTheme.DARK:
                return Theme.DARK;
            default:
                return Theme.FABRIC;
        }
    }
}
StructureThemeConverter.ɵfac = function StructureThemeConverter_Factory(t) { return new (t || StructureThemeConverter)(); };
StructureThemeConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureThemeConverter, factory: StructureThemeConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureThemeConverter, [{
        type: Injectable
    }], null, null); })();

class StructureDialogColumnManagerService extends Reactive {
    constructor(injector, schemaWarehouse, structureThemeConverter, fabricDialogService) {
        super();
        this.injector = injector;
        this.schemaWarehouse = schemaWarehouse;
        this.structureThemeConverter = structureThemeConverter;
        this.fabricDialogService = fabricDialogService;
    }
    open(compositionId, readModelId, parentInjector) {
        if (!parentInjector) {
            parentInjector = this.injector;
        }
        const injector = Injector.create({ parent: parentInjector, providers: [{ provide: CompositionId, useValue: compositionId }] });
        this.schemaWarehouse
            .onceTheme(readModelId)
            .pipe(this.hermesTakeUntil())
            .subscribe((theme) => {
            this.fabricDialogService.open(StructureDialogColumnManagerComponent, {
                injector: injector,
                theme: this.structureThemeConverter.convertTheme(theme)
            });
        });
    }
}
StructureDialogColumnManagerService.ɵfac = function StructureDialogColumnManagerService_Factory(t) { return new (t || StructureDialogColumnManagerService)(i0.ɵɵinject(i0.Injector), i0.ɵɵinject(SchemaWarehouse), i0.ɵɵinject(StructureThemeConverter), i0.ɵɵinject(i1.FabricDialogService)); };
StructureDialogColumnManagerService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureDialogColumnManagerService, factory: StructureDialogColumnManagerService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureDialogColumnManagerService, [{
        type: Injectable
    }], function () { return [{ type: i0.Injector }, { type: SchemaWarehouse }, { type: StructureThemeConverter }, { type: i1.FabricDialogService }]; }, null); })();

var SchemaRowColoring;
(function (SchemaRowColoring) {
    SchemaRowColoring[SchemaRowColoring["NONE"] = 0] = "NONE";
    SchemaRowColoring[SchemaRowColoring["EVEN"] = 1] = "EVEN";
    SchemaRowColoring[SchemaRowColoring["ODD"] = 2] = "ODD";
})(SchemaRowColoring || (SchemaRowColoring = {}));

var RowColoring;
(function (RowColoring) {
    RowColoring[RowColoring["NONE"] = 0] = "NONE";
    RowColoring[RowColoring["EVEN"] = 1] = "EVEN";
    RowColoring[RowColoring["ODD"] = 2] = "ODD";
})(RowColoring || (RowColoring = {}));

class SchemaCommandInvoker {
    constructor() {
    }
}
SchemaCommandInvoker.ɵfac = function SchemaCommandInvoker_Factory(t) { return new (t || SchemaCommandInvoker)(); };
SchemaCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaCommandInvoker, factory: SchemaCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaCommandInvoker, [{
        type: Injectable
    }], function () { return []; }, null); })();

const _c0$G = ["gui-structure-schema-manager", ""];
class StructureSchemaMangerComponent extends SmartComponent {
    constructor(changeDetectorRef, elRef, structureId, schemaReadModelRootId, schemaCommandInvoker, schemaWarehouse) {
        super(changeDetectorRef, elRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.schemaReadModelRootId = schemaReadModelRootId;
        this.schemaCommandInvoker = schemaCommandInvoker;
        this.schemaWarehouse = schemaWarehouse;
        this.coloring = Object.keys(SchemaRowColoring)
            .map((key) => SchemaRowColoring[key])
            .filter((val) => !Number.isInteger(val))
            .map((value) => {
            return {
                value: value,
                name: value
            };
        });
        this.themes = Object.keys(SchemaTheme)
            .map((key) => SchemaTheme[key])
            .filter((val) => !Number.isInteger(val))
            .map((value) => {
            return {
                value: value,
                name: value
            };
        });
    }
    ngOnInit() {
        this.hermesSubscribe(this.schemaWarehouse.onRowColoring(this.schemaReadModelRootId), (rowColoring) => {
            this.selectedRowColoring = {
                value: SchemaRowColoring[rowColoring],
                name: SchemaRowColoring[rowColoring]
            };
        });
        this.hermesSubscribe(this.schemaWarehouse.onTheme(this.schemaReadModelRootId), (schemaTheme) => {
            this.selectedTheme = {
                value: SchemaTheme[schemaTheme],
                name: SchemaTheme[schemaTheme]
            };
        });
        this.hermesSubscribe(this.schemaWarehouse.onVerticalGrid(this.schemaReadModelRootId), (verticalGrid) => {
            this.verticalGrid = verticalGrid;
        });
        this.hermesSubscribe(this.schemaWarehouse.onHorizontalGrid(this.schemaReadModelRootId), (horizontalGrid) => {
            this.horizontalGrid = horizontalGrid;
        });
    }
    toggleTheme(theme) {
        this.schemaCommandInvoker.setTheme(this.toTheme(theme.value), this.schemaReadModelRootId, this.structureId);
    }
    toggleRowColoring(schemaRowColoring) {
        this.schemaCommandInvoker.setRowColoring(this.toRowColoring(schemaRowColoring.value), this.schemaReadModelRootId);
    }
    toggleVerticalGrid(verticalGrid) {
        this.schemaCommandInvoker.setVerticalGrid(verticalGrid, this.schemaReadModelRootId);
    }
    toggleHorizontalGrid(horizontalGrid) {
        this.schemaCommandInvoker.setHorizontalGrid(horizontalGrid, this.schemaReadModelRootId);
    }
    toTheme(theme) {
        switch (theme.toLowerCase()) {
            case 'fabric':
                return SchemaTheme.FABRIC;
            case 'material':
                return SchemaTheme.MATERIAL;
            case 'generic':
                return SchemaTheme.GENERIC;
            case 'light':
                return SchemaTheme.LIGHT;
            case 'dark':
                return SchemaTheme.DARK;
            default:
                return SchemaTheme.FABRIC;
        }
    }
    toRowColoring(coloring) {
        switch (coloring.toLowerCase()) {
            case 'none':
                return RowColoring.NONE;
            case 'odd':
                return RowColoring.ODD;
            case 'even':
                return RowColoring.EVEN;
            default:
                return RowColoring.NONE;
        }
    }
    getSelectorName() {
        return 'gui-structure-schema-manager';
    }
}
StructureSchemaMangerComponent.ɵfac = function StructureSchemaMangerComponent_Factory(t) { return new (t || StructureSchemaMangerComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SchemaReadModelRootId), i0.ɵɵdirectiveInject(SchemaCommandInvoker), i0.ɵɵdirectiveInject(SchemaWarehouse)); };
StructureSchemaMangerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureSchemaMangerComponent, selectors: [["div", "gui-structure-schema-manager", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$G, decls: 20, vars: 22, consts: [[1, "gui-schema-manager", "gui-flex", "gui-flex-col"], [1, "gui-dialog-title"], [1, "gui-structure-schema-manager-select", "gui-flex", "gui-flex-col", "gui-mb-10"], [1, "gui-mb-4"], [3, "options", "placeholder", "selected", "optionChanged"], [1, "gui-structure-schema-manager-select", "gui-flex", "gui-flex-col"], [3, "options", "selected", "optionChanged"], [1, "gui-mt-14", 3, "checked", "changed"], [1, "gui-mt-10", 3, "checked", "changed"]], template: function StructureSchemaMangerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵelementStart(1, "div", 1);
        i0.ɵɵtext(2);
        i0.ɵɵpipe(3, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(4, "div", 2);
        i0.ɵɵelementStart(5, "span", 3);
        i0.ɵɵtext(6);
        i0.ɵɵpipe(7, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(8, "gui-select", 4);
        i0.ɵɵlistener("optionChanged", function StructureSchemaMangerComponent_Template_gui_select_optionChanged_8_listener($event) { return ctx.toggleTheme($event); });
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(9, "div", 5);
        i0.ɵɵelementStart(10, "span", 3);
        i0.ɵɵtext(11);
        i0.ɵɵpipe(12, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(13, "gui-select", 6);
        i0.ɵɵlistener("optionChanged", function StructureSchemaMangerComponent_Template_gui_select_optionChanged_13_listener($event) { return ctx.toggleRowColoring($event); });
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(14, "gui-checkbox", 7);
        i0.ɵɵlistener("changed", function StructureSchemaMangerComponent_Template_gui_checkbox_changed_14_listener($event) { return ctx.toggleVerticalGrid($event); });
        i0.ɵɵtext(15);
        i0.ɵɵpipe(16, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(17, "gui-checkbox", 8);
        i0.ɵɵlistener("changed", function StructureSchemaMangerComponent_Template_gui_checkbox_changed_17_listener($event) { return ctx.toggleHorizontalGrid($event); });
        i0.ɵɵtext(18);
        i0.ɵɵpipe(19, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 12, "themeManagerModalTitle"));
        i0.ɵɵadvance(4);
        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(7, 14, "themeManagerModalTheme"));
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("options", ctx.themes)("placeholder", "Select theme")("selected", ctx.selectedTheme);
        i0.ɵɵadvance(3);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(12, 16, "themeManagerModalRowColoring"), " ");
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("options", ctx.coloring)("selected", ctx.selectedRowColoring);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("checked", ctx.verticalGrid);
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(16, 18, "themeManagerModalVerticalGrid"), " ");
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("checked", ctx.horizontalGrid);
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(19, 20, "themeManagerModalHorizontalGrid"), " ");
    } }, directives: [i1.FabricSelectComponent, i1.FabricCheckboxComponent], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSchemaMangerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-schema-manager]',
                templateUrl: './structure.schema-manger.component.html',
                encapsulation: ViewEncapsulation.None,
                changeDetection: ChangeDetectionStrategy.OnPush
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: SchemaReadModelRootId }, { type: SchemaCommandInvoker }, { type: SchemaWarehouse }]; }, null); })();

const _c0$F = ["gui-schema-manager-dialog", ""];
class StructureDialogSchemaManagerComponent extends PureComponent {
    constructor(elRef) {
        super(elRef);
        this.addClassToHost('gui-pr-10');
    }
    getSelectorName() {
        return 'gui-schema-manager-dialog';
    }
}
StructureDialogSchemaManagerComponent.ɵfac = function StructureDialogSchemaManagerComponent_Factory(t) { return new (t || StructureDialogSchemaManagerComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureDialogSchemaManagerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureDialogSchemaManagerComponent, selectors: [["div", "gui-schema-manager-dialog", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$F, decls: 1, vars: 0, consts: [["gui-structure-schema-manager", ""]], template: function StructureDialogSchemaManagerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
    } }, directives: [StructureSchemaMangerComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureDialogSchemaManagerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-schema-manager-dialog]',
                template: `
		<div gui-structure-schema-manager></div>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, null); })();

class StructureDialogSchemaManagerService extends Reactive {
    constructor(injector, fabricDialogService) {
        super();
        this.injector = injector;
        this.fabricDialogService = fabricDialogService;
    }
    open(readModelId, parentInjector) {
        if (!parentInjector) {
            parentInjector = this.injector;
        }
        const injector = Injector.create({
            providers: [{ provide: SchemaReadModelRootId, useValue: readModelId }],
            parent: parentInjector
        });
        this.fabricDialogService.open(StructureDialogSchemaManagerComponent, {
            injector: injector
        });
    }
}
StructureDialogSchemaManagerService.ɵfac = function StructureDialogSchemaManagerService_Factory(t) { return new (t || StructureDialogSchemaManagerService)(i0.ɵɵinject(i0.Injector), i0.ɵɵinject(i1.FabricDialogService)); };
StructureDialogSchemaManagerService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureDialogSchemaManagerService, factory: StructureDialogSchemaManagerService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureDialogSchemaManagerService, [{
        type: Injectable
    }], function () { return [{ type: i0.Injector }, { type: i1.FabricDialogService }]; }, null); })();

class StructureInfoPanelConfig {
    constructor(enabled, infoDialog, columnsManager, schemaManager, sourceSize) {
        this.enabled = false;
        this.infoDialog = true;
        this.columnsManager = true;
        this.schemaManager = true;
        this.sourceSize = true;
        if (this.isNotUndefinedOrNull(enabled)) {
            this.enabled = enabled;
        }
        if (this.isNotUndefinedOrNull(infoDialog)) {
            this.infoDialog = infoDialog;
        }
        if (this.isNotUndefinedOrNull(columnsManager)) {
            this.columnsManager = columnsManager;
        }
        if (this.isNotUndefinedOrNull(sourceSize)) {
            this.sourceSize = sourceSize;
        }
        if (this.isNotUndefinedOrNull(schemaManager)) {
            this.schemaManager = schemaManager;
        }
    }
    isEnabled() {
        return this.enabled;
    }
    isInfoDialogEnabled() {
        return this.infoDialog;
    }
    isColumnsManagerEnabled() {
        return this.columnsManager;
    }
    isSourceSizeEnabled() {
        return this.sourceSize;
    }
    isSchemaManagerEnabled() {
        return this.schemaManager;
    }
    isNotUndefinedOrNull(config) {
        return config !== undefined && config !== null;
    }
}

class StructureInfoPanelArchive extends Archive {
    constructor() {
        super(new StructureInfoPanelConfig());
    }
}
StructureInfoPanelArchive.ɵfac = function StructureInfoPanelArchive_Factory(t) { return new (t || StructureInfoPanelArchive)(); };
StructureInfoPanelArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureInfoPanelArchive, factory: StructureInfoPanelArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoPanelArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ActiveFilterMenuComponent {
}
ActiveFilterMenuComponent.ɵfac = function ActiveFilterMenuComponent_Factory(t) { return new (t || ActiveFilterMenuComponent)(); };
ActiveFilterMenuComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ActiveFilterMenuComponent, selectors: [["ng-component"]], decls: 8, vars: 3, consts: [["gui-active-filter-list", ""], ["gui-button", "", 3, "text"], ["gui-button", "", 3, "outline", "primary"]], template: function ActiveFilterMenuComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "h3");
        i0.ɵɵtext(1, "Active filters");
        i0.ɵɵelementEnd();
        i0.ɵɵelement(2, "div", 0);
        i0.ɵɵelementStart(3, "div");
        i0.ɵɵelementStart(4, "button", 1);
        i0.ɵɵtext(5, " Cancel ");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(6, "button", 2);
        i0.ɵɵtext(7, " Clear All ");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(4);
        i0.ɵɵproperty("text", true);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("outline", true)("primary", true);
    } }, directives: [ActiveFilterListComponent, i1.FabricButtonComponent], encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveFilterMenuComponent, [{
        type: Component,
        args: [{
                template: `

		<h3>Active filters</h3>

		<div gui-active-filter-list></div>

		<div>

			<button gui-button
					[text]="true">
				Cancel
			</button>

			<button gui-button
					[outline]="true"
					[primary]="true">
				Clear All
			</button>
		</div>
	`
            }]
    }], null, null); })();

class ActiveFilterService extends Reactive {
    constructor(injector, schemaReadModelRepository, structureThemeConverter, fabricDialogService) {
        super();
        this.injector = injector;
        this.schemaReadModelRepository = schemaReadModelRepository;
        this.structureThemeConverter = structureThemeConverter;
        this.fabricDialogService = fabricDialogService;
    }
    open(readModelId, structureId) {
        const injector = Injector.create({
            parent: this.injector,
            providers: [
                { provide: SchemaReadModelRootId, useValue: readModelId },
                { provide: StructureId, useValue: structureId }
            ]
        });
        this.schemaReadModelRepository
            .onceTheme(readModelId)
            .pipe(this.hermesTakeUntil())
            .subscribe((theme) => {
            this.fabricDialogService.open(ActiveFilterMenuComponent, {
                injector: injector,
                theme: this.structureThemeConverter.convertTheme(theme)
            });
        });
    }
}
ActiveFilterService.ɵfac = function ActiveFilterService_Factory(t) { return new (t || ActiveFilterService)(i0.ɵɵinject(i0.Injector), i0.ɵɵinject(SchemaWarehouse), i0.ɵɵinject(StructureThemeConverter), i0.ɵɵinject(i1.FabricDialogService)); };
ActiveFilterService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ActiveFilterService, factory: ActiveFilterService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveFilterService, [{
        type: Injectable
    }], function () { return [{ type: i0.Injector }, { type: SchemaWarehouse }, { type: StructureThemeConverter }, { type: i1.FabricDialogService }]; }, null); })();

class ActiveFilterMenuTriggerDirective {
    constructor(el, structureId, activeFilterService, schemaReadModelRootId) {
        this.el = el;
        this.structureId = structureId;
        this.activeFilterService = activeFilterService;
        this.schemaReadModelRootId = schemaReadModelRootId;
    }
    ngOnInit() {
        // this.renderer.listen(this.el.nativeElement, 'click', () => {
        // 	this.activeFilterService.open(this.schemaReadModelRootId, this.structureId);
        // });
    }
}
ActiveFilterMenuTriggerDirective.ɵfac = function ActiveFilterMenuTriggerDirective_Factory(t) { return new (t || ActiveFilterMenuTriggerDirective)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(ActiveFilterService), i0.ɵɵdirectiveInject(SchemaReadModelRootId)); };
ActiveFilterMenuTriggerDirective.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ActiveFilterMenuTriggerDirective, selectors: [["", "gui-active-filter-menu-trigger", ""]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ActiveFilterMenuTriggerDirective, [{
        type: Directive,
        args: [{
                selector: '[gui-active-filter-menu-trigger]'
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: StructureId }, { type: ActiveFilterService }, { type: SchemaReadModelRootId }]; }, null); })();

const _c0$E = ["gui-structure-schema-manager-icon", ""];
class StructureSchemaManagerIconComponent extends IconComponent {
    constructor(elRef, cdr) {
        super(elRef, cdr);
    }
    getSelectorName() {
        return 'gui-structure-schema-manager-icon';
    }
}
StructureSchemaManagerIconComponent.ɵfac = function StructureSchemaManagerIconComponent_Factory(t) { return new (t || StructureSchemaManagerIconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
StructureSchemaManagerIconComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureSchemaManagerIconComponent, selectors: [["div", "gui-structure-schema-manager-icon", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$E, decls: 11, vars: 0, consts: [["height", "24", "viewBox", "0 0 32 24", "width", "32", "xmlns", "http://www.w3.org/2000/svg"], ["transform", "translate(0 -4)"], ["d", "M23.337,4H32v6H23.337Z", "data-name", "Path 303", "id", "Path_303"], ["d", "M11.662,4h8.662v6H11.662Z", "data-name", "Path 304", "id", "Path_304"], ["d", "M0,4H8.662v6H0Z", "data-name", "Path 305", "id", "Path_305"], ["d", "M23.337,22H32v6H23.337Z", "data-name", "Path 306", "id", "Path_306"], ["d", "M0,22H8.662v6H0Z", "data-name", "Path 307", "id", "Path_307"], ["d", "M11.662,22h8.662v6H11.662Z", "data-name", "Path 308", "id", "Path_308"], ["d", "M23.337,13H32v6H23.337Z", "data-name", "Path 309", "id", "Path_309"], ["d", "M11.662,13h8.662v6H11.662Z", "data-name", "Path 310", "id", "Path_310"], ["d", "M0,13H8.662v6H0Z", "data-name", "Path 311", "id", "Path_311"]], template: function StructureSchemaManagerIconComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(0, "svg", 0);
        i0.ɵɵelementStart(1, "g", 1);
        i0.ɵɵelement(2, "path", 2);
        i0.ɵɵelement(3, "path", 3);
        i0.ɵɵelement(4, "path", 4);
        i0.ɵɵelement(5, "path", 5);
        i0.ɵɵelement(6, "path", 6);
        i0.ɵɵelement(7, "path", 7);
        i0.ɵɵelement(8, "path", 8);
        i0.ɵɵelement(9, "path", 9);
        i0.ɵɵelement(10, "path", 10);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSchemaManagerIconComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-schema-manager-icon]',
                templateUrl: './structure.schema-manager-icon.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

const _c0$D = ["gui-structure-column-manager-icon", ""];
class StructureColumnManagerIconComponent extends IconComponent {
    constructor(elementRef, changeDetectorRef) {
        super(elementRef, changeDetectorRef);
    }
    getSelectorName() {
        return 'gui-structure-column-manager-icon';
    }
}
StructureColumnManagerIconComponent.ɵfac = function StructureColumnManagerIconComponent_Factory(t) { return new (t || StructureColumnManagerIconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
StructureColumnManagerIconComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnManagerIconComponent, selectors: [["div", "gui-structure-column-manager-icon", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$D, decls: 7, vars: 0, consts: [["data-name", "Layer 1", "xmlns", "http://www.w3.org/2000/svg", "viewBox", "0 0 10.32 10.31"], ["x1", "9.57", "y1", "3.65", "x2", "0.75", "y2", "3.65", 1, "cls-1"], ["x1", "9.57", "y1", "0.75", "x2", "0.75", "y2", "0.75", 1, "cls-2"], ["x1", "0.75", "y1", "9.56", "x2", "0.75", "y2", "0.88", 1, "cls-2"], ["x1", "3.69", "y1", "9.65", "x2", "3.69", "y2", "3.89", 1, "cls-1"], ["x1", "6.63", "y1", "9.56", "x2", "6.63", "y2", "3.89", 1, "cls-1"], ["x1", "9.57", "y1", "9.56", "x2", "9.57", "y2", "0.88", 1, "cls-2"]], template: function StructureColumnManagerIconComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(0, "svg", 0);
        i0.ɵɵelement(1, "line", 1);
        i0.ɵɵelement(2, "line", 2);
        i0.ɵɵelement(3, "line", 3);
        i0.ɵɵelement(4, "line", 4);
        i0.ɵɵelement(5, "line", 5);
        i0.ɵɵelement(6, "line", 6);
        i0.ɵɵelementEnd();
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnManagerIconComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-manager-icon]',
                template: `
		<svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10.32 10.31">
			<line class="cls-1" x1="9.57" y1="3.65" x2="0.75" y2="3.65"/>
			<line class="cls-2" x1="9.57" y1="0.75" x2="0.75" y2="0.75"/>
			<line class="cls-2" x1="0.75" y1="9.56" x2="0.75" y2="0.88"/>
			<line class="cls-1" x1="3.69" y1="9.65" x2="3.69" y2="3.89"/>
			<line class="cls-1" x1="6.63" y1="9.56" x2="6.63" y2="3.89"/>
			<line class="cls-2" x1="9.57" y1="9.56" x2="9.57" y2="0.88"/>
		</svg>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

const _c0$C = ["gui-structure-info-icon", ""];
class StructureInfoIconComponent extends IconComponent {
    constructor(elRef, cdr) {
        super(elRef, cdr);
    }
    getSelectorName() {
        return 'gui-structure-info-icon';
    }
}
StructureInfoIconComponent.ɵfac = function StructureInfoIconComponent_Factory(t) { return new (t || StructureInfoIconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
StructureInfoIconComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureInfoIconComponent, selectors: [["div", "gui-structure-info-icon", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$C, decls: 3, vars: 0, consts: [["data-name", "Layer 1", "viewBox", "0 0 10.08 10.08", "xmlns", "http://www.w3.org/2000/svg"], ["d", "M401.64,307.76c0-.28.23-.45.54-.45s.55.17.55.45v0a.49.49,0,0,1-.55.46.48.48,0,0,1-.54-.46Zm.05,1.27a.49.49,0,0,1,1,0v2.54a.49.49,0,0,1-1,0Z", "transform", "translate(-397.14 -304.64)", 1, "cls-1"], ["cx", "5.04", "cy", "5.04", "r", "4.54", 1, "cls-2"]], template: function StructureInfoIconComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(0, "svg", 0);
        i0.ɵɵelement(1, "path", 1);
        i0.ɵɵelement(2, "circle", 2);
        i0.ɵɵelementEnd();
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoIconComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-info-icon]',
                templateUrl: './structure.info-icon.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

const _c0$B = ["gui-structure-info-panel", ""];
function StructureInfoPanelComponent_div_1_ng_container_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtext(1);
    i0.ɵɵpipe(2, "guiTranslate");
    i0.ɵɵelementStart(3, "b");
    i0.ɵɵtext(4);
    i0.ɵɵpipe(5, "numberFormatter");
    i0.ɵɵelementEnd();
    i0.ɵɵtext(6);
    i0.ɵɵpipe(7, "guiTranslate");
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r5 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(2, 3, "infoPanelShowing"), " ");
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 5, ctx_r5.totalItemsSize));
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(7, 7, "infoPanelItems"), " ");
} }
function StructureInfoPanelComponent_div_1_ng_container_1_span_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 4);
    i0.ɵɵtext(1);
    i0.ɵɵpipe(2, "guiTranslate");
    i0.ɵɵelementStart(3, "b");
    i0.ɵɵtext(4);
    i0.ɵɵpipe(5, "numberFormatter");
    i0.ɵɵelementEnd();
    i0.ɵɵtext(6);
    i0.ɵɵpipe(7, "guiTranslate");
    i0.ɵɵelementStart(8, "b");
    i0.ɵɵtext(9);
    i0.ɵɵpipe(10, "numberFormatter");
    i0.ɵɵelementEnd();
    i0.ɵɵtext(11);
    i0.ɵɵpipe(12, "guiTranslate");
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r6 = i0.ɵɵnextContext(3);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(2, 5, "infoPanelShowing"), " ");
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 7, ctx_r6.preparedItemsSize));
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(7, 9, "infoPanelOutOf"), " ");
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(10, 11, ctx_r6.totalItemsSize));
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(12, 13, "infoPanelItems"), " ");
} }
function StructureInfoPanelComponent_div_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, StructureInfoPanelComponent_div_1_ng_container_1_ng_container_1_Template, 8, 9, "ng-container", 0);
    i0.ɵɵtemplate(2, StructureInfoPanelComponent_div_1_ng_container_1_span_2_Template, 13, 15, "span", 3);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.preparedItemsSize === ctx_r4.totalItemsSize);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.preparedItemsSize !== ctx_r4.totalItemsSize);
} }
function StructureInfoPanelComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div");
    i0.ɵɵtemplate(1, StructureInfoPanelComponent_div_1_ng_container_1_Template, 3, 2, "ng-container", 0);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r0.preparedItemsSize !== undefined && ctx_r0.totalItemsSize !== undefined);
} }
function StructureInfoPanelComponent_div_4_Template(rf, ctx) { if (rf & 1) {
    const _r8 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 5);
    i0.ɵɵlistener("click", function StructureInfoPanelComponent_div_4_Template_div_click_0_listener() { i0.ɵɵrestoreView(_r8); const ctx_r7 = i0.ɵɵnextContext(); return ctx_r7.openSchemaManager(); });
    i0.ɵɵelement(1, "div", 6);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r1.themeManagerTooltipText);
} }
function StructureInfoPanelComponent_div_5_Template(rf, ctx) { if (rf & 1) {
    const _r10 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 5);
    i0.ɵɵlistener("click", function StructureInfoPanelComponent_div_5_Template_div_click_0_listener() { i0.ɵɵrestoreView(_r10); const ctx_r9 = i0.ɵɵnextContext(); return ctx_r9.openColumnManager(); });
    i0.ɵɵelement(1, "div", 7);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r2.columnManagerTooltipText);
} }
function StructureInfoPanelComponent_div_6_Template(rf, ctx) { if (rf & 1) {
    const _r12 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 5);
    i0.ɵɵlistener("click", function StructureInfoPanelComponent_div_6_Template_div_click_0_listener() { i0.ɵɵrestoreView(_r12); const ctx_r11 = i0.ɵɵnextContext(); return ctx_r11.openInfo(); });
    i0.ɵɵelement(1, "div", 8);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r3.infoTooltipText);
} }
class StructureInfoPanelComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, injector, sourceWarehouse, dialog, compositionId, structureId, schemaReadModelRootId, menuColumnManagerService, translationService, schemaManagerService, structureInfoPanelArchive) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.injector = injector;
        this.sourceWarehouse = sourceWarehouse;
        this.dialog = dialog;
        this.compositionId = compositionId;
        this.structureId = structureId;
        this.schemaReadModelRootId = schemaReadModelRootId;
        this.menuColumnManagerService = menuColumnManagerService;
        this.translationService = translationService;
        this.schemaManagerService = schemaManagerService;
        this.structureInfoPanelArchive = structureInfoPanelArchive;
        this.infoModal = StructureInfoModalComponent;
    }
    ngOnInit() {
        this.hermesSubscribe(this.structureInfoPanelArchive.on(), (infoPanel) => {
            this.infoPanelConfig = infoPanel;
        });
        this.hermesSubscribe(this.sourceWarehouse.onOriginSize(this.structureId), (size) => {
            this.totalItemsSize = size;
        });
        this.hermesSubscribe(this.sourceWarehouse.onPreparedEntities(this.structureId), (preparedItems) => {
            this.preparedItemsSize = preparedItems.length;
        });
        this.hermesSubscribe(this.translationService.onTranslation(), (translation) => {
            this.themeManagerTooltipText = translation.infoPanelThemeMangerTooltipText;
            this.columnManagerTooltipText = translation.infoPanelColumnManagerTooltipText;
            this.infoTooltipText = translation.infoPanelInfoTooltipText;
        });
    }
    openInfo() {
        this.dialog.open(this.infoModal);
    }
    openColumnManager() {
        this.menuColumnManagerService.open(this.compositionId, this.schemaReadModelRootId, this.injector);
    }
    openSchemaManager() {
        this.schemaManagerService.open(this.schemaReadModelRootId, this.injector);
    }
    getSelectorName() {
        return 'gui-structure-info-panel';
    }
}
StructureInfoPanelComponent.ɵfac = function StructureInfoPanelComponent_Factory(t) { return new (t || StructureInfoPanelComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(SourceWarehouse), i0.ɵɵdirectiveInject(i1.FabricDialogService), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SchemaReadModelRootId), i0.ɵɵdirectiveInject(StructureDialogColumnManagerService), i0.ɵɵdirectiveInject(TranslationFacade), i0.ɵɵdirectiveInject(StructureDialogSchemaManagerService), i0.ɵɵdirectiveInject(StructureInfoPanelArchive)); };
StructureInfoPanelComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureInfoPanelComponent, selectors: [["div", "gui-structure-info-panel", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$B, decls: 7, vars: 4, consts: [[4, "ngIf"], [1, "gui-right-section"], [3, "click", 4, "ngIf"], ["gui-active-filter-menu-trigger", "", 4, "ngIf"], ["gui-active-filter-menu-trigger", ""], [3, "click"], ["gui-structure-schema-manager-icon", "", 3, "gui-tooltip"], ["gui-structure-column-manager-icon", "", 3, "gui-tooltip"], ["gui-structure-info-icon", "", 3, "gui-tooltip"]], template: function StructureInfoPanelComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div");
        i0.ɵɵtemplate(1, StructureInfoPanelComponent_div_1_Template, 2, 1, "div", 0);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(2, "div");
        i0.ɵɵelementStart(3, "div", 1);
        i0.ɵɵtemplate(4, StructureInfoPanelComponent_div_4_Template, 2, 1, "div", 2);
        i0.ɵɵtemplate(5, StructureInfoPanelComponent_div_5_Template, 2, 1, "div", 2);
        i0.ɵɵtemplate(6, StructureInfoPanelComponent_div_6_Template, 2, 1, "div", 2);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.infoPanelConfig.isSourceSizeEnabled());
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("ngIf", ctx.infoPanelConfig.isSchemaManagerEnabled());
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.infoPanelConfig.isColumnsManagerEnabled());
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.infoPanelConfig.isInfoDialogEnabled());
    } }, directives: [i4.NgIf, ActiveFilterMenuTriggerDirective, StructureSchemaManagerIconComponent, i1.FabricTooltipDirective, StructureColumnManagerIconComponent, StructureInfoIconComponent], pipes: [TranslationPipe, NumberFormatterPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoPanelComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-info-panel]',
                templateUrl: './structure.info-panel.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.Injector }, { type: SourceWarehouse }, { type: i1.FabricDialogService }, { type: CompositionId }, { type: StructureId }, { type: SchemaReadModelRootId }, { type: StructureDialogColumnManagerService }, { type: TranslationFacade }, { type: StructureDialogSchemaManagerService }, { type: StructureInfoPanelArchive }]; }, null); })();

const _c0$A = ["gui-structure-menu-column-manager", ""];
class StructureMenuColumnManagerComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
    }
    getSelectorName() {
        return 'gui-structure-menu-column-manager';
    }
}
StructureMenuColumnManagerComponent.ɵfac = function StructureMenuColumnManagerComponent_Factory(t) { return new (t || StructureMenuColumnManagerComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureMenuColumnManagerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureMenuColumnManagerComponent, selectors: [["div", "gui-structure-menu-column-manager", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$A, decls: 1, vars: 0, consts: [["gui-structure-column-manager", ""]], template: function StructureMenuColumnManagerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
    } }, directives: [StructureColumnManagerComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureMenuColumnManagerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-menu-column-manager]',
                templateUrl: './structure.menu-column-manager.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, null); })();

const declarations$3 = [
    StructureColumnManagerComponent,
    StructureDialogColumnManagerComponent,
    StructureMenuColumnManagerComponent,
    StructureColumnManagerIconComponent
];
class StructureColumnManagerModule {
}
StructureColumnManagerModule.ɵfac = function StructureColumnManagerModule_Factory(t) { return new (t || StructureColumnManagerModule)(); };
StructureColumnManagerModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: StructureColumnManagerModule });
StructureColumnManagerModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        StructureDialogColumnManagerService
    ], imports: [[
            CommonModule,
            fabricImports,
            TranslationFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnManagerModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    fabricImports,
                    TranslationFeatureModule
                ],
                declarations: declarations$3,
                exports: declarations$3,
                entryComponents: [
                    StructureColumnManagerComponent,
                    StructureDialogColumnManagerComponent,
                    StructureMenuColumnManagerComponent
                ],
                providers: [
                    StructureDialogColumnManagerService
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(StructureColumnManagerModule, { declarations: [StructureColumnManagerComponent,
        StructureDialogColumnManagerComponent,
        StructureMenuColumnManagerComponent,
        StructureColumnManagerIconComponent], imports: [CommonModule, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, TranslationFeatureModule], exports: [StructureColumnManagerComponent,
        StructureDialogColumnManagerComponent,
        StructureMenuColumnManagerComponent,
        StructureColumnManagerIconComponent] }); })();

class StructureInfoPanelConfigConverter {
    convert(config) {
        let infoDialog, columnsManager, sourceSize, schemaManager;
        if (config.infoDialog !== undefined) {
            infoDialog = config.infoDialog;
        }
        if (config.columnsManager !== undefined) {
            columnsManager = config.columnsManager;
        }
        if (config.schemaManager !== undefined) {
            schemaManager = config.schemaManager;
        }
        if (config.sourceSize !== undefined) {
            sourceSize = config.sourceSize;
        }
        return new StructureInfoPanelConfig(config.enabled, infoDialog, columnsManager, schemaManager, sourceSize);
    }
}
StructureInfoPanelConfigConverter.ɵfac = function StructureInfoPanelConfigConverter_Factory(t) { return new (t || StructureInfoPanelConfigConverter)(); };
StructureInfoPanelConfigConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureInfoPanelConfigConverter, factory: StructureInfoPanelConfigConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoPanelConfigConverter, [{
        type: Injectable
    }], null, null); })();

class SchemaManagerModule {
}
SchemaManagerModule.ɵfac = function SchemaManagerModule_Factory(t) { return new (t || SchemaManagerModule)(); };
SchemaManagerModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SchemaManagerModule });
SchemaManagerModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        StructureDialogSchemaManagerService
    ], imports: [[
            CommonModule,
            fabricImports,
            TranslationFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaManagerModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    fabricImports,
                    TranslationFeatureModule
                ],
                declarations: [
                    StructureSchemaMangerComponent,
                    StructureDialogSchemaManagerComponent,
                    StructureSchemaManagerIconComponent
                ],
                exports: [
                    StructureSchemaManagerIconComponent
                ],
                entryComponents: [
                    StructureDialogSchemaManagerComponent,
                    StructureSchemaMangerComponent
                ],
                providers: [
                    StructureDialogSchemaManagerService
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SchemaManagerModule, { declarations: [StructureSchemaMangerComponent,
        StructureDialogSchemaManagerComponent,
        StructureSchemaManagerIconComponent], imports: [CommonModule, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, TranslationFeatureModule], exports: [StructureSchemaManagerIconComponent] }); })();

class SourceCounterFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
SourceCounterFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵSourceCounterFeatureModule_BaseFactory; return function SourceCounterFeatureModule_Factory(t) { return (ɵSourceCounterFeatureModule_BaseFactory || (ɵSourceCounterFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(SourceCounterFeatureModule)))(t || SourceCounterFeatureModule); }; }();
SourceCounterFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SourceCounterFeatureModule });
SourceCounterFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        ActiveFilterService
    ], imports: [[
            CommonModule,
            FilterMenuFeatureModule,
            ActiveFilterListModule,
            FabricButtonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceCounterFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FilterMenuFeatureModule,
                    ActiveFilterListModule,
                    FabricButtonModule
                ],
                declarations: [
                    ActiveFilterMenuTriggerDirective,
                    ActiveFilterMenuComponent
                ],
                exports: [
                    ActiveFilterMenuTriggerDirective
                ],
                providers: [
                    ActiveFilterService
                ],
                entryComponents: [
                    ActiveFilterMenuComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SourceCounterFeatureModule, { declarations: [ActiveFilterMenuTriggerDirective,
        ActiveFilterMenuComponent], imports: [CommonModule,
        FilterMenuFeatureModule,
        ActiveFilterListModule,
        FabricButtonModule], exports: [ActiveFilterMenuTriggerDirective] }); })();

class StructureInfoPanelModule {
}
StructureInfoPanelModule.ɵfac = function StructureInfoPanelModule_Factory(t) { return new (t || StructureInfoPanelModule)(); };
StructureInfoPanelModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: StructureInfoPanelModule });
StructureInfoPanelModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        StructureInfoPanelConfigConverter
    ], imports: [[
            CommonModule,
            NumberFormatterModule,
            FabricModule,
            StructureColumnManagerModule,
            SchemaManagerModule,
            SourceCounterFeatureModule,
            TranslationFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoPanelModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    NumberFormatterModule,
                    FabricModule,
                    StructureColumnManagerModule,
                    SchemaManagerModule,
                    SourceCounterFeatureModule,
                    TranslationFeatureModule
                ],
                declarations: [
                    StructureInfoPanelComponent,
                    StructureInfoModalComponent,
                    StructureInfoIconComponent
                ],
                exports: [
                    StructureInfoModalComponent,
                    StructureInfoPanelComponent
                ],
                entryComponents: [
                    StructureInfoModalComponent
                ],
                providers: [
                    StructureInfoPanelConfigConverter
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(StructureInfoPanelModule, { declarations: [StructureInfoPanelComponent,
        StructureInfoModalComponent,
        StructureInfoIconComponent], imports: [CommonModule,
        NumberFormatterModule,
        FabricModule,
        StructureColumnManagerModule,
        SchemaManagerModule,
        SourceCounterFeatureModule,
        TranslationFeatureModule], exports: [StructureInfoModalComponent,
        StructureInfoPanelComponent] }); })();

class SchemaCssClassManager extends Reactive {
    constructor(schemaReadModelRepository) {
        super();
        this.schemaReadModelRepository = schemaReadModelRepository;
        this.cssClass = null;
        this.classModifier = new ClassModifier();
    }
    init(elementRef, schemaReadModelRootId) {
        this.cssHostRef = elementRef;
        this.schemaReadModelRepository
            .onCssClasses(schemaReadModelRootId)
            .pipe(this.hermesTakeUntil())
            .subscribe((classes) => {
            const diff = this.updateState(classes);
            this.renderCssClasses(diff);
        });
    }
    updateState(css) {
        if (!this.cssClass) {
            this.cssClass = css;
            return this.cssClass;
        }
        else {
            const diff = {};
            Object.keys(this.cssClass)
                .forEach((key) => {
                if (css[key] !== this.cssClass[key]) {
                    diff[key] = css[key];
                }
            });
            this.cssClass = css;
            return diff;
        }
    }
    renderCssClasses(diff) {
        if (diff.hasOwnProperty('verticalGrid')) {
            this.toggleCssClass(diff.verticalGrid, SchemaCssClassManager.VERTICAL_GRID_CLASS_NAME);
        }
        if (diff.hasOwnProperty('horizontalGrid')) {
            this.toggleCssClass(diff.horizontalGrid, SchemaCssClassManager.HORIZONTAL_GRID_CLASS_NAME);
        }
        if (diff.hasOwnProperty('theme')) {
            this.removeThemeCssClasses();
            this.addClass(this.resolveThemeClassName(diff.theme));
        }
        if (diff.hasOwnProperty('rowColoring')) {
            this.removeRowColoringClasses();
            this.addClass(this.resolveRowColoringClassName(diff.rowColoring));
        }
    }
    toggleCssClass(toggle, cssClassName) {
        if (toggle) {
            this.addClass(cssClassName);
        }
        else {
            this.removeClass(cssClassName);
        }
    }
    removeThemeCssClasses() {
        Object.keys(SchemaTheme)
            .map((key) => SchemaTheme[key])
            .map((theme) => this.resolveThemeClassName(theme))
            .filter((className) => !!className)
            .forEach((className) => {
            this.removeClass(className);
        });
    }
    resolveThemeClassName(theme) {
        switch (theme) {
            case SchemaTheme.FABRIC:
            case SchemaTheme[SchemaTheme.FABRIC]:
                return SchemaCssClassManager.THEME_FABRIC_CLASS_NAME;
            case SchemaTheme.MATERIAL:
            case SchemaTheme[SchemaTheme.MATERIAL]:
                return SchemaCssClassManager.THEME_MATERIAL_CLASS_NAME;
            case SchemaTheme.LIGHT:
            case SchemaTheme[SchemaTheme.LIGHT]:
                return SchemaCssClassManager.THEME_LIGHT_CLASS_NAME;
            case SchemaTheme.DARK:
            case SchemaTheme[SchemaTheme.DARK]:
                return SchemaCssClassManager.THEME_DARK_CLASS_NAME;
            case SchemaTheme.GENERIC:
            case SchemaTheme[SchemaTheme.GENERIC]:
                return SchemaCssClassManager.THEME_GENERIC_CLASS_NAME;
            default:
                return SchemaCssClassManager.THEME_FABRIC_CLASS_NAME;
        }
    }
    resolveRowColoringClassName(coloring) {
        switch (coloring) {
            case SchemaRowColoring.ODD:
            case SchemaRowColoring[SchemaRowColoring.ODD]:
                return SchemaCssClassManager.ROW_COLORING_ODD;
            case SchemaRowColoring.EVEN:
            case SchemaRowColoring[SchemaRowColoring.EVEN]:
                return SchemaCssClassManager.ROW_COLORING_EVEN;
            default:
                return null;
        }
    }
    removeRowColoringClasses() {
        Object.keys(SchemaRowColoring)
            .map((key) => SchemaRowColoring[key])
            .map((coloring) => this.resolveRowColoringClassName(coloring))
            .filter((className) => !!className)
            .forEach((className) => {
            this.removeClass(className);
        });
    }
    addClass(cssClassName) {
        if (cssClassName) {
            this.classModifier.getElement(this.cssHostRef.nativeElement).add(cssClassName);
        }
    }
    removeClass(cssClassName) {
        if (cssClassName) {
            this.classModifier.getElement(this.cssHostRef.nativeElement).remove(cssClassName);
        }
    }
}
SchemaCssClassManager.VERTICAL_GRID_CLASS_NAME = 'gui-vertical-grid';
SchemaCssClassManager.HORIZONTAL_GRID_CLASS_NAME = 'gui-horizontal-grid';
SchemaCssClassManager.THEME_FABRIC_CLASS_NAME = 'gui-fabric';
SchemaCssClassManager.THEME_MATERIAL_CLASS_NAME = 'gui-material';
SchemaCssClassManager.THEME_LIGHT_CLASS_NAME = 'gui-light';
SchemaCssClassManager.THEME_DARK_CLASS_NAME = 'gui-dark';
SchemaCssClassManager.THEME_GENERIC_CLASS_NAME = 'gui-generic';
SchemaCssClassManager.ROW_COLORING_ODD = 'gui-rows-odd';
SchemaCssClassManager.ROW_COLORING_EVEN = 'gui-rows-even';
SchemaCssClassManager.ɵfac = function SchemaCssClassManager_Factory(t) { return new (t || SchemaCssClassManager)(i0.ɵɵinject(SchemaWarehouse)); };
SchemaCssClassManager.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaCssClassManager, factory: SchemaCssClassManager.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaCssClassManager, [{
        type: Injectable
    }], function () { return [{ type: SchemaWarehouse }]; }, null); })();

class StructureCellEditStore extends Archive {
    constructor() {
        super();
    }
}
StructureCellEditStore.ɵfac = function StructureCellEditStore_Factory(t) { return new (t || StructureCellEditStore)(); };
StructureCellEditStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureCellEditStore, factory: StructureCellEditStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCellEditStore, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructureEditModeArchive extends Archive {
    constructor() {
        super();
    }
}
StructureEditModeArchive.ɵfac = function StructureEditModeArchive_Factory(t) { return new (t || StructureEditModeArchive)(); };
StructureEditModeArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureEditModeArchive, factory: StructureEditModeArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureEditModeArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

const structureComponentToken = new InjectionToken('StructureComponentToken');

var StructureCellEditState;
(function (StructureCellEditState) {
    StructureCellEditState[StructureCellEditState["ENTER"] = 0] = "ENTER";
    StructureCellEditState[StructureCellEditState["SUBMIT"] = 1] = "SUBMIT";
    StructureCellEditState[StructureCellEditState["CANCEL"] = 2] = "CANCEL";
})(StructureCellEditState || (StructureCellEditState = {}));

class ColumnFieldId {
    constructor(id) {
        this.id = id;
    }
    getId() {
        return this.id;
    }
}

class ColumnParams {
    constructor(column, field) {
        this.column = column;
        this.field = field;
    }
    getColumn() {
        return this.column;
    }
    getField() {
        return this.field;
    }
}

class StructureColumnInputHandler {
    constructor(structureId, compositionId, commandDispatcher, domainEventBus, columnFieldFactory, columnAutoConfigurator, compositionCommandInvoker) {
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.commandDispatcher = commandDispatcher;
        this.domainEventBus = domainEventBus;
        this.columnFieldFactory = columnFieldFactory;
        this.columnAutoConfigurator = columnAutoConfigurator;
        this.compositionCommandInvoker = compositionCommandInvoker;
    }
    handle(changes) {
        let config = [];
        if (changes.columns !== undefined && changes.columns.currentValue !== undefined) {
            config = changes.columns.currentValue;
            this.columns = config;
        }
        else {
            if (this.columns === undefined && changes.source !== undefined && changes.source !== null) {
                config = this.columnAutoConfigurator.configure(changes.source.currentValue);
                this.columns = config;
            }
            else {
                return;
            }
        }
        this.compositionCommandInvoker.setGroups(config, this.compositionId);
        // prepare model
        const { columns, groups } = this.getConfigs(config);
        const fieldConfigs = this.getFieldConfigs(columns);
        // const fieldConfigs = columns as Array<FieldConfig>;
        const initCommand = new InitFieldsCommand(this.structureId, fieldConfigs);
        this.domainEventBus
            .ofEvents([
            FieldsInitedEvent
        ])
            .pipe(hermesFilter((event) => event.getAggregateId().toString() === this.structureId.toString()), hermesTake(1))
            .subscribe((event) => {
            const fields = event.getFields(), columnFieldIds = this.convertColumnFieldIds(fields), params = this.convertColumns(columns, fields, columnFieldIds);
            this.compositionCommandInvoker.setColumns(params, this.compositionId);
            // this.compositionCommandInvoker.setGroups(this.compositionId);
        });
        this.commandDispatcher.dispatch(initCommand);
    }
    getConfigs(configs) {
        let columnConfigs = [];
        const groupConfigs = [];
        for (let i = 0; i < configs.length; i += 1) {
            const config = configs[i];
            if (config.columns !== undefined) {
                groupConfigs.push(config);
                columnConfigs = columnConfigs.concat(config.columns);
            }
            else {
                columnConfigs.push(config);
            }
        }
        return {
            columns: columnConfigs,
            groups: groupConfigs
        };
    }
    getFieldConfigs(columns) {
        return columns.map((c) => {
            return {
                field: c.field,
                type: c.type,
                matcher: c.matcher,
                summaries: c.summaries,
                sorting: c.sorting
            };
        });
    }
    convertColumnFieldIds(fields) {
        if (!fields) {
            return [];
        }
        return fields.map((field) => new ColumnFieldId(field.getId().getId()));
    }
    convertColumns(columns, fields, columnFieldIds) {
        if (!columns) {
            return [];
        }
        return columns.map((column, index) => {
            const columnFieldId = columnFieldIds[index], field = fields[index];
            const columnField = this.columnFieldFactory.create(columnFieldId, field.getAccessorMethod(), field.getDataType(), field.getSearchAccessorMethod());
            return new ColumnParams(column, columnField);
        });
    }
}

class ColumnAutoConfigurator {
}
ColumnAutoConfigurator.ɵfac = function ColumnAutoConfigurator_Factory(t) { return new (t || ColumnAutoConfigurator)(); };
ColumnAutoConfigurator.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ColumnAutoConfigurator, factory: ColumnAutoConfigurator.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnAutoConfigurator, [{
        type: Injectable
    }], null, null); })();

class SetSortingCommand extends StructureCommand {
    constructor(structureId, sortingConfig) {
        super(structureId, 'SetSortingCommand');
        this.sortingConfig = sortingConfig;
    }
    getSortingConfig() {
        return this.sortingConfig;
    }
}

class ToggleSortCommand extends StructureCommand {
    constructor(structureId, compositionId, fieldId) {
        super(structureId, 'ToggleSortCommand');
        this.compositionId = compositionId;
        this.fieldId = fieldId;
    }
    getCompositionId() {
        return this.compositionId;
    }
    getFieldId() {
        return this.fieldId;
    }
}

class SetSortOrderCommand extends StructureCommand {
    constructor(structureId, compositionId, fieldId, sortOrder) {
        super(structureId, 'SetSortOrderCommand');
        this.compositionId = compositionId;
        this.fieldId = fieldId;
        this.sortOrder = sortOrder;
    }
    getCompositionId() {
        return this.compositionId;
    }
    getFieldId() {
        return this.fieldId;
    }
    getSortOrder() {
        return this.sortOrder;
    }
}

class SortingCommandInvoker {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    setSortingConfig(config, structureId) {
        this.commandDispatcher.dispatch(new SetSortingCommand(structureId, config));
    }
    toggleSort(fieldId, compositionId, structureId) {
        this.commandDispatcher.dispatch(new ToggleSortCommand(structureId, compositionId, fieldId));
    }
    setSortOrder(fieldId, sortOrder, compositionId, structureId) {
        this.commandDispatcher.dispatch(new SetSortOrderCommand(structureId, compositionId, fieldId, sortOrder));
    }
}
SortingCommandInvoker.ɵfac = function SortingCommandInvoker_Factory(t) { return new (t || SortingCommandInvoker)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
SortingCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SortingCommandInvoker, factory: SortingCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SortingCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class CompositionEventRepository extends EventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
}
CompositionEventRepository.ɵfac = function CompositionEventRepository_Factory(t) { return new (t || CompositionEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
CompositionEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionEventRepository, factory: CompositionEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class SelectedRow {
    constructor(source, index, itemId) {
        this.source = source;
        this.index = index;
        this.itemId = itemId;
    }
    getSource() {
        return this.source;
    }
    getIndex() {
        return this.index;
    }
    getItemId() {
        return this.itemId;
    }
}

class SelectedRowChangedEvent extends StructureDomainEvent {
    constructor(structureId, selectedRows, allSelected, allUnselected) {
        super(structureId, { selectedRows, allSelected, allUnselected }, 'SelectedRowChangedEvent');
        this.selectedRows = selectedRows;
        this.allSelected = allSelected;
        this.allUnselected = allUnselected;
    }
    getSelectedRows() {
        return this.selectedRows;
    }
    isAllSelected() {
        return this.allSelected;
    }
    isAllUnselected() {
        return this.allUnselected;
    }
}

class FormationEventRepository extends EventRepository {
    constructor(domainEventBus, sourceWarehouse) {
        super(domainEventBus);
        this.sourceWarehouse = sourceWarehouse;
        this.map = new Map();
        this.subject$ = new HermesSubject();
        domainEventBus
            .ofEvents([
            SelectedRowChangedEvent
        ])
            .pipe(hermesSwitchMap((event) => {
            const selectedRows = event.getSelectedRows();
            const structureId = event.getAggregateId();
            return this.sourceWarehouse
                .onPreparedEntities(structureId)
                .pipe(hermesTake(1), hermesMap((items) => {
                const selectedItems = [], length = items.length, itemsMap = new Map();
                for (let i = 0; i < length; i += 1) {
                    itemsMap.set(items[i].getId().toString(), items[i]);
                }
                for (let j = 0; j < selectedRows.length; j += 1) {
                    const item = itemsMap.get(selectedRows[j]);
                    selectedItems.push(new SelectedRow(item.getSourceItem(), j, item.getId()));
                }
                return {
                    id: structureId,
                    items: selectedItems
                };
            }));
        }))
            .subscribe((e) => {
            this.map.set(e.id.toString(), e.items);
            this.subject$.next(this.map);
        });
    }
    onItemSelected(structureId) {
        return this.subject$
            .toObservable()
            .pipe(hermesFilter((map) => {
            return map.has(structureId.toString());
        }), hermesMap((map) => {
            return map.get(structureId.toString());
        }));
    }
}
FormationEventRepository.ɵfac = function FormationEventRepository_Factory(t) { return new (t || FormationEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus), i0.ɵɵinject(SourceWarehouse)); };
FormationEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FormationEventRepository, factory: FormationEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FormationEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }, { type: SourceWarehouse }]; }, null); })();

class StructureInfoPanelConfigService {
    constructor(structureInfoPanelConfigConverter, structureInfoPanelArchive) {
        this.structureInfoPanelConfigConverter = structureInfoPanelConfigConverter;
        this.structureInfoPanelArchive = structureInfoPanelArchive;
    }
    set(config) {
        const infoPanelConfig = this.structureInfoPanelConfigConverter.convert(config);
        this.structureInfoPanelArchive.next(infoPanelConfig);
    }
}
StructureInfoPanelConfigService.ɵfac = function StructureInfoPanelConfigService_Factory(t) { return new (t || StructureInfoPanelConfigService)(i0.ɵɵinject(StructureInfoPanelConfigConverter), i0.ɵɵinject(StructureInfoPanelArchive)); };
StructureInfoPanelConfigService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureInfoPanelConfigService, factory: StructureInfoPanelConfigService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoPanelConfigService, [{
        type: Injectable
    }], function () { return [{ type: StructureInfoPanelConfigConverter }, { type: StructureInfoPanelArchive }]; }, null); })();

class ColumnField {
    constructor(fieldId, accessor, dataType, searchAccessor) {
        this.fieldId = fieldId;
        this.accessor = accessor;
        this.dataType = dataType;
        this.searchAccessor = searchAccessor;
    }
    getId() {
        return this.fieldId;
    }
    getValue(entity) {
        return this.accessor(entity);
    }
    getAccessor() {
        return this.accessor;
    }
    getSearchAccessor() {
        return this.searchAccessor;
    }
    getDataType() {
        return this.dataType;
    }
}

class ColumnFieldFactory {
    create(columnFieldId, accessor, dataType, searchAccessor) {
        return new ColumnField(columnFieldId, accessor, dataType, searchAccessor);
    }
}
ColumnFieldFactory.ɵfac = function ColumnFieldFactory_Factory(t) { return new (t || ColumnFieldFactory)(); };
ColumnFieldFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ColumnFieldFactory, factory: ColumnFieldFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnFieldFactory, [{
        type: Injectable
    }], null, null); })();

class RowSelectEnabledRepository extends AggregateArchive {
    constructor() {
        super();
    }
}
RowSelectEnabledRepository.ɵfac = function RowSelectEnabledRepository_Factory(t) { return new (t || RowSelectEnabledRepository)(); };
RowSelectEnabledRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: RowSelectEnabledRepository, factory: RowSelectEnabledRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(RowSelectEnabledRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class GenericBuilder {
    build() {
        return this.buildObject();
    }
}

var RowSelectionType;
(function (RowSelectionType) {
    RowSelectionType[RowSelectionType["ROW"] = 0] = "ROW";
    RowSelectionType[RowSelectionType["CHECKBOX"] = 1] = "CHECKBOX";
})(RowSelectionType || (RowSelectionType = {}));
var RowSelectionMode;
(function (RowSelectionMode) {
    RowSelectionMode[RowSelectionMode["SINGLE"] = 0] = "SINGLE";
    RowSelectionMode[RowSelectionMode["MULTIPLE"] = 1] = "MULTIPLE";
})(RowSelectionMode || (RowSelectionMode = {}));
class RowSelection {
    constructor(config) {
        if (config.enabled !== undefined) {
            this.enabled = config.enabled;
        }
        if (config.mode !== undefined) {
            this.mode = config.mode;
        }
        if (config.type !== undefined) {
            this.type = config.type;
        }
    }
    isModeDefined() {
        return this.mode !== undefined;
    }
    isTypeDefined() {
        return this.type !== undefined;
    }
    isEnabledDefined() {
        return this.enabled !== undefined;
    }
    isEnabled() {
        return this.enabled;
    }
    getMode() {
        return this.mode;
    }
    getType() {
        return this.type;
    }
}
RowSelection.Builder = class RowSelectionBuilder extends GenericBuilder {
    constructor() {
        super();
    }
    buildObject() {
        return new RowSelection({
            enabled: this.enabled,
            type: this.type,
            mode: this.mode
        });
    }
    withEnabled(enabled) {
        this.enabled = enabled;
        return this;
    }
    withType(type) {
        this.type = type;
        return this;
    }
    withMode(mode) {
        this.mode = mode;
        return this;
    }
};

class RowSelectionTypeArchive extends Archive {
    constructor() {
        super(RowSelectionTypeArchive.DEFAULT_ROW_SELECTION_TYPE);
    }
}
RowSelectionTypeArchive.DEFAULT_ROW_SELECTION_TYPE = RowSelectionType.ROW;
RowSelectionTypeArchive.ɵfac = function RowSelectionTypeArchive_Factory(t) { return new (t || RowSelectionTypeArchive)(); };
RowSelectionTypeArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: RowSelectionTypeArchive, factory: RowSelectionTypeArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(RowSelectionTypeArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaRowClassArchive extends Archive {
    constructor() {
        super();
    }
}
SchemaRowClassArchive.ɵfac = function SchemaRowClassArchive_Factory(t) { return new (t || SchemaRowClassArchive)(); };
SchemaRowClassArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaRowClassArchive, factory: SchemaRowClassArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaRowClassArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaRowStyleArchive extends Archive {
    constructor() {
        super();
    }
}
SchemaRowStyleArchive.ɵfac = function SchemaRowStyleArchive_Factory(t) { return new (t || SchemaRowStyleArchive)(); };
SchemaRowStyleArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaRowStyleArchive, factory: SchemaRowStyleArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaRowStyleArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SetEnabledSelectionCommand extends StructureCommand {
    constructor(structureId, enabled) {
        super(structureId, 'SetEnabledSelectionCommand');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class SetSelectionModeCommand extends StructureCommand {
    constructor(structureId, mode) {
        super(structureId, 'SetSelectionModeCommand');
        this.mode = mode;
    }
    getMode() {
        return this.mode;
    }
}

class SelectAllRowsCommand extends StructureCommand {
    constructor(structureId) {
        super(structureId, 'SelectAllRowsCommand');
    }
}

class UnselectAllRowsCommand extends StructureCommand {
    constructor(structureId) {
        super(structureId, 'UnselectAllRowsCommand');
    }
}

class ToggleSelectedRowCommand extends StructureCommand {
    constructor(structureId, selectedRow, type) {
        super(structureId, 'ToggleSelectedRowCommand');
        this.selectedRow = selectedRow;
        this.type = type;
    }
    getSelectedRow() {
        return this.selectedRow;
    }
    getType() {
        return this.type;
    }
}

class FormationDispatcher {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    toggleSelectedRow(structureId, selectedRow, type) {
        this.commandDispatcher.dispatch(new ToggleSelectedRowCommand(structureId, selectedRow, type));
    }
}
FormationDispatcher.ɵfac = function FormationDispatcher_Factory(t) { return new (t || FormationDispatcher)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
FormationDispatcher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FormationDispatcher, factory: FormationDispatcher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FormationDispatcher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class FormationCommandInvoker {
    constructor(commandDispatcher, formationDispatcher) {
        this.commandDispatcher = commandDispatcher;
        this.formationDispatcher = formationDispatcher;
    }
    setDefaultFormation(structureId) {
        // this.commandDispatcher.dispatch(new )
    }
    toggleSelectedRow(selectedRow, type, structureId) {
        this.formationDispatcher.toggleSelectedRow(structureId, selectedRow, type);
    }
    changeMode(mode, structureId) {
        this.commandDispatcher.dispatch(new SetSelectionModeCommand(structureId, mode));
    }
    setSelection(enabled, structureId) {
        this.commandDispatcher.dispatch(new SetEnabledSelectionCommand(structureId, enabled));
    }
    selectAll(structureId) {
        this.commandDispatcher.dispatch(new SelectAllRowsCommand(structureId));
    }
    unselectAll(structureId) {
        this.commandDispatcher.dispatch(new UnselectAllRowsCommand(structureId));
    }
}
FormationCommandInvoker.ɵfac = function FormationCommandInvoker_Factory(t) { return new (t || FormationCommandInvoker)(i0.ɵɵinject(i1$1.CommandDispatcher), i0.ɵɵinject(FormationDispatcher)); };
FormationCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FormationCommandInvoker, factory: FormationCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FormationCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }, { type: FormationDispatcher }]; }, null); })();

class StructureHeaderBottomEnabledArchive extends Archive {
    constructor() {
        super(false);
    }
}
StructureHeaderBottomEnabledArchive.ɵfac = function StructureHeaderBottomEnabledArchive_Factory(t) { return new (t || StructureHeaderBottomEnabledArchive)(); };
StructureHeaderBottomEnabledArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureHeaderBottomEnabledArchive, factory: StructureHeaderBottomEnabledArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureHeaderBottomEnabledArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaEventRepository extends EventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
}
SchemaEventRepository.ɵfac = function SchemaEventRepository_Factory(t) { return new (t || SchemaEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
SchemaEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaEventRepository, factory: SchemaEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class StructureInitialValuesReadyArchive extends AggregateArchive {
    constructor() {
        super(StructureInitialValuesReadyArchive.default);
    }
    on(aggregateId) {
        return super.on(aggregateId)
            .pipe(hermesFilter(v => v));
    }
    once(aggregateId) {
        return this.on(aggregateId)
            .pipe(hermesTake(1));
    }
}
StructureInitialValuesReadyArchive.default = false;
StructureInitialValuesReadyArchive.ɵfac = function StructureInitialValuesReadyArchive_Factory(t) { return new (t || StructureInitialValuesReadyArchive)(); };
StructureInitialValuesReadyArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureInitialValuesReadyArchive, factory: StructureInitialValuesReadyArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInitialValuesReadyArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

/** @internal */
class StructureGateway extends SmartComponent {
    constructor(changeDetectorRef, elementRef, domainEventBus, commandDispatcher, columnAutoConfigurator, structureId, compositionId, schemaId, structureCommandInvoker, structurePagingCommandDispatcher, pagingEventRepository, sortingCommandDispatcher, searchCommandDispatcher, fieldCommandDispatcher, sourceCommandService, sourceEventService, schemaCommandInvoker, compositionCommandDispatcher, compositionEventRepository, formationEventService, structureEditModeArchive, structureCellEditArchive, structureInfoPanelConfigService, structureCellEditStore, columnFieldFactory, rowSelectEnabledArchive, rowSelectionTypeArchive, schemaRowClassArchive, schemaRowStyleArchive, formationCommandDispatcher, searchEventRepository, structureHeaderBottomEnabledArchive, schemaEventRepository, translationService, structureInitialValuesReadyArchive) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.domainEventBus = domainEventBus;
        this.commandDispatcher = commandDispatcher;
        this.columnAutoConfigurator = columnAutoConfigurator;
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.schemaId = schemaId;
        this.structureCommandInvoker = structureCommandInvoker;
        this.structurePagingCommandDispatcher = structurePagingCommandDispatcher;
        this.pagingEventRepository = pagingEventRepository;
        this.sortingCommandDispatcher = sortingCommandDispatcher;
        this.searchCommandDispatcher = searchCommandDispatcher;
        this.fieldCommandDispatcher = fieldCommandDispatcher;
        this.sourceCommandService = sourceCommandService;
        this.sourceEventService = sourceEventService;
        this.schemaCommandInvoker = schemaCommandInvoker;
        this.compositionCommandDispatcher = compositionCommandDispatcher;
        this.compositionEventRepository = compositionEventRepository;
        this.formationEventService = formationEventService;
        this.structureEditModeArchive = structureEditModeArchive;
        this.structureCellEditArchive = structureCellEditArchive;
        this.structureInfoPanelConfigService = structureInfoPanelConfigService;
        this.structureCellEditStore = structureCellEditStore;
        this.columnFieldFactory = columnFieldFactory;
        this.rowSelectEnabledArchive = rowSelectEnabledArchive;
        this.rowSelectionTypeArchive = rowSelectionTypeArchive;
        this.schemaRowClassArchive = schemaRowClassArchive;
        this.schemaRowStyleArchive = schemaRowStyleArchive;
        this.formationCommandDispatcher = formationCommandDispatcher;
        this.searchEventRepository = searchEventRepository;
        this.structureHeaderBottomEnabledArchive = structureHeaderBottomEnabledArchive;
        this.schemaEventRepository = schemaEventRepository;
        this.translationService = translationService;
        this.structureInitialValuesReadyArchive = structureInitialValuesReadyArchive;
        // DOESNT WORK WITH GATE
        this.source = [];
        /** *********************
         * OUTPUTS
         ***********************/
        this.themeChanged = new EventEmitter();
        this.columnsChanged = new EventEmitter();
        this.containerWidthChanged = new EventEmitter();
        this.sourceEdited = new EventEmitter();
        this.cellEditEntered = new EventEmitter();
        this.cellEditCanceled = new EventEmitter();
        this.cellEditSubmitted = new EventEmitter();
        this.changeAfterInit = false;
        this.structureColumnInputHandler = new StructureColumnInputHandler(structureId, compositionId, commandDispatcher, domainEventBus, columnFieldFactory, columnAutoConfigurator, compositionCommandDispatcher);
        this.translationService.setDefaultTranslation();
    }
    ngOnChanges(changes) {
        if (changes.editMode !== undefined && changes.editMode.currentValue !== undefined) {
            this.structureEditModeArchive.next(this.editMode);
        }
        if (changes.cellEditing !== undefined && changes.cellEditing.currentValue !== undefined) {
            let editingConfig;
            if (typeof this.cellEditing === 'boolean') {
                editingConfig = {
                    enabled: this.cellEditing
                };
            }
            else {
                editingConfig = this.cellEditing;
            }
            this.structureCommandInvoker.setCellEdit(editingConfig, this.structureId);
        }
        if (changes.width !== undefined && changes.width.currentValue !== undefined) {
            this.compositionCommandDispatcher.setWidth(this.width, this.compositionId);
        }
        if (changes.theme !== undefined && changes.theme.currentValue !== undefined) {
            this.schemaCommandInvoker.setTheme(this.theme, this.schemaId, this.structureId);
        }
        if (changes.rowHeight !== undefined && changes.rowHeight.currentValue !== undefined) {
            this.structureCommandInvoker.setRowHeight(this.rowHeight, this.structureId);
        }
        if (changes.autoResizeWidth !== undefined && changes.autoResizeWidth.currentValue !== undefined) {
            this.compositionCommandDispatcher.setResizeWidth(this.autoResizeWidth, this.compositionId);
        }
        /**
         * Columns
         */
        this.structureColumnInputHandler.handle(changes);
        if (changes.maxHeight && this.maxHeight) {
            this.structureCommandInvoker.setContainerHeight(this.maxHeight, this.structureId);
        }
        /**
         * Setting source should be last step
         */
        if (changes.source !== undefined && changes.source.currentValue !== undefined) {
            this.sourceCommandService.setOrigin(this.source, this.structureId);
        }
    }
    ngOnInit() {
        this.compositionEventRepository
            .onColumnsChanged(this.compositionId.toReadModelRootId())
            .pipe(this.hermesTakeUntil())
            .subscribe(() => {
            this.columnsChanged.emit();
        });
        this.compositionEventRepository
            .onContainerWidthChanged(this.compositionId.toReadModelRootId())
            .pipe(this.hermesTakeUntil())
            .subscribe((containerWidth) => {
            this.containerWidthChanged.emit(containerWidth);
        });
        this.sourceEventService
            .onSourceEdited(this.structureId)
            .subscribe((values) => {
            this.sourceEdited.emit(values);
        });
        this.structureCellEditStore
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((state) => {
            switch (state) {
                case StructureCellEditState.ENTER:
                    this.cellEditEntered.emit();
                    break;
                case StructureCellEditState.SUBMIT:
                    this.cellEditSubmitted.emit();
                    break;
                case StructureCellEditState.CANCEL:
                    this.cellEditCanceled.emit();
                    break;
                default:
                    break;
            }
        });
        this.subscribeAndEmit(this.schemaEventRepository.onThemeChanged(this.schemaId), this.themeChanged);
        this.componentInitialized();
    }
    componentInitialized() {
        this.changeAfterInit = true;
    }
}
StructureGateway.ɵfac = function StructureGateway_Factory(t) { return new (t || StructureGateway)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1$1.DomainEventBus), i0.ɵɵdirectiveInject(i1$1.CommandDispatcher), i0.ɵɵdirectiveInject(ColumnAutoConfigurator), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(SchemaReadModelRootId), i0.ɵɵdirectiveInject(StructureCommandInvoker), i0.ɵɵdirectiveInject(PagingCommandInvoker), i0.ɵɵdirectiveInject(PagingEventRepository), i0.ɵɵdirectiveInject(SortingCommandInvoker), i0.ɵɵdirectiveInject(SearchCommandInvoker), i0.ɵɵdirectiveInject(FieldCommandInvoker), i0.ɵɵdirectiveInject(SourceCommandInvoker), i0.ɵɵdirectiveInject(SourceEventService), i0.ɵɵdirectiveInject(SchemaCommandInvoker), i0.ɵɵdirectiveInject(CompositionCommandInvoker), i0.ɵɵdirectiveInject(CompositionEventRepository), i0.ɵɵdirectiveInject(FormationEventRepository), i0.ɵɵdirectiveInject(StructureEditModeArchive), i0.ɵɵdirectiveInject(StructureCellEditArchive), i0.ɵɵdirectiveInject(StructureInfoPanelConfigService), i0.ɵɵdirectiveInject(StructureCellEditStore), i0.ɵɵdirectiveInject(ColumnFieldFactory), i0.ɵɵdirectiveInject(RowSelectEnabledRepository), i0.ɵɵdirectiveInject(RowSelectionTypeArchive), i0.ɵɵdirectiveInject(SchemaRowClassArchive), i0.ɵɵdirectiveInject(SchemaRowStyleArchive), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(SearchEventRepository), i0.ɵɵdirectiveInject(StructureHeaderBottomEnabledArchive), i0.ɵɵdirectiveInject(SchemaEventRepository), i0.ɵɵdirectiveInject(TranslationFacade), i0.ɵɵdirectiveInject(StructureInitialValuesReadyArchive)); };
StructureGateway.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureGateway, inputs: { maxHeight: "maxHeight", width: "width", rowHeight: "rowHeight", autoResizeWidth: "autoResizeWidth", source: "source", columns: "columns", editMode: "editMode", cellEditing: "cellEditing", theme: "theme" }, outputs: { themeChanged: "themeChanged", columnsChanged: "columnsChanged", containerWidthChanged: "containerWidthChanged", sourceEdited: "sourceEdited", cellEditEntered: "cellEditEntered", cellEditCanceled: "cellEditCanceled", cellEditSubmitted: "cellEditSubmitted" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureGateway, [{
        type: Directive
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i1$1.DomainEventBus }, { type: i1$1.CommandDispatcher }, { type: ColumnAutoConfigurator }, { type: StructureId }, { type: CompositionId }, { type: SchemaReadModelRootId }, { type: StructureCommandInvoker }, { type: PagingCommandInvoker }, { type: PagingEventRepository }, { type: SortingCommandInvoker }, { type: SearchCommandInvoker }, { type: FieldCommandInvoker }, { type: SourceCommandInvoker }, { type: SourceEventService }, { type: SchemaCommandInvoker }, { type: CompositionCommandInvoker }, { type: CompositionEventRepository }, { type: FormationEventRepository }, { type: StructureEditModeArchive }, { type: StructureCellEditArchive }, { type: StructureInfoPanelConfigService }, { type: StructureCellEditStore }, { type: ColumnFieldFactory }, { type: RowSelectEnabledRepository }, { type: RowSelectionTypeArchive }, { type: SchemaRowClassArchive }, { type: SchemaRowStyleArchive }, { type: FormationCommandInvoker }, { type: SearchEventRepository }, { type: StructureHeaderBottomEnabledArchive }, { type: SchemaEventRepository }, { type: TranslationFacade }, { type: StructureInitialValuesReadyArchive }]; }, { maxHeight: [{
            type: Input
        }], width: [{
            type: Input
        }], rowHeight: [{
            type: Input
        }], autoResizeWidth: [{
            type: Input
        }], source: [{
            type: Input
        }], columns: [{
            type: Input
        }], editMode: [{
            type: Input
        }], cellEditing: [{
            type: Input
        }], theme: [{
            type: Input
        }], themeChanged: [{
            type: Output
        }], columnsChanged: [{
            type: Output
        }], containerWidthChanged: [{
            type: Output
        }], sourceEdited: [{
            type: Output
        }], cellEditEntered: [{
            type: Output
        }], cellEditCanceled: [{
            type: Output
        }], cellEditSubmitted: [{
            type: Output
        }] }); })();

class StructureColumnMenuConfig {
    constructor(enabled = false, sort = true, filter = false, columnsManager = false) {
        this.enabled = enabled;
        this.sort = sort;
        this.filter = filter;
        this.columnsManager = columnsManager;
        this.mainMenu = 'Menu';
        this.filterMenu = 'Filter';
        this.columnsMenu = 'Columns';
    }
    static default() {
        return new StructureColumnMenuConfig();
    }
    static fromConfig(config) {
        return new StructureColumnMenuConfig(config.enabled, config.sort, config.filter, config.columnsManager);
    }
    isEnabled() {
        return this.enabled &&
            (this.sort || this.filter || this.columnsManager);
    }
    isMainEnabled() {
        return this.sort;
    }
    isSortingEnabled() {
        return this.sort;
    }
    isFilteringEnabled() {
        return this.filter;
    }
    isColumnManagerEnabled() {
        return this.columnsManager;
    }
    getMenus() {
        const menus = [];
        if (this.isMainEnabled()) {
            menus.push(this.getMainMenu());
        }
        if (this.isFilteringEnabled()) {
            menus.push(this.getFilterMenu());
        }
        if (this.isColumnManagerEnabled()) {
            menus.push(this.getColumnMenu());
        }
        return menus;
    }
    getActiveMenu() {
        return this.getMenus()[0];
    }
    getMainMenu() {
        return this.mainMenu;
    }
    getFilterMenu() {
        return this.filterMenu;
    }
    getColumnMenu() {
        return this.columnsMenu;
    }
    setMainMenu(mainMenu) {
        this.mainMenu = mainMenu;
    }
    setFilterMenu(filterMenu) {
        this.filterMenu = filterMenu;
    }
    setColumnsMenu(columnsMenu) {
        this.columnsMenu = columnsMenu;
    }
}

class StructureColumnMenuConfigArchive extends Archive {
    constructor() {
        super(StructureColumnMenuConfig.default());
    }
    nextConfig(config) {
        const menuConfig = StructureColumnMenuConfig.fromConfig(config);
        this.next(menuConfig);
    }
}
StructureColumnMenuConfigArchive.ɵfac = function StructureColumnMenuConfigArchive_Factory(t) { return new (t || StructureColumnMenuConfigArchive)(); };
StructureColumnMenuConfigArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureColumnMenuConfigArchive, factory: StructureColumnMenuConfigArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnMenuConfigArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructureCellEditCloseAllService {
    constructor() {
        this.closeAll$ = new HermesSubject();
    }
    closeAll() {
        this.closeAll$.next();
    }
    onCloseAll() {
        return this.closeAll$.toObservable();
    }
}
StructureCellEditCloseAllService.ɵfac = function StructureCellEditCloseAllService_Factory(t) { return new (t || StructureCellEditCloseAllService)(); };
StructureCellEditCloseAllService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureCellEditCloseAllService, factory: StructureCellEditCloseAllService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCellEditCloseAllService, [{
        type: Injectable
    }], null, null); })();

class StructureHeaderTopEnabledArchive extends Archive {
    constructor() {
        super(true);
    }
}
StructureHeaderTopEnabledArchive.ɵfac = function StructureHeaderTopEnabledArchive_Factory(t) { return new (t || StructureHeaderTopEnabledArchive)(); };
StructureHeaderTopEnabledArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureHeaderTopEnabledArchive, factory: StructureHeaderTopEnabledArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureHeaderTopEnabledArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructureRowDetailConfigArchive extends Archive {
    constructor() {
        super({
            enabled: false,
            template: (item => 'Detail View')
        });
    }
}
StructureRowDetailConfigArchive.ɵfac = function StructureRowDetailConfigArchive_Factory(t) { return new (t || StructureRowDetailConfigArchive)(); };
StructureRowDetailConfigArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureRowDetailConfigArchive, factory: StructureRowDetailConfigArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowDetailConfigArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

const structureRowDetailViewItem = new InjectionToken('structureRowDetailViewItem');
const structureRowDetailViewTemplate = new InjectionToken('structureRowDetailViewTemplate');

class DynamicallyCreatedComponent {
    constructor() {
        this.subClassConstructor = this.constructor;
        if (this.hasInputs()) {
            this.throwError('it cannot have properties annotated with @Inputs().');
        }
    }
    hasInputs() {
        return false;
        // Works with Angular 12
        // return !this.isEmpty((this.constructor as any).ɵcmp.inputs);
    }
    isEmpty(obj) {
        for (const key in obj) {
            if (obj.hasOwnProperty(key)) {
                return false;
            }
        }
        return true;
    }
    throwError(reason) {
        throw new Error(`Component "${this.subClassConstructor.name}" is a DynamicallyCreatedComponent, ${reason}.`);
    }
}
DynamicallyCreatedComponent.ɵfac = function DynamicallyCreatedComponent_Factory(t) { return new (t || DynamicallyCreatedComponent)(); };
DynamicallyCreatedComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: DynamicallyCreatedComponent });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DynamicallyCreatedComponent, [{
        type: Directive
    }], function () { return []; }, null); })();

const _c0$z = ["gui-row-detail", ""];
class StructureRowDetailViewComponent extends DynamicallyCreatedComponent {
    constructor(item, template, sanitizer) {
        super();
        this.item = item;
        this.template = template;
        this.sanitizer = sanitizer;
        this.safeHTML = this.sanitizer.bypassSecurityTrustHtml(this.template(this.item.getSource(), this.item.getIndex()));
    }
    ngOnInit() {
        this.selectedRowValue = this.item.getSource();
    }
}
StructureRowDetailViewComponent.ɵfac = function StructureRowDetailViewComponent_Factory(t) { return new (t || StructureRowDetailViewComponent)(i0.ɵɵdirectiveInject(structureRowDetailViewItem), i0.ɵɵdirectiveInject(structureRowDetailViewTemplate), i0.ɵɵdirectiveInject(i1$3.DomSanitizer)); };
StructureRowDetailViewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureRowDetailViewComponent, selectors: [["div", "gui-row-detail", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$z, decls: 1, vars: 1, consts: [[3, "innerHTML"]], template: function StructureRowDetailViewComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("innerHTML", ctx.safeHTML, i0.ɵɵsanitizeHtml);
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowDetailViewComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-row-detail]',
                templateUrl: './structure.row-detail-view.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: SelectedRow, decorators: [{
                type: Inject,
                args: [structureRowDetailViewItem]
            }] }, { type: undefined, decorators: [{
                type: Inject,
                args: [structureRowDetailViewTemplate]
            }] }, { type: i1$3.DomSanitizer }]; }, null); })();

class StructureRowDetailService extends Reactive {
    constructor(injector, structureId, structureDetailViewConfigArchive, formationEventService, drawerService) {
        super();
        this.injector = injector;
        this.structureId = structureId;
        this.structureDetailViewConfigArchive = structureDetailViewConfigArchive;
        this.formationEventService = formationEventService;
        this.drawerService = drawerService;
        this.enabled = false;
    }
    init(ref) {
        this.elementRef = ref;
        this.structureDetailViewConfigArchive
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((config) => {
            this.config = config;
            if (config.enabled === true) {
                this.turnOn();
            }
            else if (config.enabled === false) {
                this.turnOff();
            }
        });
        this.formationEventService
            .onItemSelected(this.structureId)
            .pipe(this.hermesTakeUntil())
            .subscribe((items) => {
            if (!this.enabled) {
                return;
            }
            this.drawerService.close();
            if (items.length === 0) {
                return;
            }
            const item = items[0];
            const injector = Injector.create({
                parent: this.injector,
                providers: [
                    { provide: structureRowDetailViewItem, useValue: item },
                    { provide: structureRowDetailViewTemplate, useValue: this.config.template }
                ]
            });
            this.drawerService.open(this.elementRef, StructureRowDetailViewComponent, { injector: injector });
        });
    }
    turnOn() {
        this.enabled = true;
    }
    turnOff() {
        this.enabled = false;
    }
}
StructureRowDetailService.ɵfac = function StructureRowDetailService_Factory(t) { return new (t || StructureRowDetailService)(i0.ɵɵinject(i0.Injector), i0.ɵɵinject(StructureId), i0.ɵɵinject(StructureRowDetailConfigArchive), i0.ɵɵinject(FormationEventRepository), i0.ɵɵinject(i1.FabricDrawerService)); };
StructureRowDetailService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureRowDetailService, factory: StructureRowDetailService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowDetailService, [{
        type: Injectable
    }], function () { return [{ type: i0.Injector }, { type: StructureId }, { type: StructureRowDetailConfigArchive }, { type: FormationEventRepository }, { type: i1.FabricDrawerService }]; }, null); })();

class StructureTitlePanelConfigArchive extends Archive {
    constructor() {
        super(Object.assign({}, StructureTitlePanelConfigArchive.titlePanelConfig));
    }
}
StructureTitlePanelConfigArchive.titlePanelConfig = {
    enabled: false,
    template: 'Title Panel'
};

class StructureFooterPanelConfigArchive extends Archive {
    constructor() {
        super(Object.assign({}, StructureFooterPanelConfigArchive.footerPanelConfig));
    }
}
StructureFooterPanelConfigArchive.footerPanelConfig = {
    enabled: false,
    template: 'Footer Panel'
};

class SortToggledEvent extends StructureDomainEvent {
    constructor(aggregateId, compositionId, directions) {
        super(aggregateId, { compositionId, directions }, 'SortToggledEvent');
        this.compositionId = compositionId;
        this.directions = directions;
    }
    getCompositionId() {
        return this.compositionId;
    }
    getDirections() {
        return this.directions;
    }
}

class ToggleSortCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return ToggleSortCommand;
    }
    handle(structure, command) {
        const aggregateId = command.getAggregateId(), compositionId = command.getCompositionId(), fieldId = command.getFieldId();
        const sorters = structure.toggleSort(fieldId);
        this.publishSortEvent(aggregateId, compositionId, fieldId, sorters);
    }
    publish(aggregate, command) {
    }
    publishSortEvent(aggregateId, compositionId, fieldId, sorters) {
        const directions = sorters.map((sorter) => {
            return {
                direction: sorter.hasDirection(),
                fieldId: sorter.getField().getId()
            };
        });
        this.domainEventPublisher.publish(new SortToggledEvent(aggregateId, compositionId, directions));
    }
}
ToggleSortCommandHandler.ɵfac = function ToggleSortCommandHandler_Factory(t) { return new (t || ToggleSortCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
ToggleSortCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ToggleSortCommandHandler, factory: ToggleSortCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ToggleSortCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class SortingSetEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'SortingSetEvent');
    }
}

class SetSortingCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetSortingCommand;
    }
    handle(aggregate, command) {
        const sortingConfig = command.getSortingConfig();
        aggregate.setSortingConfig(sortingConfig);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new SortingSetEvent(command.getAggregateId()));
    }
}
SetSortingCommandHandler.ɵfac = function SetSortingCommandHandler_Factory(t) { return new (t || SetSortingCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetSortingCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetSortingCommandHandler, factory: SetSortingCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetSortingCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SortOrderSetEvent extends StructureDomainEvent {
    constructor(aggregateId, compositionId, directions) {
        super(aggregateId, { compositionId, directions }, 'SortOrderSetEvent');
        this.compositionId = compositionId;
        this.directions = directions;
    }
    getCompositionId() {
        return this.compositionId;
    }
    getDirections() {
        return this.directions;
    }
}

class SetSortOrderCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetSortOrderCommand;
    }
    handle(structure, command) {
        const structureId = command.getAggregateId(), compositionId = command.getCompositionId(), fieldId = command.getFieldId(), sortOrder = command.getSortOrder();
        const sorters = structure.setSortOrder(fieldId, sortOrder);
        this.publishSortEvent(structureId, compositionId, fieldId, sorters);
    }
    publish(aggregate, command) {
    }
    publishSortEvent(aggregateId, compositionId, fieldId, sorters) {
        const directions = sorters.map((sorter) => {
            return {
                direction: sorter.hasDirection(),
                fieldId: sorter.getField().getId()
            };
        });
        this.domainEventPublisher.publish(new SortOrderSetEvent(aggregateId, compositionId, directions));
    }
}
SetSortOrderCommandHandler.ɵfac = function SetSortOrderCommandHandler_Factory(t) { return new (t || SetSortOrderCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetSortOrderCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetSortOrderCommandHandler, factory: SetSortOrderCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetSortOrderCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class SortingDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(ToggleSortCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetSortingCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetSortOrderCommandHandler, structureKey)
        ];
    }
}
SortingDomainModule.ɵfac = function SortingDomainModule_Factory(t) { return new (t || SortingDomainModule)(); };
SortingDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SortingDomainModule });
SortingDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SortingDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SortingDomainModule, { imports: [CommonModule] }); })();

class SortingApiModule extends ApiModule {
}
SortingApiModule.ɵfac = /*@__PURE__*/ function () { let ɵSortingApiModule_BaseFactory; return function SortingApiModule_Factory(t) { return (ɵSortingApiModule_BaseFactory || (ɵSortingApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(SortingApiModule)))(t || SortingApiModule); }; }();
SortingApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SortingApiModule });
SortingApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        SortingCommandInvoker
    ], imports: [[
            CommonModule,
            SortingDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SortingApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    SortingDomainModule
                ],
                providers: [
                    SortingCommandInvoker
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SortingApiModule, { imports: [CommonModule,
        SortingDomainModule] }); })();

class SortingFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
SortingFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵSortingFeatureModule_BaseFactory; return function SortingFeatureModule_Factory(t) { return (ɵSortingFeatureModule_BaseFactory || (ɵSortingFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(SortingFeatureModule)))(t || SortingFeatureModule); }; }();
SortingFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SortingFeatureModule });
SortingFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            SortingApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SortingFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    SortingApiModule
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SortingFeatureModule, { imports: [CommonModule,
        SortingApiModule] }); })();

class FieldReadModel {
    constructor(id, dataType, name) {
        this.id = id;
        this.dataType = dataType;
        this.name = name;
    }
    getFieldId() {
        return this.id;
    }
    getId() {
        return this.id.getId();
    }
    getDataType() {
        return this.dataType;
    }
    getName() {
        return this.name;
    }
}

class FieldUiConverter {
    convert(fields) {
        return fields.map((field) => {
            return this.convertOne(field);
        });
    }
    convertOne(field) {
        return new FieldReadModel(field.getId(), field.getDataType(), field.getName());
    }
}
FieldUiConverter.ɵfac = function FieldUiConverter_Factory(t) { return new (t || FieldUiConverter)(); };
FieldUiConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FieldUiConverter, factory: FieldUiConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldUiConverter, [{
        type: Injectable
    }], null, null); })();

class FieldCollection {
    constructor(fieldFactory) {
        this.fieldFactory = fieldFactory;
        this.fields = new Map();
    }
    getField(fieldId) {
        if (fieldId === null) {
            return this.getAllFields()[0];
        }
        return this.fields.get(fieldId.getId());
    }
    getAllFieldIds() {
        return Array.from(this.fields.keys());
    }
    getAllFields() {
        return Array.from(this.fields.values());
    }
    getFieldsAsMap() {
        return this.fields;
    }
    initFields(fieldConfigs) {
        const fields = this.fieldFactory.create(fieldConfigs);
        this.clear();
        this.addFields(fields);
    }
    addFields(fields) {
        for (const field of fields) {
            this.addField(field);
        }
    }
    addField(field) {
        this.fields.set(field.getId().toString(), field);
    }
    clear() {
        this.fields.clear();
    }
}

class Field {
    constructor(id, field, name) {
        this.id = id;
        this.field = field;
        this.name = name;
    }
    static of(id, dataField, name) {
        return new Field(id, dataField, name);
    }
    getId() {
        return this.id;
    }
    getKey() {
        return this.getId().toString();
    }
    getDataType() {
        return this.field.getDataType();
    }
    getName() {
        return this.name;
    }
    /**
     * @deprecated
     */
    getField() {
        return this.field;
    }
    /**
     * Probably should not be used.
     *
     * @deprecated
     */
    getAccessor() {
        return this.field.getAccessor();
    }
    /**
     * Probably should not be used.
     *
     * @deprecated
     */
    getAccessorMethod() {
        return this.field.getAccessorMethod();
    }
    /**
     * Probably should not be used.
     *
     * @deprecated
     */
    getSearchAccessorMethod() {
        return this.field.getSearchAccessorMethod();
    }
    getValue(entity) {
        return this.field.getValue(entity);
    }
    getDisplayValue(value) {
        return this.field.getDisplayValue(value);
    }
    /**
     * Probably should not be used.
     *
     * @deprecated
     */
    isSummaries(type) {
        return this.field.isSummaries(type);
    }
    /**
     * Probably should not be used.
     *
     * @deprecated
     */
    isSummariesEnabled() {
        return this.field.isSummariesEnabled();
    }
    search(item, searchPhrase) {
        return this.field.search(item, searchPhrase);
    }
    filter(item, filterPhrase) {
        const value = this.field.getValue(item);
        if (this.field.getDataType() === DataType.NUMBER) {
            return this.field.filter(value, filterPhrase);
        }
        else if (this.field.getDataType() === DataType.BOOLEAN) {
            return this.field.filter(value, filterPhrase);
        }
        else if (this.field.getDataType() === DataType.STRING) {
            return this.field.filter(value, filterPhrase);
        }
        else if (this.field.getDataType() === DataType.DATE) {
            return this.field.filter(value, filterPhrase);
        }
        else {
            return true;
        }
    }
    sort(entityOne, entityTwo, direction) {
        const valueOne = direction ? this.field.getSortValue(entityOne) : this.field.getSortValue(entityTwo), valueTwo = direction ? this.field.getSortValue(entityTwo) : this.field.getSortValue(entityOne);
        if (this.field.getDataType() === DataType.NUMBER) {
            return this.field.sort(valueOne, valueTwo);
        }
        else if (this.field.getDataType() === DataType.BOOLEAN) {
            return this.field.sort(valueOne, valueTwo);
        }
        else if (this.field.getDataType() === DataType.STRING) {
            return this.field.sort(valueOne, valueTwo);
        }
        else if (this.field.getDataType() === DataType.DATE) {
            return this.field.sort(valueOne, valueTwo);
        }
        else {
            return 0;
        }
    }
}

class FieldId {
    constructor(id) {
        this.id = id;
    }
    getId() {
        return this.id;
    }
    equals(fieldId) {
        return fieldId.toString() === this.id;
    }
    toString() {
        return this.id;
    }
}

class FieldIdGenerator {
    generateId() {
        const id = RandomStringGenerator.generate();
        return new FieldId(id);
    }
}

class BaseDataField {
    constructor(accessor, dataType, matchers) {
        this.accessor = accessor;
        this.dataType = dataType;
        this.matchers = matchers;
        if (typeof accessor === 'string') {
            this.accessorMethod = (entity) => entity.getSourceItem()[accessor];
        }
        else if (typeof accessor === 'function') {
            this.accessorMethod = (entity) => accessor(entity.getSourceItem());
        }
        else {
            this.accessorMethod = (entity) => entity;
        }
    }
    getDataType() {
        return this.dataType;
    }
    getAccessor() {
        return this.accessor;
    }
    getAccessorMethod() {
        return this.accessorMethod;
    }
    getMatchers() {
        return this.matchers;
    }
    getSearchAccessorMethod() {
        let matcher;
        this.matchers
            .getSearchMatcher()
            .ifPresent((m) => {
            matcher = m;
        });
        if (matcher) {
            return (entity) => {
                const val = this.accessorMethod(entity);
                return matcher(val);
            };
        }
        else {
            return (entity) => {
                return this.accessorMethod(entity);
            };
        }
    }
    getValue(entity) {
        return this.accessorMethod(entity);
    }
    getSortValue(entity) {
        let value = this.accessorMethod(entity);
        this.matchers
            .getSortMatcher()
            .ifPresent((matcher) => {
            value = matcher(value);
        });
        return value;
    }
    getSearchValue(entity) {
        let value = this.accessorMethod(entity);
        this.matchers
            .getSearchMatcher()
            .ifPresent((matcher) => {
            value = matcher(value);
        });
        return value;
    }
}

class DataField extends BaseDataField {
    constructor(accessor, dataType, matchers, summariesConfig) {
        super(accessor, dataType, matchers);
        this.summariesEnabled = true;
        this.possibleSummaries = this.assignPossibleSummaries();
        this.assignSummaries(summariesConfig);
    }
    isSummaries(type) {
        if (!this.isSummariesEnabled()) {
            return false;
        }
        return !!(this.summariesTypes & type);
    }
    isSummariesEnabled() {
        return this.summariesEnabled;
    }
    setSummariesEnabled(enabled) {
        this.summariesEnabled = enabled;
    }
    assignSummaries(summariesConfig) {
        if (!!summariesConfig && Object.keys(summariesConfig).length !== 0) {
            if (summariesConfig.enabled) {
                this.summariesEnabled = !!summariesConfig.enabled;
            }
            if (summariesConfig.summariesTypes) {
                this.summariesTypes = 0;
                summariesConfig.summariesTypes.forEach((t) => {
                    this.summariesTypes |= t;
                });
            }
            else {
                this.summariesTypes = this.assignDefaultSummaries();
            }
        }
        else {
            this.summariesTypes = this.assignDefaultSummaries();
        }
    }
}

var SummariesType;
(function (SummariesType) {
    SummariesType[SummariesType["COUNT"] = 1024] = "COUNT";
    SummariesType[SummariesType["DISTINCT"] = 1] = "DISTINCT";
    SummariesType[SummariesType["SUM"] = 2] = "SUM";
    SummariesType[SummariesType["AVERAGE"] = 4] = "AVERAGE";
    SummariesType[SummariesType["MIN"] = 8] = "MIN";
    SummariesType[SummariesType["MAX"] = 16] = "MAX";
    SummariesType[SummariesType["MEDIAN"] = 32] = "MEDIAN";
    SummariesType[SummariesType["TRUTHY"] = 64] = "TRUTHY";
    SummariesType[SummariesType["FALSY"] = 128] = "FALSY";
    SummariesType[SummariesType["EARLIEST"] = 256] = "EARLIEST";
    SummariesType[SummariesType["LATEST"] = 512] = "LATEST";
})(SummariesType || (SummariesType = {}));
// count
// count distinct
// percentile
// std.dev
// std.dev Pop
// variance
// variance pop

class UnknownDataField extends DataField {
    constructor(accessor, matchers, summariesConfig) {
        super(accessor, DataType.UNKNOWN, matchers, summariesConfig);
    }
    assignDefaultSummaries() {
        return 0;
        // return SummariesType.COUNT |
        // 	SummariesType.DISTINCT;
    }
    assignPossibleSummaries() {
        return SummariesType.COUNT |
            SummariesType.DISTINCT;
    }
    search(item, searchPhrase) {
        return false;
    }
    sort(one, two) {
        return 0;
    }
    filter(value, filterPhrase) {
        return false;
    }
    equals(item, value) {
        return false;
    }
    getDisplayValue(item) {
        return item;
    }
}

class NumberDataField extends DataField {
    constructor(accessor, matchers, summariesConfig) {
        super(accessor, DataType.NUMBER, matchers, summariesConfig);
    }
    getField() {
        return this;
    }
    assignDefaultSummaries() {
        return 0;
        // return SummariesType.COUNT |
        // 	SummariesType.DISTINCT |
        // 	SummariesType.SUM |
        // 	SummariesType.MIN |
        // 	SummariesType.MAX |
        // 	SummariesType.AVERAGE |
        // 	SummariesType.MEDIAN;
    }
    assignPossibleSummaries() {
        return SummariesType.COUNT |
            SummariesType.DISTINCT |
            SummariesType.SUM |
            SummariesType.MIN |
            SummariesType.MAX |
            SummariesType.AVERAGE |
            SummariesType.MEDIAN;
    }
    search(item, searchPhrase) {
        return false;
    }
    sort(numOne, numTwo) {
        const sureNumOne = +numOne, sureNumTwo = +numTwo;
        return sureNumOne - sureNumTwo;
    }
    filter(value, filterPhrase) {
        return value > filterPhrase;
    }
    equals(item, value) {
        return this.getValue(item) === value;
    }
    getDisplayValue(item) {
        return `${item}`;
    }
}

class StringDataField extends DataField {
    constructor(accessor, matchers, summariesConfig) {
        super(accessor, DataType.STRING, matchers, summariesConfig);
    }
    assignDefaultSummaries() {
        return 0;
        // return SummariesType.COUNT |
        // 	SummariesType.DISTINCT;
    }
    assignPossibleSummaries() {
        return SummariesType.COUNT |
            SummariesType.DISTINCT;
    }
    search(item, searchPhrase) {
        const value = this.getSearchValue(item);
        if (typeof value === 'string') {
            return value.toLowerCase().indexOf(searchPhrase.toLowerCase()) > -1;
        }
        else {
            return false;
        }
    }
    sort(strOne, strTwo) {
        const sureStrOne = '' + strOne, sureStrTwo = '' + strTwo;
        return sureStrOne.localeCompare(sureStrTwo);
    }
    filter(value, filterPhrase) {
        return value.toLowerCase().indexOf(filterPhrase.toLowerCase()) > -1;
    }
    equals(item, value) {
        return this.getValue(item) === value;
    }
    getDisplayValue(item) {
        return item;
    }
}

class BooleanDataField extends DataField {
    constructor(accessor, matchers, summariesConfig) {
        super(accessor, DataType.BOOLEAN, matchers, summariesConfig);
    }
    assignDefaultSummaries() {
        return 0;
        // return SummariesType.COUNT |
        // 	SummariesType.DISTINCT |
        // 	SummariesType.TRUTHY |
        // 	SummariesType.FALSY;
    }
    assignPossibleSummaries() {
        return SummariesType.COUNT |
            SummariesType.DISTINCT |
            SummariesType.TRUTHY |
            SummariesType.FALSY;
    }
    search(item, searchPhrase) {
        return false;
    }
    sort(booleanOne, booleanTwo) {
        const sureBoolOne = !!booleanOne, sureBoolTwo = !!booleanTwo;
        return (sureBoolOne === sureBoolTwo) ? 0 : sureBoolTwo ? -1 : 1;
    }
    filter(value, filterPhrase) {
        return value === filterPhrase;
    }
    equals(item, value) {
        return this.getValue(item) === value;
    }
    getDisplayValue(item) {
        return item ? 'True' : 'False';
    }
}

class DateDataField extends DataField {
    constructor(accessor, matchers, summariesConfig) {
        super(accessor, DataType.DATE, matchers, summariesConfig);
    }
    assignDefaultSummaries() {
        return 0;
        // return SummariesType.COUNT |
        // 	SummariesType.DISTINCT;
    }
    assignPossibleSummaries() {
        return SummariesType.COUNT |
            SummariesType.DISTINCT;
    }
    search(item, searchPhrase) {
        return false;
    }
    sort(dateOne, dateTwo) {
        return dateOne - dateTwo;
    }
    filter(value, filterPhrase) {
        return false;
    }
    equals(item, value) {
        return this.getValue(item).getTime() === value.getTime();
    }
    getDisplayValue(item) {
        return item.toDateString();
    }
}

class FieldMatchers {
    constructor(matcher, sortMatcher, searchMatcher) {
        this.matcher = matcher;
        this.sortMatcher = sortMatcher;
        this.searchMatcher = searchMatcher;
    }
    getMatcher() {
        return Optional.of(this.matcher);
    }
    getSortMatcher() {
        let matcher;
        if (this.sortMatcher) {
            matcher = this.sortMatcher;
        }
        if (this.matcher) {
            matcher = this.matcher;
        }
        return Optional.of(matcher);
    }
    getSearchMatcher() {
        let matcher;
        if (this.searchMatcher) {
            matcher = this.searchMatcher;
        }
        if (this.matcher) {
            matcher = this.matcher;
        }
        return Optional.of(matcher);
    }
}

class DataFieldFactory {
    create(fieldConfig) {
        const fieldMatchers = this.createMatchers(fieldConfig);
        let columnType = fieldConfig.type;
        if (columnType === undefined) {
            columnType = DataType.STRING;
        }
        if (columnType === DataType.UNKNOWN) {
            return new UnknownDataField(fieldConfig.field, fieldMatchers, fieldConfig.summaries);
        }
        if (columnType === DataType.NUMBER) {
            return new NumberDataField(fieldConfig.field, fieldMatchers, fieldConfig.summaries);
        }
        if (columnType === DataType.STRING) {
            return new StringDataField(fieldConfig.field, fieldMatchers);
        }
        if (columnType === DataType.BOOLEAN) {
            return new BooleanDataField(fieldConfig.field, fieldMatchers);
        }
        if (columnType === DataType.DATE) {
            return new DateDataField(fieldConfig.field, fieldMatchers);
        }
        return new UnknownDataField(fieldConfig.field, fieldMatchers, fieldConfig.summaries);
    }
    createMatchers(fieldConfig) {
        const matcher = fieldConfig.matcher;
        let sortMatcher;
        if (fieldConfig.sorting) {
            sortMatcher = fieldConfig.sorting.matcher;
        }
        return new FieldMatchers(matcher, sortMatcher);
    }
}
DataFieldFactory.ɵfac = function DataFieldFactory_Factory(t) { return new (t || DataFieldFactory)(); };
DataFieldFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: DataFieldFactory, factory: DataFieldFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DataFieldFactory, [{
        type: Injectable
    }], null, null); })();

class FieldFactory {
    constructor(fieldIdGenerator, dataFieldFactory) {
        this.fieldIdGenerator = fieldIdGenerator;
        this.dataFieldFactory = dataFieldFactory;
    }
    create(configs) {
        if (!configs) {
            return [];
        }
        return configs.map((fieldConfig, index) => {
            const fieldId = this.fieldIdGenerator.generateId(), dataField = this.dataFieldFactory.create(fieldConfig);
            return new Field(fieldId, dataField, this.getFieldName(fieldConfig, index));
        });
    }
    getFieldName(fieldConfig, index) {
        if (typeof fieldConfig.field === 'string') {
            return fieldConfig.field.toLowerCase();
        }
        else {
            return 'Field #' + index;
        }
    }
}
FieldFactory.ɵfac = function FieldFactory_Factory(t) { return new (t || FieldFactory)(i0.ɵɵinject(FieldIdGenerator), i0.ɵɵinject(DataFieldFactory)); };
FieldFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FieldFactory, factory: FieldFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldFactory, [{
        type: Injectable
    }], function () { return [{ type: FieldIdGenerator }, { type: DataFieldFactory }]; }, null); })();

class FieldCollectionFactory {
    constructor(fieldFactory) {
        this.fieldFactory = fieldFactory;
    }
    create() {
        return new FieldCollection(this.fieldFactory);
    }
}
FieldCollectionFactory.ɵfac = function FieldCollectionFactory_Factory(t) { return new (t || FieldCollectionFactory)(i0.ɵɵinject(FieldFactory)); };
FieldCollectionFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FieldCollectionFactory, factory: FieldCollectionFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldCollectionFactory, [{
        type: Injectable
    }], function () { return [{ type: FieldFactory }]; }, null); })();

class InitFieldsCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return InitFieldsCommand;
    }
    handle(structure, command) {
        const fieldConfigs = command.getFieldConfigs();
        structure.createFields(fieldConfigs);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
InitFieldsCommandHandler.ɵfac = function InitFieldsCommandHandler_Factory(t) { return new (t || InitFieldsCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
InitFieldsCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InitFieldsCommandHandler, factory: InitFieldsCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InitFieldsCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class FieldsInitedEventHandler {
    constructor(fieldReadModelRepository, fieldUiConverter) {
        this.fieldReadModelRepository = fieldReadModelRepository;
        this.fieldUiConverter = fieldUiConverter;
    }
    forEvent() {
        return FieldsInitedEvent;
    }
    handle(event) {
        if (event.ofMessageType('FieldsInitedEvent')) {
            const fields = this.fieldUiConverter.convert(event.getFields());
            this.fieldReadModelRepository.next(event.getAggregateId(), fields);
        }
    }
}
FieldsInitedEventHandler.ɵfac = function FieldsInitedEventHandler_Factory(t) { return new (t || FieldsInitedEventHandler)(i0.ɵɵinject(FieldReadModelArchive), i0.ɵɵinject(FieldUiConverter)); };
FieldsInitedEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FieldsInitedEventHandler, factory: FieldsInitedEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldsInitedEventHandler, [{
        type: Injectable
    }], function () { return [{ type: FieldReadModelArchive }, { type: FieldUiConverter }]; }, null); })();

class FieldDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(InitFieldsCommandHandler, structureKey)
        ];
    }
    static domainEventHandlers() {
        return [
            HermesModule.registerDomainEventHandler(FieldsInitedEventHandler)
        ];
    }
}
FieldDomainModule.ɵfac = function FieldDomainModule_Factory(t) { return new (t || FieldDomainModule)(); };
FieldDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: FieldDomainModule });
FieldDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        FieldCollectionFactory,
        FieldFactory,
        FieldIdGenerator,
        DataFieldFactory
    ] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldDomainModule, [{
        type: NgModule,
        args: [{
                providers: [
                    FieldCollectionFactory,
                    FieldFactory,
                    FieldIdGenerator,
                    DataFieldFactory
                ]
            }]
    }], function () { return []; }, null); })();

class FieldApiModule extends ApiModule {
}
FieldApiModule.ɵfac = /*@__PURE__*/ function () { let ɵFieldApiModule_BaseFactory; return function FieldApiModule_Factory(t) { return (ɵFieldApiModule_BaseFactory || (ɵFieldApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(FieldApiModule)))(t || FieldApiModule); }; }();
FieldApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: FieldApiModule });
FieldApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        FieldCommandInvoker,
        FieldReadModelArchive,
        FieldUiConverter,
        FieldWarehouse
    ], imports: [[
            CommonModule,
            FieldDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FieldDomainModule
                ],
                providers: [
                    FieldCommandInvoker,
                    FieldReadModelArchive,
                    FieldUiConverter,
                    FieldWarehouse
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(FieldApiModule, { imports: [CommonModule,
        FieldDomainModule] }); })();

class FieldFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
FieldFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵFieldFeatureModule_BaseFactory; return function FieldFeatureModule_Factory(t) { return (ɵFieldFeatureModule_BaseFactory || (ɵFieldFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(FieldFeatureModule)))(t || FieldFeatureModule); }; }();
FieldFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: FieldFeatureModule });
FieldFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            FieldApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FieldFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FieldApiModule
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(FieldFeatureModule, { imports: [CommonModule,
        FieldApiModule] }); })();

let Source = class Source {
    constructor(loading) {
        this.loading = loading;
    }
    isLoading() {
        return this.loading;
    }
};
Source = __decorate([
    ReadModelObject
], Source);

class SourceConverter {
    convert(aggregate) {
        return new Source(aggregate.isLoading());
    }
}
SourceConverter.ɵfac = function SourceConverter_Factory(t) { return new (t || SourceConverter)(); };
SourceConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceConverter, factory: SourceConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceConverter, [{
        type: Injectable
    }], null, null); })();

class SetSourceLoadingEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'SetSourceLoadingEvent');
    }
}

class SourceSetLoadingCommand extends StructureCommand {
    constructor(structureId, enabled) {
        super(structureId, 'SourceSetLoadingCommand');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class SourceSetLoadingCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SourceSetLoadingCommand;
    }
    handle(aggregate, command) {
        const enabled = command.isEnabled(), source = aggregate.getSource();
        source.setLoading(enabled);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new SetSourceLoadingEvent(command.getAggregateId()));
    }
}
SourceSetLoadingCommandHandler.ɵfac = function SourceSetLoadingCommandHandler_Factory(t) { return new (t || SourceSetLoadingCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SourceSetLoadingCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceSetLoadingCommandHandler, factory: SourceSetLoadingCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceSetLoadingCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetOriginCommand extends StructureCommand {
    constructor(structureId, items = []) {
        super(structureId, 'SetOriginCommand');
        this.items = items;
    }
    getItems() {
        return this.items;
    }
}

class SetOriginCommandHandler {
    constructor(structureSourceDomainEventPublisher) {
        this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
    }
    forCommand() {
        return SetOriginCommand;
    }
    handle(structure, command) {
        const items = command.getItems();
        structure.setOrigin(items);
    }
    publish(aggregate, command) {
        const aggregateEvents = aggregate.getEvents();
        this.structureSourceDomainEventPublisher.publish(aggregateEvents);
    }
}
SetOriginCommandHandler.ɵfac = function SetOriginCommandHandler_Factory(t) { return new (t || SetOriginCommandHandler)(i0.ɵɵinject(SourceDomainEventPublisher)); };
SetOriginCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetOriginCommandHandler, factory: SetOriginCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetOriginCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: SourceDomainEventPublisher }]; }, null); })();

class StructureEditSourceItemCommand extends StructureCommand {
    constructor(structureId, params) {
        super(structureId, 'StructureEditSourceItemCommand');
        this.params = params;
    }
    getParams() {
        return this.params;
    }
}

class StructureEditSourceItemCommandHandler {
    constructor(structureSourceDomainEventPublisher) {
        this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
    }
    forCommand() {
        return StructureEditSourceItemCommand;
    }
    handle(structure, command) {
        const params = command.getParams();
        structure.editItem(params);
    }
    publish(aggregate, command) {
        const aggregateEvents = aggregate.getEvents();
        this.structureSourceDomainEventPublisher.publish(aggregateEvents);
    }
}
StructureEditSourceItemCommandHandler.ɵfac = function StructureEditSourceItemCommandHandler_Factory(t) { return new (t || StructureEditSourceItemCommandHandler)(i0.ɵɵinject(SourceDomainEventPublisher)); };
StructureEditSourceItemCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureEditSourceItemCommandHandler, factory: StructureEditSourceItemCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureEditSourceItemCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: SourceDomainEventPublisher }]; }, null); })();

class SourceDispatcher {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    setLoading(structureId, enabled) {
        this.commandDispatcher.dispatch(new SourceSetLoadingCommand(structureId, enabled));
    }
    setOrigin(structureId, items) {
        this.commandDispatcher.dispatch(new SetOriginCommand(structureId, items));
    }
    editItem(structureId, params) {
        this.commandDispatcher.dispatch(new StructureEditSourceItemCommand(structureId, params));
    }
}
SourceDispatcher.ɵfac = function SourceDispatcher_Factory(t) { return new (t || SourceDispatcher)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
SourceDispatcher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceDispatcher, factory: SourceDispatcher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceDispatcher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class OriginItemEntity extends Entity {
    constructor(id, sourceItem, position, version = 0) {
        super(id);
        this.sourceItem = sourceItem;
        this.position = position;
        this.version = version;
    }
    getSourceItem() {
        return this.sourceItem;
    }
    getVersion() {
        return this.version;
    }
    getPosition() {
        return this.position;
    }
    bumpVersion() {
        this.version += 1;
    }
    setPosition(position) {
        this.position = position;
    }
    clone() {
        const rawData = Object.assign({}, this.sourceItem);
        return new OriginItemEntity(this.getId(), rawData, this.version);
    }
}

class StructureSourceItemEditedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId, beforeItem, afterItem) {
        super(aggregateId, 'StructureSourceItemEditedAggregateEvent');
        this.beforeItem = beforeItem;
        this.afterItem = afterItem;
    }
    toDomainEvent() {
        return new StructureSourceItemEditedEvent(this.getAggregateId(), this.beforeItem, this.afterItem);
    }
    getBeforeItem() {
        return this.beforeItem;
    }
    getAfterItem() {
        return this.afterItem;
    }
}

class StructureOriginChangedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId, origin) {
        super(aggregateId, 'StructureOriginChangedAggregateEvent');
        this.origin = origin;
    }
    toDomainEvent() {
        return new OriginSetEvent(this.getAggregateId(), this.origin);
    }
    getOrigin() {
        return this.origin;
    }
}

class OriginId extends EntityId {
    constructor(id) {
        super(id);
    }
    toString() {
        return this.getId();
    }
}

class SourceManager {
    constructor(formationManager) {
        this.loading = false;
        this.fetched = false;
        this.entities = [];
        // Entities after filtering, searching
        this.preparedEntities = [];
        this.slicedEntities = [];
        this.formationManager = formationManager;
    }
    isLoading() {
        return this.loading;
    }
    isFetched() {
        return this.fetched;
    }
    setLoading(enabled) {
        this.loading = enabled;
    }
    setEntities(ent) {
        this.entities = ent;
        this.recalculatePositions();
    }
    getEntities() {
        return this.entities;
    }
    setPreparedEntities() {
        this.preparedEntities = Array.from(this.entities);
    }
    getPreparedEntities() {
        return this.preparedEntities;
    }
    setSlicedEntities(ent) {
        this.slicedEntities = ent;
    }
    getSlicedEntities() {
        return this.slicedEntities;
    }
    setOrigin(items = [], structureId) {
        this.origin = this.convertItems(items);
        return this.createOriginChangedEvent(structureId);
    }
    setConvertedOrigin(items = [], structureId) {
        this.origin = Array.from(items);
        return this.createOriginChangedEvent(structureId);
    }
    getOrigin() {
        return this.origin;
    }
    getOriginSize() {
        return this.origin.length;
    }
    // editOriginItemByProperty(byField, value: any, field: Field, structureId: StructureId): AggregateEvent {
    //
    // }
    editOriginItem(itemId, value, field, structureId) {
        const item = this.findOriginItem(itemId), itemBeforeChange = item.clone();
        if (item) {
            item.sourceItem[field.getAccessor()] = value;
            item.bumpVersion();
        }
        return [
            new StructureSourceItemEditedAggregateEvent(structureId, itemBeforeChange, item.clone()),
            this.createOriginChangedEvent(structureId)
        ];
    }
    deleteAllSelected(structureId) {
        let events = [];
        const rows = this.formationManager.getSelectedRows();
        rows.forEach((r) => {
            events = events.concat(this.deleteOriginItemByItemId(new OriginId(r), structureId));
        });
        return events;
    }
    deleteOriginItem(payload, structureId) {
        if (payload instanceof OriginId) {
            return this.deleteOriginItemByItemId(payload, structureId);
        }
        else if (Array.isArray(payload)) {
            let events = [];
            payload.forEach((item) => {
                events = events.concat(this.deleteOneOriginItem(item, structureId));
            });
            return events;
        }
        else if (Number.isInteger(payload)) {
            return this.deleteOriginItemByIndex(payload, structureId);
        }
        else {
            return [];
        }
    }
    addOriginItem(item, structureId) {
        this.origin.push(item);
        return [this.createOriginChangedEvent(structureId)];
    }
    selectAll() {
        this.formationManager.selectAll(this.getEntities().map(e => e.getId().toString()));
    }
    unselectAll() {
        this.formationManager.unselectAll();
    }
    toggleRow(itemId, type) {
        this.formationManager.toggleRow(itemId, type, this.getEntities().map(e => e.getId().toString()));
    }
    getFormation() {
        return this.formationManager;
    }
    convertItems(items) {
        return items.map((item, index) => {
            return new OriginItemEntity(new OriginId(RandomStringGenerator.generate()), item, index);
        });
    }
    createOriginChangedEvent(structureId) {
        return new StructureOriginChangedAggregateEvent(structureId, this.origin);
    }
    findOriginItem(itemId) {
        return this.origin.find((item) => item.getId().toString() === itemId);
    }
    findOriginItemIndex(itemId) {
        return this.origin.findIndex((item) => item.getId().toString() === itemId);
    }
    recalculatePositions() {
        this.entities.forEach((ent, index) => {
            ent.setPosition(index);
        });
    }
    deleteOneOriginItem(item, structureId) {
        if (item instanceof OriginId) {
            return this.deleteOriginItemByItemId(item, structureId);
        }
        else if (Number.isInteger(item)) {
            return this.deleteOriginItemByIndex(item, structureId);
        }
        else {
            return [];
        }
    }
    deleteOriginItemByItemId(itemId, structureId) {
        const index = this.findOriginItemIndex(itemId.toString());
        return this.deleteOriginItemByIndex(index, structureId);
    }
    deleteOriginItemByIndex(index, structureId) {
        if (index > -1) {
            const removedElements = this.origin.splice(index, 1);
            if (removedElements.length > 0) {
                for (const element of removedElements) {
                    this.formationManager.unselectRow(element.getId().toString());
                }
                this.formationManager.calculateAllSelected(removedElements.map((f) => f.getId().toString()));
                this.formationManager.calculateAllUnselected();
            }
            return [
                this.createOriginChangedEvent(structureId)
            ];
        }
        return [];
    }
    deleteManyOriginItemByIndex(indexes, structureId) {
        let events = [];
        indexes.forEach((index) => {
            events = events.concat(this.deleteOriginItemByIndex(index, structureId));
        });
        return events;
    }
    deleteManyOriginItemByItemID(itemIds, structureId) {
        let events = [];
        itemIds.forEach((itemId) => {
            events = events.concat(this.deleteOriginItemByItemId(itemId, structureId));
        });
        return events;
    }
}

var RowSelectToggleType;
(function (RowSelectToggleType) {
    RowSelectToggleType[RowSelectToggleType["NONE"] = 0] = "NONE";
    RowSelectToggleType[RowSelectToggleType["ADD"] = 1] = "ADD";
    RowSelectToggleType[RowSelectToggleType["RANGE"] = 2] = "RANGE";
})(RowSelectToggleType || (RowSelectToggleType = {}));

class FormationManager {
    constructor(selectedRows) {
        this.enabled = true;
        this.mode = RowSelectionMode.SINGLE;
        this.selectedRows = selectedRows;
    }
    isAllSelected() {
        return this.allSelected;
    }
    isAllUnselected() {
        return this.allUnselected;
    }
    setSelection(enabled) {
        this.enabled = enabled;
    }
    setMode(mode) {
        this.mode = mode;
    }
    getSelectedRows() {
        return Array.from(this.selectedRows);
    }
    selectAll(allItemIds) {
        this.selectedRows = new Set(allItemIds);
        this.allSelected = true;
        this.allUnselected = false;
    }
    unselectAll() {
        this.selectedRows.clear();
        this.allSelected = false;
        this.allUnselected = true;
    }
    toggleRow(itemId, type, allItemIds) {
        if (!this.enabled) {
            return;
        }
        if (type === RowSelectToggleType.ADD && this.mode === RowSelectionMode.SINGLE) {
            type = RowSelectToggleType.NONE;
        }
        switch (type) {
            case RowSelectToggleType.NONE:
                if (this.selectedRows.has(itemId)) {
                    this.selectedRows.delete(itemId);
                }
                else {
                    this.selectedRows.clear();
                    this.selectedRows.add(itemId);
                }
                break;
            case RowSelectToggleType.ADD:
                if (this.selectedRows.has(itemId)) {
                    this.selectedRows.delete(itemId);
                }
                else {
                    this.selectedRows.add(itemId);
                }
                break;
            case RowSelectToggleType.RANGE:
                break;
            default:
                break;
        }
        this.calculateAllSelected(allItemIds);
        this.calculateAllUnselected();
    }
    calculateAllSelected(allItemIds) {
        if (allItemIds.length !== this.selectedRows.size) {
            this.allSelected = false;
        }
        else {
            const rows = Array.from(this.selectedRows);
            let equal = true;
            rows.sort();
            allItemIds.sort();
            for (let i = 0; i < rows.length; i += 1) {
                if (rows[i] !== allItemIds[i]) {
                    equal = false;
                    break;
                }
            }
            this.allSelected = equal;
        }
    }
    calculateAllUnselected() {
        this.allUnselected = this.selectedRows.size === 0;
    }
    unselectRow(itemId) {
        if (this.selectedRows.has(itemId)) {
            this.selectedRows.delete(itemId);
        }
    }
}

class FormationManagerFactory {
    create() {
        return new FormationManager(new Set());
    }
}
FormationManagerFactory.ɵfac = function FormationManagerFactory_Factory(t) { return new (t || FormationManagerFactory)(); };
FormationManagerFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FormationManagerFactory, factory: FormationManagerFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FormationManagerFactory, [{
        type: Injectable
    }], null, null); })();

class SourceManagerFactory {
    constructor(formationManagerFactory) {
        this.formationManagerFactory = formationManagerFactory;
    }
    createDefault() {
        const fm = this.formationManagerFactory.create();
        return new SourceManager(fm);
    }
    create() {
        const fm = this.formationManagerFactory.create();
        return new SourceManager(fm);
    }
}
SourceManagerFactory.ɵfac = function SourceManagerFactory_Factory(t) { return new (t || SourceManagerFactory)(i0.ɵɵinject(FormationManagerFactory)); };
SourceManagerFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceManagerFactory, factory: SourceManagerFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceManagerFactory, [{
        type: Injectable
    }], function () { return [{ type: FormationManagerFactory }]; }, null); })();

class SetEnabledSelectionCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetEnabledSelectionCommand;
    }
    handle(aggregate, command) {
        aggregate.setSelection(command.isEnabled());
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SetEnabledSelectionCommandHandler.ɵfac = function SetEnabledSelectionCommandHandler_Factory(t) { return new (t || SetEnabledSelectionCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetEnabledSelectionCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetEnabledSelectionCommandHandler, factory: SetEnabledSelectionCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetEnabledSelectionCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class ToggleSelectedRowCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return ToggleSelectedRowCommand;
    }
    handle(aggregate, command) {
        const selectedRow = command.getSelectedRow(), type = command.getType();
        aggregate.toggleRow(selectedRow, type);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
ToggleSelectedRowCommandHandler.ɵfac = function ToggleSelectedRowCommandHandler_Factory(t) { return new (t || ToggleSelectedRowCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
ToggleSelectedRowCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ToggleSelectedRowCommandHandler, factory: ToggleSelectedRowCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ToggleSelectedRowCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class RowSelectedReadModel {
    constructor(itemIds, allSelected, allUnselected) {
        this.itemIds = new Array();
        this.itemIds = itemIds;
        this.allSelected = allSelected;
        this.allUnselected = allUnselected;
    }
    getAll() {
        return this.itemIds;
    }
    isSelected(id) {
        return this.itemIds.some((itemId) => itemId === id);
    }
    isAllSelected() {
        return this.allSelected;
    }
    isAllUnselected() {
        return this.allUnselected;
    }
    isIndeterminate() {
        return !(this.isAllSelected() || this.isAllUnselected());
    }
}

class RowSelectedRepository extends AggregateArchive {
    constructor() {
        super();
    }
}
RowSelectedRepository.ɵfac = function RowSelectedRepository_Factory(t) { return new (t || RowSelectedRepository)(); };
RowSelectedRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: RowSelectedRepository, factory: RowSelectedRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(RowSelectedRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SelectedRowChangedEventHandler {
    constructor(rowSelectedRepository) {
        this.rowSelectedRepository = rowSelectedRepository;
    }
    forEvent() {
        return SelectedRowChangedEvent;
    }
    handle(rowChangedEvent) {
        if (rowChangedEvent.ofMessageType('SelectedRowChangedEvent')) {
            const rowSelectedRead = new RowSelectedReadModel(rowChangedEvent.getSelectedRows(), rowChangedEvent.isAllSelected(), rowChangedEvent.isAllUnselected());
            this.rowSelectedRepository.next(rowChangedEvent.getAggregateId(), rowSelectedRead);
        }
    }
}
SelectedRowChangedEventHandler.ɵfac = function SelectedRowChangedEventHandler_Factory(t) { return new (t || SelectedRowChangedEventHandler)(i0.ɵɵinject(RowSelectedRepository)); };
SelectedRowChangedEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SelectedRowChangedEventHandler, factory: SelectedRowChangedEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SelectedRowChangedEventHandler, [{
        type: Injectable
    }], function () { return [{ type: RowSelectedRepository }]; }, null); })();

class SetSelectionModeCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetSelectionModeCommand;
    }
    handle(aggregate, command) {
        aggregate.setSelectionMode(command.getMode());
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SetSelectionModeCommandHandler.ɵfac = function SetSelectionModeCommandHandler_Factory(t) { return new (t || SetSelectionModeCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetSelectionModeCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetSelectionModeCommandHandler, factory: SetSelectionModeCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetSelectionModeCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SelectAllRowsCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SelectAllRowsCommand;
    }
    handle(aggregate, command) {
        aggregate.selectAll();
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SelectAllRowsCommandHandler.ɵfac = function SelectAllRowsCommandHandler_Factory(t) { return new (t || SelectAllRowsCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SelectAllRowsCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SelectAllRowsCommandHandler, factory: SelectAllRowsCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SelectAllRowsCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class UnselectAllRowsCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return UnselectAllRowsCommand;
    }
    handle(aggregate, command) {
        aggregate.unselectAll();
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
UnselectAllRowsCommandHandler.ɵfac = function UnselectAllRowsCommandHandler_Factory(t) { return new (t || UnselectAllRowsCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
UnselectAllRowsCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: UnselectAllRowsCommandHandler, factory: UnselectAllRowsCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UnselectAllRowsCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class SelectionModeSetEvent extends StructureDomainEvent {
    constructor(aggregateId, mode) {
        super(aggregateId, mode, 'SelectionModeSetEvent');
        this.mode = mode;
    }
    getMode() {
        return this.mode;
    }
}

class RowSelectionModeRepository extends AggregateArchive {
    constructor() {
        super();
    }
}
RowSelectionModeRepository.ɵfac = function RowSelectionModeRepository_Factory(t) { return new (t || RowSelectionModeRepository)(); };
RowSelectionModeRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: RowSelectionModeRepository, factory: RowSelectionModeRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(RowSelectionModeRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SelectionModeSetEventHandler {
    constructor(rowSelectionModeRepository) {
        this.rowSelectionModeRepository = rowSelectionModeRepository;
    }
    forEvent() {
        return SelectionModeSetEvent;
    }
    handle(modeSetEvent) {
        if (modeSetEvent.ofMessageType('SelectionModeSetEvent')) {
            this.rowSelectionModeRepository.next(modeSetEvent.getAggregateId(), modeSetEvent.getMode());
        }
    }
}
SelectionModeSetEventHandler.ɵfac = function SelectionModeSetEventHandler_Factory(t) { return new (t || SelectionModeSetEventHandler)(i0.ɵɵinject(RowSelectionModeRepository)); };
SelectionModeSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SelectionModeSetEventHandler, factory: SelectionModeSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SelectionModeSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: RowSelectionModeRepository }]; }, null); })();

var DeleteCommandPayloadType;
(function (DeleteCommandPayloadType) {
    DeleteCommandPayloadType[DeleteCommandPayloadType["INDEX"] = 0] = "INDEX";
    DeleteCommandPayloadType[DeleteCommandPayloadType["ITEM_ID"] = 1] = "ITEM_ID";
    DeleteCommandPayloadType[DeleteCommandPayloadType["MANY_INDEX"] = 2] = "MANY_INDEX";
    DeleteCommandPayloadType[DeleteCommandPayloadType["MANY_ITEM_ID"] = 3] = "MANY_ITEM_ID";
})(DeleteCommandPayloadType || (DeleteCommandPayloadType = {}));
class DeleteOriginItemCommand extends StructureCommand {
    constructor(structureId, payload, type) {
        super(structureId, 'DeleteOriginItemCommand');
        this.payload = payload;
        this.type = type;
    }
    static byIndex(structureId, index) {
        return new DeleteOriginItemCommand(structureId, index, DeleteCommandPayloadType.INDEX);
    }
    static byManyIndex(structureId, indexes) {
        return new DeleteOriginItemCommand(structureId, indexes, DeleteCommandPayloadType.MANY_INDEX);
    }
    static byItemId(structureId, itemId) {
        return new DeleteOriginItemCommand(structureId, itemId, DeleteCommandPayloadType.ITEM_ID);
    }
    static byManyItemId(structureId, itemIds) {
        return new DeleteOriginItemCommand(structureId, itemIds, DeleteCommandPayloadType.MANY_ITEM_ID);
    }
    getType() {
        return this.type;
    }
    getPayload() {
        return this.payload;
    }
}

class DeleteOriginItemCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return DeleteOriginItemCommand;
    }
    handle(aggregate, command) {
        aggregate.deleteItem(command.getPayload());
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
DeleteOriginItemCommandHandler.ɵfac = function DeleteOriginItemCommandHandler_Factory(t) { return new (t || DeleteOriginItemCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
DeleteOriginItemCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: DeleteOriginItemCommandHandler, factory: DeleteOriginItemCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DeleteOriginItemCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class StructureSourceOriginArchive extends AggregateArchive {
    constructor() {
        super(StructureSourceOriginArchive.default);
    }
}
StructureSourceOriginArchive.default = [];
StructureSourceOriginArchive.ɵfac = function StructureSourceOriginArchive_Factory(t) { return new (t || StructureSourceOriginArchive)(); };
StructureSourceOriginArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureSourceOriginArchive, factory: StructureSourceOriginArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSourceOriginArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructureOriginChangedEventHandler {
    constructor(structureSourceOriginRepository) {
        this.structureSourceOriginRepository = structureSourceOriginRepository;
    }
    forEvent() {
        return OriginSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('OriginSetEvent')) {
            const origin = event.getOrigin();
            this.structureSourceOriginRepository.next(event.getAggregateId(), origin);
        }
    }
}
StructureOriginChangedEventHandler.ɵfac = function StructureOriginChangedEventHandler_Factory(t) { return new (t || StructureOriginChangedEventHandler)(i0.ɵɵinject(StructureSourceOriginArchive)); };
StructureOriginChangedEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureOriginChangedEventHandler, factory: StructureOriginChangedEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureOriginChangedEventHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureSourceOriginArchive }]; }, null); })();

class StructurePreparedItemsArchive extends AggregateArchive {
    constructor() {
        super(StructurePreparedItemsArchive.default);
    }
    /**
     * @deprecated
     */
    getPreparedItems(structureId) {
        return this.get(structureId).getValueOrNullOrThrowError();
    }
}
StructurePreparedItemsArchive.default = [];
StructurePreparedItemsArchive.ɵfac = function StructurePreparedItemsArchive_Factory(t) { return new (t || StructurePreparedItemsArchive)(); };
StructurePreparedItemsArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructurePreparedItemsArchive, factory: StructurePreparedItemsArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructurePreparedItemsArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructurePreparedItemsEventHandler {
    constructor(structurePreparedItemsRepository) {
        this.structurePreparedItemsRepository = structurePreparedItemsRepository;
    }
    forEvent() {
        return StructurePreparedEntitiesSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('StructurePreparedEntitiesSetEvent')) {
            const preparedItems = event.getPreparedItems();
            this.structurePreparedItemsRepository.next(event.getAggregateId(), preparedItems);
        }
    }
}
StructurePreparedItemsEventHandler.ɵfac = function StructurePreparedItemsEventHandler_Factory(t) { return new (t || StructurePreparedItemsEventHandler)(i0.ɵɵinject(StructurePreparedItemsArchive)); };
StructurePreparedItemsEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructurePreparedItemsEventHandler, factory: StructurePreparedItemsEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructurePreparedItemsEventHandler, [{
        type: Injectable
    }], function () { return [{ type: StructurePreparedItemsArchive }]; }, null); })();

class SourceDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SourceSetLoadingCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetOriginCommandHandler, structureKey),
            HermesModule.registerCommandHandler(StructureEditSourceItemCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetEnabledSelectionCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetSelectionModeCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SelectAllRowsCommandHandler, structureKey),
            HermesModule.registerCommandHandler(UnselectAllRowsCommandHandler, structureKey),
            HermesModule.registerCommandHandler(DeleteOriginItemCommandHandler, structureKey),
            HermesModule.registerCommandHandler(ToggleSelectedRowCommandHandler, structureKey)
        ];
    }
    static domainEventHandlers() {
        return [
            HermesModule.registerDomainEventHandler(StructureOriginChangedEventHandler),
            HermesModule.registerDomainEventHandler(SelectedRowChangedEventHandler),
            HermesModule.registerDomainEventHandler(SelectionModeSetEventHandler),
            HermesModule.registerDomainEventHandler(StructurePreparedItemsEventHandler)
        ];
    }
}
SourceDomainModule.ɵfac = function SourceDomainModule_Factory(t) { return new (t || SourceDomainModule)(); };
SourceDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SourceDomainModule });
SourceDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        SourceDispatcher,
        SourceManagerFactory,
        SourceDomainEventPublisher,
        FormationDispatcher,
        FormationManagerFactory
    ], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [
                    SourceDispatcher,
                    SourceManagerFactory,
                    SourceDomainEventPublisher,
                    FormationDispatcher,
                    FormationManagerFactory
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SourceDomainModule, { imports: [CommonModule] }); })();

class FormationWarehouse {
    constructor(rowSelectedRepository, rowSelectionModeRepository, sourceWarehouse) {
        this.rowSelectedRepository = rowSelectedRepository;
        this.rowSelectionModeRepository = rowSelectionModeRepository;
        this.sourceWarehouse = sourceWarehouse;
    }
    getSelectedRows(structureId) {
        const items = this.sourceWarehouse.getPreparedEntities(structureId), selectedItemIds = this.getSelectedItemIds(structureId);
        const selectedItems = [], length = items.length;
        for (let i = 0; i < length; i += 1) {
            const item = items[i];
            if (selectedItemIds.some((itemId) => itemId === item.getId().toString())) {
                selectedItems.push(new SelectedRow(item.getSourceItem(), i, item.getId()));
            }
        }
        return selectedItems;
    }
    onRowSelectedReadModel(structureId) {
        return this.rowSelectedRepository
            .on(structureId);
    }
    getSelectedItemIds(structureId) {
        return this.rowSelectedRepository.get(structureId).getValueOrNullOrThrowError().getAll();
    }
    onSelectedRows(structureId) {
        return this.rowSelectedRepository
            .on(structureId)
            .pipe(hermesMap((rm) => {
            return rm.getAll();
        }));
    }
    onMode(structureId) {
        return this.rowSelectionModeRepository.on(structureId);
    }
}
FormationWarehouse.ɵfac = function FormationWarehouse_Factory(t) { return new (t || FormationWarehouse)(i0.ɵɵinject(RowSelectedRepository), i0.ɵɵinject(RowSelectionModeRepository), i0.ɵɵinject(SourceWarehouse)); };
FormationWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: FormationWarehouse, factory: FormationWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FormationWarehouse, [{
        type: Injectable
    }], function () { return [{ type: RowSelectedRepository }, { type: RowSelectionModeRepository }, { type: SourceWarehouse }]; }, null); })();

class SourceDomainWarehouse extends SourceWarehouse {
    constructor(structureRepository, structurePreparedItemsRepository, structureSourceOriginRepository) {
        super();
        this.structureRepository = structureRepository;
        this.structurePreparedItemsRepository = structurePreparedItemsRepository;
        this.structureSourceOriginRepository = structureSourceOriginRepository;
    }
    /**
     * @deprecated
     */
    getEntities(structureId) {
        return this.structureRepository.getStructure(structureId).getEntities();
    }
    onEntities(structureId) {
        return this.structureRepository
            .on(structureId)
            .pipe(hermesMap((structure) => structure.getEntities()), hermesDistinctUntilChanged((ents1, ents2) => {
            if (ents1.length !== ents2.length) {
                return false;
            }
            let flag = true;
            ents1.forEach((ent, index) => {
                if (!ent.equals(ents2[index])) {
                    flag = false;
                    return;
                }
            });
            return flag;
        }));
    }
    onEntitiesSize(structureId) {
        return this.onEntities(structureId)
            .pipe(hermesMap((entities) => {
            return entities.length;
        }));
    }
    onceEntities(structureId) {
        return this.onEntities(structureId)
            .pipe(hermesTake(1));
    }
    onOriginSize(structureId) {
        return this.structureSourceOriginRepository
            .on(structureId)
            .pipe(hermesMap(origin => origin.length));
    }
    onLoading(structureId) {
        return this.structureRepository
            .on(structureId)
            .pipe(hermesMap((structure) => structure.getSource().isLoading()));
    }
    onPreparedEntities(structureId) {
        return this.structurePreparedItemsRepository.on(structureId);
    }
    /**
     * @deprecated
     */
    getPreparedEntities(structureId) {
        return this.structurePreparedItemsRepository.getPreparedItems(structureId);
    }
}
SourceDomainWarehouse.ɵfac = function SourceDomainWarehouse_Factory(t) { return new (t || SourceDomainWarehouse)(i0.ɵɵinject(StructureReadModelRepository), i0.ɵɵinject(StructurePreparedItemsArchive), i0.ɵɵinject(StructureSourceOriginArchive)); };
SourceDomainWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceDomainWarehouse, factory: SourceDomainWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceDomainWarehouse, [{
        type: Injectable
    }], function () { return [{ type: StructureReadModelRepository }, { type: StructurePreparedItemsArchive }, { type: StructureSourceOriginArchive }]; }, null); })();

class StructureEditSourceItemParams {
    constructor(itemId, columnFieldId, // TODO Rethink
    value) {
        this.itemId = itemId;
        this.columnFieldId = columnFieldId;
        this.value = value;
    }
    getItemId() {
        return this.itemId;
    }
    getColumnFieldId() {
        return this.columnFieldId;
    }
    getValue() {
        return this.value;
    }
}

class SourceDomainCommandInvoker extends SourceCommandInvoker {
    constructor(commandDispatcher, sourceDispatcher, fieldWarehouse, sourceReadModelService) {
        super();
        this.commandDispatcher = commandDispatcher;
        this.sourceDispatcher = sourceDispatcher;
        this.fieldWarehouse = fieldWarehouse;
        this.sourceReadModelService = sourceReadModelService;
    }
    setOrigin(items, structureId) {
        this.sourceDispatcher.setOrigin(structureId, items);
    }
    setLoading(enabled, structureId) {
        this.sourceDispatcher.setLoading(structureId, enabled);
    }
    editItem(params, structureId) {
        this.sourceDispatcher.editItem(structureId, params);
    }
    editItemByIndex(itemIndex, fieldIndex, value, structureId) {
        const itemId$ = toRxJsObservable(this.sourceReadModelService
            .onceEntities(structureId)
            .pipe(hermesMap((entities) => {
            return entities[itemIndex].getId();
        })));
        const fieldId$ = toRxJsObservable(this.fieldWarehouse.onFields(structureId));
        fromRxJsObservable(zip(itemId$, fieldId$))
            .pipe(hermesTake(1))
            .subscribe((array) => {
            const itemId = array[0], fields = array[1];
            this.editItem(new StructureEditSourceItemParams(itemId, fields[fieldIndex], value), structureId);
        });
    }
    deleteRow(row, structureId) {
        if (row.getItemId() !== undefined) {
            this.deleteItemById(row.getItemId(), structureId);
        }
        else if (row.getIndex() !== undefined) {
            this.deleteItemByIndex(row.getIndex(), structureId);
        }
    }
    deleteRows(rows, structureId) {
        if (rows.length > 0) {
            if (rows[0].getItemId() !== undefined) {
                this.deleteManyItemsByItemIds(rows.map(r => r.getItemId()), structureId);
            }
            else if (rows[0].getIndex() !== undefined) {
                this.deleteManyItemsByIndex(rows.map(r => r.getIndex()), structureId);
            }
        }
    }
    deleteItemByIndex(index, structureId) {
        this.commandDispatcher.dispatch(DeleteOriginItemCommand.byIndex(structureId, index));
    }
    deleteItemById(itemId, structureId) {
        this.commandDispatcher.dispatch(DeleteOriginItemCommand.byItemId(structureId, itemId));
    }
    deleteManyItemsByIndex(indexes, structureId) {
        this.commandDispatcher.dispatch(DeleteOriginItemCommand.byManyIndex(structureId, indexes));
    }
    deleteManyItemsByItemIds(itemIds, structureId) {
        this.commandDispatcher.dispatch(DeleteOriginItemCommand.byManyItemId(structureId, itemIds));
    }
}
SourceDomainCommandInvoker.ɵfac = function SourceDomainCommandInvoker_Factory(t) { return new (t || SourceDomainCommandInvoker)(i0.ɵɵinject(i1$1.CommandDispatcher), i0.ɵɵinject(SourceDispatcher), i0.ɵɵinject(FieldWarehouse), i0.ɵɵinject(SourceWarehouse)); };
SourceDomainCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SourceDomainCommandInvoker, factory: SourceDomainCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceDomainCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }, { type: SourceDispatcher }, { type: FieldWarehouse }, { type: SourceWarehouse }]; }, null); })();

class SourceApiModule extends ApiModule {
}
SourceApiModule.ɵfac = /*@__PURE__*/ function () { let ɵSourceApiModule_BaseFactory; return function SourceApiModule_Factory(t) { return (ɵSourceApiModule_BaseFactory || (ɵSourceApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(SourceApiModule)))(t || SourceApiModule); }; }();
SourceApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SourceApiModule });
SourceApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        StructureSourceOriginArchive,
        StructurePreparedItemsArchive,
        SourceConverter,
        {
            provide: SourceCommandInvoker,
            useClass: SourceDomainCommandInvoker
        },
        {
            provide: SourceWarehouse,
            useClass: SourceDomainWarehouse
        },
        SourceEventService,
        RowSelectedRepository,
        FormationEventRepository,
        FormationCommandInvoker,
        FormationWarehouse,
        RowSelectionModeRepository
    ], imports: [[
            CommonModule,
            SourceDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    SourceDomainModule
                ],
                providers: [
                    StructureSourceOriginArchive,
                    StructurePreparedItemsArchive,
                    SourceConverter,
                    {
                        provide: SourceCommandInvoker,
                        useClass: SourceDomainCommandInvoker
                    },
                    {
                        provide: SourceWarehouse,
                        useClass: SourceDomainWarehouse
                    },
                    SourceEventService,
                    RowSelectedRepository,
                    FormationEventRepository,
                    FormationCommandInvoker,
                    FormationWarehouse,
                    RowSelectionModeRepository
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SourceApiModule, { imports: [CommonModule,
        SourceDomainModule] }); })();

class SourceFeatureModule extends FeatureModule {
    static forComponent() {
        return [
            RowSelectionTypeArchive
        ];
    }
}
SourceFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵSourceFeatureModule_BaseFactory; return function SourceFeatureModule_Factory(t) { return (ɵSourceFeatureModule_BaseFactory || (ɵSourceFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(SourceFeatureModule)))(t || SourceFeatureModule); }; }();
SourceFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SourceFeatureModule });
SourceFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            SourceApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    SourceApiModule
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SourceFeatureModule, { imports: [CommonModule,
        SourceApiModule] }); })();

class SchemaDomainEvent extends DomainEvent {
}

class SchemaThemeSetEvent extends SchemaDomainEvent {
    constructor(schemaId, theme) {
        super(schemaId, theme, 'SchemaThemeSetEvent');
        this.theme = theme;
    }
    getTheme() {
        return this.theme;
    }
}

class SchemaAggregateEvent extends AggregateEvent {
}

class SchemaThemeSetAggregateEvent extends SchemaAggregateEvent {
    constructor(schemaId, theme) {
        super(schemaId, 'SchemaThemeSetAggregateEvent');
        this.theme = theme;
    }
    toDomainEvent() {
        return new SchemaThemeSetEvent(this.getAggregateId(), this.theme);
    }
}

class RowColoringSetEvent extends SchemaDomainEvent {
    constructor(schemaId, rowColoring) {
        super(schemaId, rowColoring, 'RowColoringSetEvent');
        this.rowColoring = rowColoring;
    }
    getRowColoring() {
        return this.rowColoring;
    }
}

class RowColoringSetAggregateEvent extends SchemaAggregateEvent {
    constructor(schemaId, rowColoring) {
        super(schemaId, 'RowColoringSetEvent');
        this.rowColoring = rowColoring;
    }
    toDomainEvent() {
        return new RowColoringSetEvent(this.getAggregateId(), this.rowColoring);
    }
}

class SchemaVerticalGridSetEvent extends SchemaDomainEvent {
    constructor(schemaId, verticalGrid) {
        super(schemaId, verticalGrid, 'SchemaVerticalGridSetEvent');
        this.verticalGrid = verticalGrid;
    }
    getVerticalGrid() {
        return this.verticalGrid;
    }
}

class SchemaVerticalGridSetAggregateEvent extends SchemaAggregateEvent {
    constructor(schemaId, verticalGrid) {
        super(schemaId, 'SchemaHorizontalGridSetEvent');
        this.verticalGrid = verticalGrid;
    }
    toDomainEvent() {
        return new SchemaVerticalGridSetEvent(this.getAggregateId(), this.verticalGrid);
    }
}

class SchemaHorizontalGridSetEvent extends SchemaDomainEvent {
    constructor(schemaId, horizontalGrid) {
        super(schemaId, horizontalGrid, 'SchemaHorizontalGridSetEvent');
        this.horizontalGrid = horizontalGrid;
    }
    getHorizontalGrid() {
        return this.horizontalGrid;
    }
}

class SchemaHorizontalGridSetAggregateEvent extends SchemaAggregateEvent {
    constructor(schemaId, horizontalGrid) {
        super(schemaId, 'SchemaHorizontalGridSetEvent');
        this.horizontalGrid = horizontalGrid;
    }
    toDomainEvent() {
        return new SchemaHorizontalGridSetEvent(this.getAggregateId(), this.horizontalGrid);
    }
}

class SchemaCreatedEvent extends SchemaDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'SchemaCreatedEvent');
    }
}

class SchemaCreatedAggregateEvent extends SchemaAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'SchemaCreatedAggregateEvent');
    }
    toDomainEvent() {
        return new SchemaCreatedEvent(this.getAggregateId());
    }
}

class SchemaAggregate extends AggregateRoot {
    constructor(id) {
        super(id, 'SchemaAggregate');
        this.setTheme(SchemaAggregate.DEFAULT_THEME);
        this.setHorizontalGrid(SchemaAggregate.DEFAULT_HORIZONTAL_GRID);
        this.setVerticalGrid(SchemaAggregate.DEFAULT_VERTICAL_GRID);
        this.setRowColoring(SchemaAggregate.DEFAULT_ROW_COLORING);
    }
    createEvent() {
        return SchemaCreatedAggregateEvent;
    }
    changeTheme(theme) {
        this.setTheme(theme);
        if (theme === SchemaTheme.MATERIAL) {
            this.setRowColoring(SchemaRowColoring.NONE);
            this.setVerticalGrid(false);
        }
        if (theme === SchemaTheme.LIGHT) {
            this.setRowColoring(SchemaRowColoring.NONE);
            this.setVerticalGrid(false);
        }
        if (theme === SchemaTheme.DARK) {
            this.setRowColoring(SchemaRowColoring.NONE);
            this.setVerticalGrid(false);
        }
        if (theme === SchemaTheme.GENERIC) {
            this.setRowColoring(SchemaRowColoring.ODD);
        }
    }
    setRowColoring(coloring) {
        this.rowColoring = coloring;
        this.addEvent(new RowColoringSetAggregateEvent(this.getId(), this.rowColoring));
    }
    setVerticalGrid(enabled) {
        this.verticalGrid = enabled;
        this.addEvent(new SchemaVerticalGridSetAggregateEvent(this.getId(), this.verticalGrid));
    }
    setHorizontalGrid(enabled) {
        this.horizontalGrid = enabled;
        this.addEvent(new SchemaHorizontalGridSetAggregateEvent(this.getId(), this.horizontalGrid));
    }
    setTheme(theme) {
        this.theme = theme;
        this.addEvent(new SchemaThemeSetAggregateEvent(this.getId(), this.theme));
    }
}
SchemaAggregate.DEFAULT_THEME = SchemaTheme.GENERIC;
SchemaAggregate.DEFAULT_ROW_COLORING = SchemaRowColoring.ODD;
SchemaAggregate.DEFAULT_VERTICAL_GRID = true;
SchemaAggregate.DEFAULT_HORIZONTAL_GRID = true;

class SchemaAggregateFactory extends AggregateFactory {
    constructor() {
        super();
    }
    create(aggregateId) {
        return new SchemaAggregate(aggregateId);
    }
}
SchemaAggregateFactory.ɵfac = function SchemaAggregateFactory_Factory(t) { return new (t || SchemaAggregateFactory)(); };
SchemaAggregateFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaAggregateFactory, factory: SchemaAggregateFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaAggregateFactory, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaAggregateRepository extends AggregateRepository {
}

class InMemorySchemaStore extends InMemoryStore {
}
InMemorySchemaStore.ɵfac = /*@__PURE__*/ function () { let ɵInMemorySchemaStore_BaseFactory; return function InMemorySchemaStore_Factory(t) { return (ɵInMemorySchemaStore_BaseFactory || (ɵInMemorySchemaStore_BaseFactory = i0.ɵɵgetInheritedFactory(InMemorySchemaStore)))(t || InMemorySchemaStore); }; }();
InMemorySchemaStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemorySchemaStore, factory: InMemorySchemaStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemorySchemaStore, [{
        type: Injectable
    }], null, null); })();

class InMemorySchemaAggregateStore extends InMemoryAggregateStore {
    constructor(inMemorySchemaStore, aggregateStoreRegister) {
        super(inMemorySchemaStore, aggregateStoreRegister);
    }
}
InMemorySchemaAggregateStore.ɵfac = function InMemorySchemaAggregateStore_Factory(t) { return new (t || InMemorySchemaAggregateStore)(i0.ɵɵinject(InMemorySchemaStore), i0.ɵɵinject(i1$1.AggregateStoreRegister)); };
InMemorySchemaAggregateStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemorySchemaAggregateStore, factory: InMemorySchemaAggregateStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemorySchemaAggregateStore, [{
        type: Injectable
    }], function () { return [{ type: InMemorySchemaStore }, { type: i1$1.AggregateStoreRegister }]; }, null); })();

class InMemorySchemaAggregateRepository extends SchemaAggregateRepository {
    constructor(inMemorySchemaAggregateStore) {
        super();
        this.inMemorySchemaAggregateStore = inMemorySchemaAggregateStore;
    }
    findById(schemaId) {
        return this.inMemorySchemaAggregateStore.findById(schemaId);
    }
    save(schemaAggregate) {
        this.inMemorySchemaAggregateStore.save(schemaAggregate);
    }
}
InMemorySchemaAggregateRepository.ɵfac = function InMemorySchemaAggregateRepository_Factory(t) { return new (t || InMemorySchemaAggregateRepository)(i0.ɵɵinject(InMemorySchemaAggregateStore)); };
InMemorySchemaAggregateRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemorySchemaAggregateRepository, factory: InMemorySchemaAggregateRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemorySchemaAggregateRepository, [{
        type: Injectable
    }], function () { return [{ type: InMemorySchemaAggregateStore }]; }, null); })();

class CreateSchemaCommand extends CreateAggregateCommand {
    constructor(schemaId) {
        super(schemaId, 'CreateSchemaCommand');
    }
}

class CreateSchemaCommandHandler {
    forCommand() {
        return CreateSchemaCommand;
    }
}
CreateSchemaCommandHandler.ɵfac = function CreateSchemaCommandHandler_Factory(t) { return new (t || CreateSchemaCommandHandler)(); };
CreateSchemaCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CreateSchemaCommandHandler, factory: CreateSchemaCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CreateSchemaCommandHandler, [{
        type: Injectable
    }], null, null); })();

class SchemaCommand extends Command {
}

class SetSchemaThemeCommand extends SchemaCommand {
    constructor(schemaId, theme) {
        super(schemaId, 'SetSchemaThemeCommand');
        this.theme = theme;
    }
    getTheme() {
        return this.theme;
    }
}

class SetSchemaThemeCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetSchemaThemeCommand;
    }
    handle(schemaAggregate, command) {
        const theme = command.getTheme();
        schemaAggregate.changeTheme(theme);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SetSchemaThemeCommandHandler.ɵfac = function SetSchemaThemeCommandHandler_Factory(t) { return new (t || SetSchemaThemeCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetSchemaThemeCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetSchemaThemeCommandHandler, factory: SetSchemaThemeCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetSchemaThemeCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetRowColoringCommand extends SchemaCommand {
    constructor(schemaId, coloring) {
        super(schemaId, 'SetRowColoringCommand');
        this.coloring = coloring;
    }
    getColoring() {
        return this.coloring;
    }
}

class SetRowColoringCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetRowColoringCommand;
    }
    handle(schemaAggregate, command) {
        const coloring = command.getColoring();
        schemaAggregate.setRowColoring(coloring);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SetRowColoringCommandHandler.ɵfac = function SetRowColoringCommandHandler_Factory(t) { return new (t || SetRowColoringCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetRowColoringCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetRowColoringCommandHandler, factory: SetRowColoringCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetRowColoringCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetSchemaHorizontalGridCommand extends SchemaCommand {
    constructor(schemaId, enabled) {
        super(schemaId, 'SetSchemaHorizontalGridCommand');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class SetSchemaHorizontalGridCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetSchemaHorizontalGridCommand;
    }
    handle(schemaAggregate, command) {
        const enabled = command.isEnabled();
        schemaAggregate.setHorizontalGrid(enabled);
    }
    publish(schemaAggregate, command) {
        this.domainEventPublisher.publishFromAggregate(schemaAggregate);
    }
}
SetSchemaHorizontalGridCommandHandler.ɵfac = function SetSchemaHorizontalGridCommandHandler_Factory(t) { return new (t || SetSchemaHorizontalGridCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetSchemaHorizontalGridCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetSchemaHorizontalGridCommandHandler, factory: SetSchemaHorizontalGridCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetSchemaHorizontalGridCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetSchemaVerticalGridCommand extends SchemaCommand {
    constructor(schemaId, enabled) {
        super(schemaId, 'SetSchemaVerticalGridCommand');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class SetSchemaVerticalGridCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetSchemaVerticalGridCommand;
    }
    handle(schemaAggregate, command) {
        const enabled = command.isEnabled();
        schemaAggregate.setVerticalGrid(enabled);
    }
    publish(schemaAggregate, command) {
        this.domainEventPublisher.publishFromAggregate(schemaAggregate);
    }
}
SetSchemaVerticalGridCommandHandler.ɵfac = function SetSchemaVerticalGridCommandHandler_Factory(t) { return new (t || SetSchemaVerticalGridCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetSchemaVerticalGridCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetSchemaVerticalGridCommandHandler, factory: SetSchemaVerticalGridCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetSchemaVerticalGridCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SchemaCssClass {
    constructor(verticalGrid, horizontalGrid, theme, rowColoring) {
        this.verticalGrid = verticalGrid;
        this.horizontalGrid = horizontalGrid;
        this.theme = theme;
        this.rowColoring = rowColoring;
    }
    getRowColoring() {
        return this.rowColoring;
    }
}

class SchemaCssClassesRepository extends AggregateArchive {
    constructor() {
        super();
    }
}
SchemaCssClassesRepository.ɵfac = function SchemaCssClassesRepository_Factory(t) { return new (t || SchemaCssClassesRepository)(); };
SchemaCssClassesRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaCssClassesRepository, factory: SchemaCssClassesRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaCssClassesRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaCssClassesEventHandler {
    constructor(schemaCssClassesRepository) {
        this.schemaCssClassesRepository = schemaCssClassesRepository;
    }
    publish(aggregateId) {
        if (this.rowColoring !== undefined && this.horizontalGrid !== undefined && this.verticalGrid !== undefined && this.schemaTheme !== undefined) {
            this.schemaCssClassesRepository.next(aggregateId, new SchemaCssClass(this.verticalGrid, this.horizontalGrid, this.schemaTheme, this.rowColoring));
        }
    }
    forEvents() {
        return [
            SchemaThemeSetEvent,
            RowColoringSetEvent,
            SchemaHorizontalGridSetEvent,
            SchemaVerticalGridSetEvent
        ];
    }
    handle(event) {
        if (event.ofMessageType('RowColoringSetEvent')) {
            this.rowColoring = event.getRowColoring();
        }
        if (event.ofMessageType('SchemaHorizontalGridSetEvent')) {
            this.horizontalGrid = event.getHorizontalGrid();
        }
        if (event.ofMessageType('SchemaVerticalGridSetEvent')) {
            this.verticalGrid = event.getVerticalGrid();
        }
        if (event.ofMessageType('SchemaThemeSetEvent')) {
            this.schemaTheme = event.getTheme();
        }
        this.publish(event.getAggregateId());
    }
}
SchemaCssClassesEventHandler.ɵfac = function SchemaCssClassesEventHandler_Factory(t) { return new (t || SchemaCssClassesEventHandler)(i0.ɵɵinject(SchemaCssClassesRepository)); };
SchemaCssClassesEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaCssClassesEventHandler, factory: SchemaCssClassesEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaCssClassesEventHandler, [{
        type: Injectable
    }], function () { return [{ type: SchemaCssClassesRepository }]; }, null); })();

const schemaKey = 'SchemaAggregate';

class SchemaVerticalGridRepository extends EventDrivenRepository {
    constructor() {
        super();
    }
    forEvent() {
        return SchemaVerticalGridSetEvent;
    }
}
SchemaVerticalGridRepository.ɵfac = function SchemaVerticalGridRepository_Factory(t) { return new (t || SchemaVerticalGridRepository)(); };
SchemaVerticalGridRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaVerticalGridRepository, factory: SchemaVerticalGridRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaVerticalGridRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaThemeRepository extends EventDrivenRepository {
    constructor() {
        super();
    }
    forEvent() {
        return SchemaThemeSetEvent;
    }
}
SchemaThemeRepository.ɵfac = function SchemaThemeRepository_Factory(t) { return new (t || SchemaThemeRepository)(); };
SchemaThemeRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaThemeRepository, factory: SchemaThemeRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaThemeRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaRowColoringRepository extends EventDrivenRepository {
    constructor() {
        super();
    }
    forEvent() {
        return RowColoringSetEvent;
    }
}
SchemaRowColoringRepository.ɵfac = function SchemaRowColoringRepository_Factory(t) { return new (t || SchemaRowColoringRepository)(); };
SchemaRowColoringRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaRowColoringRepository, factory: SchemaRowColoringRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaRowColoringRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaHorizontalGridRepository extends EventDrivenRepository {
    constructor() {
        super();
    }
    forEvent() {
        return SchemaHorizontalGridSetEvent;
    }
}
SchemaHorizontalGridRepository.ɵfac = function SchemaHorizontalGridRepository_Factory(t) { return new (t || SchemaHorizontalGridRepository)(); };
SchemaHorizontalGridRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaHorizontalGridRepository, factory: SchemaHorizontalGridRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaHorizontalGridRepository, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SchemaDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SetSchemaThemeCommandHandler, schemaKey),
            HermesModule.registerCommandHandler(SetRowColoringCommandHandler, schemaKey),
            HermesModule.registerCommandHandler(SetSchemaHorizontalGridCommandHandler, schemaKey),
            HermesModule.registerCommandHandler(SetSchemaVerticalGridCommandHandler, schemaKey)
        ];
    }
    static domainEventHandlers() {
        return [
            HermesModule.registerDomainEventHandler(SchemaThemeRepository),
            HermesModule.registerDomainEventHandler(SchemaHorizontalGridRepository),
            HermesModule.registerDomainEventHandler(SchemaRowColoringRepository),
            HermesModule.registerDomainEventHandler(SchemaVerticalGridRepository),
            HermesModule.registerMultiDomainEventHandler(SchemaCssClassesEventHandler)
        ];
    }
}
SchemaDomainModule.ɵfac = function SchemaDomainModule_Factory(t) { return new (t || SchemaDomainModule)(); };
SchemaDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SchemaDomainModule });
SchemaDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SchemaDomainModule, { imports: [CommonModule] }); })();

class SchemaDispatcher {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    create(schemaId) {
        this.commandDispatcher.dispatch(new CreateSchemaCommand(schemaId));
    }
    setTheme(theme, schemaId) {
        this.commandDispatcher.dispatch(new SetSchemaThemeCommand(schemaId, theme));
    }
    setRowColoring(rowColoring, schemaId) {
        this.commandDispatcher.dispatch(new SetRowColoringCommand(schemaId, rowColoring));
    }
    setVerticalGrid(verticalGrid, schemaId) {
        this.commandDispatcher.dispatch(new SetSchemaVerticalGridCommand(schemaId, verticalGrid));
    }
    setHorizontalGrid(horizontalGrid, schemaId) {
        this.commandDispatcher.dispatch(new SetSchemaHorizontalGridCommand(schemaId, horizontalGrid));
    }
}
SchemaDispatcher.ɵfac = function SchemaDispatcher_Factory(t) { return new (t || SchemaDispatcher)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
SchemaDispatcher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaDispatcher, factory: SchemaDispatcher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaDispatcher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class SchemaDomainCommandInvoker extends SchemaCommandInvoker {
    constructor(schemaDispatcher, structureCommandService, fabricModalThemeService) {
        super();
        this.schemaDispatcher = schemaDispatcher;
        this.structureCommandService = structureCommandService;
        this.fabricModalThemeService = fabricModalThemeService;
    }
    create(schemaId) {
        this.schemaDispatcher.create(schemaId.toAggregateId());
    }
    setTheme(theme, schemaId, structureId) {
        this.schemaDispatcher.setTheme(theme, schemaId.toAggregateId());
        this.fabricModalThemeService.changeTheme(this.toFabricTheme(theme)); // TODO github #2162
        this.structureCommandService.setRowHeightBasedOnTheme(theme, structureId);
    }
    setRowColoring(rowColoring, schemaId) {
        const schemaRowColoring = this.toSchemaRowColoring(rowColoring);
        this.schemaDispatcher.setRowColoring(schemaRowColoring, schemaId.toAggregateId());
    }
    setVerticalGrid(verticalGrid, schemaId) {
        this.schemaDispatcher.setVerticalGrid(verticalGrid, schemaId.toAggregateId());
    }
    setHorizontalGrid(horizontalGrid, schemaId) {
        this.schemaDispatcher.setHorizontalGrid(horizontalGrid, schemaId.toAggregateId());
    }
    toSchemaRowColoring(coloring) {
        switch (coloring) {
            case RowColoring.NONE:
                return SchemaRowColoring.NONE;
            case RowColoring.ODD:
                return SchemaRowColoring.ODD;
            case RowColoring.EVEN:
                return SchemaRowColoring.EVEN;
            default:
                return SchemaRowColoring.NONE;
        }
    }
    toFabricTheme(schemaTheme) {
        switch (schemaTheme) {
            case SchemaTheme.DARK: {
                return Theme.DARK;
            }
            case SchemaTheme.FABRIC: {
                return Theme.FABRIC;
            }
            case SchemaTheme.GENERIC: {
                return Theme.GENERIC;
            }
            case SchemaTheme.LIGHT: {
                return Theme.LIGHT;
            }
            case SchemaTheme.MATERIAL: {
                return Theme.MATERIAL;
            }
            default:
                return Theme.FABRIC;
        }
    }
}
SchemaDomainCommandInvoker.ɵfac = function SchemaDomainCommandInvoker_Factory(t) { return new (t || SchemaDomainCommandInvoker)(i0.ɵɵinject(SchemaDispatcher), i0.ɵɵinject(StructureCommandInvoker), i0.ɵɵinject(i1.FabricModalThemeService)); };
SchemaDomainCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaDomainCommandInvoker, factory: SchemaDomainCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaDomainCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: SchemaDispatcher }, { type: StructureCommandInvoker }, { type: i1.FabricModalThemeService }]; }, null); })();

class SchemaDomainWarehouse extends SchemaWarehouse {
    constructor(schemaCssClassesRepository, schemaThemeRepository, schemaHorizontalGridRepository, schemaRowColoringRepository, schemaVerticalGridRepository) {
        super();
        this.schemaCssClassesRepository = schemaCssClassesRepository;
        this.schemaThemeRepository = schemaThemeRepository;
        this.schemaHorizontalGridRepository = schemaHorizontalGridRepository;
        this.schemaRowColoringRepository = schemaRowColoringRepository;
        this.schemaVerticalGridRepository = schemaVerticalGridRepository;
    }
    onTheme(schemaId) {
        return this.schemaThemeRepository
            .on(schemaId.toAggregateId());
    }
    onceTheme(schemaId) {
        return this.onTheme(schemaId)
            .pipe(hermesTake(1));
    }
    onHorizontalGrid(schemaId) {
        return this.schemaHorizontalGridRepository
            .on(schemaId.toAggregateId());
    }
    onVerticalGrid(schemaId) {
        return this.schemaVerticalGridRepository
            .on(schemaId.toAggregateId());
    }
    onRowColoring(schemaId) {
        return this.schemaRowColoringRepository
            .on(schemaId.toAggregateId());
    }
    onCssClasses(schemaId) {
        return this.schemaCssClassesRepository
            .on(schemaId.toAggregateId());
    }
}
SchemaDomainWarehouse.ɵfac = function SchemaDomainWarehouse_Factory(t) { return new (t || SchemaDomainWarehouse)(i0.ɵɵinject(SchemaCssClassesRepository), i0.ɵɵinject(SchemaThemeRepository), i0.ɵɵinject(SchemaHorizontalGridRepository), i0.ɵɵinject(SchemaRowColoringRepository), i0.ɵɵinject(SchemaVerticalGridRepository)); };
SchemaDomainWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaDomainWarehouse, factory: SchemaDomainWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaDomainWarehouse, [{
        type: Injectable
    }], function () { return [{ type: SchemaCssClassesRepository }, { type: SchemaThemeRepository }, { type: SchemaHorizontalGridRepository }, { type: SchemaRowColoringRepository }, { type: SchemaVerticalGridRepository }]; }, null); })();

class SchemaDomainEventRepository extends SchemaEventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
    onThemeChanged(schemaId) {
        return this.onEvent(schemaId, SchemaThemeSetEvent)
            .pipe(hermesMap((event) => {
            return event.getTheme();
        }));
    }
    onHorizontalGridChanged(schemaId) {
        return this.onEvent(schemaId, SchemaHorizontalGridSetEvent)
            .pipe(hermesMap((event) => event.getHorizontalGrid()));
    }
    onVerticalGridChanged(schemaId) {
        return this.onEvent(schemaId, SchemaVerticalGridSetEvent)
            .pipe(hermesMap((event) => event.getVerticalGrid()));
    }
    onRowColoring(schemaId) {
        return this.onEvent(schemaId, RowColoringSetEvent)
            .pipe(hermesMap((event) => event.getRowColoring()));
    }
}
SchemaDomainEventRepository.ɵfac = function SchemaDomainEventRepository_Factory(t) { return new (t || SchemaDomainEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
SchemaDomainEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SchemaDomainEventRepository, factory: SchemaDomainEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaDomainEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class SchemaApiModule extends ApiModule {
    constructor() {
        super();
    }
}
SchemaApiModule.ɵfac = function SchemaApiModule_Factory(t) { return new (t || SchemaApiModule)(); };
SchemaApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SchemaApiModule });
SchemaApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        SchemaDispatcher,
        {
            provide: SchemaAggregateRepository,
            useClass: InMemorySchemaAggregateRepository
        },
        InMemorySchemaAggregateStore,
        InMemorySchemaStore,
        {
            provide: SchemaCommandInvoker,
            useClass: SchemaDomainCommandInvoker
        },
        {
            provide: SchemaWarehouse,
            useClass: SchemaDomainWarehouse
        },
        {
            provide: SchemaEventRepository,
            useClass: SchemaDomainEventRepository
        },
        SchemaCssClassesRepository
    ], imports: [[
            CommonModule,
            HermesModule.defineAggregate(schemaKey, SchemaAggregateFactory, InMemorySchemaAggregateRepository, CreateSchemaCommandHandler, SchemaDomainModule.commandHandlers(), SchemaDomainModule.domainEventHandlers()),
            SchemaDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    HermesModule.defineAggregate(schemaKey, SchemaAggregateFactory, InMemorySchemaAggregateRepository, CreateSchemaCommandHandler, SchemaDomainModule.commandHandlers(), SchemaDomainModule.domainEventHandlers()),
                    SchemaDomainModule
                ],
                providers: [
                    SchemaDispatcher,
                    {
                        provide: SchemaAggregateRepository,
                        useClass: InMemorySchemaAggregateRepository
                    },
                    InMemorySchemaAggregateStore,
                    InMemorySchemaStore,
                    {
                        provide: SchemaCommandInvoker,
                        useClass: SchemaDomainCommandInvoker
                    },
                    {
                        provide: SchemaWarehouse,
                        useClass: SchemaDomainWarehouse
                    },
                    {
                        provide: SchemaEventRepository,
                        useClass: SchemaDomainEventRepository
                    },
                    SchemaCssClassesRepository
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SchemaApiModule, { imports: [CommonModule, i1$1.HermesDomainModule, SchemaDomainModule] }); })();

class SchemaFeatureModule extends FeatureModule {
    constructor(schemaApiModule) {
        super();
        if (schemaApiModule === null) {
            throw new Error('SchemaApiModule is required.');
        }
    }
    static forComponent() {
        return [
            SchemaRowClassArchive,
            SchemaRowStyleArchive
        ];
    }
}
SchemaFeatureModule.ɵfac = function SchemaFeatureModule_Factory(t) { return new (t || SchemaFeatureModule)(i0.ɵɵinject(SchemaApiModule, 8)); };
SchemaFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SchemaFeatureModule });
SchemaFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            SchemaApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SchemaFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    SchemaApiModule
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return [{ type: SchemaApiModule, decorators: [{
                type: Optional$1
            }] }]; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SchemaFeatureModule, { imports: [CommonModule,
        SchemaApiModule] }); })();

var StyleName;
(function (StyleName) {
    StyleName["WIDTH"] = "width";
    StyleName["HEIGHT"] = "height";
    StyleName["PADDING_TOP"] = "padding-top";
})(StyleName || (StyleName = {}));

var _a;
class StyleModifier extends Modifier {
    constructor(htmlElement) {
        super(htmlElement);
        this.htmlElement = htmlElement;
    }
    createModifier(htmlElement) {
        return new StyleModifier.StyleModifier(htmlElement);
    }
}
StyleModifier.StyleModifier = (_a = class {
        constructor(htmlElement) {
            this.htmlElement = htmlElement;
        }
        setStyleByName(name, value) {
            this.set(name, value);
        }
        setWidth(value) {
            this.set(StyleName.WIDTH, this.toPx(value));
        }
        setHeight(value) {
            this.set(StyleName.HEIGHT, this.toPx(value));
        }
        setPaddingTop(value) {
            this.set(StyleName.PADDING_TOP, this.toPx(value));
        }
        remove(styleName) {
            this.htmlElement[StyleModifier.StyleModifier.STYLE][styleName] = '';
        }
        removeStyleByName(name) {
            this.htmlElement[StyleModifier.StyleModifier.STYLE][name] = '';
        }
        clear() {
            this.htmlElement.removeAttribute(StyleModifier.StyleModifier.STYLE);
        }
        set(name, value) {
            this.htmlElement[StyleModifier.StyleModifier.STYLE][name] = value;
        }
        toPx(value) {
            return value > 0 ? `${value}px` : `${value}`;
        }
    },
    _a.STYLE = 'style',
    _a);

class SummariesCommandInvoker {
    constructor() {
    }
}
SummariesCommandInvoker.ɵfac = function SummariesCommandInvoker_Factory(t) { return new (t || SummariesCommandInvoker)(); };
SummariesCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesCommandInvoker, factory: SummariesCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesCommandInvoker, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SummariesEventRepository extends EventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
}
SummariesEventRepository.ɵfac = function SummariesEventRepository_Factory(t) { return new (t || SummariesEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
SummariesEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesEventRepository, factory: SummariesEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class StructureSetSummariesEnabledCommand extends StructureCommand {
    constructor(structureId, enabled) {
        super(structureId, 'StructureSetSummariesEnabledCommand');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

const StructureSummariesEnabledSetEventName = 'StructureSummariesEnabledSetEvent';
class StructureSummariesEnabledSetEvent extends StructureDomainEvent {
    constructor(aggregateId, enabled) {
        super(aggregateId, enabled, StructureSummariesEnabledSetEventName);
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class StructureSetSummariesEnabledCommandHandler {
    constructor(structureSourceDomainEventPublisher, domainEventPublisher) {
        this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return StructureSetSummariesEnabledCommand;
    }
    handle(structure, command) {
        const enabled = command.isEnabled();
        structure.setSummariesEnabled(enabled);
    }
    publish(aggregate, command) {
        const enabled = command.isEnabled(), aggregateEvents = aggregate.getEvents();
        this.domainEventPublisher.publish(new StructureSummariesEnabledSetEvent(command.getAggregateId(), enabled));
        this.structureSourceDomainEventPublisher.publish(aggregateEvents);
    }
}
StructureSetSummariesEnabledCommandHandler.ɵfac = function StructureSetSummariesEnabledCommandHandler_Factory(t) { return new (t || StructureSetSummariesEnabledCommandHandler)(i0.ɵɵinject(SourceDomainEventPublisher), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
StructureSetSummariesEnabledCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureSetSummariesEnabledCommandHandler, factory: StructureSetSummariesEnabledCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSetSummariesEnabledCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: SourceDomainEventPublisher }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class StructureSummariesChangedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId, summarizedValues) {
        super(aggregateId, 'StructureSummariesChangedAggregateEvent');
        this.summarizedValues = summarizedValues;
    }
    toDomainEvent() {
        return new StructureSummariesChangedEvent(this.getAggregateId(), this.summarizedValues);
    }
    getSummaries() {
        return this.summarizedValues;
    }
}

class SummariesManager {
    constructor(structureId, calculators) {
        this.calculators = calculators;
        this.values = new Map();
        this.structureId = structureId;
        this.enabled = SummariesManager.DEFAULT_ENABLED;
    }
    calculate(fields, entities) {
        if (!this.enabled) {
            return [];
        }
        const calculations = new Map();
        this.calculators.forEach((calc) => {
            const aggregatedValues = calc.calculate(fields, entities);
            if (aggregatedValues) {
                Array.from(aggregatedValues.keys())
                    .forEach((key) => {
                    calculations.set(key, aggregatedValues.get(key));
                });
            }
        });
        if (calculations.size > 0) {
            return [
                new StructureSummariesChangedAggregateEvent(this.structureId, calculations)
            ];
        }
        else {
            return [];
        }
    }
    setEnabled(enabled) {
        this.enabled = enabled;
    }
    add() {
    }
    remove() {
    }
    update() {
    }
}
SummariesManager.DEFAULT_ENABLED = false;

class SummariesEnabledArchive extends AggregateArchive {
    constructor() {
        super(SummariesManager.DEFAULT_ENABLED);
    }
    init(structureId) {
        this.next(structureId, SummariesManager.DEFAULT_ENABLED);
    }
}
SummariesEnabledArchive.ɵfac = function SummariesEnabledArchive_Factory(t) { return new (t || SummariesEnabledArchive)(); };
SummariesEnabledArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesEnabledArchive, factory: SummariesEnabledArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesEnabledArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructureSummariesEnabledSetEventHandler {
    constructor(summariesEnabledArchive) {
        this.summariesEnabledArchive = summariesEnabledArchive;
    }
    forEvent() {
        return StructureSummariesEnabledSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('StructureSummariesEnabledSetEvent')) {
            this.summariesEnabledArchive.next(event.getAggregateId(), event.isEnabled());
        }
    }
}
StructureSummariesEnabledSetEventHandler.ɵfac = function StructureSummariesEnabledSetEventHandler_Factory(t) { return new (t || StructureSummariesEnabledSetEventHandler)(i0.ɵɵinject(SummariesEnabledArchive)); };
StructureSummariesEnabledSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureSummariesEnabledSetEventHandler, factory: StructureSummariesEnabledSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSummariesEnabledSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: SummariesEnabledArchive }]; }, null); })();

const SUMMARIES_CALCULATORS = 'GUI - Summaries Calculators';

function provideSummariesCalculator(clazz) {
    return {
        provide: SUMMARIES_CALCULATORS,
        useClass: clazz,
        multi: true
    };
}

class SummariesCalculator {
    calculate(fields, items) {
        const filteredFields = fields.filter((field) => this.forDataType(field.getDataType()));
        if (!filteredFields || filteredFields.length === 0 || items.length === 0) {
            return null;
        }
        const count = new Map(), distinct = new Map();
        // init
        filteredFields.forEach((field) => {
            const key = field.getKey();
            count.set(key, 0);
            distinct.set(key, new Set());
            this.prepare(field);
        });
        // calculate
        items.forEach((item) => {
            filteredFields.forEach((field) => {
                const key = field.getKey(), value = field.getValue(item);
                if (value !== null || value !== undefined || value !== '') {
                    if (field.isSummaries(SummariesType.COUNT)) {
                        const countForField = count.get(key);
                        count.set(key, countForField + 1);
                    }
                    if (field.isSummaries(SummariesType.DISTINCT)) {
                        const distinctSet = distinct.get(key);
                        distinctSet.add(value);
                    }
                }
                this.aggregate(field, value);
            });
        });
        filteredFields.forEach((field) => {
            this.postCalculate(field, items);
        });
        const summaries = new Map();
        filteredFields.forEach((field) => {
            const key = field.getKey();
            const aggregatedValues = this.generateAggregatedValues(field);
            if (field.isSummaries(SummariesType.COUNT)) {
                aggregatedValues.setCount(count.get(key));
            }
            if (field.isSummaries(SummariesType.DISTINCT)) {
                aggregatedValues.setDistinct((distinct.get(key)).size);
            }
            summaries.set(key, aggregatedValues);
        });
        return summaries;
    }
}

class SummariesValues {
    setCount(value) {
        this.count = value;
    }
    setDistinct(value) {
        this.distinct = value;
    }
}

class BooleanSummarizedValues extends SummariesValues {
    constructor(truthy, falsy) {
        super();
        this.truthy = truthy;
        this.falsy = falsy;
    }
}

class BooleanSummariesCalculator extends SummariesCalculator {
    constructor() {
        super();
        this.truthy = new Map();
        this.falsy = new Map();
    }
    forDataType(dataType) {
        return dataType === DataType.BOOLEAN;
    }
    prepare(field) {
        const key = field.getKey();
        if (field.isSummaries(SummariesType.TRUTHY)) {
            this.truthy.set(key, 0);
        }
        if (field.isSummaries(SummariesType.FALSY)) {
            this.falsy.set(key, 0);
        }
    }
    postCalculate(field, items) {
    }
    aggregate(field, value) {
        const booleanValue = value, // (value as any === 'true'),
        key = field.getKey(), truthyForField = this.truthy.get(key), falsyForField = this.falsy.get(key);
        if (booleanValue) {
            if (field.isSummaries(SummariesType.TRUTHY)) {
                this.truthy.set(key, truthyForField + 1);
            }
        }
        else {
            if (field.isSummaries(SummariesType.FALSY)) {
                this.falsy.set(key, falsyForField + 1);
            }
        }
    }
    generateAggregatedValues(field) {
        const key = field.getKey();
        return new BooleanSummarizedValues(this.truthy.get(key), this.falsy.get(key));
    }
}
BooleanSummariesCalculator.ɵfac = function BooleanSummariesCalculator_Factory(t) { return new (t || BooleanSummariesCalculator)(); };
BooleanSummariesCalculator.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: BooleanSummariesCalculator, factory: BooleanSummariesCalculator.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(BooleanSummariesCalculator, [{
        type: Injectable
    }], function () { return []; }, null); })();

class DateSummarizedValues extends SummariesValues {
    constructor() {
        super();
    }
}

class DateSummariesCalculator extends SummariesCalculator {
    constructor() {
        super();
    }
    forDataType(dataType) {
        return dataType === DataType.DATE;
    }
    prepare(field) {
    }
    postCalculate(field, items) {
    }
    aggregate(field, value) {
    }
    generateAggregatedValues(field) {
        return new DateSummarizedValues();
    }
}
DateSummariesCalculator.ɵfac = function DateSummariesCalculator_Factory(t) { return new (t || DateSummariesCalculator)(); };
DateSummariesCalculator.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: DateSummariesCalculator, factory: DateSummariesCalculator.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DateSummariesCalculator, [{
        type: Injectable
    }], function () { return []; }, null); })();

class NumberSummarizedValues extends SummariesValues {
    constructor(sum, min, max, average, median) {
        super();
        this.sum = this.setValueWithPrecision(sum);
        this.min = this.setValueWithPrecision(min);
        this.max = this.setValueWithPrecision(max);
        this.average = this.setValueWithPrecision(average);
        this.median = this.setValueWithPrecision(median);
    }
    setValueWithPrecision(value) {
        if (!value && value !== 0) {
            return null;
        }
        if (value === 0) {
            return 0;
        }
        return +((value).toFixed(2));
    }
}

class NumberSummariesCalculator extends SummariesCalculator {
    constructor() {
        super();
        this.sum = new Map();
        this.min = new Map();
        this.max = new Map();
        this.average = new Map();
        this.median = new Map();
    }
    forDataType(dataType) {
        return dataType === DataType.NUMBER;
    }
    prepare(field) {
        const key = field.getKey();
        this.sum.set(key, 0);
        this.min.set(key, Number.MAX_SAFE_INTEGER);
        this.max.set(key, 0);
    }
    postCalculate(field, items) {
        const key = field.getKey();
        if (field.isSummaries(SummariesType.AVERAGE)) {
            this.average.set(key, this.sum.get(key) / items.length);
        }
        if (field.isSummaries(SummariesType.MEDIAN)) {
            this.median.set(key, field.getValue(items[Math.floor(items.length / 2)]));
        }
    }
    aggregate(field, value) {
        const numberValue = +value, key = field.getKey(), sumForField = this.sum.get(key), minForField = this.min.get(key), maxForField = this.max.get(key);
        if (field.isSummaries(SummariesType.SUM) || field.isSummaries(SummariesType.AVERAGE)) {
            this.sum.set(key, sumForField + numberValue);
        }
        if (field.isSummaries(SummariesType.MIN)) {
            if (minForField > numberValue) {
                this.min.set(key, numberValue);
            }
        }
        if (field.isSummaries(SummariesType.MAX)) {
            if (maxForField < numberValue) {
                this.max.set(key, numberValue);
            }
        }
    }
    generateAggregatedValues(field) {
        const key = field.getKey(), sum = field.isSummaries(SummariesType.SUM) ? this.sum.get(key) : undefined, min = field.isSummaries(SummariesType.MIN) ? this.min.get(key) : undefined, max = field.isSummaries(SummariesType.MAX) ? this.max.get(key) : undefined, average = field.isSummaries(SummariesType.AVERAGE) ? this.average.get(key) : undefined, median = field.isSummaries(SummariesType.MEDIAN) ? this.median.get(key) : undefined;
        return new NumberSummarizedValues(sum, min, max, average, median);
    }
}
NumberSummariesCalculator.ɵfac = function NumberSummariesCalculator_Factory(t) { return new (t || NumberSummariesCalculator)(); };
NumberSummariesCalculator.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: NumberSummariesCalculator, factory: NumberSummariesCalculator.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(NumberSummariesCalculator, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StringSummarizedValues extends SummariesValues {
    constructor() {
        super();
    }
}

class StringSummariesCalculator extends SummariesCalculator {
    constructor() {
        super();
    }
    forDataType(dataType) {
        return dataType === DataType.STRING;
    }
    prepare(field) {
    }
    postCalculate(field, items) {
    }
    aggregate(field, value) {
    }
    generateAggregatedValues(field) {
        return new StringSummarizedValues();
    }
}
StringSummariesCalculator.ɵfac = function StringSummariesCalculator_Factory(t) { return new (t || StringSummariesCalculator)(); };
StringSummariesCalculator.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StringSummariesCalculator, factory: StringSummariesCalculator.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StringSummariesCalculator, [{
        type: Injectable
    }], function () { return []; }, null); })();

class UnknownSummarizedValues extends SummariesValues {
    constructor() {
        super();
    }
}

class UnknownSummariesCalculator extends SummariesCalculator {
    constructor() {
        super();
    }
    forDataType(dataType) {
        return dataType === DataType.UNKNOWN;
    }
    prepare(field) {
    }
    postCalculate(field, items) {
    }
    aggregate(field, value) {
    }
    generateAggregatedValues(field) {
        return new UnknownSummarizedValues();
    }
}
UnknownSummariesCalculator.ɵfac = function UnknownSummariesCalculator_Factory(t) { return new (t || UnknownSummariesCalculator)(); };
UnknownSummariesCalculator.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: UnknownSummariesCalculator, factory: UnknownSummariesCalculator.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UnknownSummariesCalculator, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SummariesManagerFactory {
    constructor(calculators) {
        this.calculators = calculators;
    }
    create(structureId) {
        return new SummariesManager(structureId, this.calculators);
    }
}
SummariesManagerFactory.ɵfac = function SummariesManagerFactory_Factory(t) { return new (t || SummariesManagerFactory)(i0.ɵɵinject(SUMMARIES_CALCULATORS)); };
SummariesManagerFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesManagerFactory, factory: SummariesManagerFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesManagerFactory, [{
        type: Injectable
    }], function () { return [{ type: Array, decorators: [{
                type: Inject,
                args: [SUMMARIES_CALCULATORS]
            }] }]; }, null); })();

class SummariesDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return HermesModule.registerCommandHandler(StructureSetSummariesEnabledCommandHandler, structureKey);
    }
    static domainEventHandlers() {
        return HermesModule.registerDomainEventHandler(StructureSummariesEnabledSetEventHandler);
    }
}
SummariesDomainModule.ɵfac = function SummariesDomainModule_Factory(t) { return new (t || SummariesDomainModule)(); };
SummariesDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SummariesDomainModule });
SummariesDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        provideSummariesCalculator(BooleanSummariesCalculator),
        provideSummariesCalculator(DateSummariesCalculator),
        provideSummariesCalculator(NumberSummariesCalculator),
        provideSummariesCalculator(StringSummariesCalculator),
        provideSummariesCalculator(UnknownSummariesCalculator),
        SummariesManagerFactory
    ], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [
                    provideSummariesCalculator(BooleanSummariesCalculator),
                    provideSummariesCalculator(DateSummariesCalculator),
                    provideSummariesCalculator(NumberSummariesCalculator),
                    provideSummariesCalculator(StringSummariesCalculator),
                    provideSummariesCalculator(UnknownSummariesCalculator),
                    SummariesManagerFactory
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SummariesDomainModule, { imports: [CommonModule] }); })();

class SummariesWarehouse {
    constructor() {
    }
}
SummariesWarehouse.ɵfac = function SummariesWarehouse_Factory(t) { return new (t || SummariesWarehouse)(); };
SummariesWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesWarehouse, factory: SummariesWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesWarehouse, [{
        type: Injectable
    }], function () { return []; }, null); })();

class StructureSummariesPanelConfig {
    constructor() {
        this.top = StructureSummariesPanelConfig.defaultTop;
        this.bottom = StructureSummariesPanelConfig.defaultBottom;
    }
    setTop(top) {
        this.top = top;
    }
    setBottom(bottom) {
        this.bottom = bottom;
    }
    isTopEnabled() {
        return this.top;
    }
    isBottomEnabled() {
        return this.bottom;
    }
}
StructureSummariesPanelConfig.defaultTop = false;
StructureSummariesPanelConfig.defaultBottom = true;

class StructureSummariesConfigArchive extends AggregateArchive {
    constructor() {
        super(StructureSummariesConfigArchive.default);
    }
}
StructureSummariesConfigArchive.default = new StructureSummariesPanelConfig();
StructureSummariesConfigArchive.ɵfac = function StructureSummariesConfigArchive_Factory(t) { return new (t || StructureSummariesConfigArchive)(); };
StructureSummariesConfigArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureSummariesConfigArchive, factory: StructureSummariesConfigArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSummariesConfigArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class SummariesDomainWarehouse extends SummariesWarehouse {
    constructor(summariesEnabledArchive, structureSummariesArchive) {
        super();
        this.summariesEnabledArchive = summariesEnabledArchive;
        this.structureSummariesArchive = structureSummariesArchive;
    }
    onEnabled(structureId) {
        return this.summariesEnabledArchive.on(structureId);
    }
    onTopEnabled(structureId) {
        return this.onEnabled(structureId)
            .pipe(hermesSwitchMap((enabled) => {
            return this.structureSummariesArchive
                .on(structureId)
                .pipe(hermesMap((config) => enabled && config.isTopEnabled()));
        }));
    }
    onBottomEnabled(structureId) {
        return this.onEnabled(structureId)
            .pipe(hermesSwitchMap((enabled) => {
            return this.structureSummariesArchive
                .on(structureId)
                .pipe(hermesMap((config) => enabled && config.isBottomEnabled()));
        }));
    }
}
SummariesDomainWarehouse.ɵfac = function SummariesDomainWarehouse_Factory(t) { return new (t || SummariesDomainWarehouse)(i0.ɵɵinject(SummariesEnabledArchive), i0.ɵɵinject(StructureSummariesConfigArchive)); };
SummariesDomainWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesDomainWarehouse, factory: SummariesDomainWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesDomainWarehouse, [{
        type: Injectable
    }], function () { return [{ type: SummariesEnabledArchive }, { type: StructureSummariesConfigArchive }]; }, null); })();

class StructureSummariesPanelConfigConverter {
    convert(config) {
        const panelConfig = new StructureSummariesPanelConfig();
        if (config.top !== undefined && config.top !== null) {
            panelConfig.setTop(config.top);
        }
        if (config.bottom !== undefined && config.bottom !== null) {
            panelConfig.setBottom(config.bottom);
        }
        return panelConfig;
    }
}
StructureSummariesPanelConfigConverter.ɵfac = function StructureSummariesPanelConfigConverter_Factory(t) { return new (t || StructureSummariesPanelConfigConverter)(); };
StructureSummariesPanelConfigConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureSummariesPanelConfigConverter, factory: StructureSummariesPanelConfigConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSummariesPanelConfigConverter, [{
        type: Injectable
    }], null, null); })();

class SummariesDomainCommandInvoker extends SummariesCommandInvoker {
    constructor(commandDispatcher, configConverter, structureSummariesConfigArchive) {
        super();
        this.commandDispatcher = commandDispatcher;
        this.configConverter = configConverter;
        this.structureSummariesConfigArchive = structureSummariesConfigArchive;
    }
    setSummariesEnabled(enabled, structureId) {
        this.commandDispatcher.dispatch(new StructureSetSummariesEnabledCommand(structureId, enabled));
    }
    setConfig(config, structureId) {
        const summariesPanelConfig = this.configConverter.convert(config);
        this.setSummariesEnabled(config.enabled, structureId);
        this.structureSummariesConfigArchive.next(structureId, summariesPanelConfig);
    }
}
SummariesDomainCommandInvoker.ɵfac = function SummariesDomainCommandInvoker_Factory(t) { return new (t || SummariesDomainCommandInvoker)(i0.ɵɵinject(i1$1.CommandDispatcher), i0.ɵɵinject(StructureSummariesPanelConfigConverter), i0.ɵɵinject(StructureSummariesConfigArchive)); };
SummariesDomainCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesDomainCommandInvoker, factory: SummariesDomainCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesDomainCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }, { type: StructureSummariesPanelConfigConverter }, { type: StructureSummariesConfigArchive }]; }, null); })();

class SummariesDomainEventRepository extends SummariesEventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
    onSummariesChanged(structureId) {
        return this.onEvent(structureId, StructureSummariesChangedEvent);
    }
}
SummariesDomainEventRepository.ɵfac = function SummariesDomainEventRepository_Factory(t) { return new (t || SummariesDomainEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
SummariesDomainEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SummariesDomainEventRepository, factory: SummariesDomainEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesDomainEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class SummariesApiModule extends ApiModule {
}
SummariesApiModule.ɵfac = /*@__PURE__*/ function () { let ɵSummariesApiModule_BaseFactory; return function SummariesApiModule_Factory(t) { return (ɵSummariesApiModule_BaseFactory || (ɵSummariesApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(SummariesApiModule)))(t || SummariesApiModule); }; }();
SummariesApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SummariesApiModule });
SummariesApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        {
            provide: SummariesCommandInvoker,
            useClass: SummariesDomainCommandInvoker
        },
        {
            provide: SummariesEventRepository,
            useClass: SummariesDomainEventRepository
        },
        {
            provide: SummariesWarehouse,
            useClass: SummariesDomainWarehouse
        },
        SummariesEnabledArchive
    ], imports: [[
            CommonModule,
            SummariesDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    SummariesDomainModule
                ],
                providers: [
                    {
                        provide: SummariesCommandInvoker,
                        useClass: SummariesDomainCommandInvoker
                    },
                    {
                        provide: SummariesEventRepository,
                        useClass: SummariesDomainEventRepository
                    },
                    {
                        provide: SummariesWarehouse,
                        useClass: SummariesDomainWarehouse
                    },
                    SummariesEnabledArchive
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SummariesApiModule, { imports: [CommonModule,
        SummariesDomainModule] }); })();

class SummariesTranslations {
    constructor(distinctTooltip, averageTooltip, minTooltip, maxTooltip, medTooltip, countTooltip) {
        this.distinctTooltip = distinctTooltip;
        this.averageTooltip = averageTooltip;
        this.minTooltip = minTooltip;
        this.maxTooltip = maxTooltip;
        this.medTooltip = medTooltip;
        this.countTooltip = countTooltip;
    }
}

const _c0$y = ["gui-structure-summaries-panel", "", "enabled", ""];
function StructureSummariesPanelComponent_ng_container_0_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 3);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span", 7);
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r5 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r5.summariesTranslations.countTooltip);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 3, "summariesCount"));
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r5.summaries.get(column_r3.getFieldId().getId()).count);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span", 7);
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r6 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r6.summariesTranslations.distinctTooltip);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 3, "summariesDist"));
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r6.summaries.get(column_r3.getFieldId().getId()).distinct);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span");
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r7 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(3, 2, "summariesSum"), " ");
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r7.summaries.get(column_r3.getFieldId().getId()).sum);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span", 7);
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r8 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r8.summariesTranslations.averageTooltip);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 3, "summariesAvg"));
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r8.summaries.get(column_r3.getFieldId().getId()).average);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_5_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span", 7);
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r9 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r9.summariesTranslations.minTooltip);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(3, 3, "summariesMin"), " ");
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r9.summaries.get(column_r3.getFieldId().getId()).min);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_6_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span", 7);
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r10 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r10.summariesTranslations.maxTooltip);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(3, 3, "summariesMax"), " ");
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r10.summaries.get(column_r3.getFieldId().getId()).max);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_7_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span", 7);
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r11 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("gui-tooltip", ctx_r11.summariesTranslations.medTooltip);
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 3, "summariesMed"));
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r11.summaries.get(column_r3.getFieldId().getId()).median);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_8_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span");
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r12 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, "summariesTruthy"));
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r12.summaries.get(column_r3.getFieldId().getId()).truthy);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_9_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 6);
    i0.ɵɵelementStart(1, "span");
    i0.ɵɵtext(2);
    i0.ɵɵpipe(3, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "span", 8);
    i0.ɵɵtext(5);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext(2).$implicit;
    const ctx_r13 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 2, "summariesFalsy"));
    i0.ɵɵadvance(3);
    i0.ɵɵtextInterpolate(ctx_r13.summaries.get(column_r3.getFieldId().getId()).falsy);
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_1_Template, 6, 5, "div", 5);
    i0.ɵɵtemplate(2, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_2_Template, 6, 5, "div", 5);
    i0.ɵɵtemplate(3, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_3_Template, 6, 4, "div", 5);
    i0.ɵɵtemplate(4, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_4_Template, 6, 5, "div", 5);
    i0.ɵɵtemplate(5, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_5_Template, 6, 5, "div", 5);
    i0.ɵɵtemplate(6, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_6_Template, 6, 5, "div", 5);
    i0.ɵɵtemplate(7, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_7_Template, 6, 5, "div", 5);
    i0.ɵɵtemplate(8, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_8_Template, 6, 4, "div", 5);
    i0.ɵɵtemplate(9, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_div_9_Template, 6, 4, "div", 5);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const column_r3 = i0.ɵɵnextContext().$implicit;
    const ctx_r4 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).count));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).distinct));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).sum));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).average));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).min));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).max));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).median));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).truthy));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r4.isSummariesTypePresent(ctx_r4.summaries.get(column_r3.getFieldId().getId()).falsy));
} }
function StructureSummariesPanelComponent_ng_container_0_div_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 4);
    i0.ɵɵtemplate(1, StructureSummariesPanelComponent_ng_container_0_div_2_ng_container_1_Template, 10, 9, "ng-container", 0);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r3 = ctx.$implicit;
    const ctx_r2 = i0.ɵɵnextContext(2);
    i0.ɵɵstyleProp("width", column_r3.width, "px");
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r2.summaries && !!ctx_r2.summaries.get(column_r3.getFieldId().getId()));
} }
function StructureSummariesPanelComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, StructureSummariesPanelComponent_ng_container_0_div_1_Template, 1, 0, "div", 1);
    i0.ɵɵtemplate(2, StructureSummariesPanelComponent_ng_container_0_div_2_Template, 2, 3, "div", 2);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r0.checkboxSelection);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngForOf", ctx_r0.headerColumns);
} }
class StructureSummariesPanelComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, compositionId, structureSummariesEventRepository, translationService, sourceWarehouse, rowSelectionTypeArchive, compositionWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.structureSummariesEventRepository = structureSummariesEventRepository;
        this.translationService = translationService;
        this.sourceWarehouse = sourceWarehouse;
        this.rowSelectionTypeArchive = rowSelectionTypeArchive;
        this.compositionWarehouse = compositionWarehouse;
        this.sourceEmpty = false;
        this.addClassToHost('gui-flex');
        this.hermesSubscribe(this.structureSummariesEventRepository.onSummariesChanged(this.structureId.toReadModelRootId()), (event) => {
            this.summaries = event.getSummaries();
        });
    }
    ngOnInit() {
        this.hermesSubscribe(this.rowSelectionTypeArchive.on(), (type) => {
            this.checkboxSelection = type === RowSelectionType.CHECKBOX;
        });
        this.hermesSubscribe(this.sourceWarehouse.onEntitiesSize(this.structureId), (size) => {
            this.sourceEmpty = size === 0;
        });
        this.hermesSubscribe(this.compositionWarehouse.onHeaderColumns(this.compositionId), (columns) => {
            this.headerColumns = columns;
        });
        this.hermesSubscribe(this.translationService.onTranslation(), (translation) => {
            this.summariesTranslations = new SummariesTranslations(translation.summariesDistinctValuesTooltip, translation.summariesAverageTooltip, translation.summariesMinTooltip, translation.summariesMaxTooltip, translation.summariesMedTooltip, translation.summariesCountTooltip);
        });
    }
    isSummariesTypePresent(summaries) {
        return summaries !== undefined && summaries !== null;
    }
    getSelectorName() {
        return 'gui-structure-summaries-panel';
    }
}
StructureSummariesPanelComponent.ɵfac = function StructureSummariesPanelComponent_Factory(t) { return new (t || StructureSummariesPanelComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(SummariesEventRepository), i0.ɵɵdirectiveInject(TranslationFacade), i0.ɵɵdirectiveInject(SourceWarehouse), i0.ɵɵdirectiveInject(RowSelectionTypeArchive), i0.ɵɵdirectiveInject(CompositionWarehouse)); };
StructureSummariesPanelComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureSummariesPanelComponent, selectors: [["div", "gui-structure-summaries-panel", "", "enabled", ""]], inputs: { enabled: "enabled" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$y, decls: 1, vars: 1, consts: [[4, "ngIf"], ["class", "gui-structure-summaries-cell gui-row-checkbox gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis", 4, "ngIf"], ["class", "gui-structure-summaries-cell", 3, "width", 4, "ngFor", "ngForOf"], [1, "gui-structure-summaries-cell", "gui-row-checkbox", "gui-flex", "gui-justify-between", "gui-overflow-hidden", "gui-relative", "gui-py-0", "gui-px-6", "gui-box-border", "gui-leading-4", "gui-whitespace-nowrap", "gui-overflow-ellipsis"], [1, "gui-structure-summaries-cell"], ["class", "gui-structure-summaries-value", 4, "ngIf"], [1, "gui-structure-summaries-value"], [3, "gui-tooltip"], [1, "gui-summaries-value"]], template: function StructureSummariesPanelComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureSummariesPanelComponent_ng_container_0_Template, 3, 2, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.enabled && ctx.summaries && !ctx.sourceEmpty);
    } }, directives: [i4.NgIf, i4.NgForOf, i1.FabricTooltipDirective], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSummariesPanelComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-summaries-panel][enabled]',
                templateUrl: './structure.summaries-panel.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: CompositionId }, { type: SummariesEventRepository }, { type: TranslationFacade }, { type: SourceWarehouse }, { type: RowSelectionTypeArchive }, { type: CompositionWarehouse }]; }, { enabled: [{
            type: Input
        }] }); })();

class SummariesFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
SummariesFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵSummariesFeatureModule_BaseFactory; return function SummariesFeatureModule_Factory(t) { return (ɵSummariesFeatureModule_BaseFactory || (ɵSummariesFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(SummariesFeatureModule)))(t || SummariesFeatureModule); }; }();
SummariesFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SummariesFeatureModule });
SummariesFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        StructureSummariesConfigArchive,
        StructureSummariesPanelConfigConverter
    ], imports: [[
            CommonModule,
            FabricModule,
            TranslationFeatureModule,
            SummariesApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SummariesFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    FabricModule,
                    TranslationFeatureModule,
                    SummariesApiModule
                ],
                declarations: [
                    StructureSummariesPanelComponent
                ],
                exports: [
                    StructureSummariesPanelComponent
                ],
                providers: [
                    StructureSummariesConfigArchive,
                    StructureSummariesPanelConfigConverter
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SummariesFeatureModule, { declarations: [StructureSummariesPanelComponent], imports: [CommonModule,
        FabricModule,
        TranslationFeatureModule,
        SummariesApiModule], exports: [StructureSummariesPanelComponent] }); })();

class StructurePagingDefinitionBuilder extends GenericBuilder {
    constructor(enabled) {
        super();
        this.enabled = enabled;
    }
    withEnabled(enabled) {
        this.enabled = enabled;
        return this;
    }
    buildObject() {
        return new PagingDefinition(this.enabled);
    }
}
class StructurePagingDefinitionDefaultBuilder extends StructurePagingDefinitionBuilder {
    constructor() {
        super(StructurePagingDefinitionDefaultBuilder.defaultEnabled);
    }
}
StructurePagingDefinitionDefaultBuilder.defaultEnabled = true;
class PagingDefinition {
    constructor(enabled) {
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}
PagingDefinition.Builder = StructurePagingDefinitionBuilder;
PagingDefinition.DefaultBuilder = StructurePagingDefinitionDefaultBuilder;

class StructureDefinitionBuilder extends GenericBuilder {
    constructor(headerEnabled, bottomPaging, topPaging) {
        super();
        this.headerEnabled = headerEnabled;
        this.bottomPaging = bottomPaging;
        this.topPaging = topPaging;
        this.border = true;
    }
    buildObject() {
        return new StructureDefinition(this.headerEnabled, this.bottomPaging, this.topPaging, this.border);
    }
    withHeader(enabled) {
        this.headerEnabled = enabled;
        return this;
    }
    withBottomPaging(paging) {
        this.bottomPaging = paging;
        return this;
    }
    withTopPaging(paging) {
        this.topPaging = paging;
        return this;
    }
    withBorder(enabled) {
        this.border = enabled;
        return this;
    }
}
class StructureDefinitionDefaultBuilder extends StructureDefinitionBuilder {
    constructor() {
        super(StructureDefinitionDefaultBuilder.defaultHeaderEnabled, StructureDefinitionDefaultBuilder.defaultBottomPaging, StructureDefinitionDefaultBuilder.defaultTopPaging);
    }
}
StructureDefinitionDefaultBuilder.defaultHeaderEnabled = true;
StructureDefinitionDefaultBuilder.defaultBottomPaging = new PagingDefinition.DefaultBuilder().build();
StructureDefinitionDefaultBuilder.defaultTopPaging = new PagingDefinition.DefaultBuilder().build();
class StructureDefinition {
    constructor(headerEnabled, bottomPaging, topPaging, border) {
        this.headerEnabled = headerEnabled;
        this.bottomPaging = bottomPaging;
        this.topPaging = topPaging;
        this.border = border;
    }
    isHeaderEnabled() {
        return this.headerEnabled;
    }
    isBorderEnabled() {
        return this.border;
    }
    getBottomPaging() {
        return this.bottomPaging;
    }
    getTopPaging() {
        return this.topPaging;
    }
}
StructureDefinition.Builder = StructureDefinitionBuilder;
StructureDefinition.DefaultBuilder = StructureDefinitionDefaultBuilder;

const prefix = 'Structure -';
const STRUCTURE_CSS_CLASS_NAME = new InjectionToken(`${prefix} - css className`);

const structureParentComponent = new InjectionToken('StructureParentComponent');

class VerticalFormationWarehouse {
    constructor() {
    }
}
VerticalFormationWarehouse.ɵfac = function VerticalFormationWarehouse_Factory(t) { return new (t || VerticalFormationWarehouse)(); };
VerticalFormationWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: VerticalFormationWarehouse, factory: VerticalFormationWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationWarehouse, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ResizeDetector {
    constructor(platformId) {
        this.platformId = platformId;
    }
    on(element) {
        if (isPlatformBrowser(this.platformId)) {
            return fromRxJsObservable((new Observable((observer) => {
                const resizeObserver = new ResizeObserver((entries) => {
                    if (entries && entries.length > 0) {
                        observer.next(entries[0].contentRect);
                    }
                });
                resizeObserver.observe(element);
                return () => resizeObserver.disconnect();
            }))
                .pipe(throttleTime(25)));
        }
        return hermesEmpty();
    }
    destroy(element) {
    }
}
ResizeDetector.ɵfac = function ResizeDetector_Factory(t) { return new (t || ResizeDetector)(i0.ɵɵinject(PLATFORM_ID)); };
ResizeDetector.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ResizeDetector, factory: ResizeDetector.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ResizeDetector, [{
        type: Injectable
    }], function () { return [{ type: undefined, decorators: [{
                type: Inject,
                args: [PLATFORM_ID]
            }] }]; }, null); })();

class StructureCreatedEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'StructureCreatedEvent');
    }
}

class VerticalScrollEnabledSetEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'VerticalScrollEnabledSetEvent');
    }
}

class RowHeightSetEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'RowHeightSetEvent');
    }
}

class StructureHeightSetEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'StructureHeightSetEvent');
    }
}

class ScrollPositionSetEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'ScrollPositionSetEvent');
    }
}

class RowHeightSetBasedOnThemeEvent extends StructureDomainEvent {
    constructor(structureId) {
        super(structureId, null, 'RowHeightSetBasedOnThemeEvent');
    }
}

class InMemoryStructureStore extends InMemoryStore {
}
InMemoryStructureStore.ɵfac = /*@__PURE__*/ function () { let ɵInMemoryStructureStore_BaseFactory; return function InMemoryStructureStore_Factory(t) { return (ɵInMemoryStructureStore_BaseFactory || (ɵInMemoryStructureStore_BaseFactory = i0.ɵɵgetInheritedFactory(InMemoryStructureStore)))(t || InMemoryStructureStore); }; }();
InMemoryStructureStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryStructureStore, factory: InMemoryStructureStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryStructureStore, [{
        type: Injectable
    }], null, null); })();

class StructureReadModelRoot extends ReadModelRoot {
    constructor(uid, paging, entities, source, verticalFormation) {
        super(uid);
        this.paging = paging;
        this.entities = entities;
        this.source = source;
        this.verticalFormation = verticalFormation;
    }
    getPaging() {
        return this.paging;
    }
    getEntities() {
        return this.entities;
    }
    getSource() {
        return this.source;
    }
    getVerticalFormation() {
        return this.verticalFormation;
    }
    // TODO Remove
    getTopMargin() {
        return this.verticalFormation.getTopMargin();
    }
    isLoaderVisible() {
        return this.getSource().isLoading();
    }
    getSourceHeight() {
        return this.verticalFormation.getSourceHeight();
    }
    isReadyToDisplay() {
        return this.entities.length > 0;
        // this.presentation.getColumns().length > 0; // TODO presentation getColumns
    }
    isVerticalScrollEnabled() {
        return this.verticalFormation.isEnabled();
    }
}

class ItemEntity {
    constructor(source, position, id, version = 0) {
        this.version = 0;
        this.source = source;
        this.position = position;
        this.version = version;
        if (!id) {
            this.id = RandomStringGenerator.generate();
        }
        else {
            this.id = id;
        }
    }
    getSourceItem() {
        return this.source;
    }
    getUiId() {
        return 'gui' + this.id.replace(/-/g, '');
    }
    getId() {
        return this.id;
    }
    getVersion() {
        return this.version;
    }
    getPosition() {
        return this.position;
    }
    isSelected() {
        return false;
    }
    isEven() {
        return this.position % 2 === 0;
    }
    isOdd() {
        return this.position % 2 === 1;
    }
    equals(entity) {
        return this.id === entity.id && this.getVersion() === entity.getVersion();
    }
    equalsById(id) {
        return this.id === id;
    }
}

let VerticalFormationReadModel = class VerticalFormationReadModel {
    constructor(enabled, topMargin, sourceHeight, viewportHeight, rowHeight) {
        this.enabled = enabled;
        this.topMargin = topMargin;
        this.sourceHeight = sourceHeight;
        this.viewportHeight = viewportHeight;
        this.rowHeight = rowHeight;
    }
    isEnabled() {
        return this.enabled;
    }
    getTopMargin() {
        return this.topMargin; //  * this.rowHeight;
    }
    getSourceHeight() {
        return this.sourceHeight;
    }
    getViewPortHeight() {
        return this.viewportHeight;
    }
    getRowHeight() {
        return this.rowHeight;
    }
};
VerticalFormationReadModel = __decorate([
    ReadModelObject
], VerticalFormationReadModel);

class VerticalFormationConverter {
    convert(verticalFormation) {
        const enabled = verticalFormation.isEnabled(), topMargin = verticalFormation.getTopMargin(), sourceHeight = verticalFormation.getSourceHeight(), viewportHeight = verticalFormation.getViewPortHeight(), rowHeight = verticalFormation.getRowHeight();
        return new VerticalFormationReadModel(enabled, topMargin, sourceHeight, viewportHeight, rowHeight);
    }
}
VerticalFormationConverter.ɵfac = function VerticalFormationConverter_Factory(t) { return new (t || VerticalFormationConverter)(); };
VerticalFormationConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: VerticalFormationConverter, factory: VerticalFormationConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationConverter, [{
        type: Injectable
    }], null, null); })();

class StructureReadModelRootConverter {
    constructor(pagingConverter, sourceConverter, verticalFormationConverter) {
        this.pagingConverter = pagingConverter;
        this.sourceConverter = sourceConverter;
        this.verticalFormationConverter = verticalFormationConverter;
    }
    convert(aggregate) {
        const pagingAggregate = aggregate.getPaging(), originItemEntities = aggregate.getEntities(), sourceCoordinator = aggregate.getSource(), verticalFormation = aggregate.getVerticalFormation();
        return new StructureReadModelRoot(aggregate.getId().toReadModelRootId(), this.pagingConverter.convert(pagingAggregate), this.convertSource(originItemEntities), this.sourceConverter.convert(sourceCoordinator), this.verticalFormationConverter.convert(verticalFormation));
    }
    convertSource(source) {
        return source.map((originItem) => {
            return new ItemEntity(originItem.sourceItem, originItem.getPosition(), originItem.getId().toString(), originItem.getVersion());
        });
    }
}
StructureReadModelRootConverter.ɵfac = function StructureReadModelRootConverter_Factory(t) { return new (t || StructureReadModelRootConverter)(i0.ɵɵinject(PagingConverter), i0.ɵɵinject(SourceConverter), i0.ɵɵinject(VerticalFormationConverter)); };
StructureReadModelRootConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureReadModelRootConverter, factory: StructureReadModelRootConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureReadModelRootConverter, [{
        type: Injectable
    }], function () { return [{ type: PagingConverter }, { type: SourceConverter }, { type: VerticalFormationConverter }]; }, null); })();

class InMemoryStructureReadStore extends InMemoryReadModelStore {
    constructor(inMemoryProjectStore, structureConverter) {
        super(inMemoryProjectStore);
        this.inMemoryProjectStore = inMemoryProjectStore;
        this.structureConverter = structureConverter;
    }
    toReadModel(aggregate) {
        return this.structureConverter.convert(aggregate);
    }
}
InMemoryStructureReadStore.ɵfac = function InMemoryStructureReadStore_Factory(t) { return new (t || InMemoryStructureReadStore)(i0.ɵɵinject(InMemoryStructureStore), i0.ɵɵinject(StructureReadModelRootConverter)); };
InMemoryStructureReadStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryStructureReadStore, factory: InMemoryStructureReadStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryStructureReadStore, [{
        type: Injectable
    }], function () { return [{ type: InMemoryStructureStore }, { type: StructureReadModelRootConverter }]; }, null); })();

class VerticalFormationRepository extends Reactive {
    constructor(domainEventBus, inMemoryStructureReadStore) {
        super();
        this.domainEventBus = domainEventBus;
        this.inMemoryStructureReadStore = inMemoryStructureReadStore;
        this.verticalFormation = new Map();
        this.verticalFormation$ = new HermesReplaySubject(1);
        this.domainEventBus
            .ofEvents([
            StructureCreatedEvent,
            VerticalScrollEnabledSetEvent,
            OriginSetEvent,
            StructureHeightSetEvent,
            RowHeightSetEvent,
            SchemaThemeSetEvent,
            RowHeightSetBasedOnThemeEvent,
            ScrollPositionSetEvent,
            SearchPhraseSetDomainEvent,
            PageChangedEvent,
            PagingSetEvent
        ])
            .pipe(this.hermesTakeUntil())
            .subscribe((event) => {
            const aggregateId = event.getAggregateId();
            const optStructure = this.inMemoryStructureReadStore.getById(aggregateId);
            optStructure.ifPresent((structureReadModelRoot) => {
                const verticalFormation = structureReadModelRoot.getVerticalFormation();
                this.next(aggregateId, verticalFormation);
            });
        });
    }
    onVerticalScrollEnabled(structureId) {
        return this.onVerticalFormation(structureId)
            .pipe(hermesMap((v) => v.isEnabled()), hermesDistinctUntilChanged());
    }
    onRowHeight(structureId) {
        return this.onVerticalFormation(structureId)
            .pipe(hermesMap((v) => v.getRowHeight()), hermesDistinctUntilChanged());
    }
    onContainerHeight(structureId) {
        return this.onVerticalFormation(structureId)
            .pipe(hermesMap((v) => v.getViewPortHeight()), hermesDistinctUntilChanged());
    }
    onTopMargin(structureId) {
        return this.onVerticalFormation(structureId)
            .pipe(hermesMap((v) => v.getTopMargin()), hermesDistinctUntilChanged());
    }
    onVerticalFormation(structureId) {
        return this.verticalFormation$
            .toObservable()
            .pipe(hermesFilter((idToVerticalFormation) => {
            const key = structureId.getId();
            return idToVerticalFormation.has(key);
        }), hermesMap((idToVerticalFormation) => idToVerticalFormation.get(structureId.getId())));
    }
    next(structureId, verticalFormation) {
        this.verticalFormation.set(structureId.toString(), verticalFormation);
        this.verticalFormation$.next(this.verticalFormation);
    }
}
VerticalFormationRepository.ɵfac = function VerticalFormationRepository_Factory(t) { return new (t || VerticalFormationRepository)(i0.ɵɵinject(i1$1.DomainEventBus), i0.ɵɵinject(InMemoryStructureReadStore)); };
VerticalFormationRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: VerticalFormationRepository, factory: VerticalFormationRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }, { type: InMemoryStructureReadStore }]; }, null); })();

class ChangedValueEmitter {
    constructor() {
        this.subject$ = new HermesReplaySubject(1);
    }
    emit(value) {
        this.subject$.next(value);
    }
    on() {
        return this.subject$.toObservable();
    }
}

var EditEventType;
(function (EditEventType) {
    EditEventType[EditEventType["SUBMIT"] = 0] = "SUBMIT";
    EditEventType[EditEventType["BLUR"] = 1] = "BLUR";
    EditEventType[EditEventType["CANCEL"] = 2] = "CANCEL";
})(EditEventType || (EditEventType = {}));

class ColumnId extends EntityId {
    constructor(id) {
        super(id);
    }
    toString() {
        return this.getId();
    }
}

const _c0$x = ["cellContainer"];
const _c1$a = ["gui-structure-cell-edit-boolean", "", "entity", "", "cell", ""];
function StructureCellEditBooleanComponent_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
class StructureCellEditBooleanComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, sourceCommandService) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.sourceCommandService = sourceCommandService;
    }
    ngOnChanges(changes) {
        if (changes.entity !== null && changes.entity !== undefined) {
            this.initEditContext();
        }
        if (changes.cell !== null && changes.cell !== undefined) {
            this.initEditContext();
        }
    }
    ngOnInit() {
        this.initEditContext();
    }
    submitChanges() {
        const itemId = this.entity.getId(), updatedValue = this.actualValue, fieldId = this.cell.columnFieldId;
        this.sourceCommandService.editItem(new StructureEditSourceItemParams(itemId, fieldId, updatedValue), this.structureId);
    }
    initEditContext() {
        this.valueChanges$ = new ChangedValueEmitter();
        this.status$ = new ChangedValueEmitter();
        this.editContext = {
            status: this.status$,
            valueChanges: this.valueChanges$,
            value: this.cell.getValue(this.entity).value,
            focus: false,
            parent: this.cellContainerRef
        };
        this.observeValueChanges();
        this.status$
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((status) => {
            switch (status) {
                case EditEventType.SUBMIT:
                    this.submitChanges();
                    break;
                default:
                    break;
            }
        });
    }
    observeValueChanges() {
        this.valueChanges$
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((value) => {
            this.actualValue = value;
        });
    }
    getSelectorName() {
        return 'gui-structure-cell-edit-boolean';
    }
}
StructureCellEditBooleanComponent.ɵfac = function StructureCellEditBooleanComponent_Factory(t) { return new (t || StructureCellEditBooleanComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SourceCommandInvoker)); };
StructureCellEditBooleanComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureCellEditBooleanComponent, selectors: [["div", "gui-structure-cell-edit-boolean", "", "entity", "", "cell", ""]], viewQuery: function StructureCellEditBooleanComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$x, 7);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.cellContainerRef = _t.first);
    } }, inputs: { entity: "entity", cell: "cell" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c1$a, decls: 3, vars: 2, consts: [["cellContainer", ""], [4, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function StructureCellEditBooleanComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "span", null, 0);
        i0.ɵɵtemplate(2, StructureCellEditBooleanComponent_ng_container_2_Template, 1, 0, "ng-container", 1);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngTemplateOutlet", ctx.cell.editTemplate)("ngTemplateOutletContext", ctx.editContext);
    } }, directives: [i4.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCellEditBooleanComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-cell-edit-boolean][entity][cell]',
                template: `

		<span #cellContainer>
			<ng-container
				*ngTemplateOutlet="cell.editTemplate;
									context: editContext">
			</ng-container>
		</span>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: SourceCommandInvoker }]; }, { cellContainerRef: [{
            type: ViewChild,
            args: ['cellContainer', { static: true }]
        }], entity: [{
            type: Input
        }], cell: [{
            type: Input
        }] }); })();

const _c0$w = ["gui-structure-cell", "", "entity", "", "cell", ""];
function StructureCellComponent_ng_container_0_span_1_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
const _c1$9 = function (a1, a2, a3, a4) { return { "gui-cell-view": true, "gui-align-left": a1, "gui-align-center": a2, "gui-align-right": a3, "gui-column-highlighted": a4 }; };
const _c2$4 = function (a0, a1, a2, a3) { return { element: a0, index: a1, value: a2, item: a3 }; };
function StructureCellComponent_ng_container_0_span_1_Template(rf, ctx) { if (rf & 1) {
    const _r6 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "span", 3);
    i0.ɵɵlistener("click", function StructureCellComponent_ng_container_0_span_1_Template_span_click_0_listener() { i0.ɵɵrestoreView(_r6); const ctx_r5 = i0.ɵɵnextContext(2); return ctx_r5.enterEditMode(); });
    i0.ɵɵtemplate(1, StructureCellComponent_ng_container_0_span_1_ng_container_1_Template, 1, 0, "ng-container", 4);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext(2);
    i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction4(3, _c1$9, ctx_r2.cell.isAlignLeft(), ctx_r2.cell.isAlignCenter(), ctx_r2.cell.isAlignRight(), ctx_r2.isHighlighted));
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", ctx_r2.cell.template)("ngTemplateOutletContext", i0.ɵɵpureFunction4(8, _c2$4, ctx_r2.cell.getValue(ctx_r2.entity, ctx_r2.searchPhrase), ctx_r2.entity.getPosition(), ctx_r2.cell.getValue(ctx_r2.entity, ctx_r2.searchPhrase).value, ctx_r2.entity.getSourceItem()));
} }
function StructureCellComponent_ng_container_0_span_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
function StructureCellComponent_ng_container_0_span_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 5);
    i0.ɵɵtemplate(1, StructureCellComponent_ng_container_0_span_2_ng_container_1_Template, 1, 0, "ng-container", 4);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngTemplateOutlet", ctx_r3.cell.editTemplate)("ngTemplateOutletContext", ctx_r3.editContext);
} }
function StructureCellComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, StructureCellComponent_ng_container_0_span_1_Template, 2, 13, "span", 1);
    i0.ɵɵtemplate(2, StructureCellComponent_ng_container_0_span_2_Template, 2, 2, "span", 2);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", !ctx_r0.inEditMode);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r0.inEditMode);
} }
function StructureCellComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelement(1, "div", 6);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("cell", ctx_r1.cell)("entity", ctx_r1.entity);
} }
class StructureCellComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, compositionId, structureCellEditStore, cellEditCloseAllService, sourceCommandService, compositionWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.elementRef = elementRef;
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.structureCellEditStore = structureCellEditStore;
        this.cellEditCloseAllService = cellEditCloseAllService;
        this.sourceCommandService = sourceCommandService;
        this.compositionWarehouse = compositionWarehouse;
        this.inEditMode = false;
    }
    ngOnInit() {
        this.hermesSubscribe(this.compositionWarehouse.onHighlightedColumn(new ColumnId(this.cell.columnDefinitionId.toString()), this.compositionId), (value) => {
            this.isHighlighted = value;
        });
    }
    ngAfterViewInit() {
        super.ngAfterViewInit();
        this.hermesSubscribeWithoutRender(this.cellEditCloseAllService.onCloseAll(), () => {
            this.exitEditMode();
        });
    }
    isCellEditingEnabled() {
        return this.cellEditorManager.isEnabled(this.cell.getValue(this.entity), this.entity.getSourceItem(), this.rowIndex) &&
            this.cell.isCellEditingEnabled();
    }
    enterEditMode(forceCheck = true) {
        if (!this.isCellEditingEnabled()) {
            return;
        }
        this.cellEditCloseAllService.closeAll();
        hermesTimer(0)
            .pipe(this.hermesTakeUntil())
            .subscribe(() => {
            this.inEditMode = true;
            this.valueChanges$ = new ChangedValueEmitter();
            this.status$ = new ChangedValueEmitter();
            this.editContext = {
                status: this.status$,
                valueChanges: this.valueChanges$,
                value: this.cell.getValue(this.entity).value,
                focus: forceCheck,
                parent: this.elementRef
            };
            this.observeFieldStatus();
            this.observeValueChanges();
            this.publishEditEnter();
            if (!forceCheck) {
                this.changeDetectorRef.markForCheck();
            }
            else {
                this.changeDetectorRef.detectChanges();
            }
        });
    }
    exitEditMode() {
        this.inEditMode = false;
        this.changeDetectorRef.detectChanges();
    }
    submitChangesAndExit() {
        const itemId = this.entity.getId(), updatedValue = this.actualValue, fieldId = this.cell.columnFieldId;
        this.sourceCommandService.editItem(new StructureEditSourceItemParams(itemId, fieldId, updatedValue), this.structureId);
        this.exitEditMode();
    }
    observeFieldStatus() {
        this.status$
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((status) => {
            switch (status) {
                case EditEventType.SUBMIT:
                    this.submitChangesAndExit();
                    this.publishEditSubmit();
                    break;
                case EditEventType.CANCEL:
                    this.exitEditMode();
                    this.publishEditCancel();
                    break;
                default:
                    break;
            }
        });
    }
    observeValueChanges() {
        this.valueChanges$
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((value) => {
            this.actualValue = value;
        });
    }
    publishEditState(state) {
        this.structureCellEditStore.next(state);
    }
    publishEditEnter() {
        this.publishEditState(StructureCellEditState.ENTER);
    }
    publishEditCancel() {
        this.publishEditState(StructureCellEditState.CANCEL);
    }
    publishEditSubmit() {
        this.publishEditState(StructureCellEditState.SUBMIT);
    }
    getSelectorName() {
        return 'gui-structure-cell';
    }
}
StructureCellComponent.ɵfac = function StructureCellComponent_Factory(t) { return new (t || StructureCellComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(StructureCellEditStore), i0.ɵɵdirectiveInject(StructureCellEditCloseAllService), i0.ɵɵdirectiveInject(SourceCommandInvoker), i0.ɵɵdirectiveInject(CompositionWarehouse)); };
StructureCellComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureCellComponent, selectors: [["div", "gui-structure-cell", "", "entity", "", "cell", ""]], inputs: { entity: "entity", cell: "cell", editMode: "editMode", cellEditorManager: "cellEditorManager", searchPhrase: "searchPhrase", rowIndex: "rowIndex", columnIndex: "columnIndex" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$w, decls: 2, vars: 2, consts: [[4, "ngIf"], [3, "ngClass", "click", 4, "ngIf"], ["class", "gui-cell-edit-mode", 4, "ngIf"], [3, "ngClass", "click"], [4, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "gui-cell-edit-mode"], ["gui-structure-cell-edit-boolean", "", 3, "cell", "entity"]], template: function StructureCellComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureCellComponent_ng_container_0_Template, 3, 2, "ng-container", 0);
        i0.ɵɵtemplate(1, StructureCellComponent_ng_container_1_Template, 2, 2, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", !ctx.cell.isBooleanDataType() || ctx.cell.isBooleanDataType() && !ctx.isCellEditingEnabled());
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.cell.isBooleanDataType() && ctx.isCellEditingEnabled());
    } }, directives: [i4.NgIf, i4.NgClass, i4.NgTemplateOutlet, StructureCellEditBooleanComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCellComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-cell][entity][cell]',
                templateUrl: './structure.cell.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: CompositionId }, { type: StructureCellEditStore }, { type: StructureCellEditCloseAllService }, { type: SourceCommandInvoker }, { type: CompositionWarehouse }]; }, { entity: [{
            type: Input
        }], cell: [{
            type: Input
        }], editMode: [{
            type: Input
        }], cellEditorManager: [{
            type: Input
        }], searchPhrase: [{
            type: Input
        }], rowIndex: [{
            type: Input
        }], columnIndex: [{
            type: Input
        }] }); })();

const _c0$v = ["gui-structure-row", ""];
function StructureRowComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 2);
    i0.ɵɵelementStart(1, "gui-checkbox", 3);
    i0.ɵɵlistener("changed", function StructureRowComponent_div_0_Template_gui_checkbox_changed_1_listener() { i0.ɵɵrestoreView(_r3); const ctx_r2 = i0.ɵɵnextContext(); return ctx_r2.selectRow(); });
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("checked", ctx_r0.selectedItem);
} }
function StructureRowComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 4);
} if (rf & 2) {
    const column_r4 = ctx.$implicit;
    const i_r5 = ctx.index;
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵstyleProp("width", column_r4.width, "px");
    i0.ɵɵproperty("cellEditorManager", ctx_r1.cellEditing)("cell", column_r4)("columnIndex", i_r5)("editMode", ctx_r1.editMode)("entity", ctx_r1.entity)("rowIndex", ctx_r1.index)("searchPhrase", ctx_r1.searchPhrase);
} }
class StructureRowComponent extends SmartComponent {
    constructor(changeDetectorRef, elRef, structureId, formationWarehouse, formationCommandDispatcher, cssClassModifier) {
        super(changeDetectorRef, elRef);
        this.changeDetectorRef = changeDetectorRef;
        this.elRef = elRef;
        this.structureId = structureId;
        this.formationWarehouse = formationWarehouse;
        this.formationCommandDispatcher = formationCommandDispatcher;
        this.cssClassModifier = cssClassModifier;
        this.detailsEnabled = false;
        this.checkboxSelection = false;
        this.selectedItem = false;
        this.styleModifier = new StyleModifier(this.elRef.nativeElement);
        this.classModifier = new ClassModifier(this.elRef.nativeElement);
    }
    ngOnChanges(changes) {
        if (changes.entity !== undefined && changes.entity.currentValue !== undefined) {
            this.checkSelectedItem();
            this.updateRowClass(changes.entity.previousValue);
            this.updateRowStyle(changes.entity.previousValue);
        }
        if (changes.rowClass !== undefined && changes.rowClass.currentValue !== undefined) {
            this.updateRowClass();
        }
        if (changes.rowStyle !== undefined && changes.rowStyle.currentValue !== undefined) {
            this.updateRowStyle();
        }
    }
    ngOnInit() {
        this.hermesSubscribeWithoutRender(this.formationWarehouse.onRowSelectedReadModel(this.structureId), (row) => {
            this.row = row;
            const prevValue = this.selectedItem;
            this.checkSelectedItem();
            if (prevValue !== this.selectedItem) {
                if (prevValue) {
                    this.cssClassModifier.unselect(this.elRef.nativeElement);
                }
                else {
                    this.cssClassModifier.select(this.elRef.nativeElement);
                }
                this.changeDetectorRef.detectChanges();
            }
        });
    }
    ngAfterViewInit() {
        super.ngAfterViewInit();
        this.updateRowClass();
        this.updateRowStyle();
    }
    trackByFn() {
        return 0;
    }
    selectRow() {
        event.stopPropagation();
        this.formationCommandDispatcher.toggleSelectedRow(this.entity.getId(), RowSelectToggleType.ADD, this.structureId);
    }
    checkSelectedItem() {
        if (this.row) {
            const prevValue = this.selectedItem;
            this.selectedItem = this.row.isSelected(this.entity.getId());
            if (prevValue !== this.selectedItem) {
                if (prevValue) {
                    this.cssClassModifier.unselect(this.elRef.nativeElement);
                }
                else {
                    this.cssClassModifier.select(this.elRef.nativeElement);
                }
            }
        }
    }
    calculateRowStyle(entity) {
        if (!this.rowStyle) {
            return '';
        }
        if (typeof this.rowStyle.style === 'string') {
            return this.rowStyle.style || '';
        }
        if (typeof this.rowStyle.styleFunction === 'function') {
            return this.rowStyle.styleFunction(entity.getSourceItem(), entity.getPosition());
        }
        return '';
    }
    updateRowStyle(prevEntity) {
        if (prevEntity) {
            const rowStylesToRemove = this.calculateRowStyle(prevEntity);
            this.removeRowStyles(rowStylesToRemove);
        }
        const rowStylesToAdd = this.calculateRowStyle(this.entity);
        this.renderRowStyles(rowStylesToAdd);
    }
    removeRowStyles(rowStyle) {
        if (!rowStyle) {
            return;
        }
        const styles = rowStyle.split(';');
        for (let i = 0; i < styles.length; i += 1) {
            const separatedStyles = styles[i].split(':');
            if (separatedStyles[0] && separatedStyles[1]) {
                this.styleModifier.getHost().removeStyleByName(separatedStyles[0].trim());
            }
        }
    }
    renderRowStyles(rowStyle) {
        if (!rowStyle) {
            return;
        }
        const styles = rowStyle.split(';');
        for (let i = 0; i < styles.length; i += 1) {
            const separatedStyles = styles[i].split(':');
            if (separatedStyles[0] && separatedStyles[1]) {
                this.styleModifier.getHost().setStyleByName(separatedStyles[0].trim(), separatedStyles[1].trim());
            }
        }
    }
    updateRowClass(prevEntity) {
        if (prevEntity) {
            const toRemoveClass = this.calculateRowClass(prevEntity);
            if (toRemoveClass) {
                this.classModifier.getHost().remove(toRemoveClass);
            }
        }
        const toAddClass = this.calculateRowClass(this.entity);
        if (toAddClass) {
            this.classModifier.getHost().add(toAddClass);
        }
    }
    calculateRowClass(entity) {
        if (!this.rowClass) {
            return '';
        }
        let clazz;
        if (typeof this.rowClass.class === 'string') {
            clazz = this.rowClass.class || '';
        }
        if (typeof this.rowClass.classFunction === 'function') {
            if (entity) {
                clazz = this.rowClass.classFunction(entity.getSourceItem(), entity.getPosition()) || '';
            }
        }
        return clazz;
    }
    getSelectorName() {
        return 'gui-structure-row';
    }
}
StructureRowComponent.ɵfac = function StructureRowComponent_Factory(t) { return new (t || StructureRowComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FormationWarehouse), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(CssClassModifier)); };
StructureRowComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureRowComponent, selectors: [["div", "gui-structure-row", ""]], inputs: { entity: "entity", columns: "columns", editMode: "editMode", cellEditing: "cellEditing", searchPhrase: "searchPhrase", index: "index", rowStyle: "rowStyle", rowClass: "rowClass", detailsEnabled: "detailsEnabled", checkboxSelection: "checkboxSelection" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$v, decls: 2, vars: 3, consts: [["class", "gui-cell gui-row-checkbox", 4, "ngIf"], ["class", "gui-cell", "gui-structure-cell", "", 3, "cellEditorManager", "cell", "columnIndex", "editMode", "entity", "rowIndex", "searchPhrase", "width", 4, "ngFor", "ngForOf", "ngForTrackBy"], [1, "gui-cell", "gui-row-checkbox"], [3, "checked", "changed"], ["gui-structure-cell", "", 1, "gui-cell", 3, "cellEditorManager", "cell", "columnIndex", "editMode", "entity", "rowIndex", "searchPhrase"]], template: function StructureRowComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureRowComponent_div_0_Template, 2, 1, "div", 0);
        i0.ɵɵtemplate(1, StructureRowComponent_div_1_Template, 1, 9, "div", 1);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.checkboxSelection);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngForOf", ctx.columns)("ngForTrackBy", ctx.trackByFn);
    } }, directives: [i4.NgIf, i4.NgForOf, i1.FabricCheckboxComponent, StructureCellComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-row]',
                templateUrl: './structure-row.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: FormationWarehouse }, { type: FormationCommandInvoker }, { type: CssClassModifier }]; }, { entity: [{
            type: Input
        }], columns: [{
            type: Input
        }], editMode: [{
            type: Input
        }], cellEditing: [{
            type: Input
        }], searchPhrase: [{
            type: Input
        }], index: [{
            type: Input
        }], rowStyle: [{
            type: Input
        }], rowClass: [{
            type: Input
        }], detailsEnabled: [{
            type: Input
        }], checkboxSelection: [{
            type: Input
        }] }); })();

const _c0$u = ["gui-structure-content", ""];
const _c1$8 = function (a0, a1) { return { "even": a0, "odd": a1 }; };
const _c2$3 = function (a0) { return { "transform": a0 }; };
function StructureContentComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r4 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 2);
    i0.ɵɵlistener("click", function StructureContentComponent_div_1_Template_div_click_0_listener() { const restoredCtx = i0.ɵɵrestoreView(_r4); const entity_r1 = restoredCtx.$implicit; const ctx_r3 = i0.ɵɵnextContext(); return ctx_r3.toggleSelectedRow(entity_r1); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const entity_r1 = ctx.$implicit;
    const index_r2 = ctx.index;
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵstyleProp("height", ctx_r0.rowHeight, "px");
    i0.ɵɵproperty("cellEditing", ctx_r0.cellEditing)("checkboxSelection", ctx_r0.checkboxSelection)("columns", ctx_r0.columns)("detailsEnabled", ctx_r0.rowDetailOpened === index_r2)("editMode", ctx_r0.editMode)("entity", entity_r1)("id", entity_r1.getUiId())("index", entity_r1.getPosition())("ngClass", i0.ɵɵpureFunction2(15, _c1$8, entity_r1.isEven(), entity_r1.isOdd()))("ngStyle", i0.ɵɵpureFunction1(18, _c2$3, ctx_r0.translateY(index_r2)))("rowClass", ctx_r0.schemaRowClass)("rowStyle", ctx_r0.schemaRowStyle)("searchPhrase", ctx_r0.searchPhrase);
} }
class StructureContentComponent extends SmartComponent {
    constructor(elementRef, changeDetectorRef, formationCommandService, structureEditModeArchive, formationWarehouse, structureWarehouse, structureVerticalFormationWarehouse, verticalFormationRepository, structureId, // REfactor
    rowSelectionTypeArchive, searchWarehouse, schemaRowClassArchive, schemaRowStyleArchive) {
        super(changeDetectorRef, elementRef);
        this.elementRef = elementRef;
        this.changeDetectorRef = changeDetectorRef;
        this.formationCommandService = formationCommandService;
        this.structureEditModeArchive = structureEditModeArchive;
        this.formationWarehouse = formationWarehouse;
        this.structureWarehouse = structureWarehouse;
        this.structureVerticalFormationWarehouse = structureVerticalFormationWarehouse;
        this.verticalFormationRepository = verticalFormationRepository;
        this.structureId = structureId;
        this.rowSelectionTypeArchive = rowSelectionTypeArchive;
        this.searchWarehouse = searchWarehouse;
        this.schemaRowClassArchive = schemaRowClassArchive;
        this.schemaRowStyleArchive = schemaRowStyleArchive;
        this.editMode = false;
        this.searchPhrase = '';
        this.highlighting = true;
        this.phrase = true;
        this.rowDetailOpened = 4;
        this.checkboxSelection = false;
    }
    ngOnInit() {
        this.hermesSubscribe(this.rowSelectionTypeArchive.on(), (type) => {
            this.checkboxSelection = type === RowSelectionType.CHECKBOX;
        });
        this.hermesSubscribe(this.structureEditModeArchive.on(), (enabled) => {
            this.editMode = enabled;
        });
        this.hermesSubscribe(this.structureWarehouse.onEditManager(this.structureId), (manager) => {
            this.cellEditing = manager;
        });
        this.hermesSubscribe(this.schemaRowClassArchive.on(), (schemaRowClass) => {
            this.schemaRowClass = schemaRowClass;
        });
        this.hermesSubscribe(this.schemaRowStyleArchive.on(), (schemaRowStyle) => {
            this.schemaRowStyle = schemaRowStyle;
        });
        this.hermesSubscribe(this.structureVerticalFormationWarehouse.onRowHeight(this.structureId), (rowHeight) => {
            this.rowHeight = rowHeight;
        });
        this.hermesSubscribe(fromRxJsObservable(combineLatest(toRxJsObservable(this.searchWarehouse.onPhrase(this.structureId)), toRxJsObservable(this.searchWarehouse.onHighlight(this.structureId)))), (args) => {
            const searchPhrase = args[0], highlighting = args[1];
            this.highlighting = highlighting;
            this.searchPhrase = searchPhrase;
            if (!this.highlighting) {
                this.searchPhrase = '';
            }
        });
    }
    trackByFn() {
        return 0;
    }
    translateY(index) {
        const height = index * this.rowHeight;
        return `translateY(${height}px)`;
    }
    toggleSelectedRow(entity) {
        if (!this.checkboxSelection) {
            this.formationCommandService.toggleSelectedRow(entity.getId(), RowSelectToggleType.NONE, this.structureId);
        }
    }
    getSelectorName() {
        return 'gui-structure-content';
    }
}
StructureContentComponent.ɵfac = function StructureContentComponent_Factory(t) { return new (t || StructureContentComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(StructureEditModeArchive), i0.ɵɵdirectiveInject(FormationWarehouse), i0.ɵɵdirectiveInject(StructureWarehouse), i0.ɵɵdirectiveInject(VerticalFormationWarehouse), i0.ɵɵdirectiveInject(VerticalFormationRepository), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(RowSelectionTypeArchive), i0.ɵɵdirectiveInject(SearchWarehouse), i0.ɵɵdirectiveInject(SchemaRowClassArchive), i0.ɵɵdirectiveInject(SchemaRowStyleArchive)); };
StructureContentComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureContentComponent, selectors: [["div", "gui-structure-content", ""]], inputs: { source: "source", columns: "columns" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$u, decls: 2, vars: 2, consts: [[1, "gui-content"], ["class", "gui-row", "gui-structure-row", "", 3, "cellEditing", "checkboxSelection", "columns", "detailsEnabled", "editMode", "entity", "id", "index", "ngClass", "ngStyle", "rowClass", "rowStyle", "searchPhrase", "height", "click", 4, "ngFor", "ngForOf", "ngForTrackBy"], ["gui-structure-row", "", 1, "gui-row", 3, "cellEditing", "checkboxSelection", "columns", "detailsEnabled", "editMode", "entity", "id", "index", "ngClass", "ngStyle", "rowClass", "rowStyle", "searchPhrase", "click"]], template: function StructureContentComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵtemplate(1, StructureContentComponent_div_1_Template, 1, 20, "div", 1);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngForOf", ctx.source)("ngForTrackBy", ctx.trackByFn);
    } }, directives: [i4.NgForOf, StructureRowComponent, i4.NgClass, i4.NgStyle], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureContentComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-content]',
                templateUrl: './structure-content.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: FormationCommandInvoker }, { type: StructureEditModeArchive }, { type: FormationWarehouse }, { type: StructureWarehouse }, { type: VerticalFormationWarehouse }, { type: VerticalFormationRepository }, { type: StructureId }, { type: RowSelectionTypeArchive }, { type: SearchWarehouse }, { type: SchemaRowClassArchive }, { type: SchemaRowStyleArchive }]; }, { source: [{
            type: Input
        }], columns: [{
            type: Input
        }] }); })();

const _c0$t = ["sourceCollection"];
const _c1$7 = ["gui-structure-container", ""];
class StructureContainerComponent extends SmartComponent {
    constructor(changeDetectorRef, elRef, ngZone, structureId, compositionId, structureCommandService, structureWarehouse, verticalFormationWarehouse, sourceWarehouse, compositionCommandInvoker, compositionWarehouse, formationWarehouse, resizeDetector, structureInitialValuesReadyArchive, structureParent) {
        super(changeDetectorRef, elRef);
        this.elRef = elRef;
        this.ngZone = ngZone;
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.structureCommandService = structureCommandService;
        this.structureWarehouse = structureWarehouse;
        this.verticalFormationWarehouse = verticalFormationWarehouse;
        this.sourceWarehouse = sourceWarehouse;
        this.compositionCommandInvoker = compositionCommandInvoker;
        this.compositionWarehouse = compositionWarehouse;
        this.formationWarehouse = formationWarehouse;
        this.resizeDetector = resizeDetector;
        this.structureInitialValuesReadyArchive = structureInitialValuesReadyArchive;
        this.structureParent = structureParent;
        this.columns = [];
        this.source = [];
        this.autoResizeWidthEnabled = false;
        this.scrollObservation$ = new HermesSubject();
        this.styleModifier = new StyleModifier(this.elRef.nativeElement);
    }
    ngOnInit() {
        this.hermesSubscribeWithoutRender(this.verticalFormationWarehouse.onContainerHeight(this.structureId), (containerHeight) => {
            this.setContainerHeight(containerHeight);
        });
        this.hermesSubscribe(fromRxJsObservable(toRxJsObservable(this.structureInitialValuesReadyArchive.once(this.structureId))
            .pipe(flatMap(() => {
            return combineLatest(toRxJsObservable(this.sourceWarehouse.onEntities(this.structureId)), toRxJsObservable(this.compositionWarehouse.onTemplateColumns(this.compositionId)));
        }))), (arr) => {
            this.source = arr[0];
            this.columns = arr[1];
        });
        this.hermesSubscribeWithoutRender(this.compositionWarehouse.onResizeWidth(this.compositionId), (enabled) => {
            this.autoResizeWidthEnabled = enabled;
        });
    }
    ngAfterViewInit() {
        super.ngAfterViewInit();
        // turn on when structure is ready
        if (this.structureParent) {
            this.hermesSubscribeWithoutRender(this.resizeDetector
                .on(this.structureParent.getElementRef().nativeElement)
                .pipe(hermesFilter(() => this.autoResizeWidthEnabled), hermesMap((size) => size.width), hermesDistinctUntilChanged()), (width) => {
                this.recalculateContainer(width);
            });
        }
        this.hermesSubscribeWithoutRender(this.compositionWarehouse.onContainerWidth(this.compositionId), (width) => {
            this.styleModifier.getElement(this.sourceCollectionRef.nativeElement).setWidth(width);
        });
        this.hermesSubscribeWithoutRender(this.verticalFormationWarehouse.onVerticalScrollEnabled(this.structureId), (enabled) => {
            if (enabled) {
                this.enableScrollObservation();
            }
            else {
                this.disableScrollObservation();
            }
        });
        this.hermesSubscribeWithoutRender(this.structureWarehouse
            .on(this.structureId)
            .pipe(hermesFilter((str) => {
            return str.isVerticalScrollEnabled();
        })), (structure) => {
            const topMargin = structure.getTopMargin(), sourceHeight = structure.getSourceHeight();
            this.setSourceHeight(topMargin, sourceHeight);
        });
        this.hermesSubscribeWithoutRender(this.verticalFormationWarehouse.onScrollBarPosition(this.structureId), (scrollPosition) => {
            this.elRef.nativeElement.scrollTop = scrollPosition;
        });
    }
    ngOnDestroy() {
        super.ngOnDestroy();
        this.resizeDetector.destroy(this.elRef.nativeElement);
    }
    setContainerHeight(height) {
        this.height = height;
        this.styleModifier.getHost().setHeight(height);
    }
    setSourceHeight(topMargin, sourceHeight) {
        this.styleModifier.getElement(this.sourceCollectionRef.nativeElement).setPaddingTop(topMargin);
        this.styleModifier.getElement(this.sourceCollectionRef.nativeElement).setHeight(sourceHeight);
    }
    recalculateContainer(width) {
        if (this.autoResizeWidthEnabled) {
            this.compositionCommandInvoker.setContainerWidth(width, this.compositionId);
        }
    }
    enableScrollObservation() {
        this.ngZone
            .runOutsideAngular(() => {
            hermesFromEvent(this.elRef.nativeElement, 'scroll')
                .pipe(hermesTakeUntil(this.scrollObservation$))
                .subscribe((event) => {
                const scrollTop = event.target.scrollTop;
                this.structureCommandService.setScrollPosition(scrollTop, this.structureId);
            });
        });
    }
    disableScrollObservation() {
        this.scrollObservation$.next();
        this.scrollObservation$.complete();
    }
    getSelectorName() {
        return 'gui-structure-container';
    }
}
StructureContainerComponent.ɵfac = function StructureContainerComponent_Factory(t) { return new (t || StructureContainerComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(StructureCommandInvoker), i0.ɵɵdirectiveInject(StructureWarehouse), i0.ɵɵdirectiveInject(VerticalFormationWarehouse), i0.ɵɵdirectiveInject(SourceWarehouse), i0.ɵɵdirectiveInject(CompositionCommandInvoker), i0.ɵɵdirectiveInject(CompositionWarehouse), i0.ɵɵdirectiveInject(FormationWarehouse), i0.ɵɵdirectiveInject(ResizeDetector), i0.ɵɵdirectiveInject(StructureInitialValuesReadyArchive), i0.ɵɵdirectiveInject(structureParentComponent, 8)); };
StructureContainerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureContainerComponent, selectors: [["div", "gui-structure-container", ""]], viewQuery: function StructureContainerComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$t, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sourceCollectionRef = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c1$7, decls: 3, vars: 2, consts: [[1, "gui-h-full", "gui-w-full", "gui-absolute", "gui-structure-container-element"], ["sourceCollection", ""], ["gui-structure-content", "", 3, "columns", "source"]], template: function StructureContainerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0, 1);
        i0.ɵɵelement(2, "div", 2);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("columns", ctx.columns)("source", ctx.source);
    } }, directives: [StructureContentComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureContainerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-container]',
                templateUrl: './structure-container.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.NgZone }, { type: StructureId }, { type: CompositionId }, { type: StructureCommandInvoker }, { type: StructureWarehouse }, { type: VerticalFormationWarehouse }, { type: SourceWarehouse }, { type: CompositionCommandInvoker }, { type: CompositionWarehouse }, { type: FormationWarehouse }, { type: ResizeDetector }, { type: StructureInitialValuesReadyArchive }, { type: undefined, decorators: [{
                type: Optional$1
            }, {
                type: Inject,
                args: [structureParentComponent]
            }] }]; }, { sourceCollectionRef: [{
            type: ViewChild,
            args: ['sourceCollection', { static: false }]
        }] }); })();

class StructureBannerPanel extends SmartComponent {
    constructor(changeDetectorRef, elementRef) {
        super(changeDetectorRef, elementRef);
    }
    ngOnInit() {
        this.hermesSubscribe(this.onBannerPanelConfig(), (config) => {
            this.bannerPanel = config.template;
            if (typeof this.bannerPanel === 'function') {
                this.bannerPanel = this.bannerPanel();
            }
        });
    }
}
StructureBannerPanel.ɵfac = function StructureBannerPanel_Factory(t) { return new (t || StructureBannerPanel)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureBannerPanel.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureBannerPanel, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureBannerPanel, [{
        type: Directive
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, null); })();

class SafePipe {
    constructor(sanitizer) {
        this.sanitizer = sanitizer;
    }
    transform(value, type) {
        switch (type) {
            case 'html':
                return this.sanitizer.bypassSecurityTrustHtml(value);
            case 'style':
                return this.sanitizer.bypassSecurityTrustStyle(value);
            case 'script':
                return this.sanitizer.bypassSecurityTrustScript(value);
            case 'url':
                return this.sanitizer.bypassSecurityTrustUrl(value);
            case 'resourceUrl':
                return this.sanitizer.bypassSecurityTrustResourceUrl(value);
            default:
                throw new Error(`Invalid safe type specified: ${type}`);
        }
    }
}
SafePipe.ɵfac = function SafePipe_Factory(t) { return new (t || SafePipe)(i0.ɵɵdirectiveInject(i1$3.DomSanitizer, 16)); };
SafePipe.ɵpipe = /*@__PURE__*/ i0.ɵɵdefinePipe({ name: "guiSafe", type: SafePipe, pure: true });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SafePipe, [{
        type: Pipe,
        args: [{
                name: 'guiSafe'
            }]
    }], function () { return [{ type: i1$3.DomSanitizer }]; }, null); })();

const _c0$s = ["gui-structure-title-panel", ""];
class StructureTitlePanelComponent extends StructureBannerPanel {
    constructor(structureTitlePanelConfigArchive, changeDetectorRef, elementRef) {
        super(changeDetectorRef, elementRef);
        this.structureTitlePanelConfigArchive = structureTitlePanelConfigArchive;
    }
    onBannerPanelConfig() {
        return this.structureTitlePanelConfigArchive.on();
    }
    getSelectorName() {
        return 'gui-structure-title-panel';
    }
    getPanelTitle() {
        return 'Title panel';
    }
}
StructureTitlePanelComponent.ɵfac = function StructureTitlePanelComponent_Factory(t) { return new (t || StructureTitlePanelComponent)(i0.ɵɵdirectiveInject(StructureTitlePanelConfigArchive), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureTitlePanelComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureTitlePanelComponent, selectors: [["div", "gui-structure-title-panel", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$s, decls: 2, vars: 4, consts: [[1, "gui-title-panel", "gui-p-6", "gui-border-b", "gui-border-b-solid", 3, "innerHTML"]], template: function StructureTitlePanelComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
        i0.ɵɵpipe(1, "guiSafe");
    } if (rf & 2) {
        i0.ɵɵproperty("innerHTML", i0.ɵɵpipeBind2(1, 1, ctx.bannerPanel, "html"), i0.ɵɵsanitizeHtml);
    } }, pipes: [SafePipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureTitlePanelComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-title-panel]',
                templateUrl: './structure.title-panel.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: StructureTitlePanelConfigArchive }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, null); })();

const _c0$r = ["gui-structure-top-panel", ""];
class StructureTopPanelComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.addClassToHost('gui-p-6');
        this.addClassToHost('gui-border-b');
        this.addClassToHost('gui-border-b-solid');
    }
    getSelectorName() {
        return 'gui-structure-top-panel';
    }
}
StructureTopPanelComponent.ɵfac = function StructureTopPanelComponent_Factory(t) { return new (t || StructureTopPanelComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureTopPanelComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureTopPanelComponent, selectors: [["div", "gui-structure-top-panel", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$r, decls: 1, vars: 0, consts: [["gui-search-bar", "", 1, "gui-flex", "gui-items-center", "gui-h-full", "gui-w-3/5", "gui-mr-auto"]], template: function StructureTopPanelComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
    } }, directives: [SearchComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureTopPanelComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-top-panel]',
                template: `

		<div gui-search-bar
			 class="gui-flex gui-items-center gui-h-full gui-w-3/5 gui-mr-auto"></div>
		<!--		<gui-filter-menu-trigger></gui-filter-menu-trigger>-->

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, null); })();

const _c0$q = ["gui-structure-column-config-column-hide", ""];
class StructureColumnConfigColumnHideComponent extends PureComponent {
    constructor(elRef) {
        super(elRef);
        this.columnHidden = new EventEmitter();
    }
    hideColumn() {
        this.columnHidden.emit();
    }
    getSelectorName() {
        return 'gui-structure-column-config-column-hide';
    }
}
StructureColumnConfigColumnHideComponent.ɵfac = function StructureColumnConfigColumnHideComponent_Factory(t) { return new (t || StructureColumnConfigColumnHideComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureColumnConfigColumnHideComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnConfigColumnHideComponent, selectors: [["div", "gui-structure-column-config-column-hide", ""]], inputs: { column: "column" }, outputs: { columnHidden: "columnHidden" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$q, decls: 3, vars: 3, consts: [[1, "gui-header-menu-item", 3, "click"]], template: function StructureColumnConfigColumnHideComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵlistener("click", function StructureColumnConfigColumnHideComponent_Template_div_click_0_listener() { return ctx.hideColumn(); });
        i0.ɵɵtext(1);
        i0.ɵɵpipe(2, "guiTranslate");
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(2, 1, "headerMenuMainTabHideColumn"), "\n");
    } }, pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnConfigColumnHideComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-config-column-hide]',
                templateUrl: './structure.column-config-column-hide.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { column: [{
            type: Input
        }], columnHidden: [{
            type: Output
        }] }); })();

const _c0$p = ["gui-structure-column-menu-arrow-icon", ""];
class StructureColumnMenuArrowIconComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.rotateDeg = 90;
    }
    getSelectorName() {
        return 'gui-structure-column-menu-arrow-icon';
    }
}
StructureColumnMenuArrowIconComponent.ɵfac = function StructureColumnMenuArrowIconComponent_Factory(t) { return new (t || StructureColumnMenuArrowIconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureColumnMenuArrowIconComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnMenuArrowIconComponent, selectors: [["div", "gui-structure-column-menu-arrow-icon", ""]], inputs: { rotateDeg: "rotateDeg", sort: "sort" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$p, decls: 5, vars: 4, consts: [["xmlns", "http://www.w3.org/2000/svg", "viewBox", "0 0 10.04 11.72"], ["x1", "5.02", "y1", "2.15", "x2", "5.02", "y2", "10.97", 1, "cls-1"], ["x1", "5.02", "y1", "0.75", "x2", "9.29", "y2", "5.02", 1, "cls-1"], ["x1", "5.02", "y1", "0.75", "x2", "0.75", "y2", "5.02", 1, "cls-1"]], template: function StructureColumnMenuArrowIconComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div");
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(1, "svg", 0);
        i0.ɵɵelement(2, "line", 1);
        i0.ɵɵelement(3, "line", 2);
        i0.ɵɵelement(4, "line", 3);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵstyleProp("transform", "rotate(" + ctx.rotateDeg + "deg)");
        i0.ɵɵclassProp("gui-structure-column-menu-sort-icon", ctx.sort);
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnMenuArrowIconComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-menu-arrow-icon]',
                template: `
		<div [style.transform]="'rotate(' + rotateDeg + 'deg)'"
			 [class.gui-structure-column-menu-sort-icon]="sort">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10.04 11.72">
				<line class="cls-1" x1="5.02" y1="2.15" x2="5.02" y2="10.97"/>
				<line class="cls-1" x1="5.02" y1="0.75" x2="9.29" y2="5.02"/>
				<line class="cls-1" x1="5.02" y1="0.75" x2="0.75" y2="5.02"/>
			</svg>
		</div>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { rotateDeg: [{
            type: Input
        }], sort: [{
            type: Input
        }] }); })();

const _c0$o = ["gui-structure-column-config-column-move", "", "column", ""];
class StructureColumnConfigColumnMoveComponent extends PureComponent {
    constructor(elRef) {
        super(elRef);
        this.movedLeft = new EventEmitter();
        this.movedRight = new EventEmitter();
    }
    moveLeft() {
        this.movedLeft.emit();
    }
    moveRight() {
        this.movedRight.emit();
    }
    getSelectorName() {
        return 'gui-structure-column-config-column-move';
    }
}
StructureColumnConfigColumnMoveComponent.ɵfac = function StructureColumnConfigColumnMoveComponent_Factory(t) { return new (t || StructureColumnConfigColumnMoveComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureColumnConfigColumnMoveComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnConfigColumnMoveComponent, selectors: [["div", "gui-structure-column-config-column-move", "", "column", ""]], inputs: { column: "column" }, outputs: { movedLeft: "movedLeft", movedRight: "movedRight" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$o, decls: 9, vars: 7, consts: [[1, "gui-header-menu-column-move"], [1, "gui-header-menu-column-move-item", "left", 3, "click"], ["gui-structure-column-menu-arrow-icon", "", 3, "rotateDeg"], [1, "gui-header-menu-column-move-item", "right", 3, "click"], ["gui-structure-column-menu-arrow-icon", ""]], template: function StructureColumnConfigColumnMoveComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵelementStart(1, "div", 1);
        i0.ɵɵlistener("click", function StructureColumnConfigColumnMoveComponent_Template_div_click_1_listener() { return ctx.moveLeft(); });
        i0.ɵɵelement(2, "div", 2);
        i0.ɵɵtext(3);
        i0.ɵɵpipe(4, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(5, "div", 3);
        i0.ɵɵlistener("click", function StructureColumnConfigColumnMoveComponent_Template_div_click_5_listener() { return ctx.moveRight(); });
        i0.ɵɵtext(6);
        i0.ɵɵpipe(7, "guiTranslate");
        i0.ɵɵelement(8, "div", 4);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("rotateDeg", -90);
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(4, 3, "headerMenuMainTabMoveLeft"), " ");
        i0.ɵɵadvance(3);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(7, 5, "headerMenuMainTabMoveRight"), " ");
    } }, directives: [StructureColumnMenuArrowIconComponent], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnConfigColumnMoveComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-config-column-move][column]',
                templateUrl: './structure.column-config-column-move.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { column: [{
            type: Input
        }], movedLeft: [{
            type: Output
        }], movedRight: [{
            type: Output
        }] }); })();

var SortOrder;
(function (SortOrder) {
    SortOrder[SortOrder["ASC"] = 0] = "ASC";
    SortOrder[SortOrder["DESC"] = 1] = "DESC";
    SortOrder[SortOrder["NONE"] = 2] = "NONE";
})(SortOrder || (SortOrder = {}));

const _c0$n = ["gui-structure-column-config-sort", ""];
class StructureColumnConfigSortComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, compositionId, structureId, sortingCommandDispatcher, compositionReadModelService) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.compositionId = compositionId;
        this.structureId = structureId;
        this.sortingCommandDispatcher = sortingCommandDispatcher;
        this.compositionReadModelService = compositionReadModelService;
        this.placement = Placement.Right;
        this.status = SortOrder;
    }
    ngOnInit() {
        this.sortStatus = this.column.getSortStatus();
        this.hermesSubscribe(this.compositionReadModelService.onSortOrder(this.column.getFieldId(), this.compositionId), (sortStatus) => {
            this.sortStatus = sortStatus;
        });
    }
    isAscSort() {
        return this.sortStatus === SortOrder.ASC;
    }
    isDescSort() {
        return this.sortStatus === SortOrder.DESC;
    }
    isNoneSort() {
        return this.sortStatus === SortOrder.NONE;
    }
    setSortOrder(sort) {
        event.stopPropagation();
        this.sortingCommandDispatcher.setSortOrder(this.column.getFieldId(), sort, this.compositionId, this.structureId);
    }
    getSelectorName() {
        return 'gui-structure-column-config-sort';
    }
}
StructureColumnConfigSortComponent.ɵfac = function StructureColumnConfigSortComponent_Factory(t) { return new (t || StructureColumnConfigSortComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SortingCommandInvoker), i0.ɵɵdirectiveInject(CompositionWarehouse)); };
StructureColumnConfigSortComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnConfigSortComponent, selectors: [["div", "gui-structure-column-config-sort", ""]], inputs: { column: "column", dropdownTextTranslation: "dropdownTextTranslation" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$n, decls: 14, vars: 23, consts: [[1, "gui-header-menu-dropdown", 3, "dropdownText", "placement", "showOnHover", "width"], [3, "click"], [1, "gui-sort-title"], ["gui-structure-column-menu-arrow-icon", "", 3, "rotateDeg", "sort"]], template: function StructureColumnConfigSortComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "gui-dropdown", 0);
        i0.ɵɵelementStart(1, "gui-dropdown-item", 1);
        i0.ɵɵlistener("click", function StructureColumnConfigSortComponent_Template_gui_dropdown_item_click_1_listener() { return ctx.setSortOrder(ctx.status.ASC); });
        i0.ɵɵelementStart(2, "div", 2);
        i0.ɵɵtext(3);
        i0.ɵɵpipe(4, "guiTranslate");
        i0.ɵɵelement(5, "div", 3);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(6, "gui-dropdown-item", 1);
        i0.ɵɵlistener("click", function StructureColumnConfigSortComponent_Template_gui_dropdown_item_click_6_listener() { return ctx.setSortOrder(ctx.status.DESC); });
        i0.ɵɵelementStart(7, "div", 2);
        i0.ɵɵtext(8);
        i0.ɵɵpipe(9, "guiTranslate");
        i0.ɵɵelement(10, "div", 3);
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(11, "gui-dropdown-item", 1);
        i0.ɵɵlistener("click", function StructureColumnConfigSortComponent_Template_gui_dropdown_item_click_11_listener() { return ctx.setSortOrder(ctx.status.NONE); });
        i0.ɵɵtext(12);
        i0.ɵɵpipe(13, "guiTranslate");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("dropdownText", ctx.dropdownTextTranslation)("placement", ctx.placement)("showOnHover", true)("width", 225);
        i0.ɵɵadvance(1);
        i0.ɵɵclassProp("gui-header-item-active", ctx.isAscSort());
        i0.ɵɵadvance(2);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(4, 17, "headerMenuMainTabColumnSortAscending"), " ");
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("rotateDeg", 0)("sort", true);
        i0.ɵɵadvance(1);
        i0.ɵɵclassProp("gui-header-item-active", ctx.isDescSort());
        i0.ɵɵadvance(2);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(9, 19, "headerMenuMainTabColumnSortDescending"), " ");
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("rotateDeg", 180)("sort", true);
        i0.ɵɵadvance(1);
        i0.ɵɵclassProp("gui-header-item-active", ctx.isNoneSort());
        i0.ɵɵadvance(1);
        i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(13, 21, "headerMenuMainTabColumnSortNone"), " ");
    } }, directives: [i1.FabricDropdownComponent, i1.DropdownItemComponent, StructureColumnMenuArrowIconComponent], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnConfigSortComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-config-sort]',
                templateUrl: './structure.column-config-sort.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: CompositionId }, { type: StructureId }, { type: SortingCommandInvoker }, { type: CompositionWarehouse }]; }, { column: [{
            type: Input
        }], dropdownTextTranslation: [{
            type: Input
        }] }); })();

const _c0$m = ["gui-unique-value-list", "", "fieldId", ""];
function UniqueValueListComponent_div_3_Template(rf, ctx) { if (rf & 1) {
    const _r3 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div");
    i0.ɵɵelementStart(1, "gui-checkbox", 5);
    i0.ɵɵlistener("changed", function UniqueValueListComponent_div_3_Template_gui_checkbox_changed_1_listener() { const restoredCtx = i0.ɵɵrestoreView(_r3); const value_r1 = restoredCtx.$implicit; const ctx_r2 = i0.ɵɵnextContext(); return ctx_r2.toggleSelect(value_r1); });
    i0.ɵɵtext(2);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const value_r1 = ctx.$implicit;
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("checked", value_r1.isEnabled());
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", value_r1.getValue(), " ");
} }
class UniqueValueListComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, filterWarehouse, filterCommandInvoker) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.filterWarehouse = filterWarehouse;
        this.filterCommandInvoker = filterCommandInvoker;
        this.uniqueValues = [];
    }
    ngOnInit() {
        this.hermesSubscribe(this.filterWarehouse.onUniqueValues(this.structureId), (uniqueValuesReadModel) => {
            this.uniqueValues = uniqueValuesReadModel.getValues(this.fieldId);
            this.selectAllChecked = uniqueValuesReadModel.isSelectAllChecked(this.fieldId);
            this.selectAllIndeterminate = uniqueValuesReadModel.isIndeterminate(this.fieldId);
        });
    }
    toggleAllSelect() {
        event.stopPropagation();
        if (this.selectAllChecked) {
            this.filterCommandInvoker.unselectAllUniqueFilter(this.fieldId, this.structureId);
        }
        else {
            this.filterCommandInvoker.selectAllUniqueFilter(this.fieldId, this.structureId);
        }
    }
    toggleSelect(uniqueValueReadModel) {
        event.stopPropagation();
        if (uniqueValueReadModel.isEnabled()) {
            this.filterCommandInvoker.unselectUniqueFilter(this.fieldId, uniqueValueReadModel.getId(), this.structureId);
        }
        else {
            this.filterCommandInvoker.selectUniqueFilter(this.fieldId, uniqueValueReadModel.getId(), this.structureId);
        }
    }
    clearFilters() {
        this.filterCommandInvoker.selectAllUniqueFilter(this.fieldId, this.structureId);
    }
    getSelectorName() {
        return 'gui-unique-value-list';
    }
}
UniqueValueListComponent.ɵfac = function UniqueValueListComponent_Factory(t) { return new (t || UniqueValueListComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FilterWarehouse), i0.ɵɵdirectiveInject(FilterCommandInvoker)); };
UniqueValueListComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: UniqueValueListComponent, selectors: [["div", "gui-unique-value-list", "", "fieldId", ""]], inputs: { fieldId: "fieldId" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$m, decls: 7, vars: 5, consts: [[3, "checked", "indeterminate", "changed"], [1, "gui-unique-value-list-container", "gui-overflow-y-scroll", "gui-overflow-x-hidden"], [4, "ngFor", "ngForOf"], [1, "gui-unique-value-list-actions", "gui-p-6", "gui-flex", "gui-justify-end"], ["gui-button", "", 3, "outline", "primary", "click"], [3, "checked", "changed"]], template: function UniqueValueListComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "gui-checkbox", 0);
        i0.ɵɵlistener("changed", function UniqueValueListComponent_Template_gui_checkbox_changed_0_listener() { return ctx.toggleAllSelect(); });
        i0.ɵɵtext(1, " Select all\n");
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(2, "div", 1);
        i0.ɵɵtemplate(3, UniqueValueListComponent_div_3_Template, 3, 2, "div", 2);
        i0.ɵɵelementEnd();
        i0.ɵɵelementStart(4, "div", 3);
        i0.ɵɵelementStart(5, "button", 4);
        i0.ɵɵlistener("click", function UniqueValueListComponent_Template_button_click_5_listener() { return ctx.clearFilters(); });
        i0.ɵɵtext(6, " Clear ");
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("checked", ctx.selectAllChecked)("indeterminate", ctx.selectAllIndeterminate);
        i0.ɵɵadvance(3);
        i0.ɵɵproperty("ngForOf", ctx.uniqueValues);
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("outline", true)("primary", true);
    } }, directives: [i1.FabricCheckboxComponent, i4.NgForOf, i1.FabricButtonComponent], styles: [".gui-unique-value-list-container{max-height:300px}\n"], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UniqueValueListComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-unique-value-list][fieldId]',
                templateUrl: './unique-value-list.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                styleUrls: [
                    '../style/unique-value-list.ngx.scss'
                ]
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: FilterWarehouse }, { type: FilterCommandInvoker }]; }, { fieldId: [{
            type: Input
        }] }); })();

var ColumnAlign;
(function (ColumnAlign) {
    ColumnAlign[ColumnAlign["RIGHT"] = 0] = "RIGHT";
    ColumnAlign[ColumnAlign["CENTER"] = 1] = "CENTER";
    ColumnAlign[ColumnAlign["LEFT"] = 2] = "LEFT";
})(ColumnAlign || (ColumnAlign = {}));

// Basically header template
class CellTemplateWithContext {
    constructor(viewTemplate, editTemplate, 
    // public editContext: any,
    context, width, fieldId, columnDefinitionId, sortStatus, enabled, sortable, align) {
        this.viewTemplate = viewTemplate;
        this.editTemplate = editTemplate;
        this.context = context;
        this.width = width;
        this.fieldId = fieldId;
        this.columnDefinitionId = columnDefinitionId;
        this.sortStatus = sortStatus;
        this.enabled = enabled;
        this.sortable = sortable;
        this.align = align;
    }
    getColumnDefinitionId() {
        return this.columnDefinitionId;
    }
    getFieldId() {
        return this.fieldId;
    }
    getSortStatus() {
        return this.sortStatus;
    }
    isSortEnabled() {
        return this.sortable;
    }
    isAscSort() {
        return this.sortStatus === SortOrder.ASC;
    }
    isDescSort() {
        return this.sortStatus === SortOrder.DESC;
    }
    isNoSort() {
        return this.sortStatus === SortOrder.NONE;
    }
    isEnabled() {
        return this.enabled;
    }
    isAlignLeft() {
        return this.align === ColumnAlign.LEFT;
    }
    isAlignCenter() {
        return this.align === ColumnAlign.CENTER;
    }
    isAlignRight() {
        return this.align === ColumnAlign.RIGHT;
    }
}

const _c0$l = ["headerSortMenu"];
const _c1$6 = ["gui-column-config", ""];
function StructureColumnConfigComponent_div_0_ng_container_2_div_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 9);
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext(3);
    i0.ɵɵproperty("column", ctx_r4.column)("dropdownTextTranslation", ctx_r4.dropdownTextTranslation);
} }
function StructureColumnConfigComponent_div_0_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    const _r6 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "gui-tab-item", 4);
    i0.ɵɵtemplate(2, StructureColumnConfigComponent_div_0_ng_container_2_div_2_Template, 1, 2, "div", 5);
    i0.ɵɵelementStart(3, "div", 6);
    i0.ɵɵlistener("columnHidden", function StructureColumnConfigComponent_div_0_ng_container_2_Template_div_columnHidden_3_listener() { i0.ɵɵrestoreView(_r6); const ctx_r5 = i0.ɵɵnextContext(2); return ctx_r5.hideColumn(); });
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "div", 7);
    i0.ɵɵlistener("click", function StructureColumnConfigComponent_div_0_ng_container_2_Template_div_click_4_listener() { i0.ɵɵrestoreView(_r6); const ctx_r7 = i0.ɵɵnextContext(2); return ctx_r7.highlightColumn(); });
    i0.ɵɵtext(5);
    i0.ɵɵpipe(6, "guiTranslate");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(7, "div", 8);
    i0.ɵɵlistener("movedLeft", function StructureColumnConfigComponent_div_0_ng_container_2_Template_div_movedLeft_7_listener() { i0.ɵɵrestoreView(_r6); const ctx_r8 = i0.ɵɵnextContext(2); return ctx_r8.moveLeft(); })("movedRight", function StructureColumnConfigComponent_div_0_ng_container_2_Template_div_movedRight_7_listener() { i0.ɵɵrestoreView(_r6); const ctx_r9 = i0.ɵɵnextContext(2); return ctx_r9.moveRight(); });
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("tab", ctx_r1.config.getMainMenu());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r1.column.isSortEnabled());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("column", ctx_r1.column);
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", i0.ɵɵpipeBind1(6, 5, "headerMenuMainTabHighlightColumn"), " ");
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("column", ctx_r1.column);
} }
function StructureColumnConfigComponent_div_0_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "gui-tab-item", 10);
    i0.ɵɵelement(2, "div", 11);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("tab", ctx_r2.config.getFilterMenu());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("fieldId", ctx_r2.column.getFieldId());
} }
function StructureColumnConfigComponent_div_0_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelementStart(1, "gui-tab-item", 10);
    i0.ɵɵelement(2, "div", 12);
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext(2);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("tab", ctx_r3.config.getColumnMenu());
} }
function StructureColumnConfigComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 1);
    i0.ɵɵelementStart(1, "gui-tab", 2);
    i0.ɵɵtemplate(2, StructureColumnConfigComponent_div_0_ng_container_2_Template, 8, 7, "ng-container", 3);
    i0.ɵɵtemplate(3, StructureColumnConfigComponent_div_0_ng_container_3_Template, 3, 2, "ng-container", 3);
    i0.ɵɵtemplate(4, StructureColumnConfigComponent_div_0_ng_container_4_Template, 3, 1, "ng-container", 3);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("active", ctx_r0.config.getActiveMenu())("menu", ctx_r0.config.getMenus());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r0.config.isMainEnabled());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r0.config.isFilteringEnabled());
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngIf", ctx_r0.config.isColumnManagerEnabled());
} }
class StructureColumnConfigComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, structureCommandService, compositionReadModelService, filterWarehouse, translationFacade, structureColumnMenuConfigArchive, compositionId, compositionCommandInvoker, injector, column) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.structureCommandService = structureCommandService;
        this.compositionReadModelService = compositionReadModelService;
        this.filterWarehouse = filterWarehouse;
        this.translationFacade = translationFacade;
        this.structureColumnMenuConfigArchive = structureColumnMenuConfigArchive;
        this.compositionId = compositionId;
        this.compositionCommandInvoker = compositionCommandInvoker;
        this.injector = injector;
        this.column = column;
        this.uniqueValues = [];
        this.structureColumnConfigService = this.injector.get(StructureColumnConfigService);
    }
    ngOnInit() {
        this.hermesSubscribe(this.filterWarehouse.onUniqueValues(this.structureId), (uniqueValuesReadModel) => {
            this.uniqueValues = uniqueValuesReadModel.getValues(this.column.getFieldId());
        });
        this.hermesSubscribe(this.structureColumnMenuConfigArchive
            .on()
            .pipe(hermesSwitchMap((config) => {
            this.config = config;
            return this.translationFacade.onTranslation();
        })), (translation) => {
            this.setTabTitles(translation);
            this.dropdownTextTranslation = translation.headerMenuMainTabColumnSort;
        });
    }
    isEnabled() {
        return this.config && this.config.isEnabled();
    }
    hideColumn() {
        this.compositionCommandInvoker.disableColumn(this.column.getColumnDefinitionId(), this.compositionId);
        this.structureColumnConfigService.close();
    }
    moveLeft() {
        this.compositionCommandInvoker.moveLeft(this.column.getColumnDefinitionId(), this.compositionId);
        this.structureColumnConfigService.close();
    }
    moveRight() {
        this.compositionCommandInvoker.moveRight(this.column.getColumnDefinitionId(), this.compositionId);
        this.structureColumnConfigService.close();
    }
    highlightColumn() {
        this.compositionCommandInvoker.highlightColumn(this.column.getColumnDefinitionId(), this.compositionId);
        this.structureColumnConfigService.close();
    }
    setTabTitles(translation) {
        this.config.setMainMenu(translation.headerMenuMainTab);
        this.config.setFilterMenu(translation.headerMenuFilterTab);
        this.config.setColumnsMenu(translation.headerMenuColumnsTab);
    }
    getSelectorName() {
        return 'gui-column-config';
    }
}
StructureColumnConfigComponent.ɵfac = function StructureColumnConfigComponent_Factory(t) { return new (t || StructureColumnConfigComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(StructureCommandInvoker), i0.ɵɵdirectiveInject(CompositionWarehouse), i0.ɵɵdirectiveInject(FilterWarehouse), i0.ɵɵdirectiveInject(TranslationFacade), i0.ɵɵdirectiveInject(StructureColumnMenuConfigArchive), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(CompositionCommandInvoker), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject('column')); };
StructureColumnConfigComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnConfigComponent, selectors: [["div", "gui-column-config", ""]], viewQuery: function StructureColumnConfigComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$l, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.headerSortMenu = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c1$6, decls: 1, vars: 1, consts: [["class", "gui-header-menu-tab", 4, "ngIf"], [1, "gui-header-menu-tab"], [3, "active", "menu"], [4, "ngIf"], [1, "gui-tab-item-dropdown", 3, "tab"], ["gui-structure-column-config-sort", "", 3, "column", "dropdownTextTranslation", 4, "ngIf"], ["gui-structure-column-config-column-hide", "", 3, "column", "columnHidden"], [1, "gui-header-menu-item", 3, "click"], ["gui-structure-column-config-column-move", "", 3, "column", "movedLeft", "movedRight"], ["gui-structure-column-config-sort", "", 3, "column", "dropdownTextTranslation"], [3, "tab"], ["gui-unique-value-list", "", 3, "fieldId"], ["gui-structure-menu-column-manager", ""]], template: function StructureColumnConfigComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureColumnConfigComponent_div_0_Template, 5, 5, "div", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.isEnabled());
    } }, directives: [i4.NgIf, i1.FabricTabComponent, i1.TabItemComponent, StructureColumnConfigColumnHideComponent, StructureColumnConfigColumnMoveComponent, StructureColumnConfigSortComponent, UniqueValueListComponent, StructureMenuColumnManagerComponent], pipes: [TranslationPipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnConfigComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-column-config]',
                templateUrl: './structure.column-config.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: StructureCommandInvoker }, { type: CompositionWarehouse }, { type: FilterWarehouse }, { type: TranslationFacade }, { type: StructureColumnMenuConfigArchive }, { type: CompositionId }, { type: CompositionCommandInvoker }, { type: i0.Injector }, { type: CellTemplateWithContext, decorators: [{
                type: Inject,
                args: ['column']
            }] }]; }, { headerSortMenu: [{
            type: ViewChild,
            args: ['headerSortMenu', { static: false }]
        }] }); })();

class StructureColumnConfigService extends Reactive {
    constructor(injector, schemaReadModelRootId, schemaWarehouse, structureThemeConverter, inlineDialogService) {
        super();
        this.injector = injector;
        this.schemaReadModelRootId = schemaReadModelRootId;
        this.schemaWarehouse = schemaWarehouse;
        this.structureThemeConverter = structureThemeConverter;
        this.inlineDialogService = inlineDialogService;
    }
    open(elementRef, column) {
        this.close();
        const injector = Injector.create({
            providers: [{
                    provide: 'column',
                    useValue: column
                }],
            parent: this.injector
        });
        this.schemaWarehouse
            .onceTheme(this.schemaReadModelRootId)
            .pipe(this.hermesTakeUntil())
            .subscribe((theme) => {
            this.inlineDialogService.open(elementRef, StructureColumnConfigComponent, {
                injector: injector,
                placement: FabricPlacement.BOTTOM,
                offset: -34,
                theme: this.structureThemeConverter.convertTheme(theme),
                customClass: 'gui-inline-dialog-header-menu'
            });
        });
    }
    close() {
        this.inlineDialogService.close();
    }
}
StructureColumnConfigService.ɵfac = function StructureColumnConfigService_Factory(t) { return new (t || StructureColumnConfigService)(i0.ɵɵinject(i0.Injector), i0.ɵɵinject(SchemaReadModelRootId), i0.ɵɵinject(SchemaWarehouse), i0.ɵɵinject(StructureThemeConverter), i0.ɵɵinject(i1.FabricInlineDialogService)); };
StructureColumnConfigService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureColumnConfigService, factory: StructureColumnConfigService.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnConfigService, [{
        type: Injectable
    }], function () { return [{ type: i0.Injector }, { type: SchemaReadModelRootId }, { type: SchemaWarehouse }, { type: StructureThemeConverter }, { type: i1.FabricInlineDialogService }]; }, null); })();

const _c0$k = ["gui-select-all", ""];
function SelectAllComponent_gui_checkbox_0_Template(rf, ctx) { if (rf & 1) {
    const _r2 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "gui-checkbox", 1);
    i0.ɵɵlistener("changed", function SelectAllComponent_gui_checkbox_0_Template_gui_checkbox_changed_0_listener() { i0.ɵɵrestoreView(_r2); const ctx_r1 = i0.ɵɵnextContext(); return ctx_r1.toggleSelectAll(); });
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵproperty("checked", ctx_r0.selectAllChecked)("gui-tooltip", "Select")("indeterminate", ctx_r0.selectAllIndeterminate);
} }
class SelectAllComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, rowSelectionModeRepository, formationCommandDispatcher, formationWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.rowSelectionModeRepository = rowSelectionModeRepository;
        this.formationCommandDispatcher = formationCommandDispatcher;
        this.formationWarehouse = formationWarehouse;
        this.modeMulti = false;
    }
    ngOnInit() {
        this.hermesSubscribe(this.formationWarehouse.onMode(this.structureId), (mode) => {
            this.modeMulti = mode === RowSelectionMode.MULTIPLE;
        });
        this.hermesSubscribe(this.formationWarehouse.onRowSelectedReadModel(this.structureId), (rowSelectedReadModel) => {
            this.selectAllChecked = rowSelectedReadModel.isAllSelected();
            this.selectAllIndeterminate = rowSelectedReadModel.isIndeterminate();
        });
    }
    toggleSelectAll() {
        if (this.selectAllIndeterminate) {
            this.formationCommandDispatcher.unselectAll(this.structureId);
        }
        else {
            if (this.selectAllChecked) {
                this.formationCommandDispatcher.unselectAll(this.structureId);
            }
            else {
                this.formationCommandDispatcher.selectAll(this.structureId);
            }
        }
    }
    getSelectorName() {
        return 'gui-select-all';
    }
}
SelectAllComponent.ɵfac = function SelectAllComponent_Factory(t) { return new (t || SelectAllComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(RowSelectionModeRepository), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(FormationWarehouse)); };
SelectAllComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: SelectAllComponent, selectors: [["div", "gui-select-all", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$k, decls: 1, vars: 1, consts: [[3, "checked", "gui-tooltip", "indeterminate", "changed", 4, "ngIf"], [3, "checked", "gui-tooltip", "indeterminate", "changed"]], template: function SelectAllComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, SelectAllComponent_gui_checkbox_0_Template, 1, 3, "gui-checkbox", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.modeMulti);
    } }, directives: [i4.NgIf, i1.FabricCheckboxComponent, i1.FabricTooltipDirective], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SelectAllComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-select-all]',
                templateUrl: './select-all.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: RowSelectionModeRepository }, { type: FormationCommandInvoker }, { type: FormationWarehouse }]; }, null); })();

const _c0$j = ["gui-structure-column-menu-icon", ""];
class StructureColumnMenuIconComponent extends IconComponent {
    constructor(elementRef, changeDetectorRef) {
        super(elementRef, changeDetectorRef);
    }
    getSelectorName() {
        return 'gui-structure-column-menu-icon';
    }
}
StructureColumnMenuIconComponent.ɵfac = function StructureColumnMenuIconComponent_Factory(t) { return new (t || StructureColumnMenuIconComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef)); };
StructureColumnMenuIconComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnMenuIconComponent, selectors: [["div", "gui-structure-column-menu-icon", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$j, decls: 4, vars: 0, consts: [["data-name", "Layer 1", "xmlns", "http://www.w3.org/2000/svg", "viewBox", "0 0 10.32 7.46"], ["x1", "9.57", "y1", "3.73", "x2", "0.75", "y2", "3.73", 1, "cls-1"], ["x1", "9.57", "y1", "0.75", "x2", "0.75", "y2", "0.75", 1, "cls-1"], ["x1", "9.57", "y1", "6.71", "x2", "0.75", "y2", "6.71", 1, "cls-1"]], template: function StructureColumnMenuIconComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵnamespaceSVG();
        i0.ɵɵelementStart(0, "svg", 0);
        i0.ɵɵelement(1, "line", 1);
        i0.ɵɵelement(2, "line", 2);
        i0.ɵɵelement(3, "line", 3);
        i0.ɵɵelementEnd();
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnMenuIconComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-menu-icon]',
                template: `
		<svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10.32 7.46">
			<line class="cls-1" x1="9.57" y1="3.73" x2="0.75" y2="3.73"/>
			<line class="cls-1" x1="9.57" y1="0.75" x2="0.75" y2="0.75"/>
			<line class="cls-1" x1="9.57" y1="6.71" x2="0.75" y2="6.71"/>
		</svg>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, null); })();

const _c0$i = ["headerDialogContainer"];
const _c1$5 = ["gui-structure-column-config-trigger", ""];
function StructureColumnConfigTriggerComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r3 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 1, 2);
    i0.ɵɵlistener("click", function StructureColumnConfigTriggerComponent_div_0_Template_div_click_0_listener() { i0.ɵɵrestoreView(_r3); const ctx_r2 = i0.ɵɵnextContext(); return ctx_r2.openConfigDialog(); });
    i0.ɵɵelement(2, "div", 3);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("ngClass", "gui-header-menu-icon");
} }
class StructureColumnConfigTriggerComponent extends SmartComponent {
    constructor(elementRef, changeDetectorRef, structureCommandService, structureColumnMenuConfigArchive, structureColumnConfigService) {
        super(changeDetectorRef, elementRef);
        this.elementRef = elementRef;
        this.changeDetectorRef = changeDetectorRef;
        this.structureCommandService = structureCommandService;
        this.structureColumnMenuConfigArchive = structureColumnMenuConfigArchive;
        this.structureColumnConfigService = structureColumnConfigService;
    }
    ngOnInit() {
        this.hermesSubscribe(this.structureColumnMenuConfigArchive.on(), (config) => {
            this.config = config;
        });
    }
    openConfigDialog() {
        this.structureColumnConfigService.open(this.headerDialogContainer, this.column);
    }
    closeConfigDialog() {
        this.structureColumnConfigService.close();
    }
    isEnabled() {
        return this.config && this.config.isEnabled();
    }
    getSelectorName() {
        return 'gui-structure-column-config-trigger';
    }
}
StructureColumnConfigTriggerComponent.ɵfac = function StructureColumnConfigTriggerComponent_Factory(t) { return new (t || StructureColumnConfigTriggerComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(StructureCommandInvoker), i0.ɵɵdirectiveInject(StructureColumnMenuConfigArchive), i0.ɵɵdirectiveInject(StructureColumnConfigService)); };
StructureColumnConfigTriggerComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureColumnConfigTriggerComponent, selectors: [["div", "gui-structure-column-config-trigger", ""]], viewQuery: function StructureColumnConfigTriggerComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$i, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.headerDialogContainer = _t.first);
    } }, inputs: { column: "column" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c1$5, decls: 1, vars: 1, consts: [["class", "gui-header-menu-icon-wrapper", 3, "click", 4, "ngIf"], [1, "gui-header-menu-icon-wrapper", 3, "click"], ["headerDialogContainer", ""], ["gui-structure-column-menu-icon", "", 3, "ngClass"]], template: function StructureColumnConfigTriggerComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureColumnConfigTriggerComponent_div_0_Template, 3, 1, "div", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.isEnabled());
    } }, directives: [i4.NgIf, StructureColumnMenuIconComponent, i4.NgClass], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnConfigTriggerComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-column-config-trigger]',
                templateUrl: './structure.column-config-trigger.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: StructureCommandInvoker }, { type: StructureColumnMenuConfigArchive }, { type: StructureColumnConfigService }]; }, { headerDialogContainer: [{
            type: ViewChild,
            args: ['headerDialogContainer', { static: false }]
        }], column: [{
            type: Input
        }] }); })();

const _c0$h = ["gui-structure-header-columns", "", "columns", ""];
function StructureHeaderColumnsComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 2);
    i0.ɵɵelement(1, "div", 3);
    i0.ɵɵelementEnd();
} }
function StructureHeaderColumnsComponent_div_1_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
const _c1$4 = function (a0) { return { "gui-header-sortable": a0 }; };
const _c2$2 = function (a0, a1) { return { "gui-sort-asc": a0, "gui-sort-desc": a1 }; };
function StructureHeaderColumnsComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r5 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 4);
    i0.ɵɵlistener("click", function StructureHeaderColumnsComponent_div_1_Template_div_click_0_listener() { const restoredCtx = i0.ɵɵrestoreView(_r5); const column_r2 = restoredCtx.$implicit; const ctx_r4 = i0.ɵɵnextContext(); return ctx_r4.toggleSort(column_r2); });
    i0.ɵɵelementStart(1, "div", 5);
    i0.ɵɵtemplate(2, StructureHeaderColumnsComponent_div_1_ng_container_2_Template, 1, 0, "ng-container", 6);
    i0.ɵɵelement(3, "div", 7);
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "div", 8);
    i0.ɵɵelement(5, "div", 9);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const column_r2 = ctx.$implicit;
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵstyleProp("width", column_r2.width, "px");
    i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction1(7, _c1$4, column_r2.isSortEnabled()));
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("ngTemplateOutlet", column_r2.viewTemplate)("ngTemplateOutletContext", column_r2.context);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction2(9, _c2$2, ctx_r1.isSortAsc(column_r2), ctx_r1.isSortDesc(column_r2)));
    i0.ɵɵadvance(2);
    i0.ɵɵproperty("column", column_r2);
} }
class StructureHeaderColumnsComponent extends SmartComponent {
    constructor(elementRef, injector, changeDetectorRef, compositionId, structureId, formationCommandDispatcher, sortingCommandDispatcher) {
        super(changeDetectorRef, elementRef);
        this.elementRef = elementRef;
        this.injector = injector;
        this.changeDetectorRef = changeDetectorRef;
        this.compositionId = compositionId;
        this.structureId = structureId;
        this.formationCommandDispatcher = formationCommandDispatcher;
        this.sortingCommandDispatcher = sortingCommandDispatcher;
        this.checkboxSelection = false;
        this.globalSearching = false;
    }
    toggleSort(column) {
        if (column.isSortEnabled()) {
            this.sortingCommandDispatcher.toggleSort(column.getFieldId(), this.compositionId, this.structureId);
        }
    }
    isSortAsc(column) {
        return column.getSortStatus() === SortOrder.ASC;
    }
    isSortDesc(column) {
        return column.getSortStatus() === SortOrder.DESC;
    }
    isGlobalSortEnabled() {
        return this.globalSearching;
    }
    getSelectorName() {
        return 'gui-structure-header-columns';
    }
}
StructureHeaderColumnsComponent.ɵfac = function StructureHeaderColumnsComponent_Factory(t) { return new (t || StructureHeaderColumnsComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(SortingCommandInvoker)); };
StructureHeaderColumnsComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureHeaderColumnsComponent, selectors: [["div", "gui-structure-header-columns", "", "columns", ""]], inputs: { columns: "columns", checkboxSelection: "checkboxSelection" }, features: [i0.ɵɵProvidersFeature([
            StructureColumnConfigService
        ]), i0.ɵɵInheritDefinitionFeature], attrs: _c0$h, decls: 2, vars: 2, consts: [["class", "gui-header-cell gui-row-checkbox\n\t gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis", 4, "ngIf"], ["class", "gui-header-cell gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis", 3, "ngClass", "width", "click", 4, "ngFor", "ngForOf"], [1, "gui-header-cell", "gui-row-checkbox", "gui-flex", "gui-justify-between", "gui-overflow-hidden", "gui-relative", "gui-py-0", "gui-px-6", "gui-box-border", "gui-leading-4", "gui-whitespace-nowrap", "gui-overflow-ellipsis"], ["gui-select-all", ""], [1, "gui-header-cell", "gui-flex", "gui-justify-between", "gui-overflow-hidden", "gui-relative", "gui-py-0", "gui-px-6", "gui-box-border", "gui-leading-4", "gui-whitespace-nowrap", "gui-overflow-ellipsis", 3, "ngClass", "click"], [1, "gui-header-title"], [4, "ngTemplateOutlet", "ngTemplateOutletContext"], [1, "gui-sort", 3, "ngClass"], [1, "gui-header-menu"], ["gui-structure-column-config-trigger", "", 3, "column"]], template: function StructureHeaderColumnsComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureHeaderColumnsComponent_div_0_Template, 2, 0, "div", 0);
        i0.ɵɵtemplate(1, StructureHeaderColumnsComponent_div_1_Template, 6, 12, "div", 1);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.checkboxSelection);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngForOf", ctx.columns);
    } }, directives: [i4.NgIf, i4.NgForOf, SelectAllComponent, i4.NgClass, i4.NgTemplateOutlet, StructureColumnConfigTriggerComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureHeaderColumnsComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-header-columns][columns]',
                templateUrl: './structure-header-columns.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                providers: [
                    StructureColumnConfigService
                ]
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.Injector }, { type: i0.ChangeDetectorRef }, { type: CompositionId }, { type: StructureId }, { type: FormationCommandInvoker }, { type: SortingCommandInvoker }]; }, { columns: [{
            type: Input
        }], checkboxSelection: [{
            type: Input
        }] }); })();

const _c0$g = ["gui-structure-header-filters", "", "columns", ""];
function StructureHeaderFiltersComponent_ng_container_0_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r5 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementStart(0, "div", 2);
    i0.ɵɵelementStart(1, "button", 3);
    i0.ɵɵlistener("click", function StructureHeaderFiltersComponent_ng_container_0_div_1_Template_button_click_1_listener() { i0.ɵɵrestoreView(_r5); const ctx_r4 = i0.ɵɵnextContext(2); return ctx_r4.turnOnFilterMode(); });
    i0.ɵɵtext(2, "Add Filter");
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const cell_r3 = ctx.$implicit;
    i0.ɵɵstyleProp("width", cell_r3.width, "px");
} }
function StructureHeaderFiltersComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵtemplate(1, StructureHeaderFiltersComponent_ng_container_0_div_1_Template, 3, 2, "div", 1);
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("ngForOf", ctx_r0.columns);
} }
const _c1$3 = function () { return ["has value", "is the same as", "starts with", "ends with"]; };
function StructureHeaderFiltersComponent_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    const _r7 = i0.ɵɵgetCurrentView();
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelement(1, "gui-select", 4);
    i0.ɵɵelementStart(2, "form", 5);
    i0.ɵɵelement(3, "input", 6);
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(4, "button", 7);
    i0.ɵɵlistener("click", function StructureHeaderFiltersComponent_ng_container_1_Template_button_click_4_listener() { i0.ɵɵrestoreView(_r7); const ctx_r6 = i0.ɵɵnextContext(); return ctx_r6.clearFilters(); });
    i0.ɵɵtext(5, "Clear All");
    i0.ɵɵelementEnd();
    i0.ɵɵelementStart(6, "button", 7);
    i0.ɵɵlistener("click", function StructureHeaderFiltersComponent_ng_container_1_Template_button_click_6_listener() { i0.ɵɵrestoreView(_r7); const ctx_r8 = i0.ɵɵnextContext(); return ctx_r8.turnOffFilterMode(); });
    i0.ɵɵtext(7, "Close");
    i0.ɵɵelementEnd();
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("options", i0.ɵɵpureFunction0(4, _c1$3))("selected", "has value");
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("formGroup", ctx_r1.filterForm);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("formControlName", ctx_r1.filterFieldName);
} }
class StructureHeaderFiltersComponent extends PureComponent {
    constructor(structureFilterCommandService, formBuilder, cd, elementRef, structureId) {
        super(elementRef);
        this.structureFilterCommandService = structureFilterCommandService;
        this.formBuilder = formBuilder;
        this.cd = cd;
        this.structureId = structureId;
        this.closed = new EventEmitter();
        this.filterFieldName = 'phrase';
        this.filterMode = false;
        this.filterForm = this.formBuilder.group({
            [this.filterFieldName]: ['']
        });
    }
    ngOnInit() {
        this.filterForm
            .valueChanges
            // .pipe(
            // debounceTime(500)
            // )
            .subscribe((f) => {
            this.filter(f[this.filterFieldName]);
        });
    }
    filter(phrase) {
        if (phrase === undefined || phrase === null) {
            phrase = '';
        }
        // this.structureFilterCommandService.addFilter(this.columns[0].getFieldId(), '1', phrase, this.structureId);
    }
    clearFilters() {
        this.filterForm.reset();
    }
    turnOnFilterMode() {
        this.filterMode = true;
        this.cd.detectChanges();
    }
    turnOffFilterMode() {
        this.filterMode = false;
        this.cd.detectChanges();
    }
    getSelectorName() {
        return '';
    }
}
StructureHeaderFiltersComponent.ɵfac = function StructureHeaderFiltersComponent_Factory(t) { return new (t || StructureHeaderFiltersComponent)(i0.ɵɵdirectiveInject(FilterCommandInvoker), i0.ɵɵdirectiveInject(i1$2.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId)); };
StructureHeaderFiltersComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureHeaderFiltersComponent, selectors: [["div", "gui-structure-header-filters", "", "columns", ""]], inputs: { columns: "columns" }, outputs: { closed: "closed" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$g, decls: 2, vars: 2, consts: [[4, "ngIf"], ["class", "gui-header-cell gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis", 3, "width", 4, "ngFor", "ngForOf"], [1, "gui-header-cell", "gui-flex", "gui-justify-between", "gui-overflow-hidden", "gui-relative", "gui-py-0", "gui-px-6", "gui-box-border", "gui-leading-4", "gui-whitespace-nowrap", "gui-overflow-ellipsis"], [3, "click"], [3, "options", "selected"], [3, "formGroup"], ["type", "text", "gui-input", "", 3, "formControlName"], ["gui-button", "", 3, "click"]], template: function StructureHeaderFiltersComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureHeaderFiltersComponent_ng_container_0_Template, 2, 1, "ng-container", 0);
        i0.ɵɵtemplate(1, StructureHeaderFiltersComponent_ng_container_1_Template, 8, 5, "ng-container", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", !ctx.filterMode);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.filterMode);
    } }, directives: [i4.NgIf, i4.NgForOf, i1.FabricSelectComponent, i1$2.ɵNgNoValidate, i1$2.NgControlStatusGroup, i1$2.FormGroupDirective, i1.FabricInputComponent, i1$2.DefaultValueAccessor, i1$2.NgControlStatus, i1$2.FormControlName, i1.FabricButtonComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureHeaderFiltersComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-header-filters][columns]',
                template: `

		<ng-container *ngIf="!filterMode">

			<div *ngFor="let cell of columns"
				 [style.width.px]="cell.width"
				 class="gui-header-cell gui-flex gui-justify-between
\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border
\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis">

				<!--				<gui-structure-header-filter [column]="cell">-->
				<!--				</gui-structure-header-filter>-->

				<button (click)="turnOnFilterMode()">Add Filter</button>

			</div>

		</ng-container>

		<ng-container *ngIf="filterMode">

			<gui-select [options]="['has value', 'is the same as', 'starts with', 'ends with']" [selected]="'has value'">

			</gui-select>

			<form [formGroup]="filterForm">
				<input type="text" [formControlName]="filterFieldName" gui-input/>
			</form>

			<button gui-button (click)="clearFilters()">Clear All</button>
			<button gui-button (click)="turnOffFilterMode()">Close</button>

		</ng-container>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: FilterCommandInvoker }, { type: i1$2.FormBuilder }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }]; }, { columns: [{
            type: Input
        }], closed: [{
            type: Output
        }] }); })();

const _c0$f = ["gui-structure-header-groups", "", "groups", "", "checkboxSelection", ""];
function StructureHeaderGroupsComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 2);
    i0.ɵɵelement(1, "div", 3);
    i0.ɵɵelementEnd();
} }
function StructureHeaderGroupsComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "div", 4);
    i0.ɵɵelementStart(1, "div", 5);
    i0.ɵɵtext(2);
    i0.ɵɵelementEnd();
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const group_r2 = ctx.$implicit;
    i0.ɵɵstyleProp("width", group_r2.width, "px");
    i0.ɵɵadvance(2);
    i0.ɵɵtextInterpolate1(" ", group_r2.header, " ");
} }
class StructureHeaderGroupsComponent extends PureComponent {
    constructor(elementRef, injector, changeDetectorRef, compositionId, structureId, formationCommandDispatcher, sortingCommandDispatcher) {
        super(elementRef);
        this.elementRef = elementRef;
        this.injector = injector;
        this.changeDetectorRef = changeDetectorRef;
        this.compositionId = compositionId;
        this.structureId = structureId;
        this.formationCommandDispatcher = formationCommandDispatcher;
        this.sortingCommandDispatcher = sortingCommandDispatcher;
        this.checkboxSelection = false;
        this.globalSearching = false;
    }
    toggleSort(column) {
        if (column.isSortEnabled()) {
            this.sortingCommandDispatcher.toggleSort(column.getFieldId(), this.compositionId, this.structureId);
        }
    }
    isSortAsc(column) {
        return column.getSortStatus() === SortOrder.ASC;
    }
    isSortDesc(column) {
        return column.getSortStatus() === SortOrder.DESC;
    }
    isGlobalSortEnabled() {
        return this.globalSearching;
    }
    getSelectorName() {
        return 'gui-structure-header-groups';
    }
}
StructureHeaderGroupsComponent.ɵfac = function StructureHeaderGroupsComponent_Factory(t) { return new (t || StructureHeaderGroupsComponent)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(SortingCommandInvoker)); };
StructureHeaderGroupsComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureHeaderGroupsComponent, selectors: [["div", "gui-structure-header-groups", "", "groups", "", "checkboxSelection", ""]], inputs: { groups: "groups", showGroups: "showGroups", checkboxSelection: "checkboxSelection" }, features: [i0.ɵɵProvidersFeature([
            StructureColumnConfigService
        ]), i0.ɵɵInheritDefinitionFeature], attrs: _c0$f, decls: 2, vars: 2, consts: [["class", "gui-header-cell gui-row-checkbox gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis", 4, "ngIf"], ["class", "gui-header-cell gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis", 3, "width", 4, "ngFor", "ngForOf"], [1, "gui-header-cell", "gui-row-checkbox", "gui-flex", "gui-justify-between", "gui-overflow-hidden", "gui-relative", "gui-py-0", "gui-px-6", "gui-box-border", "gui-leading-4", "gui-whitespace-nowrap", "gui-overflow-ellipsis"], ["gui-select-all", ""], [1, "gui-header-cell", "gui-flex", "gui-justify-between", "gui-overflow-hidden", "gui-relative", "gui-py-0", "gui-px-6", "gui-box-border", "gui-leading-4", "gui-whitespace-nowrap", "gui-overflow-ellipsis"], [1, "gui-header-title"]], template: function StructureHeaderGroupsComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureHeaderGroupsComponent_div_0_Template, 2, 0, "div", 0);
        i0.ɵɵtemplate(1, StructureHeaderGroupsComponent_div_1_Template, 3, 3, "div", 1);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.checkboxSelection);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngForOf", ctx.groups);
    } }, directives: [i4.NgIf, i4.NgForOf, SelectAllComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureHeaderGroupsComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-header-groups][groups][checkboxSelection]',
                templateUrl: './structure-header-groups.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                providers: [
                    StructureColumnConfigService
                ]
            }]
    }], function () { return [{ type: i0.ElementRef }, { type: i0.Injector }, { type: i0.ChangeDetectorRef }, { type: CompositionId }, { type: StructureId }, { type: FormationCommandInvoker }, { type: SortingCommandInvoker }]; }, { groups: [{
            type: Input
        }], showGroups: [{
            type: Input
        }], checkboxSelection: [{
            type: Input
        }] }); })();

const _c0$e = ["gui-structure-header", ""];
function StructureHeaderComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 3);
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵproperty("checkboxSelection", ctx_r0.checkboxSelection)("groups", ctx_r0.groups);
} }
function StructureHeaderComponent_div_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 4);
} if (rf & 2) {
    const ctx_r1 = i0.ɵɵnextContext();
    i0.ɵɵproperty("columns", ctx_r1.headerColumns);
} }
class StructureHeaderComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, eventBus, structureId, compositionId, filterWarehouse, structureWarehouse, rowSelectionTypeArchive, structureVerticalFormationWarehouse, compositionWarehouse) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.eventBus = eventBus;
        this.structureId = structureId;
        this.compositionId = compositionId;
        this.filterWarehouse = filterWarehouse;
        this.structureWarehouse = structureWarehouse;
        this.rowSelectionTypeArchive = rowSelectionTypeArchive;
        this.structureVerticalFormationWarehouse = structureVerticalFormationWarehouse;
        this.compositionWarehouse = compositionWarehouse;
        this.headerColumns = [];
        this.filterRowEnabled = false;
        this.showGroups = false;
        this.styleModifier = new StyleModifier(elementRef.nativeElement);
    }
    ngOnInit() {
        this.hermesSubscribe(this.rowSelectionTypeArchive.on(), (type) => {
            this.checkboxSelection = type === RowSelectionType.CHECKBOX;
        });
        this.hermesSubscribe(this.compositionWarehouse.onHeaderColumns(this.compositionId), (columns) => {
            this.headerColumns = columns;
        });
        this.hermesSubscribeWithoutRender(this.compositionWarehouse.onContainerWidth(this.compositionId), (width) => {
            this.styleModifier.getElement(this.containerRef.nativeElement).setWidth(width);
        });
        this.hermesSubscribe(this.filterWarehouse.onFilteringEnabled(this.structureId), (enabled) => {
            this.filterRowEnabled = enabled;
        });
        this.hermesSubscribe(this.compositionWarehouse.onGroups(this.compositionId), (collection) => {
            this.showGroups = collection.isVisible();
            this.groups = collection.getGroups();
        });
    }
    ngAfterViewInit() {
        super.ngAfterViewInit();
        this.hermesSubscribeWithoutRender(this.structureVerticalFormationWarehouse.onRowHeight(this.structureId), (rowHeight) => {
            const headerHeight = +(rowHeight) + 2;
            if (this.filtersRef) {
                this.styleModifier.getElement(this.filtersRef.nativeElement).setHeight(headerHeight);
            }
        });
    }
    getSelectorName() {
        return 'gui-structure-header';
    }
}
StructureHeaderComponent.ɵfac = function StructureHeaderComponent_Factory(t) { return new (t || StructureHeaderComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1$1.DomainEventBus), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(FilterWarehouse), i0.ɵɵdirectiveInject(StructureWarehouse), i0.ɵɵdirectiveInject(RowSelectionTypeArchive), i0.ɵɵdirectiveInject(VerticalFormationWarehouse), i0.ɵɵdirectiveInject(CompositionWarehouse)); };
StructureHeaderComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureHeaderComponent, selectors: [["div", "gui-structure-header", ""]], viewQuery: function StructureHeaderComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(StructureHeaderColumnsComponent, 7, ElementRef);
        i0.ɵɵviewQuery(StructureHeaderFiltersComponent, 7, ElementRef);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.containerRef = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.filtersRef = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$e, decls: 3, vars: 4, consts: [["class", "gui-header", "gui-structure-header-groups", "", 3, "checkboxSelection", "groups", 4, "ngIf"], ["gui-structure-header-columns", "", 1, "gui-header", 3, "checkboxSelection", "columns"], ["class", "gui-header", "gui-structure-header-filters", "", 3, "columns", 4, "ngIf"], ["gui-structure-header-groups", "", 1, "gui-header", 3, "checkboxSelection", "groups"], ["gui-structure-header-filters", "", 1, "gui-header", 3, "columns"]], template: function StructureHeaderComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureHeaderComponent_div_0_Template, 1, 2, "div", 0);
        i0.ɵɵelement(1, "div", 1);
        i0.ɵɵtemplate(2, StructureHeaderComponent_div_2_Template, 1, 1, "div", 2);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.showGroups);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("checkboxSelection", ctx.checkboxSelection)("columns", ctx.headerColumns);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.filterRowEnabled);
    } }, directives: [i4.NgIf, StructureHeaderColumnsComponent, StructureHeaderGroupsComponent, StructureHeaderFiltersComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureHeaderComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-header]',
                templateUrl: './structure-header.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i1$1.DomainEventBus }, { type: StructureId }, { type: CompositionId }, { type: FilterWarehouse }, { type: StructureWarehouse }, { type: RowSelectionTypeArchive }, { type: VerticalFormationWarehouse }, { type: CompositionWarehouse }]; }, { containerRef: [{
            type: ViewChild,
            args: [StructureHeaderColumnsComponent, { read: ElementRef, static: true }]
        }], filtersRef: [{
            type: ViewChild,
            args: [StructureHeaderFiltersComponent, { read: ElementRef, static: true }]
        }] }); })();

const _c0$d = ["gui-structure-footer-panel", ""];
class StructureFooterPanelComponent extends StructureBannerPanel {
    constructor(structureFooterPanelConfigArchive, changeDetectorRef, elementRef) {
        super(changeDetectorRef, elementRef);
        this.structureFooterPanelConfigArchive = structureFooterPanelConfigArchive;
    }
    onBannerPanelConfig() {
        return this.structureFooterPanelConfigArchive.on();
    }
    getSelectorName() {
        return 'gui-structure-footer-panel';
    }
    getPanelTitle() {
        return 'Footer panel';
    }
}
StructureFooterPanelComponent.ɵfac = function StructureFooterPanelComponent_Factory(t) { return new (t || StructureFooterPanelComponent)(i0.ɵɵdirectiveInject(StructureFooterPanelConfigArchive), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
StructureFooterPanelComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureFooterPanelComponent, selectors: [["div", "gui-structure-footer-panel", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$d, decls: 2, vars: 4, consts: [[1, "gui-footer-panel", "gui-p-6", "gui-border-t", "gui-border-t-solid", 3, "innerHTML"]], template: function StructureFooterPanelComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
        i0.ɵɵpipe(1, "guiSafe");
    } if (rf & 2) {
        i0.ɵɵproperty("innerHTML", i0.ɵɵpipeBind2(1, 1, ctx.bannerPanel, "html"), i0.ɵɵsanitizeHtml);
    } }, pipes: [SafePipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureFooterPanelComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-footer-panel]',
                templateUrl: './structure.footer-panel.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: StructureFooterPanelConfigArchive }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, null); })();

const _c0$c = ["gui-structure-blueprint", ""];
function StructureBlueprintComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 10);
} }
function StructureBlueprintComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 11);
} }
function StructureBlueprintComponent_div_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 12);
} if (rf & 2) {
    i0.ɵɵproperty("position", 0);
} }
function StructureBlueprintComponent_div_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 13);
} if (rf & 2) {
    const ctx_r3 = i0.ɵɵnextContext();
    i0.ɵɵproperty("ngClass", ctx_r3.getHeaderTopClasses());
} }
function StructureBlueprintComponent_div_7_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 13);
} if (rf & 2) {
    const ctx_r4 = i0.ɵɵnextContext();
    i0.ɵɵproperty("ngClass", ctx_r4.getHeaderBottomClasses());
} }
function StructureBlueprintComponent_div_9_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 14);
} }
function StructureBlueprintComponent_div_10_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 12);
} if (rf & 2) {
    i0.ɵɵproperty("position", 1);
} }
function StructureBlueprintComponent_div_11_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "div", 15);
} }
class StructureBlueprintComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureDefinition, structureId, structureWarehouse, structureInfoPanelArchive, pagingWarehouse, summariesWarehouse, filterWarehouse, searchWarehouse, structureHeaderTopEnabledArchive, structureHeaderBottomEnabledArchive, structureTitlePanelConfigArchive, structureFooterPanelConfigArchive, className) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureDefinition = structureDefinition;
        this.structureId = structureId;
        this.structureWarehouse = structureWarehouse;
        this.structureInfoPanelArchive = structureInfoPanelArchive;
        this.pagingWarehouse = pagingWarehouse;
        this.summariesWarehouse = summariesWarehouse;
        this.filterWarehouse = filterWarehouse;
        this.searchWarehouse = searchWarehouse;
        this.structureHeaderTopEnabledArchive = structureHeaderTopEnabledArchive;
        this.structureHeaderBottomEnabledArchive = structureHeaderBottomEnabledArchive;
        this.structureTitlePanelConfigArchive = structureTitlePanelConfigArchive;
        this.structureFooterPanelConfigArchive = structureFooterPanelConfigArchive;
        this.className = className;
        this.searchEnabled = false;
        this.topSummariesPanelEnabled = false;
        this.bottomSummariesPanelEnabled = false;
        this.quickFiltersEnabled = false;
        this.infoPanelEnabled = false;
        this.items = [];
        this.localStreamCloser = new StreamCloser();
        this.headerCssClass = `gui-${this.className}-header`;
        this.contentCssClass = `gui-${this.className}-content`;
    }
    ngOnInit() {
        this.hermesSubscribe(this.structureHeaderTopEnabledArchive.on(), (topHeaderEnabled) => {
            this.topHeaderEnabled = topHeaderEnabled;
        });
        this.hermesSubscribe(this.structureHeaderBottomEnabledArchive.on(), (bottomHeaderEnabled) => {
            this.bottomHeaderEnabled = bottomHeaderEnabled;
        });
        this.hermesSubscribe(this.structureWarehouse.on(this.structureId), (structure) => {
            this.structure = structure;
            this.items = structure.getEntities();
        });
        this.hermesSubscribe(this.pagingWarehouse.onPaging(this.structureId), (paging) => {
            this.pagingReadModel = paging;
        });
        this.hermesSubscribe(this.pagingWarehouse.onPaging(this.structureId), (paging) => {
            this.pagingReadModel = paging;
        });
        this.hermesSubscribe(this.searchWarehouse.onSearchEnabled(this.structureId), (enabled) => {
            this.searchEnabled = enabled;
        });
        this.hermesSubscribe(this.filterWarehouse.onQuickFiltersEnabled(this.structureId), (enabled) => {
            this.quickFiltersEnabled = enabled;
        });
        this.hermesSubscribe(this.summariesWarehouse.onBottomEnabled(this.structureId), (enabled) => {
            this.bottomSummariesPanelEnabled = enabled;
        });
        this.hermesSubscribe(this.summariesWarehouse.onTopEnabled(this.structureId), (enabled) => {
            this.topSummariesPanelEnabled = enabled;
        });
        this.hermesSubscribe(this.structureInfoPanelArchive.on(), (infoPanel) => {
            this.infoPanelEnabled = infoPanel.isEnabled();
        });
        this.hermesSubscribe(this.structureTitlePanelConfigArchive.on(), (titlePanel) => {
            this.titlePanelEnabled = titlePanel.enabled;
        });
        this.hermesSubscribe(this.structureFooterPanelConfigArchive.on(), (footerPanel) => {
            this.footerPanelEnabled = footerPanel.enabled;
        });
    }
    ngOnDestroy() {
        this.localStreamCloser.unsubscribe();
        super.ngOnDestroy();
    }
    getHeaderTopClasses() {
        return this.headerCssClass + ' gui-header-top';
    }
    getHeaderBottomClasses() {
        return this.headerCssClass + ' gui-header-bottom';
    }
    isColumnHeaderTopEnabled() {
        return this.structureDefinition.isHeaderEnabled() && this.topHeaderEnabled;
    }
    isColumnHeaderBottomEnabled() {
        return this.structureDefinition.isHeaderEnabled() && this.bottomHeaderEnabled;
    }
    isPagingTopEnabled() {
        return this.structureDefinition.getTopPaging().isEnabled() && this.pagingReadModel && this.pagingReadModel.isPagerTop();
    }
    isPagingBottomEnabled() {
        return this.structureDefinition.getBottomPaging().isEnabled() && this.pagingReadModel && this.pagingReadModel.isPagerBottom();
    }
    isSourceEmpty() {
        return this.structure && this.structure.getEntities().length === 0;
    }
    getSelectorName() {
        return 'gui-structure-blueprint';
    }
}
StructureBlueprintComponent.ɵfac = function StructureBlueprintComponent_Factory(t) { return new (t || StructureBlueprintComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureDefinition), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(StructureWarehouse), i0.ɵɵdirectiveInject(StructureInfoPanelArchive), i0.ɵɵdirectiveInject(PagingWarehouse), i0.ɵɵdirectiveInject(SummariesWarehouse), i0.ɵɵdirectiveInject(FilterWarehouse), i0.ɵɵdirectiveInject(SearchWarehouse), i0.ɵɵdirectiveInject(StructureHeaderTopEnabledArchive), i0.ɵɵdirectiveInject(StructureHeaderBottomEnabledArchive), i0.ɵɵdirectiveInject(StructureTitlePanelConfigArchive), i0.ɵɵdirectiveInject(StructureFooterPanelConfigArchive), i0.ɵɵdirectiveInject(STRUCTURE_CSS_CLASS_NAME)); };
StructureBlueprintComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureBlueprintComponent, selectors: [["div", "gui-structure-blueprint", ""]], features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$c, decls: 12, vars: 12, consts: [["gui-structure-title-panel", "", 4, "ngIf"], ["gui-structure-top-panel", "", 4, "ngIf"], ["gui-paging", "", 3, "position", 4, "ngIf"], ["gui-structure-summaries-panel", "", 1, "gui-structure-summaries-panel-top", 3, "enabled"], ["gui-structure-header", "", 3, "ngClass", 4, "ngIf"], ["gui-structure-container", "", 3, "ngClass"], ["gui-empty-source", "", 3, "items"], ["gui-structure-summaries-panel", "", 1, "gui-structure-summaries-panel-bottom", 3, "enabled"], ["gui-structure-footer-panel", "", 4, "ngIf"], ["gui-structure-info-panel", "", 4, "ngIf"], ["gui-structure-title-panel", ""], ["gui-structure-top-panel", ""], ["gui-paging", "", 3, "position"], ["gui-structure-header", "", 3, "ngClass"], ["gui-structure-footer-panel", ""], ["gui-structure-info-panel", ""]], template: function StructureBlueprintComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, StructureBlueprintComponent_div_0_Template, 1, 0, "div", 0);
        i0.ɵɵtemplate(1, StructureBlueprintComponent_div_1_Template, 1, 0, "div", 1);
        i0.ɵɵtemplate(2, StructureBlueprintComponent_div_2_Template, 1, 1, "div", 2);
        i0.ɵɵelement(3, "div", 3);
        i0.ɵɵtemplate(4, StructureBlueprintComponent_div_4_Template, 1, 1, "div", 4);
        i0.ɵɵelement(5, "div", 5);
        i0.ɵɵelement(6, "div", 6);
        i0.ɵɵtemplate(7, StructureBlueprintComponent_div_7_Template, 1, 1, "div", 4);
        i0.ɵɵelement(8, "div", 7);
        i0.ɵɵtemplate(9, StructureBlueprintComponent_div_9_Template, 1, 0, "div", 8);
        i0.ɵɵtemplate(10, StructureBlueprintComponent_div_10_Template, 1, 1, "div", 2);
        i0.ɵɵtemplate(11, StructureBlueprintComponent_div_11_Template, 1, 0, "div", 9);
    } if (rf & 2) {
        i0.ɵɵproperty("ngIf", ctx.titlePanelEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.searchEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.isPagingTopEnabled());
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("enabled", ctx.topSummariesPanelEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.isColumnHeaderTopEnabled());
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngClass", ctx.contentCssClass);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("items", ctx.items);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.isColumnHeaderBottomEnabled());
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("enabled", ctx.bottomSummariesPanelEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.footerPanelEnabled);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.isPagingBottomEnabled());
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.infoPanelEnabled);
    } }, directives: [i4.NgIf, StructureSummariesPanelComponent, StructureContainerComponent, i4.NgClass, EmptySourceComponent, StructureTitlePanelComponent, StructureTopPanelComponent, PagingComponent, StructureHeaderComponent, StructureFooterPanelComponent, StructureInfoPanelComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureBlueprintComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-blueprint]',
                templateUrl: './structure.blueprint.component.html',
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureDefinition }, { type: StructureId }, { type: StructureWarehouse }, { type: StructureInfoPanelArchive }, { type: PagingWarehouse }, { type: SummariesWarehouse }, { type: FilterWarehouse }, { type: SearchWarehouse }, { type: StructureHeaderTopEnabledArchive }, { type: StructureHeaderBottomEnabledArchive }, { type: StructureTitlePanelConfigArchive }, { type: StructureFooterPanelConfigArchive }, { type: undefined, decorators: [{
                type: Inject,
                args: [STRUCTURE_CSS_CLASS_NAME]
            }] }]; }, null); })();

function StructureComponent_gui_spinner_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-spinner", 3);
} if (rf & 2) {
    i0.ɵɵproperty("diameter", 120)("primary", true);
} }
const _c0$b = function (a0, a1) { return { "gui-loader-visible": a0, "gui-loader-hidden": a1 }; };
/** @internal */
function structureIdFactoryForGrid(generator) {
    return new StructureId('gui-grid-' + generator.generateId());
}
/** @internal */
function compositionIdFactoryForGrid(generator) {
    return new CompositionId('gui-grid-' + generator.generateId());
}
/** @internal */
function schemaIdFactoryForGrid(generator) {
    return new SchemaReadModelRootId('gui-grid-' + generator.generateId());
}
/** @internal */
class StructureComponent extends StructureGateway {
    constructor(structureId, compositionId, pagingCommandService, pagingEventRepository, sourceCommandDispatcher, sourceEventService, sortingCommandDispatcher, searchCommandDispatcher, fieldCommandDispatcher, schemaCommandDispatcher, compositionCommandDispatcher, compositionEventRepository, formationEventService, structureCommandService, structureEditModeArchive, structureCellEditArchive, structureInfoPanelArchive, structureInfoPanelConfigService, structureCellEditStore, columnFieldFactory, structureColumnMenuConfigArchive, pagingDisplayModeArchive, rowSelectEnabledArchive, rowSelectionTypeArchive, schemaRowClassArchive, schemaRowStyleArchive, formationCommandDispatcher, searchEventRepository, structureHeaderBottomEnabledArchive, structureDetailViewConfigArchive, structureTitlePanelConfigArchive, structureFooterPanelConfigArchive, schemaEventRepository, translationService, structureInitialValuesReadyArchive, columnAutoConfigurator, elementRef, detectorRef, injector, structureDefinition, structureWarehouse, compositionWarehouse, schemaStylesManager, schemaReadModelRootId, domainEventBus, commandDispatcher, structureDetailViewService) {
        super(detectorRef, elementRef, domainEventBus, commandDispatcher, columnAutoConfigurator, structureId, compositionId, schemaReadModelRootId, structureCommandService, pagingCommandService, pagingEventRepository, sortingCommandDispatcher, searchCommandDispatcher, fieldCommandDispatcher, sourceCommandDispatcher, sourceEventService, schemaCommandDispatcher, compositionCommandDispatcher, compositionEventRepository, formationEventService, structureEditModeArchive, structureCellEditArchive, structureInfoPanelConfigService, structureCellEditStore, columnFieldFactory, rowSelectEnabledArchive, rowSelectionTypeArchive, schemaRowClassArchive, schemaRowStyleArchive, formationCommandDispatcher, searchEventRepository, structureHeaderBottomEnabledArchive, schemaEventRepository, translationService, structureInitialValuesReadyArchive);
        this.elementRef = elementRef;
        this.detectorRef = detectorRef;
        this.injector = injector;
        this.structureDefinition = structureDefinition;
        this.structureWarehouse = structureWarehouse;
        this.compositionWarehouse = compositionWarehouse;
        this.schemaStylesManager = schemaStylesManager;
        this.schemaReadModelRootId = schemaReadModelRootId;
        this.structureDetailViewService = structureDetailViewService;
        this.loaderEnabled = false;
        this.circleLoaderEnabled = true;
        this.initialLoaderAnimation = false;
        this.styleModifier = new StyleModifier(this.elementRef.nativeElement);
        structureCommandService.create(this.structureId);
        compositionCommandDispatcher.create(this.compositionId);
        schemaCommandDispatcher.create(this.schemaId);
    }
    ngOnChanges(changes) {
        super.ngOnChanges(changes);
    }
    ngOnInit() {
        super.ngOnInit();
        this.hermesSubscribe(this.structureWarehouse.on(this.structureId), (structureReadModelRoot) => {
            this.structure = structureReadModelRoot;
            this.loaderEnabled = structureReadModelRoot.getSource().isLoading();
            this.circleLoaderEnabled = structureReadModelRoot.isLoaderVisible();
            if (this.loaderEnabled && !this.initialLoaderAnimation) {
                this.initialLoaderAnimation = true;
            }
            this.detectorRef.detectChanges();
        });
        this.structureDetailViewService.init(this.elementRef);
    }
    ngAfterViewInit() {
        this.structureInitialValuesReadyArchive
            .next(this.structureId, true);
        let width = this.elementRef.nativeElement.offsetWidth;
        if (width > 0) {
            this.compositionCommandDispatcher.setContainerWidth(width, this.compositionId);
        }
        else {
            /**
             * When gui-grid is in dynamic container which is created later then grid.
             */
            hermesTimer(0)
                .pipe(this.hermesTakeUntil())
                .subscribe(() => {
                width = this.elementRef.nativeElement.offsetWidth;
                if (width > 0) {
                    this.compositionCommandDispatcher.setContainerWidth(width, this.compositionId);
                }
            });
        }
        this.schemaStylesManager
            .init(this.elementRef, this.schemaReadModelRootId);
        this.hermesSubscribeWithoutRender(this.compositionWarehouse.onWidth(this.compositionId), (width) => {
            this.styleModifier.getHost().setWidth(width);
        });
    }
    isBorderEnabled() {
        return this.structureDefinition.isBorderEnabled();
    }
    getStructureId() {
        return this.structureId;
    }
    getElementRef() {
        return this.elementRef;
    }
    getSelectorName() {
        return 'gui-structure';
    }
}
StructureComponent.ɵfac = function StructureComponent_Factory(t) { return new (t || StructureComponent)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(PagingCommandInvoker), i0.ɵɵdirectiveInject(PagingEventRepository), i0.ɵɵdirectiveInject(SourceCommandInvoker), i0.ɵɵdirectiveInject(SourceEventService), i0.ɵɵdirectiveInject(SortingCommandInvoker), i0.ɵɵdirectiveInject(SearchCommandInvoker), i0.ɵɵdirectiveInject(FieldCommandInvoker), i0.ɵɵdirectiveInject(SchemaCommandInvoker), i0.ɵɵdirectiveInject(CompositionCommandInvoker), i0.ɵɵdirectiveInject(CompositionEventRepository), i0.ɵɵdirectiveInject(FormationEventRepository), i0.ɵɵdirectiveInject(StructureCommandInvoker), i0.ɵɵdirectiveInject(StructureEditModeArchive), i0.ɵɵdirectiveInject(StructureCellEditArchive), i0.ɵɵdirectiveInject(StructureInfoPanelArchive), i0.ɵɵdirectiveInject(StructureInfoPanelConfigService), i0.ɵɵdirectiveInject(StructureCellEditStore), i0.ɵɵdirectiveInject(ColumnFieldFactory), i0.ɵɵdirectiveInject(StructureColumnMenuConfigArchive), i0.ɵɵdirectiveInject(PagingDisplayModeArchive), i0.ɵɵdirectiveInject(RowSelectEnabledRepository), i0.ɵɵdirectiveInject(RowSelectionTypeArchive), i0.ɵɵdirectiveInject(SchemaRowClassArchive), i0.ɵɵdirectiveInject(SchemaRowStyleArchive), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(SearchEventRepository), i0.ɵɵdirectiveInject(StructureHeaderBottomEnabledArchive), i0.ɵɵdirectiveInject(StructureRowDetailConfigArchive), i0.ɵɵdirectiveInject(StructureTitlePanelConfigArchive), i0.ɵɵdirectiveInject(StructureFooterPanelConfigArchive), i0.ɵɵdirectiveInject(SchemaEventRepository), i0.ɵɵdirectiveInject(TranslationFacade), i0.ɵɵdirectiveInject(StructureInitialValuesReadyArchive), i0.ɵɵdirectiveInject(ColumnAutoConfigurator), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.Injector), i0.ɵɵdirectiveInject(StructureDefinition), i0.ɵɵdirectiveInject(StructureWarehouse), i0.ɵɵdirectiveInject(CompositionWarehouse), i0.ɵɵdirectiveInject(SchemaCssClassManager), i0.ɵɵdirectiveInject(SchemaReadModelRootId), i0.ɵɵdirectiveInject(i1$1.DomainEventBus), i0.ɵɵdirectiveInject(i1$1.CommandDispatcher), i0.ɵɵdirectiveInject(StructureRowDetailService)); };
StructureComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureComponent, selectors: [["gui-structure"]], hostVars: 3, hostBindings: function StructureComponent_HostBindings(rf, ctx) { if (rf & 2) {
        i0.ɵɵhostProperty("id", ctx.structureId.toString());
        i0.ɵɵclassProp("gui-structure-border", ctx.isBorderEnabled());
    } }, features: [i0.ɵɵProvidersFeature([
            {
                provide: StructureId,
                useFactory: structureIdFactoryForGrid,
                deps: [
                    StructureIdGenerator
                ]
            },
            {
                provide: CompositionId,
                useFactory: compositionIdFactoryForGrid,
                deps: [
                    StructureIdGenerator
                ]
            },
            {
                provide: SchemaReadModelRootId,
                useFactory: schemaIdFactoryForGrid,
                deps: [
                    StructureIdGenerator
                ]
            },
            SchemaCssClassManager,
            StructureCellEditCloseAllService,
            StructureCellEditStore,
            StructureEditModeArchive,
            StructureInfoPanelArchive,
            StructureInfoPanelConfigService,
            StructureColumnMenuConfigArchive,
            PagingFeatureModule.forComponent(),
            SortingFeatureModule.forComponent(),
            FieldFeatureModule.forComponent(),
            SearchFeatureModule.forComponent(),
            SourceFeatureModule.forComponent(),
            SchemaFeatureModule.forComponent(),
            SummariesFeatureModule.forComponent(),
            TranslationFeatureModule.forComponent(),
            RowSelectEnabledRepository,
            StructureHeaderTopEnabledArchive,
            StructureHeaderBottomEnabledArchive,
            StructureRowDetailConfigArchive,
            StructureRowDetailService,
            StructureTitlePanelConfigArchive,
            StructureFooterPanelConfigArchive,
            {
                provide: structureComponentToken,
                useExisting: StructureComponent
            },
            {
                provide: filterContainerToken,
                useExisting: StructureComponent
            }
        ]), i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], decls: 3, vars: 5, consts: [["gui-structure-blueprint", ""], [1, "gui-loading", 3, "ngClass"], [3, "diameter", "primary", 4, "ngIf"], [3, "diameter", "primary"]], template: function StructureComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
        i0.ɵɵelementStart(1, "div", 1);
        i0.ɵɵtemplate(2, StructureComponent_gui_spinner_2_Template, 1, 2, "gui-spinner", 2);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngClass", i0.ɵɵpureFunction2(2, _c0$b, ctx.loaderEnabled, !ctx.loaderEnabled && ctx.initialLoaderAnimation));
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.circleLoaderEnabled);
    } }, directives: [StructureBlueprintComponent, i4.NgClass, i4.NgIf, i1.FabricSpinnerComponent], styles: [".gui-box-border{box-sizing:border-box}.gui-bg-transparent{background-color:transparent}@use \"common/variables\";.gui-border{border-width:1px}.gui-border-0{border-width:0}.gui-border-b{border-bottom-width:1px}.gui-border-t{border-top-width:1px}.gui-border-solid{border-style:solid}.gui-border-b-solid{border-bottom-style:solid}.gui-border-t-solid{border-top-style:solid}.gui-border-none{border-style:none}.gui-rounded{border-radius:4px}.gui-cursor-pointer{cursor:pointer}.gui-block{display:block}.gui-inline-block{display:inline-block}.gui-inline{display:inline}.gui-flex{display:-ms-flexbox;display:flex}.gui-hidden{display:none}.gui-display-grid{display:grid}@use \"common/variables\";.gui-flex-row{-ms-flex-direction:row;flex-direction:row}.gui-flex-row-reverse{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.gui-flex-col{-ms-flex-direction:column;flex-direction:column}.gui-flex-col-reverse{-ms-flex-direction:column-reverse;flex-direction:column-reverse}.gui-justify-start{-ms-flex-pack:start;justify-content:flex-start}.gui-justify-end{-ms-flex-pack:end;justify-content:flex-end}.gui-justify-center{-ms-flex-pack:center;justify-content:center}.gui-justify-between{-ms-flex-pack:justify;justify-content:space-between}.gui-justify-around{-ms-flex-pack:distribute;justify-content:space-around}.gui-justify-evenly{-ms-flex-pack:space-evenly;justify-content:space-evenly}.gui-items-start{-ms-flex-align:start;align-items:flex-start}.gui-items-end{-ms-flex-align:end;align-items:flex-end}.gui-items-center{-ms-flex-align:center;align-items:center}.gui-items-between{-ms-flex-align:space-between;align-items:space-between}.gui-items-around{-ms-flex-align:space-around;align-items:space-around}.gui-items-evenly{-ms-flex-align:space-evenly;align-items:space-evenly}.gui-flex-wrap{-ms-flex-wrap:wrap;flex-wrap:wrap}.gui-flex-wrap-reverse{-ms-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse}.gui-flex-nowrap{-ms-flex-wrap:nowrap;flex-wrap:nowrap}@use \"common/variables\";.gui-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.gui-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.gui-grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.gui-grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.gui-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.gui-grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}.gui-grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.gui-grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))}.gui-grid-cols-9{grid-template-columns:repeat(9,minmax(0,1fr))}.gui-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.gui-grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.gui-grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))}.gui-grid-rows-4{grid-template-rows:repeat(4,minmax(0,1fr))}.gui-grid-rows-5{grid-template-rows:repeat(5,minmax(0,1fr))}.gui-grid-rows-6{grid-template-rows:repeat(6,minmax(0,1fr))}.gui-grid-rows-7{grid-template-rows:repeat(7,minmax(0,1fr))}.gui-grid-rows-8{grid-template-rows:repeat(8,minmax(0,1fr))}.gui-grid-rows-9{grid-template-rows:repeat(9,minmax(0,1fr))}.gui-grid-rows-gap-0{grid-row-gap:0}.gui-grid-rows-gap-1{grid-row-gap:1px}.gui-grid-rows-gap-2{grid-row-gap:2px}.gui-grid-rows-gap-3{grid-row-gap:3px}.gui-grid-rows-gap-4{grid-row-gap:4px}.gui-grid-rows-gap-5{grid-row-gap:6px}.gui-grid-rows-gap-6{grid-row-gap:8px}.gui-grid-rows-gap-7{grid-row-gap:10px}.gui-grid-rows-gap-8{grid-row-gap:12px}.gui-grid-rows-gap-23{grid-row-gap:42px}.gui-grid-cols-gap-0{grid-column-gap:0}.gui-grid-cols-gap-1{grid-column-gap:1px}.gui-grid-cols-gap-2{grid-column-gap:2px}.gui-grid-cols-gap-3{grid-column-gap:3px}.gui-grid-cols-gap-4{grid-column-gap:4px}.gui-grid-cols-gap-5{grid-column-gap:6px}.gui-grid-cols-gap-6{grid-column-gap:8px}.gui-grid-cols-gap-7{grid-column-gap:10px}.gui-grid-cols-gap-8{grid-column-gap:12px}.gui-grid-cols-gap-23{grid-column-gap:42px}.gui-h-full{height:100%}.gui-list-none{list-style-type:none}@use \"common/variables\";.gui-m-0{margin:0}.gui-mx-0{margin-left:0;margin-right:0}.gui-my-0{margin-bottom:0;margin-top:0}.gui-m-1{margin:1px}.gui-mx-1{margin-left:1px;margin-right:1px}.gui-my-1{margin-bottom:1px;margin-top:1px}.gui-m-2{margin:2px}.gui-mx-2{margin-left:2px;margin-right:2px}.gui-my-2{margin-bottom:2px;margin-top:2px}.gui-m-3{margin:3px}.gui-mx-3{margin-left:3px;margin-right:3px}.gui-my-3{margin-bottom:3px;margin-top:3px}.gui-m-4{margin:4px}.gui-mx-4{margin-left:4px;margin-right:4px}.gui-my-4{margin-bottom:4px;margin-top:4px}.gui-m-5{margin:6px}.gui-mx-5{margin-left:6px;margin-right:6px}.gui-my-5{margin-bottom:6px;margin-top:6px}.gui-m-6{margin:8px}.gui-mx-6{margin-left:8px;margin-right:8px}.gui-my-6{margin-bottom:8px;margin-top:8px}.gui-m-7{margin:10px}.gui-mx-7{margin-left:10px;margin-right:10px}.gui-my-7{margin-bottom:10px;margin-top:10px}.gui-m-8{margin:12px}.gui-mx-8{margin-left:12px;margin-right:12px}.gui-my-8{margin-bottom:12px;margin-top:12px}.gui-m-23{margin:42px}.gui-mx-23{margin-left:42px;margin-right:42px}.gui-my-23{margin-bottom:42px;margin-top:42px}.gui-mb-4{margin-bottom:4px}.gui-mb-6{margin-bottom:8px}.gui-mb-8{margin-bottom:12px}.gui-mb-10{margin-bottom:16px}.gui-mb-18{margin-bottom:32px}.gui-mr-0{margin-right:0}.gui-mr-5{margin-right:6px}.gui-mr-auto{margin-right:auto}.gui-ml-auto{margin-left:auto}.gui-mt-4{margin-top:4px}.gui-mt-6{margin-top:8px}.gui-mt-10{margin-top:16px}.gui-mt-14{margin-top:24px}.gui-overflow-hidden{overflow:hidden}.gui-overflow-y-scroll{overflow-y:scroll}.gui-overflow-x-hidden{overflow-x:hidden}.gui-overflow-auto{overflow:auto}@use \"common/variables\";.gui-p-0{padding:0}.gui-px-0{padding-left:0;padding-right:0}.gui-py-0{padding-bottom:0;padding-top:0}.gui-p-1{padding:1px}.gui-px-1{padding-left:1px;padding-right:1px}.gui-py-1{padding-bottom:1px;padding-top:1px}.gui-p-2{padding:2px}.gui-px-2{padding-left:2px;padding-right:2px}.gui-py-2{padding-bottom:2px;padding-top:2px}.gui-p-3{padding:3px}.gui-px-3{padding-left:3px;padding-right:3px}.gui-py-3{padding-bottom:3px;padding-top:3px}.gui-p-4{padding:4px}.gui-px-4{padding-left:4px;padding-right:4px}.gui-py-4{padding-bottom:4px;padding-top:4px}.gui-p-5{padding:6px}.gui-px-5{padding-left:6px;padding-right:6px}.gui-py-5{padding-bottom:6px;padding-top:6px}.gui-p-6{padding:8px}.gui-px-6{padding-left:8px;padding-right:8px}.gui-py-6{padding-bottom:8px;padding-top:8px}.gui-p-7{padding:10px}.gui-px-7{padding-left:10px;padding-right:10px}.gui-py-7{padding-bottom:10px;padding-top:10px}.gui-p-8{padding:12px}.gui-px-8{padding-left:12px;padding-right:12px}.gui-py-8{padding-bottom:12px;padding-top:12px}.gui-p-23{padding:42px}.gui-px-23{padding-left:42px;padding-right:42px}.gui-py-23{padding-bottom:42px;padding-top:42px}.gui-pr-10{padding-right:16px}.gui-pl-9{padding-right:10px}.gui-pb-6{padding-bottom:8px}.gui-pl-21{padding-left:38px}.gui-pt-4{padding-top:4px}.gui-pt-6{padding-top:8px}.gui-pt-10{padding-top:16px}.gui-pt-14{padding-top:24px}.gui-static{position:static}.gui-fixed{position:fixed}.gui-relative{position:relative}.gui-absolute{position:absolute}.gui-text-xxs{font-size:11px}.gui-text-xs{font-size:12px}.gui-text-sm{font-size:13px}.gui-text-base{font-size:14px}.gui-text-lg{font-size:16px}.gui-text-xl{font-size:18px}.gui-text-2xl{font-size:20px}.gui-text-3xl{font-size:22px}.gui-leading-4{line-height:16px}.gui-leading-6{line-height:24px}.gui-font-thin{font-weight:100}.gui-font-extralight{font-weight:200}.gui-font-light{font-weight:300}.gui-font-normal{font-weight:400}.gui-font-medium{font-weight:500}.gui-font-semibold{font-weight:600}.gui-font-bold{font-weight:700}.gui-font-extrabold{font-weight:800}.gui-font-black{font-weight:900}.gui-not-italic{font-style:normal}.gui-whitespace-nowrap{white-space:nowrap}.gui-overflow-ellipsis{text-overflow:ellipsis}.gui-no-underline{text-decoration:none}.gui-w-full{width:100%}.gui-w-96{width:384px}.gui-w-3\\/5{width:60%}.gui-structure *,.gui-structure *:after,.gui-structure *:before{box-sizing:border-box}.gui-structure input{font-size:13px;outline:0}.gui-bold{font-weight:bold}.gui-italic{font-style:italic}.gui-bar-view{width:100%}.gui-align-right{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;text-align:right;width:100%}.gui-align-left{text-align:left;width:100%}.gui-align-center{-ms-flex-pack:center;justify-content:center;text-align:center;width:100%}.gui-icon{cursor:pointer}.gui-icon svg{fill:#aaa;stroke:#aaa;transition:stroke .3s ease-in-out}.gui-icon svg:hover{fill:#464646!important;stroke:#464646!important}.gui-view-text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.gui-percentage-bar{background:#deebff;border-radius:4px;box-shadow:inset 1px 1px 2px #ccc;color:#0747a6;height:22px;padding:4px;position:relative;text-align:center;width:100%}.gui-percentage-bar .gui-percentage{background:#8abcfc;border-radius:4px;height:22px;left:0;position:absolute;top:0}.gui-percentage-bar .gui-percentage-view{color:#031d44;position:relative;width:100%}.gui-clear-search-icon{cursor:pointer;height:16px;position:absolute;right:8px;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);width:16px}.gui-clear-search-icon:before,.gui-clear-search-icon:after{background-color:#aaa;border-radius:8px;content:\" \";height:16px;left:7px;position:absolute;width:2px}.gui-clear-search-icon:before{-ms-transform:rotate(45deg);transform:rotate(45deg)}.gui-clear-search-icon:after{-ms-transform:rotate(-45deg);transform:rotate(-45deg)}.gui-clear-search-icon:hover:before,.gui-clear-search-icon:hover:after{background-color:#464646}\n", ".gui-structure{border-color:#d6d6d6;font-size:14px}.gui-structure *{border-color:#d6d6d6;font-size:14px}.gui-structure input{color:#333;font-family:Arial}.gui-header{background:#f2f3f4;border-bottom:1px solid;border-color:inherit;height:36px}.gui-header .gui-header-cell.gui-header-sortable{cursor:pointer}.gui-header .gui-header-cell.gui-header-sortable:hover{background:#e6e7e8}.gui-header .gui-header-cell .gui-header-menu-icon{display:none}.gui-header .gui-header-cell:hover .gui-header-menu{cursor:pointer}.gui-header .gui-header-cell:hover .gui-header-menu .gui-header-menu-icon-wrapper .gui-header-menu-icon{display:block}.gui-header .gui-header-cell:last-of-type{border-right:0}.gui-header .gui-header-cell .gui-header-title{display:-ms-flexbox;display:flex;line-height:1.4em}.gui-header .gui-header-cell .gui-header-title .gui-sort{display:none;height:14px;margin-left:4px;width:14px}.gui-header .gui-header-cell .gui-header-title .gui-sort-asc{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAAB2CAYAAAAz4kaDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABNRSURBVHhe7V1pU1vHmkYSixEIBAIhME6cXNshjjMkNuBNeMM2U6lUJeOKwfg6W5UrqeRLPuQHJPk2n6Y8+ZaUZ7I5cYwXbEySe+/Unbmp3MQbiM3YGBtvxAVml1iEEJLmeVqniSyD8ILhKDmP3Zw+3X16eZ9+3377nCMpRoMGDSHQKceoQiAQ0H366aexra2tsXogOTk5gGT/M8884y0rK/MFS0UXDMoxKkACcIh1OBxmg8FQ0tzSsmfM43llYHDwhe6engJLZuaC7Vu3dq9Zs2b8xx9/JDlRg6jRCEULUsbHx9ecra3dqDfoV46NjT3r9Y4nMT8uNs6dEJ9wXqfXnytcverv1nTrGWjHsLg4ChAVRJCEzz//PNXj86w/c+pcxcjo8GZdjC4FWUYEPcvodDoUC7gRXEZj0v+tt9sPZKan//Tyyy8PMV/tUL1pIgn79u1L9UxM2FtaLpSPDA9tHRvzZMXGxibAPOl8Ph/LxOCcTMR5vd4kvU5n6+3rNRoTE4d27NjRVV1dPa5Up1qonojc5bnp/nH/+ubmpor+vr5tMPxWLtBAjN/vF2WgDYIMHhGo5caR4eGcgYGB5GxbtrO8vPx2VVWVRxRWKYRaqxVff/112lDX6PrGhuayIdfQFsg4EwLXQxOE4EmEIvwYqRnMQ7oOGmJxulxbz9Wdq3C5XMXHjx83KdWqEqrViC+++MLS09Oz/uKFC7uGXK5tAX/AajBADaASYs4LnwhaoCxz/DsZRBmBRI/Hk9Pf1w8PN9n5xhtvdB8+fFiVmqFKjaAmDA4Ormtvb38Fs3kTkjKFLYKAYf8FCRS4XqefFH4wruRNltHpkG4ZGRkpaWpq2tXf329Xq2aoTiOOHTtm6ejoWHf58uUKCK4EZsYmSHhw6FCHEYt4Tm9vrykpKclZUVGhujVDVUSQhJs3b66FJuyE0Eows20IUALO+QcHrqdHZYSZskHDEq1Wqwt7DFWRoRoiSMKlS5fW3bhx45W+vr4tSMpBoAxF/sNA8ahYkdHtdlvhTRnNZvOQmjRDFUSQBGjBuuvXr5dDE+gd5XKPQK9IEaJS8sHAOhi418BpMsjIdjqdprS0NNWYqXlfrLkwkwSYpB1YoLkwL2S6JODhlocgWAfrIrEAojoriNiCBbx8eHjYXllZmSwKziPmVSOoCbdu3Vrf1tbGhVmYI0qJJFBoFB7DbIH1Ekq9SdAMG8xgCjXj9ddfn1fXdt6IoCaQhCtwUWGzS5CUjQD5/Cb8UDKkECVkmiwr46FHQsZZl9QMQimXPD4+boMmJprMJteOl+fvdsi8mKZDhw6l3+7ttV9sa63AmrANAqF3RCglggKUZkkKNRShZQmey7TQ8jLOHXcoZHmEjEHnYKnDUb/HG/AWw0ylKkXmFHOuEdSEXzs77dfgokITtkB0NopDyb4DUrDhs5lHCphpUtCMh2qQDDJfnk8FFEmamJjIcg66EhOTkly752EBn1MiqAmd3Z321gsXdg04B7YE/AEbRBRxn0ABM/BeEmc1A+NSyJIgkkAwDd6RiLNcXFzctARIkCp/wG8cc49m9w/0J1vS0uf8dsicEfHZZ5+Z4anYWy5c2Ol0urZCcFkQKsWolJgaoTMau+NJLQgVbnic+ZjhghASFF4+HMzjdEA5o2fMk+0aciZa0i3OV199tRNkzMmaMSdEkITR0dFiR0NDhWtwcItOrxckyFkcSUgS8fHxQrgsSwFTuCSFaayHmsI0HqXwExISJu/KRmrDj3zlWnRNbxwZdWf39vWaMi0ZzpdeemlOFvBHSgQGp1u8eLF52D1sb25uLseiuBVpVpLAgROUD+ajiE8FRYA+j8fjg5mhGRPurQTzZZAgQQgBXONlecSnb4AIdkKQwWsDfn8Sb4fATBmt2Tmuf5sDMh4ZESRBecZcXFvrKB8aGirBIMVDnTs1IRINYqH2QgP6oBE9mP18Pm1AGuUr8qkBFJ6sUzmi+cCY0WjsYARYQD5EgWkg6+P1rA/niWPYZ3R3305alLvIVQoz9f0jNFOPhAgMXDxjJgmOekfFqHu0BLPMCpGjPZgJzjqaAz9NBi8IXieFwTwFXgjlitlsrsnLy7vY1dVFN5dvcEySyaOME8pC7cd1159//vkTME03R0ZG0pGWgnqFY8D65VEAzdI8ESQBGUxEasA4MeHL7u7pTl6ckeksfbUUZHz/SMiYdSIwOKEJmL322traiuHhkW26QEwGxiXakvOfw5RxKUhJBI9I80LgHbDzB5KSkv7d5XL1YZ3hxi8LQcxulgsPCihJXruvsLDQgV17LMhYiL6loIwoxAOJkKSE/pvsGQ74bxz3jOfcvn3buDhzsetRLeCzuqELIWFDfX39brfbXYIBWZBlCA4vCDlUIQAEmhceQ2a2F+vB9bS0tJObNm36n3379jlBghv5kwXkteFBAn0J9PT0jGHXXLt69eqD6enpx6klSKZdE23xKNsOvf63fooY/6RjLNvq6ur2wPPb8CjuTc0aEZIEDKb43Llz5ejwVhDCZ8wRtQ75k/sCCgVxLrA3MzMza9asWVMJTajH+aStul+8/fbb3uHh4Xq73X4wKyvrBOsGCT6aMLZJQtiHGcC3RTJAaumpU6f2oL4NX375pXifarYwK0SQhI8//tiEgRWfPXu2AmaA3pEFgjVwsJFAISiLI+NcmK9lZGTU5OfnH4FpqX/vvfceelNFMqAdDUVFRd+CYJJxg2TIvs1EBMuhj/TW0jAxtpEMeFUbZ1MzHpoIdE534MABPoIsPn36dAW8o20QZgY6b5A+fCRIEqA9Ezi9illbg0W2EmmO8vJyd7DUw4OEwtw1rF279mB2dvZxJF1Hk1zUgwt0BHAMiinToQ4LyNguNWO2yHgoIkgCzRGEvwEk7EbHSpCWThKkDZ4JimmYiI2Lu2q1WqtBwhGQWv/mm2+OKUVmDWVlZePUDJi8b0F4FQi4jvYJpcT04FhYTmoGJxzJmK0144GJIAl0UTHruSbQHG1DJ4UmcHJzlrHzM5GBfG7UrmTbbCdXrlx5BIOtn01NCAc1A8ITmpGbm3scbbcjOSITchwMvM2CI4anTwcZpT///POskPFAREhNgCdhh3e0i24lCKGvHnRR0WFplmQIRcj5BMpeweysXr58+VGkNz0KTQgH1wwI8vxzzz1HzaA3dRVt30WG7DsDtUHRCJFHMjBG89jY2NYzZ878GS7yxv379z/wqzr3TQQ69ZsmOGrFmoBOCU1QiggiZIcJDkAOSAJxH8pcXrhw4clly5YdMZlMDXNBggTNFJyBxhUrVnyLPhxHn0kGIfLlkX0nwsdE4Jy3aizUjLPnzv4Z2lL8oGTcFxFoVJCABu3NLc1l7lE3H28G9wnoKBF6lIFuqRyYAvry7Tk5OTVLly49hvOWR2mOpgPJQD8uoA9HuICjj9dwHmCfCfZ5yn1GyBFBj5GljYyObq1vatwd0Osf6PXOeyZCksAbeGdra8sGB50lEz7fPe8T5IAww3yIt8M+f/f4449XYaPVDFMxqhSfc1ALsXFsgrt8GBOjGknX0V9BBjVAakQkgBaaKYtzcHDb6VM/777V1bXhfsm4ZyKwGKVxTWhqPF8xMNC/HQuyzaDXU7pKibtBEhg4IAwsgEFxVFdhCk4sWbLkcHx8fKMaPkxCbcSC21hYWMgF/Bj6yh14gJOHYLc5julA0lCWZioTE7TU4ajd09Xbu+Grr77iZzjuCfdEBB9vdnV1rW9obChzuZxb0GgmGhe3sqenIdhBxa4GFJ+9/bHHHqt54oknjs63JoSD3tT4+HgT9zCcKEi6BhMMSxPcZ3As0wHTTRCFMuItdJfTtfXc2TMVrpF7fwt9RiL4VnZvb6/9QuuFXf0DA9vRoBWNTT5PkMepwDzMJhZANEASjj/55JOVILJJDZoQDpopjLVx1apVB0FGFZKuseMzmyeQhFGyHMZG35ZmSryQcKvrFl3bGV9IiEgENaG7r3vdxUsXXxl0ujaB8Ewk0x6KGSLDdEAeba0fnbuC9eC7RYsWVWVkZJxXkyaEQ2oGyKBmnOQtF3KBoJS4G5SATh+URfAGAe/06y3DQ8Ml9XUNu7p6emZ8C31aIvjyFz+fcOXylV39ff3b/D7f5FvZ7JToWITOKeBUugxNOEFNSE1NVaUmhIOawdshBQUF39hstmMYdsRNn6LyQZkocZDCHXiGa8hV2thIzeiKuGZMSURNTU3a1atX17a1te0cHHBuRp185UV8PkGwr6gi2+UDFR9VVyTxXzANR6rNFWjBSd5OwMLc8tprr42IBqIAdG2pGc8+++xhW7atWm/QX/PTSAXHNjlWn195Jh5MFLKR8sFf2ouMEWhGQ13drkivd05JxC+//PKn9vb2sr6+vu2oSLx3pKcZQp7STIx4/0KYJpEoyGBfqKI4n0A3Ly/MzT2BhfmwxWJp2rt3b1R8ujMU1Ax6U0WFRQezbFnHMNh2jM/HMXKsIEY8bRQCgSDkOym/BfGPhTNQz7/W1tbuvnz58pPIugt3EXH06FGrx+PJHxgYKICg+TSMdU4JkSHI+G3XiTkzEWswXM222b7709InxJoQTZoQDuWubXPhqsIjVmvWSZAgbqEzj2NWzND0QgpCh3WSn1wqwC58TVVVlVlJn8RdRDgcjryxsTF+Uke8ixpMnRrsBD0FHtEQj150qR2qfCL/X/IPWVItjfOxY55t0Ezx4dIGu/0bTDDeCYCZCnBjKvKlDCKB+XBysvkpqJaWljwleRJ3EFFdXZ2BBXo5XLh8nKbOVDlpCpon4S14Yw2x17Js1u+WP5tfhbTm3wMJErxRiENzwcqCwzZbVjW0gTtw3i8T459JJSBLelImEJEPk78yfOG+g4jz588vTUhIKEbFNvrDMxKB1tkJlPNiTbiJteCHgtUFR529vXN6A2+uQM2gN7WmaE1lljWzxu/z/4qxK0/6IjNBWZI0uMNZsDjFmPDLlCyBO4i4ePGiFdrwDC5Ko7oFG4iAoLp54RFdz7BkVhcVFlb6xnyO999//3ejCeEgGbDzDpDxTabVWoUJexOOCl0npcTUoCwhK05uM7RieV1dHT+aNok7iLBarU4wNoDCvCs5ea9lOqBpb2xcbEd6uuV7+7p1h9GQ4/eoCeGgmaJmYMzfWq2Z1XBOOiDpiF9PRFkyQEZuo9HYk52dfcem9g4iNm/e3Ird5D8Q7eQ5LhIqRfAYFrxwaW+YzeYTBUUrD0GT/hAkSEjNKCoo+ibNbD4O23ETyT7KhpByknFFlpzcnfAk/1FUVNQmMhXcQcSLL77YNTo6+k+w3QrT5JamKaxSLlrUnBtpaWk1xRvshwd7Bx1080SBPxCoGfSmijcXf5uenl4Ned1A8hBkJLQjVG6UJeLDCxYsuAQZn9m5c2eHyFBwBxHE9u3bW7CbrISgT+HCfiR5uF5goeGbd06QdD0xMfFvUK//3rhx46Hert4/JAkSJGOof8hht9sPpKSkfELZkBAEF+SF5UPc9OTLcb1YS0/l5eUdQdlW5AcZUnAXEdSKFStW/IDwXxD2MQi+BST0wZu6CXL+npqa+vkLL7zwcU5Ozn8i/dwfmQQJklFRUVFns9k+Li0t/Q9Yiv0Q+v9CXjdBRj/izZDf0aeffvrAsmXL/tba2npLuXQS07pFn3zySRwqyenq6tqIDcgzcE0HwORPHR0dDWB+XPGr5wx79+5dBZv8CWbScziN7EUEbXWDyWR6e//+/XVK2pzggw8+0EM+Cbm5uc/99NNPdnhImZjUF7Oysn5saGi4BRPm/eijj+66gTiDfxokhF9iiMqpShOoRNznnWtECxESJAQkxEEr9HwoNh0BEjMSoRZEGxH3i7vWCA3zA40IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJoo6IQMi3gk2FSHlqxu9SI6KRDM00qQQaESqBRoRKoBGhEmhEqATRRwS/hRCBfhF/SEN+K6GIRzGihgifwTAR0Os8IIC/vAQiAjF6/mYF8gIgg3H+pgvjMXodf12DX48d8fu61YSoIcJiMg2nmlLa9Ho9f51F/CRZbGys2DOExcnNkNmc2paSkqLaX/cKR9QQkZeX15331FN/hbDbDQaDPy4uLsbtdovfZMC5iJMMBGrBlaVP5f11yZIlPcGr1Y+oIYI/FuVyuX5JTk6qx6zvxvQfhdD5i4/it99IDkgahjp0m1JMjZ2//nr2nXfeGVQuVz1m+iJbVeHdd98dTzGlODu7bg/FGsTMT4Lw+Ysmnvi4+IG4hPhav8//l8KVq35YvHhxW35+ftR8b7nic0QP+FXPZrM5Bdpg/+X06XVer4e/DBYTHx/fvXad/dS42/1PaI7rww8/JEFcL6ICUUeERGVlpaGlpSWus7NTbzKZdDBXfqwjE2+99RZ/NT5qCNCgQcPdiIn5f8mUtwsfGiECAAAAAElFTkSuQmCC);background-position:center;background-repeat:no-repeat;background-size:contain;display:block}.gui-header .gui-header-cell .gui-header-title .gui-sort-desc{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAAB2CAYAAAAz4kaDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABPcSURBVHhe7V1pU1TXuqa7aQSaHpjBaxRkEKMCMikeoyeVm9ycqAhGcIia5GYwX/IhvyDmD+RDqu6HpJJKVeJ1wFQqZSVVVxETacQBxOiJlibxRBOFpqFpukGGHu/zrN6b0yg0RgF3m/2QlbV7DXuv9T7rHdbe2+4YFSpUhEEj5VGFYDCo+eSTT2KvXbsWq9PptG63O5idnR1YtmyZt6GhwS81iyropDwqQAKQxV68eNESo9M9d/3na7sc/Y6tI6MjLw243BWpKSnxzz//vH316tWeU6dOBUO9ogNRpRH79+83OZ3O6razZ9fPmxdX5vN4V3h8XgPrdLHaEb0u7ieQ1bGqqupERkZGG7RjRHSMAkSNRlAbvvzyy/m37tzaOzbmqff7fAU+vz85EAgkoC5eE6MxBHz+bJ/fWwSy4kdHRzugFS6pu+IRNURkZmYmxxsM63779V91Go0mHyne5/Np9Hp9jFarjeFxrD5Wj/LEMa9Hk7c47w9oxK2jR496pFMoGlFDxJIlSxbaurpeG/WMrfH7/YnUkPj4+Biv1yvqeezxeITmgBiDe3DIOzQ4eKGtrc0pGigcWilXPAYHBxMHXK5CHBohaCx8DbVAaEP4MaCBuTIMuF2FDrc7iQXRgKghAitdh//FxwSCGg3iIYg/JuD3x/CYEYc4xh8o4meNNhCcp/X7Y0O9lY+oIWIyaDXS8EkMjkUIyKA1qgLXEKKaiCcJKhEKgUqEQqASoRCoRCgEUUcE9wxPIqJSIyKRwbpoJEs1TQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQRvz3k/fff1/b39+tjY2O1Pp8vkJKS4v3ggw8CUvWc4s033ywfHBz8WKPRlOLjdF+T6g8Ggz8ajca9n3766QWpbE4B2fGLHWPdbremqKjIt3fv3tD3ok6BSSdEAoqLi+P4XauY+KabN2/Wz5s3b0VlZWWgurrasXr16sBcf/d2WVnZfI/HswnjycLH6TSZY7NhzN92dnZ2h4rmBh9//LF+/fr1Cfn5+RXXrl3b1tvb+4+kpKTMnTt3DmzYsGH422+/nXQh36cREgnzr1+//uzVq1f/homvHBsby8Ok3Ki+hJOeX7du3SlcpHPfvn1jqJ8TQpSuEY2NjborV67MW7ZsWRkW6TqMtRxjLRkZGbHExcXd0uv1nYWFhSch2+9BiE3qNo77JvTOO+8suHHjxgsgYSdW4HOBQGABJmVElcnv9y8YHR0tunXrVi7IWTA0NDT2wgsv9E7F8kxCyRrx0UcfzUtMTCy/fPnydizg2uHh4RchtxUw52nIkyC/FK/Xm2+327O1Wu3Ie++9Zztw4MCQ1F1gwoTQQdPa2lqE1b4VHavRKQ3FCfzmYZCgQ70JaRFYfsHlcu21Wq27TKmmMqpj6Ax/PZCE1KxUasE2EPDflA1klwN5mUGCXvp25nlYQCkoqwZZDceOHVsmOodhAhFHjhx5Csyuwqpfgo5kUpTjePxbwZBTi4wkBI68pqW5ZTvM1cq/IhkkwZxqLrO2WOudTudGaMAiFJshIyGLcLlRliAlASQVQcZrv/vuO2r2OCYQcf78+UI4l7+DuWycQKPT6cIJmHAM6EDTQqdroLa9o32nyWQqg52MEw3+Avj888/jU1NTyy60X9w24HRtDmBhQi78tv5xWUlyEjllKSH7zp07fz958mSR9FlgAhE2my0RqpWOTgkgI4YpIoJBnc/vf8pmt9e0tLVtB9ulfwXNIAkI6cusZ87UO/r7XvJ5fU9B5BHnTVlCK8CJJg6ak4wFb5aqBCYQAYfYhb3CVXQYABnIpgmIyLRWqwv4/Qv7enrqzrWfe+I148MPP0yIjY8tO9fe3uDos9d4xjw5kJWesogEyTRRO5zQpCvYW9ilKoEJRGRkZPwcHx9vhZPpQRpXrakRFBdAO51Wp11g67FvPHPuTAM140kkg5pgTk0tbT/X/rKjr+8fMD7cZ+lDCzbyoqUsoRVc3DbIx7p8+fJfpCqBCUTs2rXLDbY6kS6BiEF0jnx21HIQJA2rQoc8x2brqblw8UI9alc8SWYKCysB2Yqr/7xc19PTu8Hn9+XCPAkSBBGRJSUvald6evqltLS0qzU1NX2iQsIEIghsSK4lJyc34yLdUucpwXopPBM2UBuKqHK7uru3tLS27mQ09SRoBknoc/WV/Pjjj9u6u7o3B4OBPMxdzznLMphOVkAQ7bphcZrLy8uvSWXjuI+Iurq6AexIzyLE6sCFHCiakmtWcDVwENQKAhfTBQPBRT32nk0dnR3cj6xgmCcqoxBffPGFAY51+Y2ff6vr6rFt8AX8izFH8QMhnHNIG6AVovWUQLNgDxZ4BzaZl7Zs2TLBPxD3EUEUFBT8q7Ky8oDFYvm/GE1MX0j5QheTk5+Cl1QyiGP5hzRAApNOEwzm2bptWxAS74ADL6F9RXVU4bPPPjM6HI7i3377rb7r9u3NmGEB5hvLOXKuCFRC8xcpKGRC2ciyQkjLoyAkZYO5P56fn99YXV19g+e+F5MS0dDQMASz0lpaXn7IYDQ046QgA+fE1UMXwSceI1Eb4KnFwOC8RM6flwEx2oA/kIuQuOann36qj4uLK44mM0VNGBsbW9aDaPCPP/7YBEHnY2466adzQjOFGEiGKAsVytKRjwP4s6UkW74vLCw8kpube2bjxo2T/vjUpEQQdNzzMzNbSkrL95tM5mMQeB/1S7aFzEUSn6aEFuqb1w2f0dHRsZPRVDRoBhZMktvtpiY0/P7775tRVIA0pawEZHlI8sG8A1qdzpaaltqUV5B3CE76NEwSTf2kiHjy2traway0tNay8tJDSdAMnFv4DDjykLGiGQo1nRTSwPgsI7erq2tTZ2dnAzVDyT4DkV5iX1/fchBQd/PmzQ3wk/mYq5ZrUGpyH4QspITgkUUBBKq9yWbzD0uLln6VkZrR9sorr0T8GbbILAMwU675mfNb4On3m5Mtx0gG42ERLYmhRaICFwhFFHAZwdzbt2/XXbhwYQfspSJ9BjUBc5M1oRbDzkMxf9eOUwg1mgRyHXMsugBye5ol+fjTS58+hLm2vvrqq1NqgoxpiSCoGSaDyVpVueqgyWw84fX5HBCsMFORjBNXCIgTSa/Xs2HunTt3NiMMVJxmUBP6+/tXgISXoQkbMeY8PplEFX/XTsxlKrCGskCbgM/v7TWaLSdXrlzZmJWVdXo6TZDxQEQQ9BmZaWnQjKr9yRbzMVy5F6sHgcHUA+TghOYAaMvP1IwcOL8t7e3tIppijC4aPEZQE+C/Sm7cuFHPhYJhMkQV5ogkcB5MUwIyQMTkB3G21OS046Ulyw9iv9BaX1//wL8K+cBEENQMOvDVa9YeSDZbmmAPHaBh2odCJENeVejDGeXAgddcvnyZt4+LH6eZkjUBWsDoiD4hD+PljTaxeGjzI5IAoN4fq9X1Wizm5sqKikZDvKH1tddec6E8st0Ow58igiAZCIWsK0tLDxgSEk9Auk4MelwzwnM5SdoQXi7MFBx47S+//LIVn59+HKEttRHjWvbrr79uwcLYiHHQJ4zLhGPm2KUxi0Tck/MWtSPBEH+yeHlxI0zwnyaB+NNEEG+88cYgLmhdtWrV/8K8MLR1YMVP0IxwuyqbJ5kM5kg0U4vhwGuvXLmy3ePx0EzNGRnUwsHBwdLr169vhTnaBIEXYEjjDw2kMY6PnQifE4Fj3sXrMxqNTVXlVQfR1vowJBAPRQRBMrBlP0UysG0/ARUewKAEGRwwJ8AkT4jpXqCM+4zF2PTVwoFvx/HyubhRSBJw7eKrV6++jA1bDa6bj2Jx2+LeccpjZ6KZCiPCj8/9iYmJzWVlZYfoE95++2032v1pEoiHJoLgDtxsNresXbt2P1YFQ9t+ksHfmOaA5TQNtHCUebDPtW1tbTtwvtLZjKZojrBAVl68eHFrV3f3Jlyb+4RxTZgM8jy4wKQ9FHxzoM9gMDRVVT2aJsh4JCIImYw1a9aQjCYUOTFIsc94ABJkzaFm5Njt9rqzZ89uxy50Vp5nUBOGhoYECbhWjc/rXQzhxXIM04FzkebkR59+kNC8evXqA5hzy6NogoxHJoIgGRhYS3V19X6QchyrTOwzOHAMUGo1ObjKpJXGsTCaqj1z5swO3g6ZSc2gJmBIZdzDwBzRMS/GNWORi+tHAucgmSU/NmzCJ2CuB4eHh63YJ0z/3OYBMCNEECQDvuIUNQMOvAmDE5rBiUaCTBTbgTiGjYuwWjefP39eaMZM+AwSOjY2tvLSpUtbe3t7+bZFLq4rHuqQBHkMU4Ht4MypCQ4suBM0RyizvvvuuzNCAjFjRBB79uy5K2uGxWI5hlXEp1ARB0ohSCov/0o7yViIVbvZarXueNRXdXAuDVbwSmhZA0nguTEu8VCH1+RKn44I1NMxY59gOVFZWXkY/awzYY7CEdFJPQyOHDni2b17d3dKSooLZsaAsPQ/MOAEuDtMVxO6HYBEIciQTYNMCNpzR2seHR2d73K5YgsLC51ut1s/MDDwEpqJN/3C+4cDXZnRLNopuOPHj7sRou6Ab9gGohehXJDKdjzHBI0QGUf579WDYz9G50iCJlRUVAjHPNMkEDNOBEEyXtz9YndORo7b7rAbPF5vFiadGJoxxo8s9NAkJJDwREg5Mo3x7t272dj5JmdlZS0CscUoT0E5nTvb3AeSCfDUw0uWLNE5HI7/xH6hBtcX5oiV0vkFxDH+Gx+PlnXiCEQF/BqttteYlNQMEg7B9J5G2D7jJBD/HtEs4H8aG5PiXK51p8+e3jk8OPy8RqdNR/HE+zeYUqRBQIB+CLcfIfEANGQB+sSjP++IinqaFoKmhuC5UYduQU9cXNxtfE6CJqSgbErzJqTKoZAMJOnc4CbQk2AwNq+uqDiMslnRBBmzSgTBx43eQOCZixc6dvY7nf+FojTG4rLgaAimGwSEGUB7H8jgm3TckQuBkUgKnjmTXCYhiMjLx2gMZZH3CeIPY5HOA+J4K7s3xZLctKJ0xeGHuXf0ZzGjznoyiNshWE0V5RUHeAsdM+mVV50s0EiQBK3FDpZvyAltklasEBo/k1QeE/J52RZ9qAXiBl4ksJpteA7kAQTdPUaTma/Qixt4r7/++sBskkDMio+4F0ePHhUOPD013TXgdCbC7s/HhMVb5pi01CoyKHAmmiLmMvhZFj4ht5GjIpkgOZ8MrKNvQB/xUMeSYjmxsrj0MIi0kgSp2axi1jVChrQDP11SXMKHS01YX70QGm/bSi0mB4UsC5a3TngsC13O7xUy+8A/CFJYx8+RwDGgbUCr09pMScaTRUuLjvAZ81yRQMyJRshANDW2Y8eOHnNKqmtwaCjB4xmjZhgirVYKk4kEEOGrnAJmHctkrZDL5HoSSES6BpSSHXvS0zKa8wsLG7PTM1sxzgd+qDMTmFMiiK+//nrs9VdftVuSTa7evl6j1+PJhGEwSNXjCBf4ZEKUBc86pnAywhHed7LzAPAKQZs52fRDYdHSwwvnzz891yQQc04EQc2oq62zZWRluFxOVwI3bihOZF24sLiyZUHLCD8OJ2sqyPX3nksiDFnQlpaR0bQkv7AxMz19zjVBRuRZzDIaGxvN2Kz9rb29fTc2Xc9iRWeynEKShTydoB8Uk5wTH4NdJpOpZenSpQdzcnLaIr13NNt4LBohg5qxZ88ecTvE6XQmjIyMZKNY+AyZgJkigpD9DLUDpHfBITctXrz4SHZ2duu2bdv6ReVjwpxFTVOB0ZR4vbO09LDFYjmJVcoXdMefZ8iO91HAc8jaIOEOIrgfFi5c+HVeXt60L3/NBR6rRsigA2c0lZyc7BoYGIiHZmRAcEkgQ0juUbVC7o9z8l2s29CEZpBwpKCg4LGao3AogghCJiMjI8MNM2UAGcKBQ3CPbJskbSAPNpKQn5//FUzSGaWQQCiGCIJkwFZTMwYdDofR5/Nlwaw8Mhk4RwDa1QNf9D1M0WE4ZkWRQDzyapsNfPPNN8aenp51nZ2d210ul7hRiPRQY4UW0MlQE04UFhZ+xXdRleAT7sVjd9aTgS+xQStaS0pKDvEhfSAYcDD4JBU0MyLHH8rFXVMm+Zh14rYJc3rpmJheo9H4A0zRV3DQinDMk0FRpikcDG3feustG4TocjgdCSPY9Gm02gQIefxZBOUsjiWCeOOOVkyQwruoOq3dZDI3Pb1ihdis7d69+7GGqJGgSI2QId5CN5msVRVVB81Gk3gLHYIPyre95RuATCSEZVKd+PcJRnPSyZKVxY2mrMQHfiv7cUHRRBB8Cz02Nlb8+4z01LRjOo22D04csg89+JeJkI+9Xm8AbeyZmRnHly8vPegd9ba+Uf+GokkgoNTRATrwXqfzmVarddfI8N1nYYRMMEV8V0meA/3BMGhxJyYmfV9dXXUwThd3erafrM0UooYIorGxMcneb1/Vfu7Cc8FAoHLMM7bc6/OKf1+h18fdTYiP/6ffH+isqqg4FRcXd3Y2nzHPNKKKCILfsGaxWEz6+Pi1rS0ta/R6vbhR6PF67eufeebM6OhoK0Je9759+/hCWFSQQEQdETKgHfzqNj6T1t69e5df7BXglxhCC3zRRIAKFSruR0zM/wMYBpbiISU/xQAAAABJRU5ErkJggg==);background-position:center;background-repeat:no-repeat;background-size:contain;display:block}.gui-header .gui-header-cell .gui-header-menu{display:-ms-flexbox;display:flex}.gui-header .gui-header-cell .gui-header-menu .gui-header-menu-icon-wrapper{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:16px;padding:16px;position:relative;right:0;width:16px}.gui-header .gui-header-cell .gui-header-menu .gui-header-menu-icon-wrapper .gui-header-menu-icon{display:none;height:16px;width:16px}.gui-header-bottom .gui-header{border-bottom:0;border-color:inherit;border-top:1px solid}.gui-structure{background:#fff;border-color:#d6d6d6;box-sizing:border-box;color:#333;display:block;font-family:Arial;font-size:14px;position:relative}.gui-structure *{box-sizing:border-box}.gui-structure .gui-structure-header{display:block;height:100%;width:100%}.gui-structure .gui-structure-header .gui-structure-header-filters.gui-header{height:32px}.gui-structure .gui-structure-header .gui-structure-header-filters.gui-header .gui-header-cell{padding:4px}.gui-structure .gui-structure-header .gui-structure-header-filters.gui-header .gui-header-cell input{box-sizing:border-box;height:100%;padding:2px;position:relative;width:100%;border-color:#d6d6d6;border-style:solid;border-width:1px;font-size:13px}.gui-structure-container{display:block;height:100%;overflow:auto;overflow-x:hidden;position:relative;width:100%}.gui-structure-container .gui-structure-container-element{height:100%;position:absolute;width:100%}.gui-structure-container .gui-structure-container-element .gui-content{height:100%;position:relative}.gui-structure-container .gui-structure-container-element .gui-content .gui-row{border-bottom:1px solid transparent;position:absolute;width:100%}.gui-structure-container .gui-structure-container-element .gui-content .gui-row:last-child{border-bottom:0}.gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:#ecedee}.gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#d0e8fb}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell{border-right:1px solid transparent;box-sizing:border-box;line-height:1em;overflow:hidden;padding:0;white-space:nowrap}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-cell-view span{line-height:1.4em}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-button{padding:0}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-cell-boolean{-ms-flex-pack:center;justify-content:center}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-checkbox{line-height:24px;position:relative}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-checkbox input{position:relative}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-chip{line-height:1em;margin:0;padding:4px 8px}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-badge{padding:0}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-input{background:transparent;font-size:14px;padding:0;border-radius:0;border-style:none}.gui-structure-container .gui-cell{display:inline-block}.gui-structure-container .gui-cell:last-child .gui-cell-view{padding-right:20px}.gui-structure-container .gui-cell>span{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:100%;padding:0 8px;width:100%}.gui-structure-container .gui-cell .gui-cell-edit-mode{border:2px solid #2185d0;height:100%;padding:6px}.gui-structure-container .gui-cell .gui-cell-edit-mode .gui-boolean-edit{margin-left:calc(50% - 11px)}.gui-structure-container .gui-cell .gui-cell-edit-mode input:focus{box-shadow:none;outline:none}.gui-vertical-grid .gui-structure-summaries-cell{border-right:1px solid;border-right-color:inherit}.gui-vertical-grid .gui-structure-container-element .gui-content .gui-row .gui-cell,.gui-vertical-grid .gui-structure-header .gui-header .gui-header-cell{border-right:1px solid;border-right-color:inherit}.gui-vertical-grid .gui-structure-container-element .gui-content .gui-row .gui-cell:last-of-type,.gui-vertical-grid .gui-structure-header .gui-header .gui-header-cell:last-of-type{border-right:0}.gui-vertical-grid .gui-row-checkbox{border-right:1px solid!important;border-right-color:inherit!important}.gui-horizontal-grid .gui-structure-container-element .gui-content .gui-row{border-bottom:1px solid;border-bottom-color:inherit}.gui-horizontal-grid .gui-structure-container-element .gui-content .gui-row:last-of-type{border-bottom:0}.gui-rows-even .gui-row.even,.gui-rows-odd .gui-row.odd{background:#f7f8f9}.gui-structure-info-panel{-ms-flex-align:center;align-items:center;background:#f2f3f4;box-sizing:border-box;display:-ms-flexbox;display:flex;height:36px;-ms-flex-pack:justify;justify-content:space-between;padding:0 6px;width:100%;border-top-color:inherit;border-top-style:solid;border-top-width:1px}.gui-structure-info-panel p{margin:0}.gui-structure-info-panel p b{font-weight:bold}.gui-structure-info-panel div button{background:#ccc;color:#fff;cursor:pointer;font-family:Arial;font-weight:bold;height:16px;line-height:14px;padding:0;width:16px;border-color:transparent;border-radius:50%;border-style:solid;border-width:1px}.gui-structure-info-panel div button:focus{box-shadow:0 0 4px #ccc;outline:none}.gui-structure-border{border:1px solid;border-color:#d6d6d6}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut{0%{opacity:1}to{opacity:0}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}.gui-loading{-ms-flex-line-pack:center;align-content:center;-webkit-animation-duration:.2s;animation-duration:.2s;background:rgba(255,255,255,.8);border:1px solid;border-color:inherit;display:-ms-flexbox;display:flex;height:100%;-ms-flex-pack:center;justify-content:center;left:0;opacity:0;position:absolute;top:0;visibility:hidden;width:100%}.gui-loading .gui-spinner{-ms-flex-item-align:center;align-self:center}.gui-loading.gui-loader-hidden{-webkit-animation-name:fadeOut;animation-name:fadeOut;opacity:0;visibility:visible;z-index:-1}.gui-loading.gui-loader-visible{-webkit-animation-name:fadeIn;animation-name:fadeIn;opacity:1;visibility:visible;z-index:1}.gui-structure-column-manager>div:hover{background:#ecedee}.gui-structure-column-manager label{margin-bottom:0}.gui-text-highlight{background:#fff799;padding:0!important}.gui-title-panel{border-bottom-color:#d6d6d6}.gui-footer-panel{border-top-color:#d6d6d6}.gui-schema-manager-dialog .gui-schema-manager .gui-structure-schema-manager-select,.gui-schema-manager-dialog .gui-schema-manager .gui-checkbox{color:#333}.gui-schema-manager-dialog .gui-schema-manager .gui-structure-schema-manager-select:nth-last-child(1),.gui-schema-manager-dialog .gui-schema-manager .gui-checkbox:nth-last-child(1){margin-bottom:0}.gui-structure-schema-manager-icon{margin-right:16px}.gui-structure-schema-manager-icon svg{height:18px;margin-bottom:-1px;width:18px}.gui-row-checkbox{-ms-flex-align:center;align-items:center;cursor:pointer;display:-ms-flexbox!important;display:flex!important;-ms-flex-pack:center;justify-content:center;padding:0 12px!important;width:48px!important}.gui-row-checkbox .gui-checkbox{height:24px;margin:0;padding:0;width:24px}.gui-select-all .gui-checkbox .gui-checkmark{top:0}.gui-structure-cell-edit-boolean{height:100%}.gui-column-highlighted{background:#fffddd}\n", ".gui-structure-column-manager ol li:hover{background:#ecedee}.gui-structure-column-menu-icon svg{height:16px;width:16px}.gui-structure-column-menu-icon .cls-1{fill:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px}.gui-structure-column-menu-arrow-icon{display:inline-block}.gui-structure-column-menu-arrow-icon svg{height:10px;width:12px}.gui-structure-column-menu-arrow-icon .gui-structure-column-menu-sort-icon svg{height:16px}.gui-structure-column-menu-arrow-icon .cls-1{fill:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px}.gui-structure-dialog-column-manager .gui-dialog-title{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.gui-structure-dialog-column-manager ol{max-height:400px;min-width:250px}\n", ".gui-summaries-value{font-weight:bold}.gui-structure-summaries-panel{background:#f2f3f4}.gui-structure-summaries-panel.gui-structure-summaries-panel-bottom .gui-structure-summaries-cell{border-top:1px solid #d6d6d6}.gui-structure-summaries-panel.gui-structure-summaries-panel-top .gui-structure-summaries-cell{border-bottom:1px solid #d6d6d6}.gui-structure-summaries-panel .gui-structure-summaries-cell{font-size:14px;padding-left:16px;padding-right:16px}.gui-structure-summaries-panel .gui-structure-summaries-cell:last-child{padding-right:20px}.gui-structure-summaries-panel .gui-structure-summaries-value{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;line-height:1em;overflow:hidden;padding:8px 0}.gui-structure-summaries-panel .gui-structure-summaries-value div .gui-math-symbol{position:relative;top:-1px}.gui-structure-summaries-panel .gui-structure-summaries-value .gui-mean,.gui-structure-summaries-panel .gui-structure-summaries-value .gui-median{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:relative}.gui-structure-summaries-panel .gui-structure-summaries-value .gui-mean span:nth-child(1){left:1px;position:absolute;top:-15px}.gui-structure-summaries-panel .gui-structure-summaries-value .gui-median span:nth-child(1){left:1px;position:absolute;top:-8px}\n", ".gui-structure-column-manager-icon svg{height:16px;width:16px}.gui-structure-column-manager-icon .cls-1,.gui-structure-column-manager-icon .cls-2{fill:none;stroke-linecap:round;stroke-linejoin:round}.gui-structure-column-manager-icon .cls-2{stroke-width:1.5px}.gui-structure-info-icon svg{height:16px;width:16px}.gui-structure-info-icon .cls-1{stroke-width:0}.gui-structure-info-icon .cls-2{fill:none;stroke-linecap:round;stroke-linejoin:round}.gui-structure-info-panel div{display:inline-block}.gui-structure-info-panel div button{display:inline-block}.gui-structure-info-panel .gui-right-section .gui-structure-column-manager-icon{margin-right:16px;position:relative}.gui-structure-info-panel .gui-right-section .gui-structure-info-icon{margin-right:4px;position:relative}.gui-structure-info-modal .gui-quote{color:#575757}.gui-structure-info-modal p{color:#333}.gui-structure-info-modal a{color:#2185d0}.gui-structure-info-modal a:hover{color:#59a9e5;text-decoration:underline}\n", "@media (max-width: 500px){.gui-paging>*{padding-left:4px}.gui-paging .gui-paging-stats{padding-left:4px}}\n", ".gui-header{display:-ms-flexbox;display:flex}.gui-header .gui-header-cell{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex}.gui-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.gui-content .gui-structure-cell-container,.gui-content .gui-row{display:-ms-flexbox;display:flex}.gui-content .gui-structure-cell-container .gui-cell,.gui-content .gui-row .gui-cell{display:inline-block}.gui-content .gui-structure-row-details{background:#80cbc4;display:block;height:200px;position:absolute;-ms-transform:translateY(0);transform:translateY(0);width:100%}\n", ".gui-inline-dialog-header-menu.gui-inline-dialog-wrapper .gui-inline-dialog-content{background:transparent;box-shadow:none}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-item-active{font-weight:bold}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-list{background:#fff}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item{color:#333}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item.gui-active{color:#2185d0}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-content{box-shadow:0 3px 7px #ccc;box-sizing:content-box;padding:0;width:225px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move{color:#333;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding:0}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item{-ms-flex-align:center;align-items:center;cursor:pointer;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item svg line{stroke:#aaa}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item.left{padding:12px 16px 12px 12px;width:48%}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item.right{padding:12px 10px;width:52%}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover svg line{stroke:#464646}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container{border:none;border-radius:0}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container:hover .gui-dropdown-arrow{opacity:1}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu{width:125px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item{background:#fff;color:#333;display:-ms-flexbox;display:flex;padding:8px 8px 8px 12px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item:hover .gui-sort-title svg line{stroke:#464646}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item .gui-sort-title{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;width:100%}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item .gui-sort-title svg{margin-top:3px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item .gui-sort-title svg line{stroke:#aaa}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-header-item-active .gui-item .gui-sort{opacity:1}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item{color:#333;cursor:pointer;display:block;padding:8px 12px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-checkbox{color:#333;margin-left:12px;padding:8px 12px 8px 32px;width:169px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-checkbox label{display:inline-block;width:inherit}\n", ".gui-cell .gui-checkbox{display:block}.gui-cell .gui-chip{margin:0;padding:2px 8px}.gui-cell .gui-input{display:block;font-size:11px;padding:2px 4px;width:100%}.gui-cell .gui-button{padding:2px 8px}.gui-cell .gui-cell-number{display:block;width:100%}.gui-cell .gui-cell-boolean{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:100%;text-align:center;width:100%}.gui-cell .gui-string-edit{width:100%}\n", ".gui-fabric{border-color:#d6d6d6;font-family:Arial;font-size:14px}.gui-fabric .gui-header-cell,.gui-fabric .gui-structure-header-columns{height:42px}.gui-fabric .gui-structure-top-panel,.gui-fabric .gui-structure-info-panel,.gui-fabric .gui-paging{height:42px}\n", ".gui-material{border-color:rgba(0,0,0,.122);font-family:Arial;font-size:14px}.gui-material *{border-color:rgba(0,0,0,.122);font-size:14px}.gui-material.gui-structure{border:0;border-radius:0;box-shadow:0 2px 2px rgba(0,0,0,.141),0 3px 1px -2px rgba(0,0,0,.122),0 1px 5px rgba(0,0,0,.2)}.gui-material.gui-structure,.gui-material .gui-header{font-family:Arial}.gui-material .gui-header-cell,.gui-material .gui-structure-header-columns{height:56px}.gui-material .gui-header .gui-header-cell.gui-header-sortable:hover{background:transparent}.gui-material .gui-header-cell{padding-left:16px;padding-right:16px}.gui-material .gui-structure-container-element .gui-structure-cell>span{padding-left:16px;padding-right:16px}.gui-material .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:rgba(0,0,0,.04)}.gui-material .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#e6f7ff}.gui-material .gui-structure-header .gui-header{background:transparent;color:#464646;font-weight:bold}.gui-material .gui-structure-header .gui-header .gui-header-cell{border-color:inherit}.gui-material .gui-cell .gui-button{padding:0}.gui-material .gui-cell .gui-badge{padding:0}.gui-material .gui-paging-alternative-navigator .gui-button{background:transparent;color:#333;margin:0 4px;padding:0}.gui-material .gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-material .gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#ccc;opacity:.4}.gui-material .gui-structure-summaries-panel{background:#fff}.gui-material gui-structure-top-panel,.gui-material .gui-structure-info-panel,.gui-material .gui-paging{height:52px;padding-left:16px;padding-right:16px}.gui-material .gui-structure-info-panel{background:#fff;border-radius:0}.gui-material gui-structure-top-panel{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;padding-right:0}.gui-material gui-structure-top-panel .gui-search-bar form input{border:0;outline:0}.gui-material .gui-search-bar form input{border:0;outline:none}\n", ".gui-dark{border-color:#575757;border-radius:2px;color:#f0f0f0;font-family:Arial;font-size:14px}.gui-dark *{border-color:#575757;color:#f0f0f0;font-size:14px}.gui-dark.gui-structure{border-radius:2px}.gui-dark .gui-header-cell,.gui-dark .gui-structure-header-columns{background:#333;height:46px}.gui-dark .gui-structure-border{border:none;box-shadow:5px 5px 10px 2px #1f1f1f}.gui-dark .gui-header-cell{border-bottom:1px solid;border-color:inherit;padding-left:16px;padding-right:16px}.gui-dark .gui-structure-container-element .gui-structure-cell>span{padding-left:16px;padding-right:16px}.gui-dark .gui-structure-header .gui-header{border-bottom-color:#666;color:#bdbdbd}.gui-dark .gui-structure-header .gui-header .gui-header-cell:hover{background:#525252}.gui-dark .gui-structure-header .gui-header .gui-header-cell:hover .gui-header-menu .gui-header-menu-icon-wrapper{background-color:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-list{background:#383838}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item{color:#f0f0f0}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item.gui-active{color:#ce93d8}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-content{box-shadow:0 1px 2px #525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-structure-column-manager ol li:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move{color:#f0f0f0}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover svg line{stroke:#ce93d8}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container .gui-dropdown-menu{border-color:#666}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container .gui-dropdown-menu .gui-item:hover svg line{stroke:#ce93d8}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-item{background:#383838;color:#f0f0f0;display:-ms-flexbox;display:flex}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item{color:#f0f0f0}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-checkbox{color:#f0f0f0}.gui-dark .gui-structure-column-manager>div:hover{background:#525252}.gui-dark .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:#525252}.gui-dark .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#7cb9f652}.gui-dark.gui-rows-odd .gui-row.odd{background:#4f4f4f}.gui-dark.gui-rows-even .gui-row.even{background:#4f4f4f}.gui-dark .gui-horizontal-grid .gui-structure-container-element .gui-row .gui-cell{border-bottom-color:#666}.gui-dark .gui-paging.gui-paging-bottom{border-top-color:#666}.gui-dark .gui-paging.gui-paging-top{border-bottom-color:#666}.gui-dark ::-webkit-scrollbar{width:15px}.gui-dark ::-webkit-scrollbar-track{background:#616161}.gui-dark ::-webkit-scrollbar-thumb{background:#424242}.gui-dark ::-webkit-scrollbar-thumb:hover{background:#212121}.gui-dark .gui-structure-top-panel,.gui-dark .gui-structure-info-panel,.gui-dark .gui-paging,.gui-dark .gui-structure-container-element,.gui-dark .gui-row{background:#444}.gui-dark .gui-structure-top-panel,.gui-dark .gui-structure-info-panel,.gui-dark .gui-paging{height:42px;padding-left:16px;padding-right:16px}.gui-dark .gui-structure-summaries-cell{background:#383838;color:#f0f0f0}.gui-dark .gui-structure-summaries-panel-bottom .gui-structure-summaries-cell{border-top-color:#666}.gui-dark .gui-structure-summaries-panel-top .gui-structure-summaries-cell{border-bottom-color:#666}.gui-dark .gui-structure-info-panel{background:#383838;border-top-color:#666}.gui-dark .gui-structure-info-panel div{color:#f0f0f0}.gui-dark .gui-structure-info-panel div button{background:#616161}.gui-dark .gui-structure-info-panel p{color:#f0f0f0}.gui-dark .gui-structure-info-modal p{color:#f0f0f0}.gui-dark gui-paging-alternative-navigator .gui-button{background:transparent;color:#f0f0f0;margin:0 4px;padding:0}.gui-dark gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-dark gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#f0f0f0;opacity:.4}.gui-dark gui-paging-alternative-navigator gui-paging-alternative-pages .gui-paging-active-page{box-shadow:0 1px #f0f0f0;color:#f0f0f0}.gui-dark .gui-search-bar form{background:#444}.gui-dark .gui-search-bar input{background:#444;border:0;color:#f0f0f0;cursor:pointer}.gui-dark .gui-search-bar:hover .gui-search-icon-svg line,.gui-dark .gui-search-bar:hover .gui-search-icon-svg circle{stroke:#878787}.gui-dark .gui-icon{cursor:pointer}.gui-dark .gui-icon svg{stroke:#aaa;transition:stroke .3s ease-in-out}.gui-dark .gui-icon svg:hover{stroke:#e6e6e6!important}.gui-dark .gui-empty-source div{background:#383838}.gui-dark .gui-dialog-wrapper .gui-dialog-content .gui-schema-manager-dialog .gui-dialog-title{color:#f0f0f0}.gui-dark .gui-title-panel,.gui-dark .gui-footer-panel{background:#383838}\n", ".gui-light{border-color:#f0f0f0;font-family:Arial;font-size:14px}.gui-light *{border-color:#f0f0f0;font-size:14px}.gui-light.gui-structure-border{border:0}.gui-light.gui-structure,.gui-light .gui-header{background:#fff;color:#333;font-family:Arial}.gui-light .gui-header-cell,.gui-light .gui-structure-header-columns{height:56px}.gui-light.gui-structure-border{border-color:#f0f0f0 transparent}.gui-light .gui-header-cell,.gui-light .gui-structure-container-element .gui-structure-cell>span{padding-left:16px;padding-right:16px}.gui-light .gui-structure-header .gui-header{color:#333;font-weight:bold}.gui-light .gui-structure-header .gui-header .gui-header-cell:hover{background:#f3f9ff}.gui-light .gui-structure-header .gui-header .gui-header-cell:hover .gui-header-menu .gui-header-menu-icon-wrapper{background-color:#f3f9ff}.gui-light .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:#f3f9ff}.gui-light .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#7cb9f652}.gui-light.gui-rows-odd .gui-row.odd{background:#f7f7f7}.gui-light.gui-rows-even .gui-row.even{background:#f7f7f7}.gui-light gui-paging-alternative-navigator .gui-button{background:transparent;color:#333;margin:0 4px;padding:0}.gui-light gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-light gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#333;opacity:.4}.gui-light .gui-structure-top-panel,.gui-light .gui-structure-info-panel,.gui-light .gui-paging{height:56px;padding-left:16px;padding-right:16px}.gui-light .gui-structure-top-panel,.gui-light .gui-structure-info-panel,.gui-light .gui-paging,.gui-light .gui-structure-summaries-panel{background:#fff}.gui-light .gui-search-bar form input{border:0;outline:none}\n", ".gui-structure.gui-generic{border-color:rgba(34,36,38,.102);font-family:Arial;font-size:14px}.gui-structure.gui-generic *{border-color:rgba(34,36,38,.102);font-size:14px}.gui-structure.gui-generic .gui-header-cell,.gui-structure.gui-generic .gui-structure-header-columns{height:46px}.gui-structure.gui-generic .gui-header .gui-header-cell.gui-header-sortable:hover{background:rgba(0,0,0,.04);transition:.15s all}.gui-structure.gui-generic .gui-header-cell,.gui-structure.gui-generic .gui-structure-container-element .gui-structure-cell>span{padding-left:12px;padding-right:12px}.gui-structure.gui-generic .gui-structure-container-element .gui-structure-cell:last-child>span{padding-right:20px}.gui-structure.gui-generic .gui-structure-header.gui-header-bottom .gui-header{border-color:inherit;border-style:solid;border-width:2px 0 0}.gui-structure.gui-generic .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:rgba(0,0,0,.04)}.gui-structure.gui-generic .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#e6f7ff}.gui-structure.gui-generic .gui-structure-header .gui-header{background:#f9fafb;border-width:0 0 2px;color:#464646;font-weight:bold}.gui-structure.gui-generic .gui-rows-odd .gui-row.odd{background:#f9fafb}.gui-structure.gui-generic .gui-rows-even .gui-row.even{background:#f9fafb}.gui-structure.gui-generic .gui-cell .gui-button{padding:0}.gui-structure.gui-generic .gui-cell .gui-badge{padding:0}.gui-structure.gui-generic .gui-paging-alternative-navigator .gui-button{background:transparent;color:#333;margin:0 4px;padding:0}.gui-structure.gui-generic .gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-structure.gui-generic .gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#ccc;opacity:.4}.gui-structure.gui-generic .gui-structure-summaries-panel{background:#f9fafb}.gui-structure.gui-generic .gui-structure-top-panel,.gui-structure.gui-generic .gui-structure-info-panel,.gui-structure.gui-generic .gui-paging{height:46px;padding-left:12px;padding-right:12px}.gui-structure.gui-generic .gui-structure-info-panel{background:#f9fafb;border-radius:0}.gui-structure.gui-generic .gui-structure-top-panel{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;padding-right:0}.gui-structure.gui-generic .gui-structure-top-panel .gui-search-bar form input{border:0;outline:0}.gui-structure.gui-generic .gui-rows-odd gui-row.odd,.gui-structure.gui-generic .gui-rows-even .gui-row.even{background:#f9fafb}.gui-structure.gui-generic .gui-row:hover{background:#f9fafb;transition:.15s all}\n"], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureComponent, [{
        type: Component,
        args: [{
                selector: 'gui-structure',
                templateUrl: './structure.component.html',
                styleUrls: [
                    './style/styles.ngx.scss',
                    './style/structure.ngx.scss',
                    './style/structure-column-manager.ngx.scss',
                    './style/structure-summaries.ngx.scss',
                    './style/structure-info-modal.ngx.scss',
                    './style/structure-responsive.ngx.scss',
                    './style/structure-flex.ngx.scss',
                    './style/structure-header-menu.ngx.scss',
                    '../../../composition/feature/style/composition.ngx.scss',
                    './style/themes/fabric.structure.ngx.scss',
                    './style/themes/material.structure.ngx.scss',
                    './style/themes/dark.structure.ngx.scss',
                    './style/themes/light.structure.ngx.scss',
                    './style/themes/generic.structure.ngx.scss'
                ],
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None,
                host: {
                    '[class.gui-structure-border]': 'isBorderEnabled()',
                    '[id]': 'structureId.toString()'
                },
                providers: [
                    {
                        provide: StructureId,
                        useFactory: structureIdFactoryForGrid,
                        deps: [
                            StructureIdGenerator
                        ]
                    },
                    {
                        provide: CompositionId,
                        useFactory: compositionIdFactoryForGrid,
                        deps: [
                            StructureIdGenerator
                        ]
                    },
                    {
                        provide: SchemaReadModelRootId,
                        useFactory: schemaIdFactoryForGrid,
                        deps: [
                            StructureIdGenerator
                        ]
                    },
                    SchemaCssClassManager,
                    StructureCellEditCloseAllService,
                    StructureCellEditStore,
                    StructureEditModeArchive,
                    StructureInfoPanelArchive,
                    StructureInfoPanelConfigService,
                    StructureColumnMenuConfigArchive,
                    PagingFeatureModule.forComponent(),
                    SortingFeatureModule.forComponent(),
                    FieldFeatureModule.forComponent(),
                    SearchFeatureModule.forComponent(),
                    SourceFeatureModule.forComponent(),
                    SchemaFeatureModule.forComponent(),
                    SummariesFeatureModule.forComponent(),
                    TranslationFeatureModule.forComponent(),
                    RowSelectEnabledRepository,
                    StructureHeaderTopEnabledArchive,
                    StructureHeaderBottomEnabledArchive,
                    StructureRowDetailConfigArchive,
                    StructureRowDetailService,
                    StructureTitlePanelConfigArchive,
                    StructureFooterPanelConfigArchive,
                    {
                        provide: structureComponentToken,
                        useExisting: StructureComponent
                    },
                    {
                        provide: filterContainerToken,
                        useExisting: StructureComponent
                    }
                ]
            }]
    }], function () { return [{ type: StructureId }, { type: CompositionId }, { type: PagingCommandInvoker }, { type: PagingEventRepository }, { type: SourceCommandInvoker }, { type: SourceEventService }, { type: SortingCommandInvoker }, { type: SearchCommandInvoker }, { type: FieldCommandInvoker }, { type: SchemaCommandInvoker }, { type: CompositionCommandInvoker }, { type: CompositionEventRepository }, { type: FormationEventRepository }, { type: StructureCommandInvoker }, { type: StructureEditModeArchive }, { type: StructureCellEditArchive }, { type: StructureInfoPanelArchive }, { type: StructureInfoPanelConfigService }, { type: StructureCellEditStore }, { type: ColumnFieldFactory }, { type: StructureColumnMenuConfigArchive }, { type: PagingDisplayModeArchive }, { type: RowSelectEnabledRepository }, { type: RowSelectionTypeArchive }, { type: SchemaRowClassArchive }, { type: SchemaRowStyleArchive }, { type: FormationCommandInvoker }, { type: SearchEventRepository }, { type: StructureHeaderBottomEnabledArchive }, { type: StructureRowDetailConfigArchive }, { type: StructureTitlePanelConfigArchive }, { type: StructureFooterPanelConfigArchive }, { type: SchemaEventRepository }, { type: TranslationFacade }, { type: StructureInitialValuesReadyArchive }, { type: ColumnAutoConfigurator }, { type: i0.ElementRef }, { type: i0.ChangeDetectorRef }, { type: i0.Injector }, { type: StructureDefinition }, { type: StructureWarehouse }, { type: CompositionWarehouse }, { type: SchemaCssClassManager }, { type: SchemaReadModelRootId }, { type: i1$1.DomainEventBus }, { type: i1$1.CommandDispatcher }, { type: StructureRowDetailService }]; }, null); })();

class StructureHeaderFilterComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureFilterCommandService, structureId) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureFilterCommandService = structureFilterCommandService;
        this.structureId = structureId;
        this.sub = new ChangedValueEmitter();
        this.editContext = {
            changes: this.sub
        };
    }
    ngOnInit() {
        this.sub
            .on()
            .subscribe((phrase) => this.filter(phrase));
    }
    filter(phrase) {
        // this.structureFilterCommandService.addFilter(this.column.getFieldId(), '1', phrase, this.structureId);
    }
    getSelectorName() {
        return 'gui-structure-header-filter';
    }
}
StructureHeaderFilterComponent.ɵfac = function StructureHeaderFilterComponent_Factory(t) { return new (t || StructureHeaderFilterComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(FilterCommandInvoker), i0.ɵɵdirectiveInject(StructureId)); };
StructureHeaderFilterComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureHeaderFilterComponent, selectors: [["gui-structure-header-filter"]], inputs: { column: "column" }, features: [i0.ɵɵInheritDefinitionFeature], decls: 2, vars: 1, consts: [["gui-button", "", 3, "primary"]], template: function StructureHeaderFilterComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "button", 0);
        i0.ɵɵtext(1, "Add Filter");
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("primary", true);
    } }, directives: [i1.FabricButtonComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureHeaderFilterComponent, [{
        type: Component,
        args: [{
                selector: 'gui-structure-header-filter',
                template: `

		<!--		<ng-container-->
		<!--				*ngTemplateOutlet="column.editTemplate; context: editContext">-->
		<!--		</ng-container>-->

		<button gui-button [primary]="true">Add Filter</button>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: FilterCommandInvoker }, { type: StructureId }]; }, { column: [{
            type: Input
        }] }); })();

const _c0$a = ["gui-structure-quick-filters", ""];
class StructureQuickFiltersComponent {
}
StructureQuickFiltersComponent.ɵfac = function StructureQuickFiltersComponent_Factory(t) { return new (t || StructureQuickFiltersComponent)(); };
StructureQuickFiltersComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureQuickFiltersComponent, selectors: [["div", "gui-structure-quick-filters", ""]], attrs: _c0$a, decls: 1, vars: 0, template: function StructureQuickFiltersComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtext(0, " QuickFilters ");
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureQuickFiltersComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-quick-filters]',
                template: `

		QuickFilters

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], null, null); })();

class InMemoryStructureAggregateStore extends InMemoryAggregateStore {
    constructor(inMemoryStructureStore, aggregateStoreRegister) {
        super(inMemoryStructureStore, aggregateStoreRegister);
    }
}
InMemoryStructureAggregateStore.ɵfac = function InMemoryStructureAggregateStore_Factory(t) { return new (t || InMemoryStructureAggregateStore)(i0.ɵɵinject(InMemoryStructureStore), i0.ɵɵinject(i1$1.AggregateStoreRegister)); };
InMemoryStructureAggregateStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryStructureAggregateStore, factory: InMemoryStructureAggregateStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryStructureAggregateStore, [{
        type: Injectable
    }], function () { return [{ type: InMemoryStructureStore }, { type: i1$1.AggregateStoreRegister }]; }, null); })();

class InMemoryStructureAggregateRepository extends StructureAggregateRepository {
    constructor(inMemoryStructureAggregateStore) {
        super();
        this.inMemoryStructureAggregateStore = inMemoryStructureAggregateStore;
    }
    findById(aggregateId) {
        return this.inMemoryStructureAggregateStore.findById(aggregateId);
    }
    save(aggregate) {
        this.inMemoryStructureAggregateStore.save(aggregate);
    }
}
InMemoryStructureAggregateRepository.ɵfac = function InMemoryStructureAggregateRepository_Factory(t) { return new (t || InMemoryStructureAggregateRepository)(i0.ɵɵinject(InMemoryStructureAggregateStore)); };
InMemoryStructureAggregateRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryStructureAggregateRepository, factory: InMemoryStructureAggregateRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryStructureAggregateRepository, [{
        type: Injectable
    }], function () { return [{ type: InMemoryStructureAggregateStore }]; }, null); })();

class SelectionEnabledSetEvent extends StructureDomainEvent {
    constructor(aggregateId, enabled) {
        super(aggregateId, enabled, 'SelectionEnabledSetEvent');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class FilterAddedEvent extends StructureDomainEvent {
    constructor(aggregateId, fieldId, filterTypeId, value) {
        super(aggregateId, { fieldId, filterTypeId, value }, 'FilterAddedEvent');
        this.fieldId = fieldId;
        this.filterTypeId = filterTypeId;
        this.value = value;
    }
}

class UniqueFilterSelectedEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'UniqueFilterSelectedEvent');
    }
}

class AllUniqueFilterSelectedEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'AllUniqueFilterSelectedEvent');
    }
}

class UniqueFilterUnselectedEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'UniqueFilterUnselectedEvent');
    }
}

class AllUniqueFilterUnselectedEvent extends StructureDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'AllUniqueFilterUnselectedEvent');
    }
}

class InMemoryStructureRepository extends StructureReadModelRepository {
    constructor(domainEventBus, inMemoryStructureReadStore) {
        super(domainEventBus);
        this.inMemoryStructureReadStore = inMemoryStructureReadStore;
        this.structureIdToStructure = new Map();
        this.hermesStructure$ = new HermesReplaySubject(1);
    }
    getStructure(structureId) {
        return this.structureIdToStructure.get(structureId.getId());
    }
    on(structureId) {
        return this.hermesStructure$
            .toObservable()
            .pipe(hermesFilter((structureIdToStructure) => {
            const key = structureId.getId();
            return structureIdToStructure.has(key);
        }), hermesMap((structureIdToStructure) => {
            return structureIdToStructure.get(structureId.getId());
        }));
    }
    forEvents() {
        return [
            StructureCreatedEvent,
            SetSourceLoadingEvent,
            PagingSetEvent,
            PrevPageEvent,
            NextPageEvent,
            PagesizeChangedEvent,
            SelectionEnabledSetEvent,
            VerticalScrollEnabledSetEvent,
            ScrollPositionSetEvent,
            SortToggledEvent,
            FilterToggledEvent,
            SearchPhraseSetDomainEvent,
            SortOrderSetEvent,
            OriginSetEvent,
            RowHeightSetEvent,
            StructureHeightSetEvent,
            RowHeightSetBasedOnThemeEvent,
            FilterAddedEvent,
            ActiveFiltersSetEvent,
            UniqueFilterSelectedEvent,
            AllUniqueFilterSelectedEvent,
            UniqueFilterUnselectedEvent,
            AllUniqueFilterUnselectedEvent
        ];
    }
    subs(event) {
        const aggregateId = event.getAggregateId();
        const optStructure = this.inMemoryStructureReadStore.getById(aggregateId);
        optStructure.ifPresent((structureReadModelRoot) => {
            const key = structureReadModelRoot.getId().toString();
            this.structureIdToStructure.set(key, structureReadModelRoot);
            this.hermesStructure$.next(this.structureIdToStructure);
        });
    }
}
InMemoryStructureRepository.ɵfac = function InMemoryStructureRepository_Factory(t) { return new (t || InMemoryStructureRepository)(i0.ɵɵinject(i1$1.DomainEventBus), i0.ɵɵinject(InMemoryStructureReadStore)); };
InMemoryStructureRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryStructureRepository, factory: InMemoryStructureRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryStructureRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }, { type: InMemoryStructureReadStore }]; }, null); })();

const inMemoryStructureCommandProviders = [
    InMemoryStructureAggregateStore,
    {
        provide: StructureAggregateRepository,
        useClass: InMemoryStructureAggregateRepository
    }
];
const inMemoryStructureReadProviders = [
    InMemoryStructureReadStore,
    {
        provide: StructureReadModelRepository,
        useClass: InMemoryStructureRepository
    }
];
const inMemoryStructureProviders = [
    InMemoryStructureStore
];

class StructurePreparedEntitiesSetAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId, preparedItems) {
        super(aggregateId, 'StructurePreparedEntitiesSetAggregateEvent');
        this.preparedItems = preparedItems;
    }
    toDomainEvent() {
        return new StructurePreparedEntitiesSetEvent(this.getAggregateId(), this.preparedItems);
    }
    getPreparedItems() {
        return this.preparedItems;
    }
}

class FieldsInitedAggregateEvent extends StructureAggregateEvent {
    constructor(structureId, fieldConfigs, // TODO merge
    fields) {
        super(structureId, 'FieldsInitedAggregateEvent');
        this.fieldConfigs = fieldConfigs;
        this.fields = fields;
    }
    toDomainEvent() {
        return new FieldsInitedEvent(this.getAggregateId(), this.fieldConfigs, this.fields);
    }
    getFieldConfigs() {
        return this.fieldConfigs;
    }
    getFields() {
        return this.fields;
    }
}

class StructureCreatedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'StructureCreatedAggregateEvent');
    }
    toDomainEvent() {
        return new StructureCreatedEvent(this.getAggregateId());
    }
}

/**
 * Override decorator
 *
 * class Car {
 *     drive() {}
 * }
 *
 * class FastCar {
 *     @Override
 *     drive() {}}
 * }
 */
function Override(container, key) {
    const basePrototype = Object.getPrototypeOf(container);
    if (typeof basePrototype[key] !== 'function') {
        throw new Error('Method "' + key + '" of class "' + container.constructor.name + '" doesn\'t override any method of base class.');
    }
}

class FilterTypesInitedAggregateEvent extends StructureAggregateEvent {
    constructor(structureId, filterTypes) {
        super(structureId, 'FilterTypesInitedAggregateEvent');
        this.filterTypes = filterTypes;
    }
    toDomainEvent() {
        return new FilterTypesInitedEvent(this.getAggregateId(), this.filterTypes);
    }
    getFilterTypes() {
        return this.filterTypes;
    }
}

class AllFiltersRemovedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'FilterAddedEvent');
    }
    toDomainEvent() {
        return new ActiveFiltersSetEvent(this.getAggregateId(), []);
    }
}

class FilterAddedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId, activeFilters) {
        super(aggregateId, 'FilterAddedEvent');
        this.activeFilters = activeFilters;
    }
    toDomainEvent() {
        return new ActiveFiltersSetEvent(this.getAggregateId(), this.activeFilters);
    }
}

class FilterRemovedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId, activeFilters) {
        super(aggregateId, 'FilterRemovedAggregateEvent');
        this.activeFilters = activeFilters;
    }
    toDomainEvent() {
        return new ActiveFiltersSetEvent(this.getAggregateId(), this.activeFilters);
    }
}

class UniqueFilterCalculatedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId, map) {
        super(aggregateId, 'UniqueFilterCalculatedAggregateEvent');
        this.map = map;
    }
    toDomainEvent() {
        return new UniqueFilterCalculatedEvent(this.getAggregateId(), this.map);
    }
}

class UniqueFilterSelectedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'UniqueFilterSelectedAggregateEvent');
    }
    toDomainEvent() {
        return new UniqueFilterSelectedEvent(this.getAggregateId());
    }
}

class UniqueFilterUnselectedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'UniqueFilterUnselectedAggregateEvent');
    }
    toDomainEvent() {
        return new UniqueFilterUnselectedEvent(this.getAggregateId());
    }
}

class AllUniqueFilterUnselectedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'AllUniqueFilterUnselectedAggregateEvent');
    }
    toDomainEvent() {
        return new AllUniqueFilterUnselectedEvent(this.getAggregateId());
    }
}

class AllUniqueFilterSelectedAggregateEvent extends StructureAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'AllUniqueFilterSelectedAggregateEvent');
    }
    toDomainEvent() {
        return new AllUniqueFilterSelectedEvent(this.getAggregateId());
    }
}

class SelectedRowChangedAggregateEvent extends StructureAggregateEvent {
    constructor(structureId, selectedRows, allSelected, allUnselected) {
        super(structureId, 'SelectedRowChangedAggregateEvent');
        this.selectedRows = selectedRows;
        this.allSelected = allSelected;
        this.allUnselected = allUnselected;
    }
    toDomainEvent() {
        return new SelectedRowChangedEvent(this.getAggregateId(), this.selectedRows, this.allSelected, this.allUnselected);
    }
}

class SelectionEnabledSetAggregateEvent extends StructureAggregateEvent {
    constructor(structureId, enabled) {
        super(structureId, 'SelectionEnabledSetAggregateEvent');
        this.enabled = enabled;
    }
    toDomainEvent() {
        return new SelectionEnabledSetEvent(this.getAggregateId(), this.enabled);
    }
}

class SelectionModeSetAggregateEvent extends StructureAggregateEvent {
    constructor(structureId, mode) {
        super(structureId, 'SelectionModeSetAggregateEvent');
        this.mode = mode;
    }
    toDomainEvent() {
        return new SelectionModeSetEvent(this.getAggregateId(), this.mode);
    }
}

class StructureAggregate extends AggregateRoot {
    constructor(structureId, pagingAggregate, sourceManager, verticalFormation, summariesManager, sorterCollection, filterManager, uniqueFilterManager, searchManager, fieldCollection) {
        super(structureId, structureKey);
        this.pagingManager = pagingAggregate;
        this.sourceManager = sourceManager;
        this.verticalFormation = verticalFormation;
        this.summariesManager = summariesManager;
        this.sorterCollection = sorterCollection;
        this.filterManager = filterManager;
        this.uniqueFilterManager = uniqueFilterManager;
        this.searchManager = searchManager;
        this.fieldCollection = fieldCollection;
    }
    createEvent() {
        return StructureCreatedAggregateEvent;
    }
    clearEvents() {
        super.clearEvents();
        this.pagingManager.clearEvents();
    }
    init() {
        this.initTheme();
    }
    setVerticalFormationEnabled(enabled) {
        this.verticalFormation.setEnabled(enabled);
        this.calculateSource();
    }
    getVerticalFormation() {
        return this.verticalFormation;
    }
    setSummariesEnabled(enabled) {
        this.summariesManager.setEnabled(enabled);
        this.calculateSource();
        return this.getEvents();
    }
    setOrigin(items) {
        this.addEvent(this.sourceManager.setOrigin(items, this.getId()));
        this.calculateUniqueValues();
        this.calculateSource();
        return this.getEvents();
    }
    deleteAllSelected() {
    }
    deleteItem(payload) {
        this.addEvent(this.sourceManager.deleteOriginItem(payload, this.getId()));
        this.generateSelectedRowChangedEvent();
        this.calculateSource();
    }
    editItem(editParams) {
        const itemId = editParams.getItemId(), fieldId = editParams.getColumnFieldId(), field = this.fieldCollection.getField(fieldId), // as FieldId
        value = editParams.getValue();
        const editItemEvents = this.sourceManager.editOriginItem(itemId, value, field, this.getId());
        editItemEvents.forEach((e) => this.addEvent(e));
        // TODO
        // this.calculateUniqueValues();
        this.calculateSource();
        return this.getEvents();
    }
    setHeight(height) {
        this.verticalFormation.setViewportHeight(height);
        this.calculateSourceBasedOnVirtualScroll();
    }
    setTheme(theme) {
        // #1707 Move to SchemeAggregate
        if (theme === SchemaTheme.MATERIAL) {
            this.getVerticalFormation().setRowHeight(52);
        }
        if (theme === SchemaTheme.GENERIC) {
            this.getVerticalFormation().setRowHeight(42);
        }
        if (theme === SchemaTheme.FABRIC) {
            this.getVerticalFormation().setRowHeight(36);
        }
        if (theme === SchemaTheme.LIGHT) {
            this.getVerticalFormation().setRowHeight(56);
        }
        if (theme === SchemaTheme.DARK) {
            this.getVerticalFormation().setRowHeight(38);
        }
    }
    setScrollPosition(position) {
        this.verticalFormation.setScrollPosition(position);
        this.calculateSourceBasedOnVirtualScroll();
    }
    scrollToIndex(index) {
        this.addEvent(this.verticalFormation.scrollToIndex(index));
    }
    setSelection(enabled) {
        this.sourceManager.getFormation().setSelection(enabled);
        this.addEvent(new SelectionEnabledSetAggregateEvent(this.getId(), enabled));
    }
    setSelectionMode(mode) {
        this.sourceManager.getFormation().setMode(mode);
        this.addEvent(new SelectionModeSetAggregateEvent(this.getId(), mode));
    }
    toggleRow(selectedRow, type) {
        this.sourceManager.toggleRow(selectedRow, type);
        this.generateSelectedRowChangedEvent();
    }
    selectAll() {
        this.sourceManager.selectAll();
        this.generateSelectedRowChangedEvent();
    }
    unselectAll() {
        this.sourceManager.unselectAll();
        this.generateSelectedRowChangedEvent();
    }
    getFormation() {
        return this.sourceManager.getFormation();
    }
    getPaging() {
        return this.pagingManager;
    }
    changePaging(config) {
        this.pagingManager.change(config);
        this.calculateSource();
    }
    setPaging(paging) {
        this.pagingManager = paging;
        this.calculateSource();
    }
    nextPage() {
        this.pagingManager.nextPage();
        this.calculateSource();
    }
    prevPage() {
        this.pagingManager.prevPage();
        this.calculateSource();
    }
    changePageSize(pageSize) {
        const pagingEvents = this.pagingManager.changePageSize(pageSize);
        // TODO
        pagingEvents.forEach((event) => {
            this.addEvent(event);
        });
        this.calculateSource();
        return this.getEvents();
    }
    getEntities() {
        return this.sourceManager.getSlicedEntities();
    }
    getSource() {
        return this.sourceManager;
    }
    createFields(fieldConfigs) {
        this.fieldCollection.initFields(fieldConfigs);
        const fields = this.fieldCollection.getAllFields();
        this.addEvent(new FieldsInitedAggregateEvent(this.getId(), fieldConfigs, fields));
        this.filterManager.assignFilterTypes(fields);
        this.addEvent(new FilterTypesInitedAggregateEvent(this.getId(), this.filterManager.getFilterTypes()));
        return this.getEvents();
    }
    setSortingConfig(config) {
        this.sorterCollection.setConfig(config);
    }
    toggleSort(fieldId) {
        const field = this.fieldCollection.getField(fieldId);
        this.sorterCollection.toggle(field);
        this.calculateSource();
        return this.sorterCollection.getAll();
    }
    setSortOrder(fieldId, sortOrder) {
        const field = this.fieldCollection.getField(fieldId);
        this.sorterCollection.setSortOrder(field, sortOrder);
        this.calculateSource();
        return this.sorterCollection.getAll();
    }
    setFilterConfig(config) {
        this.filterManager.getSettings().setFilterConfig(config);
    }
    setQuickFiltersConfig(config) {
        this.filterManager.getSettings().setQuickFiltersConfig(config);
    }
    toggleFilter(fieldId, externalFilterId, filterValue) {
        const field = this.fieldCollection.getField(fieldId);
        // Field not found
        // TODO throw aggregate event
        if (field === undefined) {
            return [];
        }
        // this.filterManager.addFilter(field, externalFilterId, filterValue);
        // this.filterManager.a
        this.calculateSource();
        return [];
    }
    addFilter(fieldId, filterTypeId, value) {
        this.filterManager.add(fieldId, filterTypeId, value);
        const fields = this.fieldCollection.getFieldsAsMap();
        const activeFilters = this.filterManager.getAllActiveFilters(fields);
        this.addEvent(new FilterAddedAggregateEvent(this.getId(), activeFilters));
        this.calculateSource();
    }
    removeAllFilters() {
        this.filterManager.removeAll();
        this.addEvent(new AllFiltersRemovedAggregateEvent(this.getId()));
        this.calculateSource();
    }
    removeFilter(filterId) {
        this.filterManager.remove(filterId);
        const fields = this.fieldCollection.getFieldsAsMap();
        const activeFilters = this.filterManager.getAllActiveFilters(fields);
        this.addEvent(new FilterRemovedAggregateEvent(this.getId(), activeFilters));
        this.calculateSource();
    }
    setSearchingConfig(config) {
        this.filterManager.getSettings().setSearchingConfig(config);
    }
    addSearchPhrase(phrase) {
        const fields = this.fieldCollection.getAllFields();
        this.searchManager.addSearchPhrase(fields, phrase);
        this.calculateSource();
        return [];
    }
    removeSearchPhrase() {
        this.searchManager.removeSearchFilters();
        this.calculateSource();
        return [];
    }
    selectAllUniqueFilter(fieldId) {
        this.uniqueFilterManager.selectAll(fieldId);
        this.addEvent(new AllUniqueFilterSelectedAggregateEvent(this.getId()));
        this.generateCalculateUniqueValuesAggregateEvent();
        this.calculateSource();
    }
    selectUniqueFilter(fieldId, uniqueValueId) {
        this.uniqueFilterManager.select(fieldId, uniqueValueId);
        this.addEvent(new UniqueFilterSelectedAggregateEvent(this.getId()));
        this.generateCalculateUniqueValuesAggregateEvent();
        this.calculateSource();
    }
    unselectAllUniqueFilter(fieldId) {
        this.uniqueFilterManager.unselectAll(fieldId);
        this.addEvent(new AllUniqueFilterUnselectedAggregateEvent(this.getId()));
        this.generateCalculateUniqueValuesAggregateEvent();
        this.calculateSource();
    }
    unselectUniqueFilter(fieldId, uniqueValueId) {
        this.uniqueFilterManager.unselect(fieldId, uniqueValueId);
        this.addEvent(new UniqueFilterUnselectedAggregateEvent(this.getId()));
        this.generateCalculateUniqueValuesAggregateEvent();
        this.calculateSource();
    }
    calculateSource() {
        if (!this.sourceManager.getOrigin() || !this.pagingManager) {
            return;
        }
        // TODO Refactor
        this.sourceManager.setEntities(this.sourceManager.getOrigin());
        // filtering
        this.sourceManager.setEntities(this.filterManager.filter(this.sourceManager.getEntities(), this.fieldCollection.getFieldsAsMap()));
        // search
        const searchedEntities = this.searchManager.search(this.sourceManager.getEntities());
        this.sourceManager.setEntities(searchedEntities);
        // unique filtering
        this.sourceManager.setEntities(this.uniqueFilterManager.filterAll(this.sourceManager.getEntities(), this.fieldCollection.getAllFields()));
        // sorting
        const ents = this.sorterCollection.sort(this.sourceManager.getEntities());
        this.sourceManager.setEntities(ents);
        // calculate filteredEntities
        this.sourceManager.setPreparedEntities();
        this.pagingManager.setSourceSize(this.sourceManager.getPreparedEntities().length);
        this.addEvent(new StructurePreparedEntitiesSetAggregateEvent(this.getId(), ents));
        // summaries
        const summariesEvents = this.summariesManager.calculate(this.fieldCollection.getAllFields(), this.sourceManager.getEntities());
        summariesEvents.forEach((ae) => {
            this.addEvent(ae);
        });
        // paging
        this.sourceManager.setEntities(this.pagingManager.sample(this.sourceManager.getEntities()));
        this.verticalFormation.setSourceSize(this.sourceManager.getEntities().length);
        this.calculateSourceBasedOnVirtualScroll();
    }
    calculateSourceBasedOnVirtualScroll() {
        if (this.verticalFormation.isEnabled()) {
            const range = this.verticalFormation.getRange();
            this.sourceManager.setSlicedEntities(this.sourceManager.getEntities().slice(range.getStart(), range.getEnd()));
        }
        else {
            this.sourceManager.setSlicedEntities(this.sourceManager.getEntities());
        }
    }
    initTheme() {
        // TODO
        const theme = SchemaAggregate.DEFAULT_THEME;
        this.setTheme(theme);
    }
    calculateUniqueValues() {
        const fields = this.fieldCollection.getAllFields(), items = this.sourceManager.getOrigin();
        this.uniqueFilterManager.calculateAll(items, fields);
        this.generateCalculateUniqueValuesAggregateEvent();
    }
    generateCalculateUniqueValuesAggregateEvent() {
        this.addEvent(new UniqueFilterCalculatedAggregateEvent(this.getId(), this.uniqueFilterManager.getAll(this.fieldCollection.getAllFields())));
    }
    generateSelectedRowChangedEvent() {
        this.addEvent(new SelectedRowChangedAggregateEvent(this.getId(), this.sourceManager.getFormation().getSelectedRows(), this.sourceManager.getFormation().isAllSelected(), this.sourceManager.getFormation().isAllUnselected()));
    }
}
__decorate([
    Override
], StructureAggregate.prototype, "clearEvents", null);

class StructureSorter {
    constructor(id, field, direction = true) {
        this.rank = 1;
        this.sorterId = id;
        this.field = field;
        this.direction = direction;
    }
    getId() {
        return this.sorterId;
    }
    getRank() {
        return this.rank;
    }
    getField() {
        return this.field;
    }
    hasDirection() {
        return this.direction;
    }
    changeDirection() {
        this.direction = !this.direction;
    }
    setDirection(direction) {
        this.direction = direction;
    }
    sort(entities) {
        if (entities.length === 0) {
            return entities;
        }
        return entities.sort((entityOne, entityTwo) => {
            return this.field.sort(entityOne, entityTwo, this.direction);
        });
    }
}

class SorterId {
    constructor(id) {
        this.sorterId = id;
    }
    getId() {
        return this.sorterId;
    }
}

class SorterCollection {
    constructor(enabled = false, multi = false) {
        this.sorters = new Map();
        this.enabled = enabled;
        this.multi = multi;
    }
    setConfig(config) {
        if (config && config.enabled !== undefined && config.enabled !== null) {
            this.enabled = config.enabled;
        }
        if (config && config.multiSorting !== undefined && config.multiSorting !== null) {
            this.multi = config.multiSorting;
            this.sorters.clear();
        }
    }
    toggle(field) {
        const fieldId = field.getId(), sorter = this.sorters.get(fieldId.getId());
        if (sorter) {
            if (sorter.hasDirection()) {
                sorter.changeDirection();
            }
            else {
                this.delete(fieldId);
            }
        }
        else {
            this.add(field);
        }
    }
    setSortOrder(field, sortOrder) {
        const fieldId = field.getId(), sorter = this.sorters.get(fieldId.getId());
        if (sortOrder === SortOrder.NONE) {
            this.delete(fieldId);
        }
        else if (sortOrder === SortOrder.ASC || sortOrder === SortOrder.DESC) {
            this.delete(fieldId);
            const direction = sortOrder === SortOrder.ASC;
            this.add(field, direction);
        }
    }
    add(field, direction = true) {
        this.addSorter(field.getId(), new StructureSorter(new SorterId(RandomStringGenerator.generate()), field, direction));
    }
    addSorter(fieldId, sorter) {
        if (!this.multi) {
            this.sorters.clear();
        }
        this.sorters.set(fieldId.getId(), sorter);
    }
    delete(fieldId) {
        this.sorters.delete(fieldId.getId());
    }
    update() {
    }
    // TODO Remove the loop from sorter.sort
    sort(entities) {
        const sorters = this.getAll();
        let sortedEntities = Array.from(entities);
        for (const sorter of sorters) {
            sortedEntities = sorter.sort(sortedEntities);
        }
        return sortedEntities;
    }
    getAll() {
        if (!this.enabled) {
            return [];
        }
        return Array.from(this.sorters)
            .map((arr) => arr[1])
            .sort((sorterOne, sorterTwo) => {
            return sorterOne.getRank() - sorterTwo.getRank();
        })
            .reverse();
    }
}

class UniqueValue {
    constructor(id, value, displayValue, enabled) {
        this.id = id;
        this.value = value;
        this.displayValue = displayValue;
        this.enabled = enabled;
    }
    getId() {
        return this.id;
    }
    getValue() {
        return this.value;
    }
    getDisplayValue() {
        return this.displayValue;
    }
    isEnabled() {
        return this.enabled;
    }
    isDisabled() {
        return !this.enabled;
    }
    select() {
        this.enabled = true;
    }
    unselect() {
        this.enabled = false;
    }
}

class UniqueValueId {
    constructor(uniqueValueId) {
        this.id = uniqueValueId;
    }
    toString() {
        return this.id;
    }
    equals(uniqueValueId) {
        return uniqueValueId.toString() === this.id;
    }
}

class UniqueValueIdGenerator {
    static generate() {
        UniqueValueIdGenerator.index += 1;
        return new UniqueValueId(`${UniqueValueIdGenerator.index}`);
    }
}
UniqueValueIdGenerator.index = 0;

class UniqueValueCollection {
    constructor(values, field) {
        this.values = [];
        for (const value of values) {
            this.values.push(new UniqueValue(UniqueValueIdGenerator.generate(), value, field.getDisplayValue(value), true));
        }
        this.calculateAllSelected();
        this.calculateAllDisabled();
    }
    getAll() {
        return this.values;
    }
    isAllSelected() {
        return this.allSelected;
    }
    isAllDisabled() {
        return this.allDisabled;
    }
    getNotSelected() {
        return this.values.filter((uv) => uv.isDisabled());
    }
    selectAll() {
        this.values.forEach((uv) => {
            uv.select();
        });
        this.allSelected = true;
        this.allDisabled = false;
    }
    select(uniqueValueId) {
        this.values
            .filter((uv) => uv.getId().equals(uniqueValueId))
            .forEach((uv) => {
            uv.select();
        });
        this.calculateAllSelected();
        this.calculateAllDisabled();
    }
    unselectAll() {
        this.values.forEach((uv) => {
            uv.unselect();
        });
        this.allSelected = false;
        this.allDisabled = true;
    }
    unselect(uniqueValueId) {
        this.values
            .filter((uv) => uv.getId().equals(uniqueValueId))
            .forEach((uv) => {
            uv.unselect();
        });
        this.calculateAllSelected();
        this.calculateAllDisabled();
    }
    calculateAllSelected() {
        this.allSelected = !this.values.some((f) => f.isDisabled());
    }
    calculateAllDisabled() {
        this.allDisabled = !this.values.some((f) => f.isEnabled());
    }
}

class UniqueFilterManager {
    constructor() {
        this.uniqueValueMap = new KeyMap();
    }
    calculate(entities, field) {
        const fieldId = field.getId();
        const optUVM = this.uniqueValueMap.get(fieldId);
        optUVM.ifEmpty(() => {
            const set = new Set();
            for (const entity of entities) {
                set.add(field.getValue(entity));
            }
            // sort
            const sortedValues = Array.from(set.values()).sort((a, b) => {
                return field.getField().sort(a, b);
            });
            const uvc = new UniqueValueCollection(sortedValues, field);
            this.uniqueValueMap.set(field.getId(), uvc);
        });
    }
    calculateAll(entities, fields) {
        for (const field of fields) {
            this.calculate(entities, field);
        }
    }
    filterAll(entities, fields) {
        let values = entities;
        for (const field of fields) {
            values = this.filter(values, field);
        }
        return values;
    }
    filter(entities, field) {
        let values = [];
        this.uniqueValueMap
            .get(field.getId())
            .ifPresent((uvc) => {
            if (uvc.isAllSelected()) {
                values = entities;
            }
            else if (uvc.isAllDisabled()) {
                values = [];
            }
            else {
                values = entities.filter((itemEntity) => {
                    for (const notSelectedValue of uvc.getNotSelected()) {
                        if (field.getField().equals(itemEntity, notSelectedValue.getValue())) {
                            return false;
                        }
                    }
                    return true;
                });
            }
        });
        return values;
    }
    selectAll(fieldId) {
        this.uniqueValueMap
            .get(fieldId)
            .ifPresent((uvc) => {
            uvc.selectAll();
        });
    }
    select(fieldId, uniqueValueId) {
        this.uniqueValueMap
            .get(fieldId)
            .ifPresent((uvc) => {
            uvc.select(uniqueValueId);
        });
    }
    unselectAll(fieldId) {
        this.uniqueValueMap
            .get(fieldId)
            .ifPresent((uvc) => {
            uvc.unselectAll();
        });
    }
    unselect(fieldId, uniqueValueId) {
        this.uniqueValueMap
            .get(fieldId)
            .ifPresent((uvc) => {
            uvc.unselect(uniqueValueId);
        });
    }
    getAll(fields) {
        const map = new Map();
        for (const field of fields) {
            this.getValues(field)
                .ifPresent((v) => {
                map.set(field.getId().toString(), v);
            });
        }
        return map;
    }
    getValues(field) {
        return this.uniqueValueMap
            .get(field.getId())
            .map((uvc) => {
            return uvc.getAll();
        });
    }
}

class VerticalRange {
    constructor(start, end, margin) {
        this.start = start;
        this.end = end;
        this.margin = margin;
    }
    getStart() {
        return this.start;
    }
    getEnd() {
        return this.end;
    }
    getMargin() {
        return this.margin;
    }
}

let VerticalFormationContainerHeight = class VerticalFormationContainerHeight {
    constructor() {
        this.containerHeight = Optional.empty();
    }
    isContainerHeightProperForVirtualScroll() {
        if (this.containerHeight.isPresent()) {
            return this.containerHeight.getValueOrNullOrThrowError() > 0;
        }
        else {
            return false;
        }
    }
    getVisibleContainerHeight() {
        return this.getHeight();
    }
    getHeight() {
        if (this.containerHeight.isPresent()) {
            return this.getContainerHeight();
        }
        return this.sourceHeight;
    }
    getSourceHeight() {
        return this.sourceHeight;
    }
    setContainerHeight(height) {
        if (height >= 0) {
            this.containerHeight = Optional.of(height);
        }
    }
    setSourceSize(height) {
        this.sourceHeight = height;
    }
    getContainerHeight() {
        if (this.containerHeight.getValueOrNullOrThrowError() > this.sourceHeight) {
            return this.sourceHeight;
        }
        else {
            return this.containerHeight.getValueOrNullOrThrowError();
        }
    }
};
VerticalFormationContainerHeight = __decorate([
    DomainObject
], VerticalFormationContainerHeight);

class ScrollBarPositionSetEvent extends StructureDomainEvent {
    constructor(aggregateId, position) {
        super(aggregateId, position, 'ScrollBarPositionSetEvent');
        this.position = position;
    }
    getPosition() {
        return this.position;
    }
}

class ScrollBarPositionSetAggregateEvent extends StructureAggregateEvent {
    constructor(schemaId, position) {
        super(schemaId, 'ScrollBarPositionSetAggregateEvent');
        this.position = position;
    }
    toDomainEvent() {
        return new ScrollBarPositionSetEvent(this.getAggregateId(), this.position);
    }
}

var VerticalFormation_1;
let VerticalFormation = VerticalFormation_1 = class VerticalFormation {
    constructor(structureId, enabled = false, viewportHeight = 0, sourceSize = 0, scrollPosition = 0, rowHeight, hiddenItemsTop, hiddenItemsBottom) {
        this.structureId = structureId;
        this.enabled = enabled;
        this.rowHeight = VerticalFormation_1.ROW_HEIGHT;
        this.hiddenItemsTop = VerticalFormation_1.HIDDEN_ITEMS_TOP;
        this.hiddenItemsBottom = VerticalFormation_1.HIDDEN_ITEMS_BOTTOM;
        this.container = new VerticalFormationContainerHeight();
        this.sourceSize = sourceSize;
        this.container.setSourceSize(this.sourceSize * this.rowHeight);
        this.container.setContainerHeight(viewportHeight);
        this.scrollPosition = scrollPosition;
        if (Number.isInteger(rowHeight)) {
            this.rowHeight = rowHeight;
        }
        if (Number.isInteger(hiddenItemsTop)) {
            this.hiddenItemsTop = hiddenItemsTop;
        }
        if (Number.isInteger(hiddenItemsBottom)) {
            this.hiddenItemsBottom = hiddenItemsBottom;
        }
        this.calculateRange();
    }
    isEnabled() {
        return this.enabled &&
            this.container.getHeight() > 0 &&
            this.sourceSize > 0;
    }
    getViewPortHeight() {
        return this.container.getVisibleContainerHeight();
    }
    getSourceHeight() {
        return this.container.getSourceHeight();
    }
    getRowHeight() {
        return this.rowHeight;
    }
    getRange() {
        return this.range;
    }
    getTopMargin() {
        return this.range.getStart() * this.rowHeight;
    }
    calculateRange() {
        if (this.calcFullHeight() <= this.container.getHeight()) {
            this.range = new VerticalRange(0, this.sourceSize, 0);
            return;
        }
        const itemsInViewport = Math.ceil(this.container.getHeight() / this.rowHeight), viewportPositionIndex = Math.floor(this.scrollPosition / this.rowHeight);
        let end = (viewportPositionIndex + itemsInViewport + this.hiddenItemsBottom);
        let topMargin = viewportPositionIndex;
        if (topMargin + itemsInViewport >= this.sourceSize) {
            topMargin = this.sourceSize - itemsInViewport;
        }
        let start = Math.max(viewportPositionIndex - this.hiddenItemsTop, 0);
        if (end > this.sourceSize) {
            end = this.sourceSize;
            start = end - itemsInViewport;
        }
        // end - itemsInViewport;
        this.range = new VerticalRange(start, end, topMargin);
        return {
            start,
            end,
            topMargin
        };
    }
    setEnabled(enabled) {
        this.enabled = enabled;
        // TODO dispatch aggregate event
        if (this.enabled && !this.container.isContainerHeightProperForVirtualScroll()) {
            this.logger.warn('Height needs to be specified in order for virtual scroll to work.');
        }
        this.calculateRange();
    }
    setSourceSize(sourceSize = 0) {
        this.sourceSize = sourceSize;
        this.container.setSourceSize(this.sourceSize * this.rowHeight);
        this.calculateRange();
    }
    setTopHiddenItemsCount(count) {
        this.hiddenItemsTop = count;
        this.calculateRange();
    }
    setBottomHiddenItemsCount(count) {
        this.hiddenItemsBottom = count;
        this.calculateRange();
    }
    setScrollPosition(scrollPosition) {
        this.scrollPosition = scrollPosition;
        this.calculateRange();
    }
    scrollToIndex(index) {
        if (index >= this.sourceSize) {
            index = this.sourceSize;
        }
        if (index < -1) {
            index = 0;
        }
        const position = index * this.rowHeight;
        return new ScrollBarPositionSetAggregateEvent(this.structureId, position);
    }
    setViewportHeight(height) {
        this.container.setContainerHeight(height);
        this.calculateRange();
    }
    setRowHeight(rowHeight) {
        this.rowHeight = rowHeight;
        this.container.setSourceSize(this.sourceSize * this.rowHeight);
        this.calculateRange();
    }
    setLogger(logger) {
        this.logger = logger;
    }
    // TODO REMOVE
    calcFullHeight() {
        return this.sourceSize * this.rowHeight;
    }
};
VerticalFormation.ROW_HEIGHT = 42;
VerticalFormation.HIDDEN_ITEMS_TOP = 5;
VerticalFormation.HIDDEN_ITEMS_BOTTOM = 2;
VerticalFormation = VerticalFormation_1 = __decorate([
    DomainObject
], VerticalFormation);

class VerticalFormationFactory {
    constructor(logger) {
        this.logger = logger;
    }
    create(structureId, enabled = false, viewportHeight = -1, sourceSize = 0, scrollPosition = 0, rowHeight, hiddenItemsTop, hiddenItemsBottom) {
        const vf = new VerticalFormation(structureId, enabled, viewportHeight, sourceSize, scrollPosition, rowHeight, hiddenItemsTop, hiddenItemsBottom);
        vf.setLogger(this.logger);
        return vf;
    }
}
VerticalFormationFactory.ɵfac = function VerticalFormationFactory_Factory(t) { return new (t || VerticalFormationFactory)(i0.ɵɵinject(Logger)); };
VerticalFormationFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: VerticalFormationFactory, factory: VerticalFormationFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationFactory, [{
        type: Injectable
    }], function () { return [{ type: Logger }]; }, null); })();

class StructureAggregateFactory extends AggregateFactory {
    constructor(pagingAggregateFactory, sourceManagerFactory, verticalFormationFactory, summariesManagerFactory, filterManagerFactory, searchManagerFactory, fieldCollectionFactory) {
        super();
        this.pagingAggregateFactory = pagingAggregateFactory;
        this.sourceManagerFactory = sourceManagerFactory;
        this.verticalFormationFactory = verticalFormationFactory;
        this.summariesManagerFactory = summariesManagerFactory;
        this.filterManagerFactory = filterManagerFactory;
        this.searchManagerFactory = searchManagerFactory;
        this.fieldCollectionFactory = fieldCollectionFactory;
    }
    create(structureId) {
        const paging = this.pagingAggregateFactory.createDefault(), source = this.sourceManagerFactory.createDefault(), verticalFormation = this.verticalFormationFactory.create(structureId);
        const sorterContainer = new SorterCollection(), filterContainer = this.filterManagerFactory.create(false), fieldContainer = this.fieldCollectionFactory.create(), summariesManager = this.summariesManagerFactory.create(structureId), searchManager = this.searchManagerFactory.create();
        const structureAggregate = new StructureAggregate(structureId, paging, source, verticalFormation, summariesManager, sorterContainer, filterContainer, new UniqueFilterManager(), searchManager, fieldContainer);
        this.init(structureAggregate);
        return structureAggregate;
    }
    init(structureAggregate) {
        structureAggregate.init();
    }
}
StructureAggregateFactory.ɵfac = function StructureAggregateFactory_Factory(t) { return new (t || StructureAggregateFactory)(i0.ɵɵinject(PagingManagerFactory), i0.ɵɵinject(SourceManagerFactory), i0.ɵɵinject(VerticalFormationFactory), i0.ɵɵinject(SummariesManagerFactory), i0.ɵɵinject(FilterManagerFactory), i0.ɵɵinject(SearchManagerFactory), i0.ɵɵinject(FieldCollectionFactory)); };
StructureAggregateFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureAggregateFactory, factory: StructureAggregateFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureAggregateFactory, [{
        type: Injectable
    }], function () { return [{ type: PagingManagerFactory }, { type: SourceManagerFactory }, { type: VerticalFormationFactory }, { type: SummariesManagerFactory }, { type: FilterManagerFactory }, { type: SearchManagerFactory }, { type: FieldCollectionFactory }]; }, null); })();

class StructureCreatedEventHandler {
    constructor(summariesEnabledArchive) {
        this.summariesEnabledArchive = summariesEnabledArchive;
    }
    forEvent() {
        return StructureCreatedEvent;
    }
    handle(event) {
        if (event.ofMessageType('StructureCreatedEvent')) {
            const structureId = event.getAggregateId();
            this.summariesEnabledArchive.init(structureId);
        }
    }
}
StructureCreatedEventHandler.ɵfac = function StructureCreatedEventHandler_Factory(t) { return new (t || StructureCreatedEventHandler)(i0.ɵɵinject(SummariesEnabledArchive)); };
StructureCreatedEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureCreatedEventHandler, factory: StructureCreatedEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCreatedEventHandler, [{
        type: Injectable
    }], function () { return [{ type: SummariesEnabledArchive }]; }, null); })();

class CreateStructureCommand extends StructureCommand {
    constructor(structureId) {
        super(structureId, 'CreateStructureCommand');
    }
}

class SetVerticalScrollEnabledCommand extends StructureCommand {
    constructor(structureId, enabled) {
        super(structureId, 'SetVerticalScrollEnabledCommand');
        this.enabled = enabled;
    }
    isEnabled() {
        return this.enabled;
    }
}

class SetScrollBarPositionCommand extends StructureCommand {
    constructor(structureId, position) {
        super(structureId, 'SetScrollBarPositionCommand');
        this.position = position;
    }
    getPosition() {
        return this.position;
    }
}

class SetScrollPositionCommand extends StructureCommand {
    constructor(structureId, position) {
        super(structureId, 'SetScrollPositionCommand');
        this.position = position;
    }
    getPosition() {
        return this.position;
    }
}

class SetRowHeightCommand extends StructureCommand {
    constructor(structureId, rowHeight) {
        super(structureId, 'SetRowHeightCommand');
        this.rowHeight = rowHeight;
    }
    getRowHeight() {
        return this.rowHeight;
    }
}

class StructureSetHeightCommand extends StructureCommand {
    constructor(structureId, height) {
        super(structureId, 'StructureSetHeightCommand');
        this.height = height;
    }
    getHeight() {
        return this.height;
    }
}

class SetRowHeightBasedOnThemeCommand extends StructureCommand {
    constructor(structureId, theme) {
        super(structureId, 'SetRowHeightBasedOnThemeCommand');
        this.theme = theme;
    }
    getTheme() {
        return this.theme;
    }
}

class StructureDomainCommandInvoker extends StructureCommandInvoker {
    constructor(commandDispatcher, structureFilterCommandService, sourceDispatcher, structureCellEditArchive) {
        super();
        this.commandDispatcher = commandDispatcher;
        this.structureFilterCommandService = structureFilterCommandService;
        this.sourceDispatcher = sourceDispatcher;
        this.structureCellEditArchive = structureCellEditArchive;
    }
    create(structureId) {
        this.commandDispatcher.dispatch(new CreateStructureCommand(structureId));
    }
    enableVirtualScroll(structureId) {
        this.commandDispatcher.dispatch(new SetVerticalScrollEnabledCommand(structureId, true));
    }
    disableVirtualScroll(structureId) {
        this.commandDispatcher.dispatch(new SetVerticalScrollEnabledCommand(structureId, false));
    }
    scrollToTop(structureId) {
        this.commandDispatcher.dispatch(new SetScrollBarPositionCommand(structureId, 0));
    }
    scrollToBottom(structureId) {
        this.commandDispatcher.dispatch(new SetScrollBarPositionCommand(structureId, Number.MAX_SAFE_INTEGER));
    }
    scrollToIndex(index, structureId) {
        this.commandDispatcher.dispatch(new SetScrollBarPositionCommand(structureId, index));
    }
    setScrollPosition(position, structureId) {
        this.commandDispatcher.dispatch(new SetScrollPositionCommand(structureId, position));
    }
    setOrigin(items, structureId) {
        this.sourceDispatcher.setOrigin(structureId, items);
    }
    setFilterConfig(config, structureId) {
        this.structureFilterCommandService.setFilteringEnabled(config, structureId);
    }
    setQuickFiltersConfig(config, structureId) {
        this.commandDispatcher.dispatch(new SetConfigQuickFilterCommand(structureId, config));
    }
    setRowHeight(rowHeight, structureId) {
        this.commandDispatcher.dispatch(new SetRowHeightCommand(structureId, +rowHeight));
    }
    setContainerHeight(height, structureId) {
        this.commandDispatcher.dispatch(new StructureSetHeightCommand(structureId, +height));
    }
    setRowHeightBasedOnTheme(theme, structureId) {
        this.commandDispatcher.dispatch(new SetRowHeightBasedOnThemeCommand(structureId, theme));
    }
    setCellEdit(cellEdit, structureId) {
        this.structureCellEditArchive.next(structureId, new CellEditorManager(cellEdit));
    }
}
StructureDomainCommandInvoker.ɵfac = function StructureDomainCommandInvoker_Factory(t) { return new (t || StructureDomainCommandInvoker)(i0.ɵɵinject(i1$1.CommandDispatcher), i0.ɵɵinject(FilterCommandInvoker), i0.ɵɵinject(SourceDispatcher), i0.ɵɵinject(StructureCellEditArchive)); };
StructureDomainCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureDomainCommandInvoker, factory: StructureDomainCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureDomainCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }, { type: FilterCommandInvoker }, { type: SourceDispatcher }, { type: StructureCellEditArchive }]; }, null); })();

const commandProviders = [
    inMemoryStructureCommandProviders
];
const readProviders = [
    inMemoryStructureReadProviders
];
const structureCommandHandlers = [];
const structureDomainEventHandlers = [
    HermesModule.registerDomainEventHandler(StructureCreatedEventHandler)
];
const structureProviders = [
    inMemoryStructureProviders,
    commandProviders,
    readProviders,
    StructureAggregateFactory,
    StructureReadModelRootConverter,
    StructureWarehouse,
    {
        provide: StructureCommandInvoker,
        useClass: StructureDomainCommandInvoker
    },
    StructureInitialValuesReadyArchive
];

class ConsoleLogger extends Logger {
    warn(text) {
        // eslint-disable-next-line no-console
        console.warn(text);
    }
    error(text) {
        // eslint-disable-next-line no-console
        console.error(text);
    }
}

class LoggerModule {
}
LoggerModule.ɵfac = function LoggerModule_Factory(t) { return new (t || LoggerModule)(); };
LoggerModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: LoggerModule });
LoggerModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [{
            provide: Logger,
            useClass: ConsoleLogger
        }] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(LoggerModule, [{
        type: NgModule,
        args: [{
                providers: [{
                        provide: Logger,
                        useClass: ConsoleLogger
                    }]
            }]
    }], null, null); })();

class ItemEntityFactory {
    create(source) {
        if (Array.isArray(source)) {
            return this.createEntities(source);
        }
        else {
            return this.createEntity(source);
        }
    }
    createEntities(source) {
        return source.map((source) => this.createEntity(source));
    }
    createEntity(originItem) {
        if (originItem instanceof OriginItemEntity) {
            return new ItemEntity(originItem.sourceItem, originItem.getPosition(), originItem.getId().toString(), originItem.getVersion());
        }
        else {
            return new ItemEntity(originItem, 0);
        }
    }
}
ItemEntityFactory.ɵfac = function ItemEntityFactory_Factory(t) { return new (t || ItemEntityFactory)(); };
ItemEntityFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ItemEntityFactory, factory: ItemEntityFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ItemEntityFactory, [{
        type: Injectable
    }], null, null); })();

class StructureTopPanelModule {
}
StructureTopPanelModule.ɵfac = function StructureTopPanelModule_Factory(t) { return new (t || StructureTopPanelModule)(); };
StructureTopPanelModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: StructureTopPanelModule });
StructureTopPanelModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            ReactiveFormsModule,
            FilterMenuFeatureModule,
            SearchFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureTopPanelModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    ReactiveFormsModule,
                    FilterMenuFeatureModule,
                    SearchFeatureModule
                ],
                declarations: [
                    StructureTopPanelComponent
                ],
                exports: [
                    StructureTopPanelComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(StructureTopPanelModule, { declarations: [StructureTopPanelComponent], imports: [CommonModule,
        ReactiveFormsModule,
        FilterMenuFeatureModule,
        SearchFeatureModule], exports: [StructureTopPanelComponent] }); })();

class UniqueValueListModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
UniqueValueListModule.ɵfac = /*@__PURE__*/ function () { let ɵUniqueValueListModule_BaseFactory; return function UniqueValueListModule_Factory(t) { return (ɵUniqueValueListModule_BaseFactory || (ɵUniqueValueListModule_BaseFactory = i0.ɵɵgetInheritedFactory(UniqueValueListModule)))(t || UniqueValueListModule); }; }();
UniqueValueListModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: UniqueValueListModule });
UniqueValueListModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            fabricImports,
            FilterApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(UniqueValueListModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    fabricImports,
                    FilterApiModule
                ],
                declarations: [
                    UniqueValueListComponent
                ],
                exports: [
                    UniqueValueListComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(UniqueValueListModule, { declarations: [UniqueValueListComponent], imports: [CommonModule, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, FilterApiModule], exports: [UniqueValueListComponent] }); })();

const declarations$2 = [
    StructureColumnConfigComponent,
    StructureColumnConfigTriggerComponent,
    StructureColumnConfigSortComponent,
    StructureColumnConfigColumnHideComponent,
    StructureColumnConfigColumnMoveComponent,
    StructureColumnMenuIconComponent,
    StructureColumnMenuArrowIconComponent
];
class StructureColumnMenuModule {
}
StructureColumnMenuModule.ɵfac = function StructureColumnMenuModule_Factory(t) { return new (t || StructureColumnMenuModule)(); };
StructureColumnMenuModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: StructureColumnMenuModule });
StructureColumnMenuModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            fabricImports,
            StructureColumnManagerModule,
            UniqueValueListModule,
            TranslationFeatureModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnMenuModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    fabricImports,
                    StructureColumnManagerModule,
                    UniqueValueListModule,
                    TranslationFeatureModule
                ],
                declarations: declarations$2,
                exports: declarations$2
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(StructureColumnMenuModule, { declarations: [StructureColumnConfigComponent,
        StructureColumnConfigTriggerComponent,
        StructureColumnConfigSortComponent,
        StructureColumnConfigColumnHideComponent,
        StructureColumnConfigColumnMoveComponent,
        StructureColumnMenuIconComponent,
        StructureColumnMenuArrowIconComponent], imports: [CommonModule, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, StructureColumnManagerModule,
        UniqueValueListModule,
        TranslationFeatureModule], exports: [StructureColumnConfigComponent,
        StructureColumnConfigTriggerComponent,
        StructureColumnConfigSortComponent,
        StructureColumnConfigColumnHideComponent,
        StructureColumnConfigColumnMoveComponent,
        StructureColumnMenuIconComponent,
        StructureColumnMenuArrowIconComponent] }); })();

class CreateStructureCommandHandler {
    constructor(structureAggregateRepository, domainEventPublisher) {
        this.structureAggregateRepository = structureAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return CreateStructureCommand;
    }
    getAggregateRepository() {
        return this.structureAggregateRepository;
    }
    publishDomainEvents(aggregate, command) {
        this.domainEventPublisher.publish(new StructureCreatedEvent(command.getAggregateId()));
    }
}
CreateStructureCommandHandler.ɵfac = function CreateStructureCommandHandler_Factory(t) { return new (t || CreateStructureCommandHandler)(i0.ɵɵinject(StructureAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
CreateStructureCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CreateStructureCommandHandler, factory: CreateStructureCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CreateStructureCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: StructureAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

const _c0$9 = ["cellContainer"];
const _c1$2 = ["gui-structure-cell-edit", "", "entity", "", "cell", ""];
function StructureCellEditComponent_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainer(0);
} }
class StructureCellEditComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, structureId, sourceCommandService) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.structureId = structureId;
        this.sourceCommandService = sourceCommandService;
    }
    ngOnChanges(changes) {
        if (changes.entity !== null && changes.entity !== undefined) {
            this.initEditContext();
        }
        if (changes.cell !== null && changes.cell !== undefined) {
            this.initEditContext();
        }
    }
    ngOnInit() {
        this.initEditContext();
    }
    submitChangesAndExit() {
        const itemId = this.entity.getId(), updatedValue = this.actualValue, fieldId = this.cell.columnFieldId;
        this.sourceCommandService.editItem(new StructureEditSourceItemParams(itemId, fieldId, updatedValue), this.structureId);
    }
    initEditContext() {
        this.valueChanges$ = new ChangedValueEmitter();
        this.status$ = new ChangedValueEmitter();
        this.editContext = {
            status: this.status$,
            valueChanges: this.valueChanges$,
            value: this.cell.getValue(this.entity),
            focus: false,
            parent: this.cellContainerRef
        };
        this.status$
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((status) => {
            switch (status) {
                case EditEventType.SUBMIT:
                    this.submitChangesAndExit();
                    this.publishEditSubmit();
                    break;
                case EditEventType.CANCEL:
                    // this.exitEditMode();
                    this.publishEditCancel();
                    break;
                default:
                    break;
            }
        });
    }
    observeValueChanges() {
        this.valueChanges$
            .on()
            .pipe(this.hermesTakeUntil())
            .subscribe((value) => {
            this.actualValue = value;
        });
    }
    publishEditState(state) {
        // this.structureCellEditStore.next(state);
    }
    publishEditEnter() {
        this.publishEditState(StructureCellEditState.ENTER);
    }
    publishEditCancel() {
        this.publishEditState(StructureCellEditState.CANCEL);
    }
    publishEditSubmit() {
        this.publishEditState(StructureCellEditState.SUBMIT);
    }
    getSelectorName() {
        return 'gui-structure-cell-edit';
    }
}
StructureCellEditComponent.ɵfac = function StructureCellEditComponent_Factory(t) { return new (t || StructureCellEditComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SourceCommandInvoker)); };
StructureCellEditComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StructureCellEditComponent, selectors: [["div", "gui-structure-cell-edit", "", "entity", "", "cell", ""]], viewQuery: function StructureCellEditComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$9, 7);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.cellContainerRef = _t.first);
    } }, inputs: { entity: "entity", cell: "cell" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c1$2, decls: 3, vars: 2, consts: [["cellContainer", ""], [4, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function StructureCellEditComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "span", null, 0);
        i0.ɵɵtemplate(2, StructureCellEditComponent_ng_container_2_Template, 1, 0, "ng-container", 1);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(2);
        i0.ɵɵproperty("ngTemplateOutlet", ctx.cell.editTemplate)("ngTemplateOutletContext", ctx.editContext);
    } }, directives: [i4.NgTemplateOutlet], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureCellEditComponent, [{
        type: Component,
        args: [{
                selector: 'div[gui-structure-cell-edit][entity][cell]',
                template: `

		<span #cellContainer>
			<ng-container
				*ngTemplateOutlet="cell.editTemplate;
									context: editContext">
			</ng-container>
		</span>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: StructureId }, { type: SourceCommandInvoker }]; }, { cellContainerRef: [{
            type: ViewChild,
            args: ['cellContainer', { static: true }]
        }], entity: [{
            type: Input
        }], cell: [{
            type: Input
        }] }); })();

class SetScrollPositionCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetScrollPositionCommand;
    }
    handle(structure, command) {
        const position = command.getPosition();
        structure.setScrollPosition(position);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new ScrollPositionSetEvent(command.getAggregateId()));
    }
}
SetScrollPositionCommandHandler.ɵfac = function SetScrollPositionCommandHandler_Factory(t) { return new (t || SetScrollPositionCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetScrollPositionCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetScrollPositionCommandHandler, factory: SetScrollPositionCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetScrollPositionCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetVerticalScrollEnabledCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetVerticalScrollEnabledCommand;
    }
    handle(structure, command) {
        const enabled = command.isEnabled();
        structure.setVerticalFormationEnabled(enabled);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new VerticalScrollEnabledSetEvent(command.getAggregateId()));
    }
}
SetVerticalScrollEnabledCommandHandler.ɵfac = function SetVerticalScrollEnabledCommandHandler_Factory(t) { return new (t || SetVerticalScrollEnabledCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetVerticalScrollEnabledCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetVerticalScrollEnabledCommandHandler, factory: SetVerticalScrollEnabledCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetVerticalScrollEnabledCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetRowHeightBasedOnThemeCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetRowHeightBasedOnThemeCommand;
    }
    handle(structure, command) {
        const theme = command.getTheme();
        structure.setTheme(theme);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new RowHeightSetBasedOnThemeEvent(command.getAggregateId()));
    }
}
SetRowHeightBasedOnThemeCommandHandler.ɵfac = function SetRowHeightBasedOnThemeCommandHandler_Factory(t) { return new (t || SetRowHeightBasedOnThemeCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetRowHeightBasedOnThemeCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetRowHeightBasedOnThemeCommandHandler, factory: SetRowHeightBasedOnThemeCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetRowHeightBasedOnThemeCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetRowHeightCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetRowHeightCommand;
    }
    handle(structure, command) {
        const rowHeight = command.getRowHeight();
        const formation = structure.getVerticalFormation();
        formation.setRowHeight(rowHeight);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new RowHeightSetEvent(command.getAggregateId()));
    }
}
SetRowHeightCommandHandler.ɵfac = function SetRowHeightCommandHandler_Factory(t) { return new (t || SetRowHeightCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetRowHeightCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetRowHeightCommandHandler, factory: SetRowHeightCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetRowHeightCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class StructureSetHeightCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return StructureSetHeightCommand;
    }
    handle(aggregate, command) {
        const height = command.getHeight();
        aggregate.setHeight(height);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new StructureHeightSetEvent(command.getAggregateId()));
    }
}
StructureSetHeightCommandHandler.ɵfac = function StructureSetHeightCommandHandler_Factory(t) { return new (t || StructureSetHeightCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
StructureSetHeightCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: StructureSetHeightCommandHandler, factory: StructureSetHeightCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSetHeightCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class VerticalFormationScrollBarPositionArchive extends AggregateArchive {
    constructor() {
        super(VerticalFormationScrollBarPositionArchive.DEFAULT_POSITION);
    }
}
VerticalFormationScrollBarPositionArchive.DEFAULT_POSITION = 0;
VerticalFormationScrollBarPositionArchive.ɵfac = function VerticalFormationScrollBarPositionArchive_Factory(t) { return new (t || VerticalFormationScrollBarPositionArchive)(); };
VerticalFormationScrollBarPositionArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: VerticalFormationScrollBarPositionArchive, factory: VerticalFormationScrollBarPositionArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationScrollBarPositionArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class ScrollBarPositionSetEventHandler {
    constructor(positionRepository) {
        this.positionRepository = positionRepository;
    }
    forEvent() {
        return ScrollBarPositionSetEvent;
    }
    handle(event) {
        if (event.ofMessageType('ScrollBarPositionSetEvent')) {
            this.positionRepository.next(event.getAggregateId(), event.getPosition());
        }
    }
}
ScrollBarPositionSetEventHandler.ɵfac = function ScrollBarPositionSetEventHandler_Factory(t) { return new (t || ScrollBarPositionSetEventHandler)(i0.ɵɵinject(VerticalFormationScrollBarPositionArchive)); };
ScrollBarPositionSetEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ScrollBarPositionSetEventHandler, factory: ScrollBarPositionSetEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ScrollBarPositionSetEventHandler, [{
        type: Injectable
    }], function () { return [{ type: VerticalFormationScrollBarPositionArchive }]; }, null); })();

class SetScrollBarPositionCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetScrollBarPositionCommand;
    }
    handle(structure, command) {
        const index = command.getPosition();
        structure.scrollToIndex(index);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publishFromAggregate(aggregate);
    }
}
SetScrollBarPositionCommandHandler.ɵfac = function SetScrollBarPositionCommandHandler_Factory(t) { return new (t || SetScrollBarPositionCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetScrollBarPositionCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetScrollBarPositionCommandHandler, factory: SetScrollBarPositionCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetScrollBarPositionCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class VerticalFormationDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SetScrollPositionCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetVerticalScrollEnabledCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetRowHeightBasedOnThemeCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetRowHeightCommandHandler, structureKey),
            HermesModule.registerCommandHandler(StructureSetHeightCommandHandler, structureKey),
            HermesModule.registerCommandHandler(SetScrollBarPositionCommandHandler, structureKey)
        ];
    }
    static domainEventHandlers() {
        return [
            HermesModule.registerDomainEventHandler(ScrollBarPositionSetEventHandler)
        ];
    }
}
VerticalFormationDomainModule.ɵfac = function VerticalFormationDomainModule_Factory(t) { return new (t || VerticalFormationDomainModule)(); };
VerticalFormationDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: VerticalFormationDomainModule });
VerticalFormationDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        VerticalFormationFactory
    ], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [
                    VerticalFormationFactory
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(VerticalFormationDomainModule, { imports: [CommonModule] }); })();

class VerticalFormationDomainWarehouse extends VerticalFormationWarehouse {
    constructor(verticalFormationRepository, positionRepository) {
        super();
        this.verticalFormationRepository = verticalFormationRepository;
        this.positionRepository = positionRepository;
    }
    onVerticalScrollEnabled(structureId) {
        return this.verticalFormationRepository.onVerticalScrollEnabled(structureId);
    }
    onRowHeight(structureId) {
        return this.verticalFormationRepository.onRowHeight(structureId);
    }
    onContainerHeight(structureId) {
        return this.verticalFormationRepository.onContainerHeight(structureId);
    }
    onTopMargin(structureId) {
        return this.verticalFormationRepository.onTopMargin(structureId);
    }
    onScrollBarPosition(structureId) {
        return this.positionRepository.on(structureId);
    }
}
VerticalFormationDomainWarehouse.ɵfac = function VerticalFormationDomainWarehouse_Factory(t) { return new (t || VerticalFormationDomainWarehouse)(i0.ɵɵinject(VerticalFormationRepository), i0.ɵɵinject(VerticalFormationScrollBarPositionArchive)); };
VerticalFormationDomainWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: VerticalFormationDomainWarehouse, factory: VerticalFormationDomainWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationDomainWarehouse, [{
        type: Injectable
    }], function () { return [{ type: VerticalFormationRepository }, { type: VerticalFormationScrollBarPositionArchive }]; }, null); })();

class VerticalFormationApiModule extends ApiModule {
}
VerticalFormationApiModule.ɵfac = /*@__PURE__*/ function () { let ɵVerticalFormationApiModule_BaseFactory; return function VerticalFormationApiModule_Factory(t) { return (ɵVerticalFormationApiModule_BaseFactory || (ɵVerticalFormationApiModule_BaseFactory = i0.ɵɵgetInheritedFactory(VerticalFormationApiModule)))(t || VerticalFormationApiModule); }; }();
VerticalFormationApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: VerticalFormationApiModule });
VerticalFormationApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        VerticalFormationConverter,
        VerticalFormationRepository,
        {
            provide: VerticalFormationWarehouse,
            useClass: VerticalFormationDomainWarehouse
        },
        VerticalFormationScrollBarPositionArchive
    ], imports: [[
            CommonModule,
            VerticalFormationDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    VerticalFormationDomainModule
                ],
                providers: [
                    VerticalFormationConverter,
                    VerticalFormationRepository,
                    {
                        provide: VerticalFormationWarehouse,
                        useClass: VerticalFormationDomainWarehouse
                    },
                    VerticalFormationScrollBarPositionArchive
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(VerticalFormationApiModule, { imports: [CommonModule,
        VerticalFormationDomainModule] }); })();

class VerticalFormationFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
VerticalFormationFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵVerticalFormationFeatureModule_BaseFactory; return function VerticalFormationFeatureModule_Factory(t) { return (ɵVerticalFormationFeatureModule_BaseFactory || (ɵVerticalFormationFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(VerticalFormationFeatureModule)))(t || VerticalFormationFeatureModule); }; }();
VerticalFormationFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: VerticalFormationFeatureModule });
VerticalFormationFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            VerticalFormationApiModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    VerticalFormationApiModule
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(VerticalFormationFeatureModule, { imports: [CommonModule,
        VerticalFormationApiModule] }); })();

const compositionKey = 'CompositionAggregate';

class CompositionContainerWidthCalculator {
    constructor(MIN_COLUMN_WIDTH) {
        this.MIN_COLUMN_WIDTH = MIN_COLUMN_WIDTH;
    }
    calculateMinWidth(columnWidths) {
        const { staticColumns, fluidColumns } = this.segregateColumns(columnWidths);
        // TODO reduce
        let sum = 0;
        staticColumns.forEach((c) => {
            sum += c.getWidth();
        });
        sum += fluidColumns.length * this.MIN_COLUMN_WIDTH;
        return sum;
    }
    segregateColumns(columns) {
        const staticColumns = columns.filter((columnWidth) => columnWidth.isTypeNumber() && columnWidth.getWidth() > this.MIN_COLUMN_WIDTH), fluidColumns = columns.filter((columnWidth) => {
            return columnWidth.isTypeAuto() ||
                columnWidth.isTypePercentage() ||
                (columnWidth.isTypeNumber() && columnWidth.getWidth() <= this.MIN_COLUMN_WIDTH);
        });
        return {
            staticColumns: staticColumns,
            fluidColumns: fluidColumns
        };
    }
}

class CompositionDomainEvent extends DomainEvent {
}

class CompositionWidthSetEvent extends CompositionDomainEvent {
    constructor(compositionId) {
        super(compositionId, null, 'CompositionWidthSetEvent');
    }
}

class CompositionAggregateEvent extends AggregateEvent {
}

class CompositionWidthSetAggregateEvent extends CompositionAggregateEvent {
    constructor(aggregateId) {
        super(aggregateId, 'CompositionWidthSetAggregateEvent');
    }
    toDomainEvent() {
        return new CompositionWidthSetEvent(this.getAggregateId());
    }
}

class CompositionContainerWidthSetEvent extends CompositionDomainEvent {
    constructor(compositionId, payload) {
        super(compositionId, payload, 'CompositionContainerWidthSetEvent');
    }
}

class CompositionContainerWidthSetAggregateEvent extends CompositionAggregateEvent {
    constructor(compositionId, containerWidth) {
        super(compositionId, 'CompositionContainerWidthSetAggregateEvent');
        this.containerWidth = containerWidth;
    }
    toDomainEvent() {
        return new CompositionContainerWidthSetEvent(this.getAggregateId(), this.containerWidth);
    }
}

class CompositionResizeWidthSetEvent extends CompositionDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'CompositionResizeWidthSetEvent');
    }
}

class CompositionResizeWidthSetAggregateEvent extends CompositionAggregateEvent {
    constructor(compositionId) {
        super(compositionId, 'CompositionResizeWidthSetAggregateEvent');
    }
    toDomainEvent() {
        return new CompositionResizeWidthSetEvent(this.getAggregateId());
    }
}

class CompositionColumnSetEnabledEvent extends CompositionDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'CompositionColumnSetEnabledEvent');
    }
}

class CompositionColumnSetEnabledAggregateEvent extends CompositionAggregateEvent {
    constructor(aggregateId, activeColumns) {
        super(aggregateId, 'CompositionColumnSetEnabledAggregateEvent');
        this.activeColumns = activeColumns;
    }
    toDomainEvent() {
        return new CompositionColumnSetEnabledEvent(this.getAggregateId());
    }
    getActiveColumns() {
        return this.activeColumns;
    }
}

var ColumnWidthType;
(function (ColumnWidthType) {
    ColumnWidthType[ColumnWidthType["PERCENTAGE"] = 0] = "PERCENTAGE";
    ColumnWidthType[ColumnWidthType["NUMBER"] = 1] = "NUMBER";
    ColumnWidthType[ColumnWidthType["AUTO"] = 2] = "AUTO";
})(ColumnWidthType || (ColumnWidthType = {}));

class ColumnWidth {
    constructor(width) {
        this.baseWidth = width;
        this.setWidthAndType(width);
    }
    getWidth() {
        return this.width;
    }
    getColumnType() {
        return this.template;
    }
    isTypePercentage() {
        return this.template === ColumnWidthType.PERCENTAGE;
    }
    isTypeAuto() {
        return this.template === ColumnWidthType.AUTO;
    }
    isTypeNumber() {
        return this.template === ColumnWidthType.NUMBER;
    }
    setWidth(width) {
        this.width = width;
    }
    setWidthAndType(width) {
        if (width === undefined || width === null || width === 'auto') {
            this.template = ColumnWidthType.AUTO;
            this.setWidth(null);
        }
        else if (this.isPercentage(width)) {
            this.template = ColumnWidthType.PERCENTAGE;
            this.setWidth(this.percentageToNumber('' + width));
        }
        else if (this.isStringNumber(width)) {
            this.template = ColumnWidthType.NUMBER;
            this.setWidth(+width);
        }
        else {
            this.template = ColumnWidthType.NUMBER;
            this.setWidth(+width);
        }
    }
    clone() {
        return new ColumnWidth(this.baseWidth);
    }
    isPercentage(width) {
        return typeof width === 'string' && width[width.length - 1] === '%';
    }
    /**
     * Width needs to be in format '89%'
     * @param width
     */
    percentageToNumber(width) {
        return +(width.slice(0, -1));
    }
    isStringNumber(width) {
        const widthAsNumber = +width;
        return Number.isNaN(widthAsNumber);
    }
}

class CompositionWidthCalculator {
    constructor(source, width, MIN_COLUMN_WIDTH) {
        this.source = source;
        this.width = width;
        this.MIN_COLUMN_WIDTH = MIN_COLUMN_WIDTH;
        this.columns = this.source.map((c) => c.clone());
    }
    calculate() {
        let width = this.width, columns = Array.from(this.columns);
        // adjust min value
        this.adjustMinimalWidth(columns);
        // remove number columns
        const newColumns = [];
        columns.forEach((column, index) => {
            if (column.isTypeNumber()) {
                width -= column.getWidth();
            }
            else {
                newColumns.push(column);
            }
        });
        columns = newColumns;
        // split even auto columns
        if (columns.length !== 0) {
            const evenWidth = width / columns.length;
            columns.forEach((column, index) => {
                column.setWidth(evenWidth);
            });
        }
        // adjust number columns
        // let numberColumns = this.columns.filter((columnWidth: ColumnWidth) => columnWidth.isTypeNumber());
        //
        // // sort by min values
        // numberColumns.sort((columnOne: ColumnWidth, columnTwo: ColumnWidth) => {
        // 	return columnOne.getWidth() - columnTwo.getWidth();
        // });
        //
        // numberColumns.forEach(() => {
        // });
        // this.adjustMinimalWidth(ColumnWidthType.NUMBER);
        //
        // this.adjustPercentageWidth();
        //
        // this.adjustAutoWidth();
        return this.columns;
    }
    adjustMinimalWidth(columns) {
        columns.forEach((column) => {
            if (column.isTypeNumber()) {
                if (column.getWidth() < this.MIN_COLUMN_WIDTH) {
                    column.setWidthAndType(this.MIN_COLUMN_WIDTH);
                }
            }
        });
    }
    adjustPercentageWidth() {
        const percentageColumns = this.columns.filter((columnWidth) => columnWidth.isTypePercentage());
        for (const column of this.columns) {
            if (column.getColumnType() === ColumnWidthType.PERCENTAGE) {
                column.setWidth(this.width * column.getWidth() * 0.01);
            }
        }
    }
    adjustAutoWidth() {
        let leftWidth = this.width;
        const autoColumns = [];
        for (let i = 0; i < this.columns.length; i += 1) {
            const column = this.columns[i];
            if (column.getColumnType() !== ColumnWidthType.AUTO) {
                leftWidth -= column.getWidth();
            }
            else {
                autoColumns.push(column);
            }
        }
        if (autoColumns.length > 0) {
            const splitWidth = leftWidth / autoColumns.length;
            for (const column of autoColumns) {
                column.setWidth(splitWidth);
            }
        }
    }
}

class ColumnWidthCollection {
    constructor(MIN_COLUMN_WIDTH, columns = [], width = 100) {
        this.MIN_COLUMN_WIDTH = MIN_COLUMN_WIDTH;
        this.baseColumnWidths = columns.map((column) => new ColumnWidth(column.width));
        this.columnWidths = columns.map((column) => new ColumnWidth(column.width));
        this.setContainerWidth(width);
        this.calculate();
    }
    getColumnWidths() {
        return this.baseColumnWidths;
    }
    getColumnsWidth() {
        return this.width;
    }
    getWidths() {
        return this.columnWidths.map(c => c.getWidth());
    }
    getMinWidth() {
        const calculator = new CompositionContainerWidthCalculator(this.MIN_COLUMN_WIDTH);
        return calculator.calculateMinWidth(this.columnWidths);
    }
    setWidth(width) {
        this.setContainerWidth(width);
        this.calculate();
    }
    setColumns(columnConfigs) {
        this.baseColumnWidths = columnConfigs.map((column) => new ColumnWidth(column.width));
        this.columnWidths = columnConfigs.map((column) => new ColumnWidth(column.width));
        this.calculate();
    }
    getMinColumnWidth() {
        return this.MIN_COLUMN_WIDTH;
    }
    calculate() {
        if (this.baseColumnWidths && this.width) {
            const calculator = new CompositionWidthCalculator(this.baseColumnWidths, this.width, this.MIN_COLUMN_WIDTH);
            this.columnWidths = calculator.calculate();
        }
    }
    setContainerWidth(width) {
        if (this.getMinWidth() > width) {
            this.width = this.getMinWidth();
        }
        else {
            this.width = width;
        }
        this.calculate();
    }
}

class CompositionChangeSortStatusEvent extends CompositionDomainEvent {
    constructor(aggregateId, activeColumns) {
        super(aggregateId, activeColumns, 'CompositionChangeSortStatusEvent');
        this.activeColumns = activeColumns;
    }
    getCompositionId() {
        return this.getAggregateId();
    }
    getActiveColumns() {
        return this.activeColumns;
    }
}

class CompositionChangeSortStatusAggregateEvent extends CompositionAggregateEvent {
    constructor(aggregateId, activeColumns) {
        super(aggregateId, 'CompositionChangeSortStatusAggregateEvent');
        this.activeColumns = activeColumns;
    }
    toDomainEvent() {
        return new CompositionChangeSortStatusEvent(this.getAggregateId(), this.activeColumns);
    }
}

class ActiveColumnContainer {
    constructor(compositionId, columns = [], gridWidth, columnConfigs) {
        this.compositionId = compositionId;
        this.MIN_COLUMN_WIDTH = 50;
        /**
         * Columns taken from user config.
         * This should not be modified and it should be used as a reference point.
         */
        this.columnWidthCollection = new ColumnWidthCollection(this.MIN_COLUMN_WIDTH);
        this.columns = columns;
        if (gridWidth && columnConfigs) {
            this.columnWidthCollection = new ColumnWidthCollection(this.MIN_COLUMN_WIDTH, columnConfigs, gridWidth);
        }
    }
    getColumnWidths() {
        return this.columnWidthCollection.getColumnWidths();
    }
    // REMOVE
    getColumns() {
        return this.columns;
    }
    setWidth(width) {
        this.columnWidthCollection.setWidth(width);
    }
    addColumn(column, index) {
        this.columns.splice(index, 0, column);
    }
    removeColumn(index) {
        this.columns.splice(index, 1);
    }
    setColumns(columns, columnConfigs) {
        this.columns = columns;
        this.columnWidthCollection.setColumns(columnConfigs);
        const updatedWidths = this.columnWidthCollection.getWidths();
        this.columns.forEach((column, index) => {
            column.setWidth(updatedWidths[index]);
        });
        // TODO
        // this.addEvent(new ColumnsSetAggregateEvent(this.getId(), columns));
    }
    changeSort(sortParams) {
        this.columns.forEach((column) => {
            column.setSortStatus(SortOrder.NONE);
        });
        for (const param of sortParams) {
            const fieldId = param.fieldId, direction = param.direction, sortStatus = direction ? SortOrder.ASC : SortOrder.DESC;
            const columns = this.columns.filter((column) => {
                return column.getField().getId().getId() === fieldId.getId();
            });
            if (columns.length > 0) {
                columns.forEach((column) => {
                    column.setSortStatus(sortStatus);
                });
            }
        }
        return new CompositionChangeSortStatusAggregateEvent(this.getCompositionId(), this.columns);
    }
    moveLeft(columnId) {
        const index = this.findColumnIndex(columnId);
        this.move(index, index - 1);
    }
    moveRight(columnId) {
        const index = this.findColumnIndex(columnId);
        this.move(index, index + 1);
    }
    getMinColumnWidth() {
        return this.MIN_COLUMN_WIDTH;
    }
    move(fromIndex, toIndex) {
        if (!this.validateMoveIndex(fromIndex) || !this.validateMoveIndex(toIndex)) {
            return;
        }
        const column = this.columns[fromIndex];
        this.columns[fromIndex] = this.columns[toIndex];
        this.columns[toIndex] = column;
    }
    validateMoveIndex(index) {
        return index >= 0;
    }
    getCompositionId() {
        return this.compositionId;
    }
    findColumnIndex(columnId) {
        return this.columns.findIndex(c => c.getId().equals(columnId));
    }
}

var CellView;
(function (CellView) {
    CellView[CellView["TEXT"] = 0] = "TEXT";
    CellView[CellView["NUMBER"] = 1] = "NUMBER";
    CellView[CellView["CHIP"] = 2] = "CHIP";
    CellView[CellView["LINK"] = 3] = "LINK";
    CellView[CellView["IMAGE"] = 4] = "IMAGE";
    CellView[CellView["BOLD"] = 5] = "BOLD";
    CellView[CellView["ITALIC"] = 6] = "ITALIC";
    CellView[CellView["CHECKBOX"] = 7] = "CHECKBOX";
    CellView[CellView["CUSTOM"] = 8] = "CUSTOM";
    CellView[CellView["FUNCTION"] = 9] = "FUNCTION";
    CellView[CellView["DATE"] = 10] = "DATE";
    CellView[CellView["BAR"] = 11] = "BAR";
    CellView[CellView["PERCENTAGE_BAR"] = 12] = "PERCENTAGE_BAR";
    CellView[CellView["PERCENTAGE"] = 13] = "PERCENTAGE";
    CellView[CellView["NG_TEMPLATE"] = 14] = "NG_TEMPLATE";
})(CellView || (CellView = {}));

class ViewEntity {
    constructor(cellView) {
        this.templateFunction = (cellValue, item) => cellValue;
        if (typeof cellView === 'function') {
            this.view = CellView.FUNCTION;
            this.templateFunction = cellView;
        }
        else {
            this.view = cellView;
        }
    }
    static fromDataType(dataType) {
        if (dataType === DataType.DATE) {
            return new ViewEntity(CellView.DATE);
        }
        else {
            return new ViewEntity(CellView.TEXT);
        }
    }
    getCellView() {
        return this.view;
    }
    getTemplateFunction() {
        return this.templateFunction;
    }
}

class AbstractColumnEntity extends Entity {
    constructor(columnId, columnField, columnConfig, presentation, header, align, view, width) {
        super(columnId);
        this.columnField = columnField;
        this.columnConfig = columnConfig;
        this.presentation = presentation;
        this.view = ViewEntity.fromDataType(columnField.getDataType());
        if (header) {
            this.header = header;
        }
        if (view) {
            this.view = view;
        }
        if (width) {
            this.width = width;
        }
        this.setInitialAlign(columnField, align);
    }
    getPresentation() {
        return this.presentation;
    }
    getColumnConfig() {
        return this.columnConfig;
    }
    getField() {
        return this.columnField;
    }
    getHeader() {
        return this.header;
    }
    getDataType() {
        return this.columnField.getDataType();
    }
    getCellView() {
        return this.view.getCellView();
    }
    getTemplateFunction() {
        return this.view.getTemplateFunction();
    }
    getFormatterFunction() {
        return this.columnConfig.formatter;
    }
    setView(view) {
        this.view = view;
    }
    setHeader(header) {
        this.header = header;
    }
    getView() {
        return this.view;
    }
    getAlign() {
        return this.align;
    }
    setWidth(width) {
        this.width = width;
    }
    getWidth() {
        return this.width;
    }
    isSortingEnabled() {
        const config = this.columnConfig;
        if (config.sorting !== undefined && config.sorting !== null) {
            if (config.sorting.enabled === undefined || config.sorting.enabled === null) {
                return true;
            }
            return config.sorting.enabled;
        }
        return true;
    }
    isCellEditingEnabled() {
        const config = this.columnConfig;
        if (config.cellEditing !== undefined && config.cellEditing !== null) {
            if (config.cellEditing.enabled === undefined || config.cellEditing.enabled === null) {
                return true;
            }
            return config.cellEditing.enabled;
        }
        return true;
    }
    setInitialAlign(columnField, align) {
        if (align !== undefined && align !== null) {
            this.align = align;
        }
        else if (columnField.getDataType() === DataType.NUMBER) {
            this.align = ColumnAlign.RIGHT;
        }
        else {
            this.align = ColumnAlign.LEFT;
        }
    }
}

class ColumnEntity extends AbstractColumnEntity {
    constructor(columnId, columnField, columnConfig, enabled, presentation, header, align, view, width) {
        super(columnId, columnField, columnConfig, presentation, header, align, view, width);
        this.sortStatus = SortOrder.NONE;
        this.enabled = true;
        this.enabled = enabled;
        if (view === undefined) {
            this.view = new ViewEntity(this.presentation.getDefaultView());
        }
        if (align === undefined) {
            this.align = this.presentation.getDefaultAlign(this.view);
        }
    }
    isEnabled() {
        return this.enabled;
    }
    setEnabled(enabled) {
        this.enabled = enabled;
    }
    getSortStatus() {
        return this.sortStatus;
    }
    setSortStatus(status) {
        this.sortStatus = status;
    }
}

class ActiveColumnEntity extends ColumnEntity {
    static fromEntity(entity) {
        return new ActiveColumnEntity(entity.getId(), entity.getField(), entity.getHeader(), entity.getAlign(), entity.getView(), entity.getColumnConfig(), entity.getPresentation());
    }
    constructor(columnId, columnField, header, align, view, config, presentation) {
        super(columnId, columnField, config, true, presentation, header, align, view, undefined);
    }
}

class ActiveColumnEntityConverter {
    convertMany(entities) {
        return entities.map(e => this.convert(e));
    }
    convert(entity) {
        return ActiveColumnEntity.fromEntity(entity);
    }
}

class CompositionColumnMovedLeftEvent extends CompositionDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'CompositionColumnMovedLeftEvent');
    }
}

class CompositionColumnMovedLeftAggregateEvent extends CompositionAggregateEvent {
    constructor(aggregateId, activeColumns) {
        super(aggregateId, 'CompositionColumnMovedLeftAggregateEvent');
        this.activeColumns = activeColumns;
    }
    // getActiveColumns(): Array<ActiveColumnEntity> {
    // 	return this.activeColumns;
    // }
    toDomainEvent() {
        return new CompositionColumnMovedLeftEvent(this.getAggregateId());
    }
}

class CompositionColumnMovedRightEvent extends CompositionDomainEvent {
    constructor(aggregateId) {
        super(aggregateId, null, 'CompositionColumnMovedRightEvent');
    }
}

class CompositionColumnMovedRightAggregateEvent extends CompositionAggregateEvent {
    constructor(aggregateId, activeColumns) {
        super(aggregateId, 'CompositionColumnMovedRightAggregateEvent');
        this.activeColumns = activeColumns;
    }
    // getActiveColumns(): Array<ActiveColumnEntity> {
    // 	return this.activeColumns;
    // }
    toDomainEvent() {
        return new CompositionColumnMovedRightEvent(this.getAggregateId());
    }
}

class CompositionColumnsSetEvent extends CompositionDomainEvent {
    constructor(compositionId) {
        super(compositionId, null, 'CompositionColumnsSetEvent');
    }
}

class ColumnsSetAggregateEvent extends CompositionAggregateEvent {
    constructor(compositionId) {
        super(compositionId, 'ColumnsSetAggregateEvent');
    }
    toDomainEvent() {
        return new CompositionColumnsSetEvent(this.getAggregateId());
    }
}

class CompositionCreatedEvent extends CompositionDomainEvent {
    constructor(compositionId) {
        super(compositionId, null, 'CompositionCreatedEvent');
    }
}

class CompositionCreatedAggregateEvent extends CompositionAggregateEvent {
    constructor(compositionId) {
        super(compositionId, 'SchemaCreatedEvent');
    }
    toDomainEvent() {
        return new CompositionCreatedEvent(this.getAggregateId());
    }
}

class Group {
    constructor(id, header, width) {
        this.id = id;
        this.header = header;
        this.width = width;
    }
}

class GroupId extends HermesId {
    constructor(id) {
        super(id);
    }
    toString() {
        return this.getId();
    }
}

const emptyGroup = new Group(new GroupId('-1'), '', 100);

class CompositionAggregate extends AggregateRoot {
    constructor(id, columnFactory, groupFactory, columnsParams = [], width, resizeWidth) {
        super(id, 'CompositionAggregate');
        this.allColumns = [];
        this.resizeWidthEnabled = true;
        this.activeColumnEntityConverter = new ActiveColumnEntityConverter();
        this.groups = new KeyMap();
        this.columnNameToGroupId = new Map();
        const columnConfigs = columnsParams.map((param) => param.getColumn());
        this.baseParams = columnsParams;
        this.baseColumns = columnConfigs;
        this.columnFactory = columnFactory;
        this.groupFactory = groupFactory;
        this.width = width;
        this.allColumns = this.columnFactory.create(columnsParams);
        const activeColumns = this.activeColumnEntityConverter.convertMany(this.getEnabledColumns());
        this.activeColumnContainer = new ActiveColumnContainer(this.getId(), activeColumns, width, columnConfigs);
        if (resizeWidth !== undefined && resizeWidth !== null) {
            this.resizeWidthEnabled = resizeWidth;
        }
    }
    createEvent() {
        return CompositionCreatedAggregateEvent;
    }
    // REMOVE
    getColumns() {
        return this.allColumns;
    }
    // REMOVE
    getActiveColumns() {
        return this.activeColumnContainer.getColumns();
    }
    // make private
    getWidth() {
        if (this.resizeWidthEnabled) {
            return this.containerInDOMWidth;
        }
        else {
            return this.width;
        }
    }
    // REMOVE
    isResizeEnabled() {
        return this.resizeWidthEnabled;
    }
    // REMOVE
    isReady() {
        return !!this.getWidth() && this.getActiveColumns().length > 0;
    }
    setGroups(configs) {
        for (let i = 0; i < configs.length; i += 1) {
            const config = configs[i];
            if (config.columns !== undefined) {
                const group = this.groupFactory.create(config);
                this.groups.set(group.id, group);
                config.columns.forEach((c, index) => {
                    this.columnNameToGroupId.set(c.header, group.id);
                });
            }
            else {
                this.columnNameToGroupId.set(config.header, emptyGroup.id);
            }
        }
    }
    setColumns(params) {
        this.allColumns = this.columnFactory.create(params);
        const columnConfigs = params.map((param) => param.getColumn());
        const activeColumns = this.activeColumnEntityConverter.convertMany(this.getEnabledColumns());
        this.activeColumnContainer.setColumns(activeColumns, columnConfigs);
        this.addEvent(new ColumnsSetAggregateEvent(this.getId()));
    }
    setContainerWidth(containerWidth) {
        this.setContainerWidthWithEvent(containerWidth);
        this.recalculateColumns();
    }
    setWidth(width) {
        this.setWidthWithEvent(width);
        this.setResizeWidthWithEvent(false);
        this.recalculateColumns();
    }
    setResizeWidth(enabled) {
        this.setResizeWidthWithEvent(enabled);
    }
    changeSort(sortParams) {
        this.addEvent(this.activeColumnContainer.changeSort(sortParams));
    }
    // DELEGATE
    enableColumn(columnId, enabled) {
        let enabledIndex = -1;
        this.allColumns.forEach((column, index) => {
            if (column.getId().getId() === columnId.getId()) {
                const prevState = column.isEnabled();
                column.setEnabled(enabled);
                if (prevState !== enabled) {
                    enabledIndex = index;
                }
            }
        });
        if (enabledIndex > 0) {
            if (enabled) {
                // convert
                const columnToAdd = this.activeColumnEntityConverter.convert(this.allColumns[enabledIndex]);
                this.activeColumnContainer.addColumn(columnToAdd, enabledIndex);
            }
            else {
                this.activeColumnContainer.removeColumn(enabledIndex);
            }
        }
        this.recalculateColumns();
        this.addEvent(new CompositionColumnSetEnabledAggregateEvent(this.getId(), this.getActiveColumns()));
    }
    moveLeft(columnId) {
        const columnIndex = this.findColumnIndex(columnId);
        let nextLeft, nextLeftIndex = -1;
        for (let i = columnIndex - 1; i >= 0; i -= 1) {
            const leftColumn = this.allColumns[i];
            if (leftColumn.isEnabled()) {
                nextLeft = leftColumn;
                nextLeftIndex = i;
                break;
            }
        }
        if (nextLeft && nextLeftIndex >= 0 && columnIndex >= 0) {
            const column = this.allColumns[columnIndex];
            this.allColumns[columnIndex] = nextLeft;
            this.allColumns[nextLeftIndex] = column;
        }
        this.activeColumnContainer.moveLeft(columnId);
        this.addEvent(new CompositionColumnMovedLeftAggregateEvent(this.getId(), this.getActiveColumns()));
    }
    moveRight(columnId) {
        const columnIndex = this.findColumnIndex(columnId);
        let nextRight, nextRightIndex = -1;
        for (let i = columnIndex + 1; i < this.allColumns.length; i += 1) {
            const rightColumn = this.allColumns[i];
            if (rightColumn.isEnabled()) {
                nextRight = rightColumn;
                nextRightIndex = i;
                break;
            }
        }
        if (nextRight && nextRightIndex >= 0 && columnIndex >= 0) {
            const column = this.allColumns[columnIndex];
            this.allColumns[columnIndex] = nextRight;
            this.allColumns[nextRightIndex] = column;
        }
        this.activeColumnContainer.moveRight(columnId);
        this.addEvent(new CompositionColumnMovedRightAggregateEvent(this.getId(), this.getActiveColumns()));
    }
    recalculateColumns() {
        const activeColumns = this.activeColumnEntityConverter.convertMany(this.getEnabledColumns());
        this.activeColumnContainer.setColumns(activeColumns, activeColumns.map(c => c.getColumnConfig()));
    }
    // TODO Refactor
    setWidthWithEvent(width) {
        const calculator = new CompositionContainerWidthCalculator(this.getMinColumnWidth());
        const minWidth = calculator.calculateMinWidth(this.activeColumnContainer.getColumnWidths());
        if (minWidth > width) {
            this.width = minWidth;
        }
        else {
            this.width = width;
        }
        this.activeColumnContainer.setWidth(this.getWidth());
        this.addEvent(new CompositionWidthSetAggregateEvent(this.getId()));
    }
    // TODO Refactor
    setContainerWidthWithEvent(containerWidth) {
        const calculator = new CompositionContainerWidthCalculator(this.getMinColumnWidth());
        const minWidth = calculator.calculateMinWidth(this.activeColumnContainer.getColumnWidths());
        if (minWidth > containerWidth) {
            this.containerInDOMWidth = minWidth;
        }
        else {
            this.containerInDOMWidth = containerWidth;
        }
        this.activeColumnContainer.setWidth(this.getWidth());
        this.addEvent(new CompositionContainerWidthSetAggregateEvent(this.getId(), containerWidth));
    }
    setResizeWidthWithEvent(enabled) {
        this.resizeWidthEnabled = enabled;
        this.activeColumnContainer.setWidth(this.getWidth());
        this.addEvent(new CompositionResizeWidthSetAggregateEvent(this.getId()));
    }
    // REMOVE -> move to allColumnsContainer
    getEnabledColumns() {
        return this.allColumns.filter(c => c.isEnabled());
    }
    findColumnIndex(columnId) {
        return this.allColumns.findIndex((column) => column.getId().equals(columnId));
    }
    getMinColumnWidth() {
        return this.activeColumnContainer.getMinColumnWidth();
    }
}

class ColumnPresentation {
}

class NumberColumnPresentation extends ColumnPresentation {
    constructor() {
        super();
    }
    static getInstance() {
        if (!NumberColumnPresentation.instance) {
            NumberColumnPresentation.instance = new NumberColumnPresentation();
        }
        return NumberColumnPresentation.instance;
    }
    getPossibleViews() {
        return [
            CellView.TEXT,
            CellView.BAR,
            CellView.PERCENTAGE_BAR,
            CellView.PERCENTAGE
        ];
    }
    getDefaultView() {
        return CellView.NUMBER;
    }
    getDefaultAlign(view) {
        return ColumnAlign.RIGHT;
    }
}
NumberColumnPresentation.instance = null;

class BooleanColumnPresentation extends ColumnPresentation {
    constructor() {
        super();
    }
    static getInstance() {
        if (!BooleanColumnPresentation.instance) {
            BooleanColumnPresentation.instance = new BooleanColumnPresentation();
        }
        return BooleanColumnPresentation.instance;
    }
    getPossibleViews() {
        return [
            CellView.TEXT,
            CellView.ITALIC,
            CellView.CHIP,
            CellView.BOLD,
            CellView.CHECKBOX
        ];
    }
    getDefaultView() {
        return CellView.TEXT;
    }
    getDefaultAlign(view) {
        if (view.getCellView() === CellView.CHECKBOX) {
            return ColumnAlign.CENTER;
        }
        else {
            return ColumnAlign.LEFT;
        }
    }
}
BooleanColumnPresentation.instance = null;

class DateColumnPresentation extends ColumnPresentation {
    constructor() {
        super();
    }
    static getInstance() {
        if (!DateColumnPresentation.instance) {
            DateColumnPresentation.instance = new DateColumnPresentation();
        }
        return DateColumnPresentation.instance;
    }
    getPossibleViews() {
        return [
            CellView.DATE,
            CellView.TEXT,
            CellView.ITALIC,
            CellView.BOLD,
            CellView.CHIP
        ];
    }
    getDefaultView() {
        return CellView.DATE;
    }
    getDefaultAlign() {
        return ColumnAlign.LEFT;
    }
}
DateColumnPresentation.instance = null;

class StringColumnPresentation extends ColumnPresentation {
    constructor() {
        super();
    }
    static getInstance() {
        if (!StringColumnPresentation.instance) {
            StringColumnPresentation.instance = new StringColumnPresentation();
        }
        return StringColumnPresentation.instance;
    }
    getPossibleViews() {
        return [
            CellView.TEXT,
            CellView.ITALIC,
            CellView.BOLD,
            CellView.IMAGE,
            CellView.LINK,
            CellView.CHIP
        ];
    }
    getDefaultView() {
        return CellView.TEXT;
    }
    getDefaultAlign() {
        return ColumnAlign.LEFT;
    }
}
StringColumnPresentation.instance = null;

class UnknownColumnPresentation extends ColumnPresentation {
    constructor() {
        super();
    }
    static getInstance() {
        if (!UnknownColumnPresentation.instance) {
            UnknownColumnPresentation.instance = new UnknownColumnPresentation();
        }
        return UnknownColumnPresentation.instance;
    }
    getPossibleViews() {
        return [
            CellView.TEXT
        ];
    }
    getDefaultView() {
        return CellView.TEXT;
    }
    getDefaultAlign() {
        return ColumnAlign.LEFT;
    }
}
UnknownColumnPresentation.instance = null;

class ColumnPresentationConverter {
    convert(dataType) {
        if (dataType === DataType.NUMBER) {
            return NumberColumnPresentation.getInstance();
        }
        else if (dataType === DataType.BOOLEAN) {
            return BooleanColumnPresentation.getInstance();
        }
        else if (dataType === DataType.DATE) {
            return DateColumnPresentation.getInstance();
        }
        else if (dataType === DataType.STRING) {
            return StringColumnPresentation.getInstance();
        }
        else {
            return UnknownColumnPresentation.getInstance();
        }
    }
}
ColumnPresentationConverter.ɵfac = function ColumnPresentationConverter_Factory(t) { return new (t || ColumnPresentationConverter)(); };
ColumnPresentationConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ColumnPresentationConverter, factory: ColumnPresentationConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnPresentationConverter, [{
        type: Injectable
    }], null, null); })();

class ColumnEntityFactory {
    constructor(columnPresentationConverter) {
        this.columnPresentationConverter = columnPresentationConverter;
    }
    create(source) {
        if (Array.isArray(source)) {
            return this.createColumns(source);
        }
        else {
            return this.createColumn(source);
        }
    }
    createColumn(params) {
        const columnConfig = params.getColumn(), field = params.getField(), dataType = field.getDataType(), width = this.convertWidth(columnConfig.width) || undefined;
        let view, enabled;
        if (columnConfig.view !== undefined) {
            view = new ViewEntity(columnConfig.view);
        }
        if (columnConfig.enabled !== undefined) {
            enabled = columnConfig.enabled;
        }
        else {
            enabled = true;
        }
        const presentation = this.getPresentation(dataType);
        const columnEntity = new ColumnEntity(new ColumnId(RandomStringGenerator.generate()), field, columnConfig, enabled, presentation, undefined, columnConfig.align, view, width);
        if (columnConfig.header !== undefined) {
            columnEntity.setHeader(columnConfig.header);
        }
        return columnEntity;
    }
    createColumns(columns) {
        const columnEntities = [];
        columns.forEach((column) => {
            columnEntities.push(this.createColumn(column));
        });
        return columnEntities;
    }
    convertWidth(width) {
        return +width;
    }
    getPresentation(dataType) {
        return this.columnPresentationConverter.convert(dataType);
    }
}
ColumnEntityFactory.ɵfac = function ColumnEntityFactory_Factory(t) { return new (t || ColumnEntityFactory)(i0.ɵɵinject(ColumnPresentationConverter)); };
ColumnEntityFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ColumnEntityFactory, factory: ColumnEntityFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnEntityFactory, [{
        type: Injectable
    }], function () { return [{ type: ColumnPresentationConverter }]; }, null); })();

class CompositionGroupFactory {
    create(config) {
        return new Group(new GroupId(RandomStringGenerator.generate()), config.header, config.width);
    }
}

class CompositionAggregateFactory extends AggregateFactory {
    constructor(columnFactory, groupFactory) {
        super();
        this.columnFactory = columnFactory;
        this.groupFactory = groupFactory;
    }
    create(id) {
        return new CompositionAggregate(id, this.columnFactory, this.groupFactory);
    }
}
CompositionAggregateFactory.ɵfac = function CompositionAggregateFactory_Factory(t) { return new (t || CompositionAggregateFactory)(i0.ɵɵinject(ColumnEntityFactory), i0.ɵɵinject(CompositionGroupFactory)); };
CompositionAggregateFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionAggregateFactory, factory: CompositionAggregateFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionAggregateFactory, [{
        type: Injectable
    }], function () { return [{ type: ColumnEntityFactory }, { type: CompositionGroupFactory }]; }, null); })();

class CompositionAggregateRepository extends AggregateRepository {
}

class InMemoryCompositionStore extends InMemoryStore {
}
InMemoryCompositionStore.ɵfac = /*@__PURE__*/ function () { let ɵInMemoryCompositionStore_BaseFactory; return function InMemoryCompositionStore_Factory(t) { return (ɵInMemoryCompositionStore_BaseFactory || (ɵInMemoryCompositionStore_BaseFactory = i0.ɵɵgetInheritedFactory(InMemoryCompositionStore)))(t || InMemoryCompositionStore); }; }();
InMemoryCompositionStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryCompositionStore, factory: InMemoryCompositionStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryCompositionStore, [{
        type: Injectable
    }], null, null); })();

class InMemoryCompositionAggregateStore extends InMemoryAggregateStore {
    constructor(inMemoryCompositionStore, aggregateStoreRegister) {
        super(inMemoryCompositionStore, aggregateStoreRegister);
    }
}
InMemoryCompositionAggregateStore.ɵfac = function InMemoryCompositionAggregateStore_Factory(t) { return new (t || InMemoryCompositionAggregateStore)(i0.ɵɵinject(InMemoryCompositionStore), i0.ɵɵinject(i1$1.AggregateStoreRegister)); };
InMemoryCompositionAggregateStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryCompositionAggregateStore, factory: InMemoryCompositionAggregateStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryCompositionAggregateStore, [{
        type: Injectable
    }], function () { return [{ type: InMemoryCompositionStore }, { type: i1$1.AggregateStoreRegister }]; }, null); })();

class InMemoryCompositionAggregateRepository extends CompositionAggregateRepository {
    constructor(inMemoryCompositionAggregateStore) {
        super();
        this.inMemoryCompositionAggregateStore = inMemoryCompositionAggregateStore;
    }
    findById(aggregateId) {
        return this.inMemoryCompositionAggregateStore.findById(aggregateId);
    }
    save(aggregate) {
        this.inMemoryCompositionAggregateStore.save(aggregate);
    }
}
InMemoryCompositionAggregateRepository.ɵfac = function InMemoryCompositionAggregateRepository_Factory(t) { return new (t || InMemoryCompositionAggregateRepository)(i0.ɵɵinject(InMemoryCompositionAggregateStore)); };
InMemoryCompositionAggregateRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryCompositionAggregateRepository, factory: InMemoryCompositionAggregateRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryCompositionAggregateRepository, [{
        type: Injectable
    }], function () { return [{ type: InMemoryCompositionAggregateStore }]; }, null); })();

class CompositionCommand extends Command {
}

class CreateCompositionCommand extends CompositionCommand {
    constructor(compositionId) {
        super(compositionId, 'CreateCompositionCommand');
        this.compositionId = compositionId;
    }
}

class CreateCompositionCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher) {
        this.compositionAggregateRepository = compositionAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return CreateCompositionCommand;
    }
    getAggregateRepository() {
        return this.compositionAggregateRepository;
    }
    publishDomainEvents(aggregate, command) {
        this.domainEventPublisher.publish(new CompositionCreatedEvent(command.getAggregateId()));
    }
}
CreateCompositionCommandHandler.ɵfac = function CreateCompositionCommandHandler_Factory(t) { return new (t || CreateCompositionCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
CreateCompositionCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CreateCompositionCommandHandler, factory: CreateCompositionCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CreateCompositionCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class SetColumnsCommand extends CompositionCommand {
    constructor(compositionId, columns) {
        super(compositionId, 'SetColumnsCommand');
        this.compositionId = compositionId;
        this.columns = columns;
    }
    getParams() {
        return this.columns;
    }
}

const CompositionAggregateEvents = {
    CompositionResizeWidthSetAggregateEvent: 'CompositionResizeWidthSetAggregateEvent',
    ColumnsSetAggregateEvent: 'ColumnsSetAggregateEvent',
    CompositionContainerWidthSetAggregateEvent: 'CompositionContainerWidthSetAggregateEvent',
    CompositionWidthSetAggregateEvent: 'CompositionWidthSetAggregateEvent',
    CompositionColumnSetEnabledAggregateEvent: 'CompositionColumnSetEnabledAggregateEvent',
    CompositionColumnMovedLeftAggregateEvent: 'CompositionColumnMovedLeftAggregateEvent',
    CompositionColumnMovedRightAggregateEvent: 'CompositionColumnMovedRightAggregateEvent',
    GroupsSetAggregateEvent: 'GroupsSetAggregateEvent'
};

class CompositionGroupsSetEvent extends CompositionDomainEvent {
    constructor(compositionId) {
        super(compositionId, null, 'CompositionGroupsSetEvent');
    }
}

class CompositionEventConverter {
    convert(arg) {
        if (Array.isArray(arg)) {
            return this.convertEvents(arg);
        }
        else {
            return this.convertEvent(arg);
        }
    }
    convertEvents(aggregateEvents) {
        return aggregateEvents.map((event) => {
            return this.convertEvent(event);
        });
    }
    convertEvent(aggregateEvent) {
        switch (aggregateEvent.getType()) {
            case CompositionAggregateEvents.CompositionResizeWidthSetAggregateEvent:
                return new CompositionResizeWidthSetEvent(aggregateEvent.getAggregateId());
            case CompositionAggregateEvents.ColumnsSetAggregateEvent:
                return new CompositionColumnsSetEvent(aggregateEvent.getAggregateId());
            case CompositionAggregateEvents.CompositionContainerWidthSetAggregateEvent:
                const payload = aggregateEvent.containerWidth;
                return new CompositionContainerWidthSetEvent(aggregateEvent.getAggregateId(), payload);
            case CompositionAggregateEvents.CompositionWidthSetAggregateEvent:
                return new CompositionWidthSetEvent(aggregateEvent.getAggregateId());
            case CompositionAggregateEvents.CompositionColumnSetEnabledAggregateEvent:
                return new CompositionColumnSetEnabledEvent(aggregateEvent.getAggregateId());
            case CompositionAggregateEvents.CompositionColumnMovedLeftAggregateEvent:
                return new CompositionColumnMovedLeftEvent(aggregateEvent.getAggregateId());
            case CompositionAggregateEvents.CompositionColumnMovedRightAggregateEvent:
                return new CompositionColumnMovedRightEvent(aggregateEvent.getAggregateId());
            case CompositionAggregateEvents.GroupsSetAggregateEvent:
                return new CompositionGroupsSetEvent(aggregateEvent.getAggregateId());
            default:
                return new CompositionResizeWidthSetEvent(aggregateEvent.getAggregateId());
        }
    }
}
CompositionEventConverter.ɵfac = function CompositionEventConverter_Factory(t) { return new (t || CompositionEventConverter)(); };
CompositionEventConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionEventConverter, factory: CompositionEventConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionEventConverter, [{
        type: Injectable
    }], null, null); })();

class SetColumnsCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
        this.compositionAggregateRepository = compositionAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
        this.compositionEventConverter = compositionEventConverter;
    }
    forCommand() {
        return SetColumnsCommand;
    }
    handle(aggregate, command) {
        const setColumnsParams = command.getParams();
        aggregate.setColumns(setColumnsParams);
    }
    publish(aggregate, command) {
        this.publishEvents(aggregate, command);
    }
    publishEvents(composition, command) {
        const events = composition.getEvents();
        const domainEvents = this.compositionEventConverter.convert(events);
        this.domainEventPublisher.publish(domainEvents);
    }
}
SetColumnsCommandHandler.ɵfac = function SetColumnsCommandHandler_Factory(t) { return new (t || SetColumnsCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher), i0.ɵɵinject(CompositionEventConverter)); };
SetColumnsCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetColumnsCommandHandler, factory: SetColumnsCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetColumnsCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }, { type: CompositionEventConverter }]; }, null); })();

class SetCompositionWidthCommand extends CompositionCommand {
    constructor(structureId, width) {
        super(structureId, 'SetCompositionWidthCommand');
        this.structureId = structureId;
        this.width = width;
    }
    getWidth() {
        return this.width;
    }
}

class SetCompositionWidthCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetCompositionWidthCommand;
    }
    handle(composition, command) {
        const width = command.getWidth();
        composition.setWidth(width);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new CompositionWidthSetEvent(command.getAggregateId()));
    }
}
SetCompositionWidthCommandHandler.ɵfac = function SetCompositionWidthCommandHandler_Factory(t) { return new (t || SetCompositionWidthCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetCompositionWidthCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetCompositionWidthCommandHandler, factory: SetCompositionWidthCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetCompositionWidthCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }]; }, null); })();

class SetCompositionResizeWidthCommand extends CompositionCommand {
    constructor(structureId, enabled) {
        super(structureId, 'SetCompositionResizeWidthCommand');
        this.structureId = structureId;
        this.enabled = enabled;
    }
    getEnabled() {
        return this.enabled;
    }
}

class SetCompositionResizeWidthCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return SetCompositionResizeWidthCommand;
    }
    handle(composition, command) {
        const enabled = command.getEnabled();
        composition.setResizeWidth(enabled);
    }
    publish(aggregate, command) {
        this.domainEventPublisher.publish(new CompositionResizeWidthSetEvent(command.getAggregateId()));
    }
}
SetCompositionResizeWidthCommandHandler.ɵfac = function SetCompositionResizeWidthCommandHandler_Factory(t) { return new (t || SetCompositionResizeWidthCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
SetCompositionResizeWidthCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetCompositionResizeWidthCommandHandler, factory: SetCompositionResizeWidthCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetCompositionResizeWidthCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class SetCompositionContainerWidthCommand extends CompositionCommand {
    constructor(structureId, width) {
        super(structureId, 'SetCompositionContainerWidthCommand');
        this.structureId = structureId;
        this.width = width;
    }
    getWidth() {
        return this.width;
    }
}

class SetCompositionContainerWidthCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
        this.compositionAggregateRepository = compositionAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
        this.compositionEventConverter = compositionEventConverter;
    }
    forCommand() {
        return SetCompositionContainerWidthCommand;
    }
    handle(composition, command) {
        const width = command.getWidth();
        composition.setContainerWidth(width);
    }
    publish(aggregate, command) {
        this.publishAggregateEvents(aggregate.getEvents());
    }
    publishAggregateEvents(aggregateEvents) {
        const domainEvents = this.compositionEventConverter.convert(aggregateEvents);
        this.domainEventPublisher.publish(domainEvents);
    }
}
SetCompositionContainerWidthCommandHandler.ɵfac = function SetCompositionContainerWidthCommandHandler_Factory(t) { return new (t || SetCompositionContainerWidthCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher), i0.ɵɵinject(CompositionEventConverter)); };
SetCompositionContainerWidthCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetCompositionContainerWidthCommandHandler, factory: SetCompositionContainerWidthCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetCompositionContainerWidthCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }, { type: CompositionEventConverter }]; }, null); })();

class CompositionSetColumnEnabledCommand extends CompositionCommand {
    constructor(compositionId, columnId, enabled) {
        super(compositionId, 'CompositionSetColumnEnabledCommand');
        this.compositionId = compositionId;
        this.columnId = columnId;
        this.enabled = enabled;
    }
    getColumnId() {
        return this.columnId;
    }
    isEnabled() {
        return this.enabled;
    }
}

class CompositionSetColumnEnabledCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
        this.compositionAggregateRepository = compositionAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
        this.compositionEventConverter = compositionEventConverter;
    }
    forCommand() {
        return CompositionSetColumnEnabledCommand;
    }
    handle(aggregate, command) {
        const columnId = command.getColumnId(), enabled = command.isEnabled();
        aggregate.enableColumn(columnId, enabled);
    }
    publish(aggregate, command) {
        this.publishEvents(aggregate, command);
    }
    publishEvents(composition, command) {
        const events = composition.getEvents();
        const domainEvents = this.compositionEventConverter.convert(events);
        if (domainEvents && domainEvents.length > 0) {
            this.domainEventPublisher.publish(domainEvents);
        }
    }
}
CompositionSetColumnEnabledCommandHandler.ɵfac = function CompositionSetColumnEnabledCommandHandler_Factory(t) { return new (t || CompositionSetColumnEnabledCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher), i0.ɵɵinject(CompositionEventConverter)); };
CompositionSetColumnEnabledCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionSetColumnEnabledCommandHandler, factory: CompositionSetColumnEnabledCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionSetColumnEnabledCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }, { type: CompositionEventConverter }]; }, null); })();

class CompositionChangeSortStatusCommand extends CompositionCommand {
    constructor(compositionId, sortParams) {
        super(compositionId, 'CompositionChangeSortStatusCommand');
        this.compositionId = compositionId;
        this.sortParams = sortParams;
    }
    getCompositionId() {
        return this.compositionId;
    }
    getSortParams() {
        return this.sortParams;
    }
}

class CompositionChangeSortStatusCommandHandler {
    constructor(domainEventPublisher) {
        this.domainEventPublisher = domainEventPublisher;
    }
    forCommand() {
        return CompositionChangeSortStatusCommand;
    }
    handle(composition, command) {
        const sortParams = command.getSortParams();
        composition.changeSort(sortParams);
    }
    publish(composition, command) {
        const compositionId = command.getAggregateId(), columns = composition.getActiveColumns();
        this.domainEventPublisher.publish(new CompositionChangeSortStatusEvent(compositionId, columns));
    }
}
CompositionChangeSortStatusCommandHandler.ɵfac = function CompositionChangeSortStatusCommandHandler_Factory(t) { return new (t || CompositionChangeSortStatusCommandHandler)(i0.ɵɵinject(i1$1.DomainEventPublisher)); };
CompositionChangeSortStatusCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionChangeSortStatusCommandHandler, factory: CompositionChangeSortStatusCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionChangeSortStatusCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventPublisher }]; }, null); })();

class CompositionMoveLeftColumnCommand extends CompositionCommand {
    constructor(compositionId, columnId) {
        super(compositionId, 'CompositionMoveLeftColumnCommand');
        this.compositionId = compositionId;
        this.columnId = columnId;
    }
    getColumnId() {
        return this.columnId;
    }
}

class CompositionMoveLeftColumnCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
        this.compositionAggregateRepository = compositionAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
        this.compositionEventConverter = compositionEventConverter;
    }
    forCommand() {
        return CompositionMoveLeftColumnCommand;
    }
    handle(aggregate, command) {
        const columnId = command.getColumnId();
        aggregate.moveLeft(columnId);
    }
    publish(aggregate, command) {
        this.publishEvents(aggregate, command);
    }
    publishEvents(composition, command) {
        const events = composition.getEvents();
        const domainEvents = this.compositionEventConverter.convert(events);
        if (domainEvents && domainEvents.length > 0) {
            this.domainEventPublisher.publish(domainEvents);
        }
    }
}
CompositionMoveLeftColumnCommandHandler.ɵfac = function CompositionMoveLeftColumnCommandHandler_Factory(t) { return new (t || CompositionMoveLeftColumnCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher), i0.ɵɵinject(CompositionEventConverter)); };
CompositionMoveLeftColumnCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionMoveLeftColumnCommandHandler, factory: CompositionMoveLeftColumnCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionMoveLeftColumnCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }, { type: CompositionEventConverter }]; }, null); })();

class CompositionMoveRightColumnCommand extends CompositionCommand {
    constructor(compositionId, columnId) {
        super(compositionId, 'CompositionMoveRightColumnCommand');
        this.columnId = columnId;
    }
    getColumnId() {
        return this.columnId;
    }
}

class CompositionMoveRightColumnCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
        this.compositionAggregateRepository = compositionAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
        this.compositionEventConverter = compositionEventConverter;
    }
    forCommand() {
        return CompositionMoveRightColumnCommand;
    }
    handle(aggregate, command) {
        const columnId = command.getColumnId();
        aggregate.moveRight(columnId);
    }
    publish(aggregate, command) {
        this.publishEvents(aggregate, command);
    }
    publishEvents(composition, command) {
        const events = composition.getEvents();
        const domainEvents = this.compositionEventConverter.convert(events);
        if (domainEvents && domainEvents.length > 0) {
            this.domainEventPublisher.publish(domainEvents);
        }
    }
}
CompositionMoveRightColumnCommandHandler.ɵfac = function CompositionMoveRightColumnCommandHandler_Factory(t) { return new (t || CompositionMoveRightColumnCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher), i0.ɵɵinject(CompositionEventConverter)); };
CompositionMoveRightColumnCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionMoveRightColumnCommandHandler, factory: CompositionMoveRightColumnCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionMoveRightColumnCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }, { type: CompositionEventConverter }]; }, null); })();

class ChangeSortParams {
    constructor(fieldId, direction) {
        this.fieldId = fieldId;
        this.direction = direction;
    }
}

class SetGroupsCommand extends CompositionCommand {
    constructor(compositionId, configs) {
        super(compositionId, 'SetGroupsCommand');
        this.compositionId = compositionId;
        this.configs = configs;
    }
    getConfigs() {
        return this.configs;
    }
}

class CompositionDispatcher {
    constructor(commandDispatcher) {
        this.commandDispatcher = commandDispatcher;
    }
    createComposition(compositionId) {
        this.commandDispatcher.dispatch(new CreateCompositionCommand(compositionId));
    }
    setColumns(compositionId, params) {
        this.commandDispatcher.dispatch(new SetColumnsCommand(compositionId, params));
    }
    setGroups(compositionId, params) {
        this.commandDispatcher.dispatch(new SetGroupsCommand(compositionId, params));
    }
    setWidth(compositionId, width) {
        this.commandDispatcher.dispatch(new SetCompositionWidthCommand(compositionId, width));
    }
    setContainerWidth(compositionId, width) {
        this.commandDispatcher.dispatch(new SetCompositionContainerWidthCommand(compositionId, width));
    }
    setResizeWidth(compositionId, enabled) {
        this.commandDispatcher.dispatch(new SetCompositionResizeWidthCommand(compositionId, enabled));
    }
    changeSort(compositionId, params) {
        this.commandDispatcher.dispatch(new CompositionChangeSortStatusCommand(compositionId, params));
    }
    setColumnEnabled(compositionId, columnId, enabled) {
        this.commandDispatcher.dispatch(new CompositionSetColumnEnabledCommand(compositionId, columnId, enabled));
    }
    moveLeft(compositionId, columnId) {
        this.commandDispatcher.dispatch(new CompositionMoveLeftColumnCommand(compositionId, columnId));
    }
    moveRight(compositionId, columnId) {
        this.commandDispatcher.dispatch(new CompositionMoveRightColumnCommand(compositionId, columnId));
    }
}
CompositionDispatcher.ɵfac = function CompositionDispatcher_Factory(t) { return new (t || CompositionDispatcher)(i0.ɵɵinject(i1$1.CommandDispatcher)); };
CompositionDispatcher.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionDispatcher, factory: CompositionDispatcher.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionDispatcher, [{
        type: Injectable
    }], function () { return [{ type: i1$1.CommandDispatcher }]; }, null); })();

class CompositionChangeSortStatusEventHandler {
    constructor(compositionDispatcher) {
        this.compositionDispatcher = compositionDispatcher;
    }
    forEvents() {
        return [
            SortToggledEvent,
            SortOrderSetEvent
        ];
    }
    handle(event) {
        if (event.ofMessageType('SortToggledEvent')) {
            const compositionId = event.getCompositionId(), dirs = event.getDirections();
            const params = dirs.map((dir) => {
                const columnFieldId = new ColumnFieldId(dir.fieldId.getId());
                return new ChangeSortParams(columnFieldId, dir.direction);
            });
            this.compositionDispatcher.changeSort(compositionId, params);
        }
        if (event.ofMessageType('SortOrderSetEvent')) {
            const compositionId = event.getCompositionId(), dirs = event.getDirections();
            const params = dirs.map((dir) => {
                const columnFieldId = new ColumnFieldId(dir.fieldId.getId());
                return new ChangeSortParams(columnFieldId, dir.direction);
            });
            this.compositionDispatcher.changeSort(compositionId, params);
        }
    }
}
CompositionChangeSortStatusEventHandler.ɵfac = function CompositionChangeSortStatusEventHandler_Factory(t) { return new (t || CompositionChangeSortStatusEventHandler)(i0.ɵɵinject(CompositionDispatcher)); };
CompositionChangeSortStatusEventHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionChangeSortStatusEventHandler, factory: CompositionChangeSortStatusEventHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionChangeSortStatusEventHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionDispatcher }]; }, null); })();

class CompositionReadModeRoot extends ReadModelRoot {
    constructor(uid, ready, allColumns, activeColumns, width, resizeWidth) {
        super(uid);
        this.ready = ready;
        this.allColumns = allColumns;
        this.activeColumns = activeColumns;
        this.width = width;
        this.resizeWidth = resizeWidth;
    }
    getActiveColumns() {
        return this.activeColumns;
    }
    getAllColumns() {
        return this.allColumns;
    }
    getActiveHeaderColumns() {
        return this.getActiveColumns()
            .map((column, index) => column.toHeaderCellTemplateWithContext(index));
    }
    getHeaderColumns() {
        return this.getAllColumns()
            .map((column, index) => column.toHeaderCellTemplateWithContext(index));
    }
    getTemplateColumns() {
        return this.getActiveColumns()
            .map((column) => column.toContentCellTemplateWithAccessor());
    }
    getWidth() {
        return this.width;
    }
    getContainerWidth() {
        return +this.width - 2;
    }
    isReady() {
        return this.ready;
    }
    isResizeWidthEnabled() {
        return this.resizeWidth;
    }
    equals(composition) {
        return this.width === composition.width &&
            this.resizeWidth === composition.resizeWidth &&
            this.equalsByColumns(composition.allColumns);
    }
    equalsByColumns(columns) {
        return this.allColumns.length === columns.length;
    }
}

class CellContext {
    constructor(element) {
        this.element = element;
    }
}

var CellValueType;
(function (CellValueType) {
    CellValueType[CellValueType["TEXT"] = 0] = "TEXT";
    CellValueType[CellValueType["HTML"] = 1] = "HTML";
})(CellValueType || (CellValueType = {}));
class CellValue {
    constructor(value, type) {
        this.value = value;
        this.type = type;
    }
    static text(value) {
        return new CellValue(value, CellValueType.TEXT);
    }
    static HTML(value) {
        return new CellValue(value, CellValueType.HTML);
    }
}

class CellTemplateWithAccessor {
    constructor(columnDefinitionId, template, editTemplate, editable, templateFun, formatterFun, accessor, searchAccessor, width, columnFieldId, align, cellEditingEnabled, type, // REFACTOR
    view) {
        this.columnDefinitionId = columnDefinitionId;
        this.template = template;
        this.editTemplate = editTemplate;
        this.editable = editable;
        this.templateFun = templateFun;
        this.formatterFun = formatterFun;
        this.accessor = accessor;
        this.searchAccessor = searchAccessor;
        this.width = width;
        this.columnFieldId = columnFieldId;
        this.align = align;
        this.cellEditingEnabled = cellEditingEnabled;
        this.type = type;
        this.view = view;
    }
    isCellEditingEnabled() {
        return this.cellEditingEnabled;
    }
    isBooleanDataType() {
        return this.type === DataType.BOOLEAN;
    }
    isAlignLeft() {
        return this.align === ColumnAlign.LEFT;
    }
    isAlignCenter() {
        return this.align === ColumnAlign.CENTER;
    }
    isAlignRight() {
        return this.align === ColumnAlign.RIGHT;
    }
    // REFACTOR #1581
    getValue(entity, searchPhrase) {
        const cellValue = this.findValue(entity, searchPhrase);
        cellValue.value = this.templateFun(cellValue.value, entity.getSourceItem());
        if (this.formatterFun) {
            cellValue.value = this.formatterFun(cellValue.value, entity.getSourceItem());
        }
        return cellValue;
    }
    getClasses() {
        return 'gui-cell-highlighted';
    }
    findValue(entity, searchPhrase) {
        const value = this.accessor(entity);
        if (this.type !== DataType.STRING) {
            return CellValue.text(value);
        }
        if (this.view && this.view.getCellView() === CellView.FUNCTION) {
            return CellValue.text(value);
        }
        if (searchPhrase) {
            let txt = '' + this.searchAccessor(entity);
            const lowerCasedText = txt.toLocaleLowerCase(), loweredSearchPhrase = searchPhrase.toLocaleLowerCase();
            const positions = [];
            let index = 0;
            while (index < loweredSearchPhrase.length) {
                const found = lowerCasedText.indexOf(loweredSearchPhrase, index);
                if (found >= 0) {
                    positions.push(found);
                    index = found + searchPhrase.length;
                    continue;
                }
                else {
                    index = loweredSearchPhrase.length;
                }
            }
            const arr = txt.split('');
            positions.forEach((pos) => {
                for (let i = 0; i < searchPhrase.length; i += 1) {
                    let ph;
                    if (i === 0) {
                        ph = `<span class="gui-text-highlight">${arr[pos + i]}`;
                    }
                    else {
                        ph = arr[pos + i];
                    }
                    if (i === searchPhrase.length - 1) {
                        ph += '</span>';
                    }
                    arr[pos + i] = ph;
                }
            });
            txt = arr.join('');
            return CellValue.HTML(txt);
        }
        else {
            return CellValue.text(value);
        }
    }
}

class ColumnDefinition extends ReadModelEntity {
    constructor(field, columnDefinitionId, // REFACTOR Id first argument
    enabled, type, // REFACTOR
    view, // REFACTOR
    align, // REFACTOR
    header, cellEditingEnabled, sort = SortOrder.NONE, sortable = true) {
        super(columnDefinitionId);
        this.type = type;
        this.view = view;
        this.align = align;
        this.sortable = true;
        this.field = field;
        this.columnDefinitionId = columnDefinitionId;
        this.enabled = enabled;
        this.header = header;
        this.cellEditingEnabled = cellEditingEnabled;
        this.sortStatus = sort;
        this.sortable = sortable;
    }
    isEnabled() {
        return this.enabled;
    }
    setHeader(header) {
        this.header = header;
    }
    setField(field) {
        this.field = field;
    }
    setTemplateFunction(templateFun) {
        this.templateFunction = templateFun;
    }
    setFormatterFunction(formatter) {
        this.formatterFunction = formatter;
    }
    toHeaderCellTemplateWithContext(index) {
        const header = this.header || '';
        let headerCellContext;
        if (typeof header === 'string') {
            headerCellContext = new CellContext(CellValue.text(header));
        }
        else if (typeof header === 'function') {
            headerCellContext = new CellContext(CellValue.text(header(index)));
        }
        const fieldId = new FieldId(this.field.getId().getId());
        return new CellTemplateWithContext(this.headerTemplate, this.editTemplate, headerCellContext, this.width, fieldId, this.columnDefinitionId, this.sortStatus, this.enabled, this.sortable, this.align);
    }
    toContentCellTemplateWithAccessor() {
        const accessor = (entity) => {
            return this.field.getAccessor()(entity);
        }, searchAccessor = (entity) => {
            return this.field.getSearchAccessor()(entity);
        };
        return new CellTemplateWithAccessor(this.columnDefinitionId, this.cellTemplate, this.editTemplate, true, this.templateFunction, this.formatterFunction, accessor, searchAccessor, this.width, this.field.getId(), this.align, this.cellEditingEnabled, this.type, this.view);
    }
}

class ColumnDefinitionId extends ReadModelEntityId {
    constructor(id) {
        super(id);
    }
}

const _c0$8 = ["value", ""];
function TextViewComponent_ng_container_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementContainerStart(0);
    i0.ɵɵelement(1, "span", 2);
    i0.ɵɵpipe(2, "guiSafe");
    i0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("innerHTML", i0.ɵɵpipeBind2(2, 1, ctx_r0.value.value, "html"), i0.ɵɵsanitizeHtml);
} }
function TextViewComponent_ng_template_1_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span");
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r2 = i0.ɵɵnextContext();
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", ctx_r2.value.value, " ");
} }
class TextViewComponent extends PureComponent {
    constructor(isBold, isItalic, elementRef, renderer) {
        super(elementRef);
        this.elementRef = elementRef;
        this.renderer = renderer;
        this.isHtml = false;
        if (isBold !== null) {
            this.addClassToHost('gui-bold');
        }
        if (isItalic !== null) {
            this.addClassToHost('gui-italic');
        }
    }
    ngOnChanges() {
        this.isHtml = this.value.type === CellValueType.HTML;
    }
    getSelectorName() {
        return 'gui-text-view';
    }
}
TextViewComponent.ɵfac = function TextViewComponent_Factory(t) { return new (t || TextViewComponent)(i0.ɵɵinjectAttribute('bold'), i0.ɵɵinjectAttribute('italic'), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.Renderer2)); };
TextViewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: TextViewComponent, selectors: [["gui-view-text", "value", ""]], inputs: { value: "value" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$8, decls: 3, vars: 2, consts: [[4, "ngIf", "ngIfElse"], ["text", ""], [3, "innerHTML"]], template: function TextViewComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, TextViewComponent_ng_container_0_Template, 3, 4, "ng-container", 0);
        i0.ɵɵtemplate(1, TextViewComponent_ng_template_1_Template, 2, 1, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
    } if (rf & 2) {
        const _r1 = i0.ɵɵreference(2);
        i0.ɵɵproperty("ngIf", ctx.isHtml)("ngIfElse", _r1);
    } }, directives: [i4.NgIf], pipes: [SafePipe], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(TextViewComponent, [{
        type: Component,
        args: [{
                selector: 'gui-view-text[value]',
                template: `

		<ng-container *ngIf="isHtml; else text">
			<span [innerHTML]="value.value | guiSafe: 'html'"></span>
		</ng-container>

		<ng-template #text>
			<span>
				{{value.value}}
			</span>
		</ng-template>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: Attribute,
                args: ['bold']
            }] }, { type: undefined, decorators: [{
                type: Attribute,
                args: ['italic']
            }] }, { type: i0.ElementRef }, { type: i0.Renderer2 }]; }, { value: [{
            type: Input
        }] }); })();

class FunctionViewComponent extends PureComponent {
    constructor(sanitizer, elRef) {
        super(elRef);
        this.sanitizer = sanitizer;
        this.elRef = elRef;
        this.addClassToHost('gui-h-full');
        this.addClassToHost('gui-w-full');
    }
    ngOnChanges() {
        this.safeHTML = this.sanitizer.bypassSecurityTrustHtml(this.element.value);
    }
    getSelectorName() {
        return 'gui-function-view';
    }
}
FunctionViewComponent.ɵfac = function FunctionViewComponent_Factory(t) { return new (t || FunctionViewComponent)(i0.ɵɵdirectiveInject(i1$3.DomSanitizer), i0.ɵɵdirectiveInject(i0.ElementRef)); };
FunctionViewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: FunctionViewComponent, selectors: [["gui-function-view"]], inputs: { element: "element" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], decls: 1, vars: 1, consts: [[1, "gui-h-full", "gui-flex", "gui-items-center", 3, "innerHTML"]], template: function FunctionViewComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelement(0, "div", 0);
    } if (rf & 2) {
        i0.ɵɵproperty("innerHTML", ctx.safeHTML, i0.ɵɵsanitizeHtml);
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(FunctionViewComponent, [{
        type: Component,
        args: [{
                selector: 'gui-function-view',
                template: `

		<div class="gui-h-full gui-flex gui-items-center"
			 [innerHTML]="safeHTML">
		</div>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i1$3.DomSanitizer }, { type: i0.ElementRef }]; }, { element: [{
            type: Input
        }] }); })();

const _c0$7 = ["value", ""];
class PercentageViewComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
    }
    getSelectorName() {
        return 'gui-percentage-view';
    }
}
PercentageViewComponent.ɵfac = function PercentageViewComponent_Factory(t) { return new (t || PercentageViewComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
PercentageViewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: PercentageViewComponent, selectors: [["gui-percentage-view", "value", ""]], inputs: { value: "value" }, features: [i0.ɵɵInheritDefinitionFeature], attrs: _c0$7, decls: 1, vars: 1, template: function PercentageViewComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtext(0);
    } if (rf & 2) {
        i0.ɵɵtextInterpolate1(" ", ctx.value, " % ");
    } }, encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(PercentageViewComponent, [{
        type: Component,
        args: [{
                selector: 'gui-percentage-view[value]',
                template: `
		{{ value }} %
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { value: [{
            type: Input
        }] }); })();

const _c0$6 = ["value", ""];
function BarViewComponent_gui_percentage_view_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-percentage-view", 3);
} if (rf & 2) {
    const ctx_r0 = i0.ɵɵnextContext();
    i0.ɵɵproperty("value", ctx_r0.value);
} }
class BarViewComponent extends PureComponent {
    constructor(elementRef) {
        super(elementRef);
        this.showPercentage = false;
    }
    ngOnChanges(changes) {
        if (changes.value !== undefined && changes.value !== null) {
            this.width = this.value > 100 ? 100 : this.value;
        }
    }
    getSelectorName() {
        return 'gui-bar-view';
    }
}
BarViewComponent.ɵfac = function BarViewComponent_Factory(t) { return new (t || BarViewComponent)(i0.ɵɵdirectiveInject(i0.ElementRef)); };
BarViewComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: BarViewComponent, selectors: [["gui-bar-view", "value", ""]], inputs: { value: "value", showPercentage: "showPercentage" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature], attrs: _c0$6, decls: 3, vars: 3, consts: [[1, "gui-percentage-bar"], [1, "gui-percentage"], [3, "value", 4, "ngIf"], [3, "value"]], template: function BarViewComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "div", 0);
        i0.ɵɵelement(1, "div", 1);
        i0.ɵɵtemplate(2, BarViewComponent_gui_percentage_view_2_Template, 1, 1, "gui-percentage-view", 2);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵstyleProp("width", ctx.width, "%");
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("ngIf", ctx.showPercentage);
    } }, directives: [i4.NgIf, PercentageViewComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(BarViewComponent, [{
        type: Component,
        args: [{
                selector: 'gui-bar-view[value]',
                template: `
		<div class="gui-percentage-bar">
			<div class="gui-percentage" [style.width.%]="width">
			</div>
			<gui-percentage-view *ngIf="showPercentage"
								 [value]="value">
			</gui-percentage-view>
		</div>
	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ElementRef }]; }, { value: [{
            type: Input
        }], showPercentage: [{
            type: Input
        }] }); })();

const _c0$5 = ["text"];
const _c1$1 = ["number"];
const _c2$1 = ["chip"];
const _c3$1 = ["link"];
const _c4$1 = ["image"];
const _c5 = ["checkbox"];
const _c6 = ["bold"];
const _c7 = ["italic"];
const _c8 = ["custom"];
const _c9 = ["function"];
const _c10 = ["date"];
const _c11 = ["bar"];
const _c12 = ["percentageBar"];
const _c13 = ["percentage"];
function ViewTemplatesComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-view-text", 14);
} if (rf & 2) {
    const element_r28 = ctx.element;
    i0.ɵɵproperty("value", element_r28);
} }
function ViewTemplatesComponent_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 15);
    i0.ɵɵtext(1);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const element_r29 = ctx.element;
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate1(" ", element_r29.value, " ");
} }
function ViewTemplatesComponent_ng_template_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "gui-chip");
    i0.ɵɵelement(1, "gui-view-text", 14);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const element_r30 = ctx.element;
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("value", element_r30);
} }
function ViewTemplatesComponent_ng_template_6_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "a", 16);
    i0.ɵɵelement(1, "gui-view-text", 14);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const element_r31 = ctx.element;
    i0.ɵɵpropertyInterpolate("href", element_r31.value, i0.ɵɵsanitizeUrl);
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("value", element_r31);
} }
function ViewTemplatesComponent_ng_template_8_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "img", 17);
} if (rf & 2) {
    const element_r32 = ctx.element;
    i0.ɵɵpropertyInterpolate("src", element_r32.value, i0.ɵɵsanitizeUrl);
} }
function ViewTemplatesComponent_ng_template_10_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 18);
    i0.ɵɵelement(1, "gui-checkbox", 19);
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const element_r33 = ctx.element;
    i0.ɵɵadvance(1);
    i0.ɵɵproperty("checked", !!element_r33.value)("disabled", true);
} }
function ViewTemplatesComponent_ng_template_12_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-view-text", 20);
} if (rf & 2) {
    const element_r34 = ctx.element;
    i0.ɵɵproperty("value", element_r34);
} }
function ViewTemplatesComponent_ng_template_14_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-view-text", 21);
} if (rf & 2) {
    const element_r35 = ctx.element;
    i0.ɵɵproperty("value", element_r35);
} }
function ViewTemplatesComponent_ng_template_16_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵtext(0);
} if (rf & 2) {
    const element_r36 = ctx.element;
    i0.ɵɵtextInterpolate1(" ", element_r36.value, " ");
} }
function ViewTemplatesComponent_ng_template_18_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-function-view", 22);
} if (rf & 2) {
    const element_r37 = ctx.element;
    i0.ɵɵproperty("element", element_r37);
} }
function ViewTemplatesComponent_ng_template_20_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelementStart(0, "span", 23);
    i0.ɵɵtext(1);
    i0.ɵɵpipe(2, "date");
    i0.ɵɵelementEnd();
} if (rf & 2) {
    const element_r38 = ctx.element;
    i0.ɵɵadvance(1);
    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(2, 1, element_r38.value, "dd/MM/yyyy"));
} }
function ViewTemplatesComponent_ng_template_22_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-bar-view", 24);
} if (rf & 2) {
    const element_r39 = ctx.element;
    i0.ɵɵproperty("value", element_r39.value)("showPercentage", false);
} }
function ViewTemplatesComponent_ng_template_24_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-bar-view", 24);
} if (rf & 2) {
    const element_r40 = ctx.element;
    i0.ɵɵproperty("value", element_r40.value)("showPercentage", true);
} }
function ViewTemplatesComponent_ng_template_26_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-percentage-view", 14);
} if (rf & 2) {
    const element_r41 = ctx.element;
    i0.ɵɵproperty("value", element_r41.value);
} }
class ViewTemplatesComponent {
    getTemplate(view) {
        switch (view) {
            case CellView.TEXT:
                return this.textTemplate;
            case CellView.NUMBER:
                return this.numberTemplate;
            case CellView.CHIP:
                return this.chipTemplate;
            case CellView.LINK:
                return this.linkTemplate;
            case CellView.IMAGE:
                return this.imageTemplate;
            case CellView.CHECKBOX:
                return this.checkboxTemplate;
            case CellView.BOLD:
                return this.boldTemplate;
            case CellView.ITALIC:
                return this.italicTemplate;
            case CellView.CUSTOM:
                return this.customTemplate;
            case CellView.FUNCTION:
                return this.functionTemplate;
            case CellView.DATE:
                return this.dateTemplate;
            case CellView.BAR:
                return this.barTemplate;
            case CellView.PERCENTAGE_BAR:
                return this.percentageBarTemplate;
            case CellView.PERCENTAGE:
                return this.percentageTemplate;
            default:
                return this.textTemplate;
        }
    }
}
ViewTemplatesComponent.ɵfac = function ViewTemplatesComponent_Factory(t) { return new (t || ViewTemplatesComponent)(); };
ViewTemplatesComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ViewTemplatesComponent, selectors: [["ng-component"]], viewQuery: function ViewTemplatesComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$5, 7, TemplateRef);
        i0.ɵɵviewQuery(_c1$1, 7, TemplateRef);
        i0.ɵɵviewQuery(_c2$1, 7, TemplateRef);
        i0.ɵɵviewQuery(_c3$1, 7, TemplateRef);
        i0.ɵɵviewQuery(_c4$1, 7, TemplateRef);
        i0.ɵɵviewQuery(_c5, 7, TemplateRef);
        i0.ɵɵviewQuery(_c6, 7, TemplateRef);
        i0.ɵɵviewQuery(_c7, 7, TemplateRef);
        i0.ɵɵviewQuery(_c8, 7, TemplateRef);
        i0.ɵɵviewQuery(_c9, 7, TemplateRef);
        i0.ɵɵviewQuery(_c10, 7, TemplateRef);
        i0.ɵɵviewQuery(_c11, 7, TemplateRef);
        i0.ɵɵviewQuery(_c12, 7, TemplateRef);
        i0.ɵɵviewQuery(_c13, 7, TemplateRef);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.textTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.numberTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.chipTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.linkTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.imageTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.checkboxTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.boldTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.italicTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.customTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.functionTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dateTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.barTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.percentageBarTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.percentageTemplate = _t.first);
    } }, decls: 28, vars: 0, consts: [["text", ""], ["number", ""], ["chip", ""], ["link", ""], ["image", ""], ["checkbox", ""], ["bold", ""], ["italic", ""], ["custom", ""], ["function", ""], ["date", ""], ["bar", ""], ["percentageBar", ""], ["percentage", ""], [3, "value"], [1, "gui-cell-number"], ["gui-button", "", "link", "true", 3, "href"], [3, "src"], [1, "gui-cell-boolean"], [3, "checked", "disabled"], ["bold", "", 3, "value"], ["italic", "", 3, "value"], [3, "element"], [1, "gui-view-text"], [3, "value", "showPercentage"]], template: function ViewTemplatesComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, ViewTemplatesComponent_ng_template_0_Template, 1, 1, "ng-template", null, 0, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(2, ViewTemplatesComponent_ng_template_2_Template, 2, 1, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(4, ViewTemplatesComponent_ng_template_4_Template, 2, 1, "ng-template", null, 2, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(6, ViewTemplatesComponent_ng_template_6_Template, 2, 2, "ng-template", null, 3, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(8, ViewTemplatesComponent_ng_template_8_Template, 1, 1, "ng-template", null, 4, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(10, ViewTemplatesComponent_ng_template_10_Template, 2, 2, "ng-template", null, 5, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(12, ViewTemplatesComponent_ng_template_12_Template, 1, 1, "ng-template", null, 6, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(14, ViewTemplatesComponent_ng_template_14_Template, 1, 1, "ng-template", null, 7, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(16, ViewTemplatesComponent_ng_template_16_Template, 1, 1, "ng-template", null, 8, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(18, ViewTemplatesComponent_ng_template_18_Template, 1, 1, "ng-template", null, 9, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(20, ViewTemplatesComponent_ng_template_20_Template, 3, 4, "ng-template", null, 10, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(22, ViewTemplatesComponent_ng_template_22_Template, 1, 2, "ng-template", null, 11, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(24, ViewTemplatesComponent_ng_template_24_Template, 1, 2, "ng-template", null, 12, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(26, ViewTemplatesComponent_ng_template_26_Template, 1, 1, "ng-template", null, 13, i0.ɵɵtemplateRefExtractor);
    } }, directives: [TextViewComponent, i1.FabricChipComponent, i1.FabricButtonComponent, i1.FabricCheckboxComponent, FunctionViewComponent, BarViewComponent, PercentageViewComponent], pipes: [i4.DatePipe], encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ViewTemplatesComponent, [{
        type: Component,
        args: [{
                template: `

		<ng-template #text let-element="element">
			<gui-view-text [value]="element"></gui-view-text>
		</ng-template>

		<ng-template #number let-element="element">
			<span class="gui-cell-number">
				{{ element.value }}
			</span>
		</ng-template>

		<ng-template #chip let-element="element">
			<gui-chip>
				<gui-view-text [value]="element"></gui-view-text>
			</gui-chip>
		</ng-template>

		<ng-template #link let-element="element">
			<a gui-button link="true" href="{{ element.value }}">
				<gui-view-text [value]="element"></gui-view-text>
			</a>
		</ng-template>

		<ng-template #image let-element="element">
			<img src="{{ element.value }}"/>
		</ng-template>

		<ng-template #checkbox let-element="element">
			<span class="gui-cell-boolean">
				<gui-checkbox [checked]="!!element.value" [disabled]="true"></gui-checkbox>
			</span>
		</ng-template>

		<ng-template #bold let-element="element">
			<gui-view-text bold [value]="element"></gui-view-text>
		</ng-template>

		<ng-template #italic let-element="element">
			<gui-view-text italic [value]="element"></gui-view-text>
		</ng-template>

		<ng-template #custom let-element="element">
			{{ element.value }}
		</ng-template>

		<ng-template #function let-element="element">
			<gui-function-view [element]="element"></gui-function-view>
		</ng-template>

		<ng-template #date let-element="element">
			<span class="gui-view-text">{{ element.value | date: 'dd/MM/yyyy' }}</span>
		</ng-template>

		<ng-template #bar let-element="element">
			<gui-bar-view [value]="element.value" [showPercentage]="false"></gui-bar-view>
		</ng-template>

		<ng-template #percentageBar let-element="element">
			<gui-bar-view [value]="element.value" [showPercentage]="true"></gui-bar-view>
		</ng-template>

		<ng-template #percentage let-element="element">
			<gui-percentage-view [value]="element.value"></gui-percentage-view>
		</ng-template>

	`
            }]
    }], null, { textTemplate: [{
            type: ViewChild,
            args: ['text', { read: TemplateRef, static: true }]
        }], numberTemplate: [{
            type: ViewChild,
            args: ['number', { read: TemplateRef, static: true }]
        }], chipTemplate: [{
            type: ViewChild,
            args: ['chip', { read: TemplateRef, static: true }]
        }], linkTemplate: [{
            type: ViewChild,
            args: ['link', { read: TemplateRef, static: true }]
        }], imageTemplate: [{
            type: ViewChild,
            args: ['image', { read: TemplateRef, static: true }]
        }], checkboxTemplate: [{
            type: ViewChild,
            args: ['checkbox', { read: TemplateRef, static: true }]
        }], boldTemplate: [{
            type: ViewChild,
            args: ['bold', { read: TemplateRef, static: true }]
        }], italicTemplate: [{
            type: ViewChild,
            args: ['italic', { read: TemplateRef, static: true }]
        }], customTemplate: [{
            type: ViewChild,
            args: ['custom', { read: TemplateRef, static: true }]
        }], functionTemplate: [{
            type: ViewChild,
            args: ['function', { read: TemplateRef, static: true }]
        }], dateTemplate: [{
            type: ViewChild,
            args: ['date', { read: TemplateRef, static: true }]
        }], barTemplate: [{
            type: ViewChild,
            args: ['bar', { read: TemplateRef, static: true }]
        }], percentageBarTemplate: [{
            type: ViewChild,
            args: ['percentageBar', { read: TemplateRef, static: true }]
        }], percentageTemplate: [{
            type: ViewChild,
            args: ['percentage', { read: TemplateRef, static: true }]
        }] }); })();

class TemplateFactory {
    constructor(templatesComponentDefinition, componentFactoryResolver) {
        this.templatesComponentDefinition = templatesComponentDefinition;
        this.componentFactoryResolver = componentFactoryResolver;
        this.templates = new Map();
        this.templatesComponent = null;
        this.createTemplatesComponent();
    }
    getTemplates() {
        return this.templates;
    }
    destroy() {
        if (this.templatesComponent) {
            this.templatesComponent.destroy();
            this.templatesComponent = null;
        }
    }
    createTemplatesComponent() {
        const componentFactory = this.componentFactoryResolver.resolveComponentFactory(this.templatesComponentDefinition);
        const injector = Injector.create({ providers: [] });
        this.templatesComponent = componentFactory.create(injector);
        this.generateMap();
    }
    generateMap() {
        this.generateMapKeys()
            .forEach((type) => {
            this.findAndSetTemplate(type);
        });
    }
    ;
    findAndSetTemplate(dt) {
        const template = this.templatesComponent.instance.getTemplate(dt);
        this.templates.set(dt, template);
    }
}

class ViewTemplateFactory extends TemplateFactory {
    constructor(componentFactoryResolver) {
        super(ViewTemplatesComponent, componentFactoryResolver);
    }
    generateMapKeys() {
        return Object.keys(CellView)
            .map(key => CellView[key]);
    }
}
ViewTemplateFactory.ɵfac = function ViewTemplateFactory_Factory(t) { return new (t || ViewTemplateFactory)(i0.ɵɵinject(i0.ComponentFactoryResolver)); };
ViewTemplateFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ViewTemplateFactory, factory: ViewTemplateFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ViewTemplateFactory, [{
        type: Injectable
    }], function () { return [{ type: i0.ComponentFactoryResolver }]; }, null); })();

class ViewTemplateRepository {
    constructor(columnTemplateFactory) {
        this.columnTemplateFactory = columnTemplateFactory;
    }
    findTemplate(view) {
        const typeToTemplate = this.columnTemplateFactory.getTemplates();
        return typeToTemplate.get(view);
    }
}
ViewTemplateRepository.ɵfac = function ViewTemplateRepository_Factory(t) { return new (t || ViewTemplateRepository)(i0.ɵɵinject(ViewTemplateFactory)); };
ViewTemplateRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ViewTemplateRepository, factory: ViewTemplateRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ViewTemplateRepository, [{
        type: Injectable
    }], function () { return [{ type: ViewTemplateFactory }]; }, null); })();

class EditCommunicationComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef) {
        super(changeDetectorRef, elementRef);
        this.ENTER_KEY_CODE = 13;
        this.ESC_KEY_CODE = 27;
    }
    submit() {
        this.emitStatus(EditEventType.SUBMIT);
    }
    cancel() {
        this.emitStatus(EditEventType.CANCEL);
    }
    emitStatus(status) {
        if (this.status) {
            this.status.emit(status);
        }
    }
}
EditCommunicationComponent.ɵfac = function EditCommunicationComponent_Factory(t) { return new (t || EditCommunicationComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
EditCommunicationComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: EditCommunicationComponent, inputs: { value: "value", valueChanges: "valueChanges", status: "status", focus: "focus", parent: "parent" }, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(EditCommunicationComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, { value: [{
            type: Input
        }], valueChanges: [{
            type: Input
        }], status: [{
            type: Input
        }], focus: [{
            type: Input
        }], parent: [{
            type: Input
        }] }); })();

const _c0$4 = ["input"];
class InputEditTemplateComponent extends EditCommunicationComponent {
    constructor(changeDetectorRef, elementRef, formBuilder) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.formBuilder = formBuilder;
        this.filterFieldName = 'phrase';
        this.filterForm = this.formBuilder.group({
            [this.filterFieldName]: ['']
        });
    }
    ngOnChanges(changes) {
        if (changes.value !== undefined) {
            this.filterForm.get(this.filterFieldName).setValue(this.value);
        }
    }
    ngOnInit() {
        this.observeChanges();
    }
    ngAfterViewInit() {
        const inputElement = this.inputRef.nativeElement;
        this.focusField(inputElement);
        this.emitValueChange(inputElement.value);
        hermesFromEvent(inputElement, 'blur')
            .pipe(this.hermesTakeUntil())
            .subscribe(() => {
            this.unsubscribe();
            this.submit();
        });
        const keyup$ = hermesFromEvent(inputElement, 'keyup');
        keyup$
            .pipe(hermesFilter((e) => e.keyCode === this.ENTER_KEY_CODE), this.hermesTakeUntil())
            .subscribe(() => {
            this.unsubscribe();
            this.submit();
        });
        keyup$
            .pipe(hermesFilter((e) => e.keyCode === this.ESC_KEY_CODE), this.hermesTakeUntil())
            .subscribe(() => {
            this.unsubscribe();
            this.cancel();
        });
    }
    focusField(inputElement) {
        if (this.focus) {
            inputElement.focus();
        }
    }
    observeChanges() {
        fromRxJsObservable(this.filterForm
            .controls[this.filterFieldName]
            .valueChanges)
            .pipe(this.hermesTakeUntil())
            .subscribe((value) => {
            this.emitValueChange(value);
        });
    }
    emitValueChange(value) {
        if (this.valueChanges) {
            this.valueChanges.emit(value);
        }
    }
}
InputEditTemplateComponent.ɵfac = function InputEditTemplateComponent_Factory(t) { return new (t || InputEditTemplateComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1$2.FormBuilder)); };
InputEditTemplateComponent.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: InputEditTemplateComponent, viewQuery: function InputEditTemplateComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$4, 7);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.inputRef = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InputEditTemplateComponent, [{
        type: Directive
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i1$2.FormBuilder }]; }, { inputRef: [{
            type: ViewChild,
            args: ['input', { static: true }]
        }] }); })();

class StringEditTemplateComponent extends InputEditTemplateComponent {
    constructor(changeDetectorRef, elementRef, fb) {
        super(changeDetectorRef, elementRef, fb);
    }
    focusField(inputElement) {
        if (this.focus) {
            inputElement.focus();
            inputElement.setSelectionRange(0, inputElement.value.length);
        }
    }
    getSelectorName() {
        return 'gui-string-edit';
    }
}
StringEditTemplateComponent.ɵfac = function StringEditTemplateComponent_Factory(t) { return new (t || StringEditTemplateComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1$2.FormBuilder)); };
StringEditTemplateComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: StringEditTemplateComponent, selectors: [["gui-string-edit"]], features: [i0.ɵɵInheritDefinitionFeature], decls: 3, vars: 2, consts: [[3, "formGroup"], ["type", "type", 1, "gui-input", 3, "formControlName"], ["input", ""]], template: function StringEditTemplateComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "form", 0);
        i0.ɵɵelement(1, "input", 1, 2);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("formGroup", ctx.filterForm);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("formControlName", ctx.filterFieldName);
    } }, directives: [i1$2.ɵNgNoValidate, i1$2.NgControlStatusGroup, i1$2.FormGroupDirective, i1$2.DefaultValueAccessor, i1$2.NgControlStatus, i1$2.FormControlName], encapsulation: 2, changeDetection: 0 });
__decorate([
    Override
], StringEditTemplateComponent.prototype, "focusField", null);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StringEditTemplateComponent, [{
        type: Component,
        args: [{
                selector: 'gui-string-edit',
                template: `

		<form [formGroup]="filterForm">
			<input #input [formControlName]="filterFieldName" type="type" class="gui-input"/>
		</form>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i1$2.FormBuilder }]; }, { focusField: [] }); })();

class NumberEditTemplateComponent extends InputEditTemplateComponent {
    constructor(changeDetectorRef, elementRef, fb) {
        super(changeDetectorRef, elementRef, fb);
    }
    getSelectorName() {
        return 'gui-number-edit';
    }
}
NumberEditTemplateComponent.ɵfac = function NumberEditTemplateComponent_Factory(t) { return new (t || NumberEditTemplateComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i1$2.FormBuilder)); };
NumberEditTemplateComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: NumberEditTemplateComponent, selectors: [["gui-number-edit"]], features: [i0.ɵɵInheritDefinitionFeature], decls: 3, vars: 2, consts: [[3, "formGroup"], ["type", "number", 1, "gui-input", 3, "formControlName"], ["input", ""]], template: function NumberEditTemplateComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "form", 0);
        i0.ɵɵelement(1, "input", 1, 2);
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("formGroup", ctx.filterForm);
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("formControlName", ctx.filterFieldName);
    } }, directives: [i1$2.ɵNgNoValidate, i1$2.NgControlStatusGroup, i1$2.FormGroupDirective, i1$2.NumberValueAccessor, i1$2.DefaultValueAccessor, i1$2.NgControlStatus, i1$2.FormControlName], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(NumberEditTemplateComponent, [{
        type: Component,
        args: [{
                selector: 'gui-number-edit',
                template: `

		<form [formGroup]="filterForm">
			<input #input [formControlName]="filterFieldName" type="number" class="gui-input"/>
		</form>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i1$2.FormBuilder }]; }, null); })();

const _c0$3 = ["checkbox"];
class BooleanEditTemplateComponent extends EditCommunicationComponent {
    constructor(changeDetectorRef, elementRef) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.filterFieldName = 'booleanEdit';
    }
    toggle(changed) {
        this.valueChanges.emit(changed);
        this.submit();
    }
    getSelectorName() {
        return 'gui-boolean-edit';
    }
}
BooleanEditTemplateComponent.ɵfac = function BooleanEditTemplateComponent_Factory(t) { return new (t || BooleanEditTemplateComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
BooleanEditTemplateComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: BooleanEditTemplateComponent, selectors: [["gui-boolean-edit"]], viewQuery: function BooleanEditTemplateComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$3, 7, ElementRef);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.checkboxRef = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], decls: 3, vars: 2, consts: [[1, "gui-cell-boolean"], [3, "checked", "name", "changed"], ["checkbox", ""]], template: function BooleanEditTemplateComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "span", 0);
        i0.ɵɵelementStart(1, "gui-checkbox", 1, 2);
        i0.ɵɵlistener("changed", function BooleanEditTemplateComponent_Template_gui_checkbox_changed_1_listener($event) { return ctx.toggle($event); });
        i0.ɵɵelementEnd();
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵadvance(1);
        i0.ɵɵproperty("checked", ctx.value)("name", ctx.filterFieldName);
    } }, directives: [i1.FabricCheckboxComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(BooleanEditTemplateComponent, [{
        type: Component,
        args: [{
                selector: 'gui-boolean-edit',
                template: `

		<span class="gui-cell-boolean">
			<gui-checkbox #checkbox
						  [checked]="value"
						  [name]="filterFieldName"
						  (changed)="toggle($event)">
			</gui-checkbox>
		</span>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, { checkboxRef: [{
            type: ViewChild,
            args: ['checkbox', { read: ElementRef, static: true }]
        }] }); })();

const _c0$2 = ["datepicker"];
class DateEditTemplateComponent extends EditCommunicationComponent {
    constructor(changeDetectorRef, elementRef) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.filterFieldName = 'dateEdit';
        this.opened = false;
        this.localStreamCloser = new StreamCloser();
    }
    ngAfterViewInit() {
        const inputElement = this.datePickerRef.nativeElement.querySelector('.gui-date-picker-input');
        const keyup$ = hermesFromEvent(inputElement, 'keyup');
        keyup$
            .pipe(hermesFilter((e) => e.keyCode === this.ENTER_KEY_CODE), this.localStreamCloser.takeUntil())
            .subscribe(() => {
            this.localStreamCloser.unsubscribe();
            this.submit();
        });
        keyup$
            .pipe(hermesFilter((e) => e.keyCode === this.ESC_KEY_CODE), this.localStreamCloser.takeUntil())
            .subscribe(() => {
            this.localStreamCloser.unsubscribe();
            this.cancel();
        });
    }
    ngOnDestroy() {
        this.localStreamCloser.unsubscribe();
        super.ngOnDestroy();
    }
    toggle(changed) {
        this.valueChanges.emit(changed);
    }
    dialogOpened(opened) {
        this.opened = opened;
        if (!opened) {
            this.localStreamCloser.unsubscribe();
            this.submit();
        }
    }
    getSelectorName() {
        return 'gui-date-edit';
    }
}
DateEditTemplateComponent.ɵfac = function DateEditTemplateComponent_Factory(t) { return new (t || DateEditTemplateComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i0.ElementRef)); };
DateEditTemplateComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: DateEditTemplateComponent, selectors: [["gui-date-edit"]], viewQuery: function DateEditTemplateComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$2, 7, ElementRef);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.datePickerRef = _t.first);
    } }, features: [i0.ɵɵInheritDefinitionFeature], decls: 2, vars: 5, consts: [[3, "selectDate", "name", "openDialog", "onlyDialog", "parentElement", "dialogOpened", "dateSelected"], ["datepicker", ""]], template: function DateEditTemplateComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵelementStart(0, "gui-date-picker", 0, 1);
        i0.ɵɵlistener("dialogOpened", function DateEditTemplateComponent_Template_gui_date_picker_dialogOpened_0_listener($event) { return ctx.dialogOpened($event); })("dateSelected", function DateEditTemplateComponent_Template_gui_date_picker_dateSelected_0_listener($event) { return ctx.toggle($event); });
        i0.ɵɵelementEnd();
    } if (rf & 2) {
        i0.ɵɵproperty("selectDate", ctx.value)("name", ctx.filterFieldName)("openDialog", true)("onlyDialog", false)("parentElement", ctx.parent);
    } }, directives: [i1.FabricDatePickerComponent], encapsulation: 2, changeDetection: 0 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DateEditTemplateComponent, [{
        type: Component,
        args: [{
                selector: 'gui-date-edit',
                template: `

		<gui-date-picker #datepicker
						 [selectDate]="value"
						 [name]="filterFieldName"
						 [openDialog]="true"
						 [onlyDialog]="false"
						 [parentElement]="parent"
						 (dialogOpened)="dialogOpened($event)"
						 (dateSelected)="toggle($event)">
		</gui-date-picker>

	`,
                changeDetection: ChangeDetectionStrategy.OnPush,
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }]; }, { datePickerRef: [{
            type: ViewChild,
            args: ['datepicker', { read: ElementRef, static: true }]
        }] }); })();

const _c0$1 = ["string"];
const _c1 = ["number"];
const _c2 = ["boolean"];
const _c3 = ["date"];
const _c4 = ["empty"];
function EditTemplatesComponent_ng_template_0_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-string-edit", 5);
} if (rf & 2) {
    const valueChanges_r10 = ctx.valueChanges;
    const value_r11 = ctx.value;
    const status_r12 = ctx.status;
    const focus_r13 = ctx.focus;
    i0.ɵɵproperty("valueChanges", valueChanges_r10)("value", value_r11)("status", status_r12)("focus", focus_r13);
} }
function EditTemplatesComponent_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-number-edit", 5);
} if (rf & 2) {
    const valueChanges_r14 = ctx.valueChanges;
    const value_r15 = ctx.value;
    const status_r16 = ctx.status;
    const focus_r17 = ctx.focus;
    i0.ɵɵproperty("valueChanges", valueChanges_r14)("value", value_r15)("status", status_r16)("focus", focus_r17);
} }
function EditTemplatesComponent_ng_template_4_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-boolean-edit", 5);
} if (rf & 2) {
    const valueChanges_r18 = ctx.valueChanges;
    const value_r19 = ctx.value;
    const status_r20 = ctx.status;
    const focus_r21 = ctx.focus;
    i0.ɵɵproperty("valueChanges", valueChanges_r18)("value", value_r19)("status", status_r20)("focus", focus_r21);
} }
function EditTemplatesComponent_ng_template_6_Template(rf, ctx) { if (rf & 1) {
    i0.ɵɵelement(0, "gui-date-edit", 6);
} if (rf & 2) {
    const valueChanges_r22 = ctx.valueChanges;
    const value_r23 = ctx.value;
    const status_r24 = ctx.status;
    const focus_r25 = ctx.focus;
    const parent_r26 = ctx.parent;
    i0.ɵɵproperty("valueChanges", valueChanges_r22)("value", value_r23)("status", status_r24)("focus", focus_r25)("parent", parent_r26);
} }
function EditTemplatesComponent_ng_template_8_Template(rf, ctx) { }
class EditTemplatesComponent {
    getTemplate(dataType) {
        switch (dataType) {
            case DataType.STRING:
                return this.stringTemplate;
            case DataType.NUMBER:
                return this.numberTemplate;
            case DataType.BOOLEAN:
                return this.booleanTemplate;
            case DataType.DATE:
                return this.dateTemplate;
            default:
                return this.emptyTemplate;
        }
    }
}
EditTemplatesComponent.ɵfac = function EditTemplatesComponent_Factory(t) { return new (t || EditTemplatesComponent)(); };
EditTemplatesComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: EditTemplatesComponent, selectors: [["ng-component"]], viewQuery: function EditTemplatesComponent_Query(rf, ctx) { if (rf & 1) {
        i0.ɵɵviewQuery(_c0$1, 7, TemplateRef);
        i0.ɵɵviewQuery(_c1, 7, TemplateRef);
        i0.ɵɵviewQuery(_c2, 7, TemplateRef);
        i0.ɵɵviewQuery(_c3, 7, TemplateRef);
        i0.ɵɵviewQuery(_c4, 7, TemplateRef);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.stringTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.numberTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.booleanTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.dateTemplate = _t.first);
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.emptyTemplate = _t.first);
    } }, decls: 10, vars: 0, consts: [["string", ""], ["number", ""], ["boolean", ""], ["date", ""], ["empty", ""], [3, "valueChanges", "value", "status", "focus"], [3, "valueChanges", "value", "status", "focus", "parent"]], template: function EditTemplatesComponent_Template(rf, ctx) { if (rf & 1) {
        i0.ɵɵtemplate(0, EditTemplatesComponent_ng_template_0_Template, 1, 4, "ng-template", null, 0, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(2, EditTemplatesComponent_ng_template_2_Template, 1, 4, "ng-template", null, 1, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(4, EditTemplatesComponent_ng_template_4_Template, 1, 4, "ng-template", null, 2, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(6, EditTemplatesComponent_ng_template_6_Template, 1, 5, "ng-template", null, 3, i0.ɵɵtemplateRefExtractor);
        i0.ɵɵtemplate(8, EditTemplatesComponent_ng_template_8_Template, 0, 0, "ng-template", null, 4, i0.ɵɵtemplateRefExtractor);
    } }, directives: [StringEditTemplateComponent, NumberEditTemplateComponent, BooleanEditTemplateComponent, DateEditTemplateComponent], encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(EditTemplatesComponent, [{
        type: Component,
        args: [{
                template: `

		<ng-template #string let-valueChanges="valueChanges" let-value="value" let-status="status" let-focus="focus">
			<gui-string-edit [valueChanges]="valueChanges" [value]="value" [status]="status" [focus]="focus">
			</gui-string-edit>
		</ng-template>

		<ng-template #number let-valueChanges="valueChanges" let-value="value" let-status="status" let-focus="focus">
			<gui-number-edit [valueChanges]="valueChanges" [value]="value" [status]="status" [focus]="focus">
			</gui-number-edit>
		</ng-template>

		<ng-template #boolean let-valueChanges="valueChanges" let-value="value" let-status="status" let-focus="focus">
			<gui-boolean-edit [valueChanges]="valueChanges" [value]="value" [status]="status" [focus]="focus">
			</gui-boolean-edit>
		</ng-template>

		<ng-template #date let-valueChanges="valueChanges" let-value="value" let-status="status" let-focus="focus" let-parent="parent">
			<gui-date-edit [valueChanges]="valueChanges" [value]="value" [status]="status" [focus]="focus" [parent]="parent">
			</gui-date-edit>
		</ng-template>

		<ng-template #empty>

		</ng-template>

	`
            }]
    }], null, { stringTemplate: [{
            type: ViewChild,
            args: ['string', { read: TemplateRef, static: true }]
        }], numberTemplate: [{
            type: ViewChild,
            args: ['number', { read: TemplateRef, static: true }]
        }], booleanTemplate: [{
            type: ViewChild,
            args: ['boolean', { read: TemplateRef, static: true }]
        }], dateTemplate: [{
            type: ViewChild,
            args: ['date', { read: TemplateRef, static: true }]
        }], emptyTemplate: [{
            type: ViewChild,
            args: ['empty', { read: TemplateRef, static: true }]
        }] }); })();

class EditTemplateFactory extends TemplateFactory {
    constructor(componentFactoryResolver) {
        super(EditTemplatesComponent, componentFactoryResolver);
    }
    generateMapKeys() {
        return Object.keys(DataType)
            .map(key => DataType[key]);
    }
}
EditTemplateFactory.ɵfac = function EditTemplateFactory_Factory(t) { return new (t || EditTemplateFactory)(i0.ɵɵinject(i0.ComponentFactoryResolver)); };
EditTemplateFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: EditTemplateFactory, factory: EditTemplateFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(EditTemplateFactory, [{
        type: Injectable
    }], function () { return [{ type: i0.ComponentFactoryResolver }]; }, null); })();

class EditTemplateRepository {
    constructor(editTemplateFactory) {
        this.editTemplateFactory = editTemplateFactory;
    }
    findTemplate(dataType) {
        const typeToTemplate = this.editTemplateFactory.getTemplates();
        return typeToTemplate.get(dataType);
    }
}
EditTemplateRepository.ɵfac = function EditTemplateRepository_Factory(t) { return new (t || EditTemplateRepository)(i0.ɵɵinject(EditTemplateFactory)); };
EditTemplateRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: EditTemplateRepository, factory: EditTemplateRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(EditTemplateRepository, [{
        type: Injectable
    }], function () { return [{ type: EditTemplateFactory }]; }, null); })();

class ColumnDefinitionFactory {
    constructor(viewTemplateRepository, editTemplateRepository) {
        this.viewTemplateRepository = viewTemplateRepository;
        this.editTemplateRepository = editTemplateRepository;
    }
    create(column) {
        if (column instanceof ColumnEntity) {
            return this.createFromColumnEntity(column);
        }
        else {
            return this.createFromActiveColumnEntity(column);
        }
    }
    createFromColumnEntity(column) {
        const columnDef = new ColumnDefinition(column.getField(), new ColumnDefinitionId(column.getId().toString()), column.isEnabled(), column.getDataType(), column.getView(), column.getAlign(), column.getHeader(), column.isCellEditingEnabled(), column.getSortStatus(), column.isSortingEnabled());
        if (column.getCellView() === CellView.NG_TEMPLATE) {
            columnDef.cellTemplate = column.getColumnConfig().templateRef;
        }
        else {
            columnDef.cellTemplate = this.findViewTemplate(column.getCellView());
        }
        if (typeof column.getHeader() === 'function') {
            columnDef.headerTemplate = this.findViewTemplate(CellView.FUNCTION);
        }
        else {
            columnDef.headerTemplate = this.findViewTemplate(CellView.TEXT);
        }
        columnDef.setTemplateFunction(column.getTemplateFunction());
        columnDef.setFormatterFunction(column.getFormatterFunction());
        columnDef.editTemplate = this.findEditTemplate(column.getDataType());
        columnDef.width = +column.getWidth();
        return columnDef;
    }
    createFromActiveColumnEntity(activeColumn) {
        const columnDef = new ColumnDefinition(activeColumn.getField(), new ColumnDefinitionId(activeColumn.getId().toString()), true, // remove,
        activeColumn.getDataType(), activeColumn.getView(), activeColumn.getAlign(), activeColumn.getHeader(), activeColumn.isCellEditingEnabled(), activeColumn.getSortStatus(), activeColumn.isSortingEnabled());
        if (activeColumn.getCellView() === CellView.NG_TEMPLATE) {
            columnDef.cellTemplate = activeColumn.getColumnConfig().templateRef;
        }
        else {
            columnDef.cellTemplate = this.findViewTemplate(activeColumn.getCellView());
        }
        if (typeof activeColumn.getHeader() === 'function') {
            columnDef.headerTemplate = this.findViewTemplate(CellView.FUNCTION);
        }
        else {
            columnDef.headerTemplate = this.findViewTemplate(CellView.TEXT);
        }
        columnDef.setTemplateFunction(activeColumn.getTemplateFunction());
        columnDef.setFormatterFunction(activeColumn.getFormatterFunction());
        columnDef.editTemplate = this.findEditTemplate(activeColumn.getDataType());
        columnDef.width = +activeColumn.getWidth();
        return columnDef;
    }
    createColumns(columns) {
        return columns.map((column) => this.create(column));
    }
    findViewTemplate(view) {
        if (view === CellView.FUNCTION) {
            return this.viewTemplateRepository.findTemplate(CellView.FUNCTION);
        }
        else {
            return this.viewTemplateRepository.findTemplate(view);
        }
    }
    findEditTemplate(dataType) {
        return this.editTemplateRepository.findTemplate(dataType);
    }
}
ColumnDefinitionFactory.ɵfac = function ColumnDefinitionFactory_Factory(t) { return new (t || ColumnDefinitionFactory)(i0.ɵɵinject(ViewTemplateRepository), i0.ɵɵinject(EditTemplateRepository)); };
ColumnDefinitionFactory.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ColumnDefinitionFactory, factory: ColumnDefinitionFactory.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnDefinitionFactory, [{
        type: Injectable
    }], function () { return [{ type: ViewTemplateRepository }, { type: EditTemplateRepository }]; }, null); })();

class CompositionReadModelRootConverter {
    constructor(columnDefinitionFactory) {
        this.columnDefinitionFactory = columnDefinitionFactory;
    }
    convert(aggregate) {
        const ready = aggregate.isReady(), allColumns = aggregate.getColumns(), activeColumns = aggregate.getActiveColumns(), allColumnDefs = this.convertToColumnDef(allColumns), activeColumnDefs = this.convertActiveColumnsToColumnDef(activeColumns), width = aggregate.getWidth(), resizeWidth = aggregate.isResizeEnabled(), aggregateId = aggregate.getId();
        return new CompositionReadModeRoot(aggregateId.toReadModelRootId(), ready, allColumnDefs, activeColumnDefs, width, resizeWidth);
    }
    convertToColumnDef(columns) {
        const columnDefs = [];
        columns.forEach((column) => {
            const columnDef = this.columnDefinitionFactory.create(column);
            columnDefs.push(columnDef);
        });
        return columnDefs;
    }
    convertActiveColumnsToColumnDef(activeColumns) {
        const columnDefs = [];
        activeColumns.forEach((column) => {
            const columnDef = this.columnDefinitionFactory.create(column);
            columnDefs.push(columnDef);
        });
        return columnDefs;
    }
}
CompositionReadModelRootConverter.ɵfac = function CompositionReadModelRootConverter_Factory(t) { return new (t || CompositionReadModelRootConverter)(i0.ɵɵinject(ColumnDefinitionFactory)); };
CompositionReadModelRootConverter.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionReadModelRootConverter, factory: CompositionReadModelRootConverter.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionReadModelRootConverter, [{
        type: Injectable
    }], function () { return [{ type: ColumnDefinitionFactory }]; }, null); })();

class InMemoryCompositionReadStore extends InMemoryReadModelStore {
    constructor(inMemoryCompositionStore, compositionConverter) {
        super(inMemoryCompositionStore);
        this.inMemoryCompositionStore = inMemoryCompositionStore;
        this.compositionConverter = compositionConverter;
    }
    toReadModel(aggregate) {
        return this.compositionConverter.convert(aggregate);
    }
}
InMemoryCompositionReadStore.ɵfac = function InMemoryCompositionReadStore_Factory(t) { return new (t || InMemoryCompositionReadStore)(i0.ɵɵinject(InMemoryCompositionStore), i0.ɵɵinject(CompositionReadModelRootConverter)); };
InMemoryCompositionReadStore.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryCompositionReadStore, factory: InMemoryCompositionReadStore.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryCompositionReadStore, [{
        type: Injectable
    }], function () { return [{ type: InMemoryCompositionStore }, { type: CompositionReadModelRootConverter }]; }, null); })();

class CompositionReadModelRootRepository extends ReadModelRootRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
}

class InMemoryCompositionRepository extends CompositionReadModelRootRepository {
    constructor(domainEventBus, inMemoryCompositionReadStore) {
        super(domainEventBus);
        this.inMemoryCompositionReadStore = inMemoryCompositionReadStore;
        this.compositionIdToComposition = new Map();
        this.composition$ = new HermesReplaySubject(1);
    }
    on(compositionId) {
        return this.composition$
            .toObservable()
            .pipe(hermesFilter((compositionIdToComposition) => {
            const key = compositionId.getId();
            return compositionIdToComposition.has(key);
        }), hermesMap((compositionIdToComposition) => compositionIdToComposition.get(compositionId.getId())));
    }
    forEvents() {
        return [
            CompositionCreatedEvent,
            CompositionResizeWidthSetEvent,
            CompositionColumnsSetEvent,
            CompositionContainerWidthSetEvent,
            CompositionWidthSetEvent,
            CompositionColumnSetEnabledEvent,
            CompositionColumnMovedLeftEvent,
            CompositionColumnMovedRightEvent,
            CompositionChangeSortStatusEvent
        ];
    }
    subscribe(event) {
        const aggregateId = event.getAggregateId();
        const optComposition = this.inMemoryCompositionReadStore.getById(aggregateId);
        optComposition.ifPresent((composition) => {
            const key = composition.getId().toString();
            this.compositionIdToComposition.set(key, composition);
            this.composition$.next(this.compositionIdToComposition);
        });
    }
}
InMemoryCompositionRepository.ɵfac = function InMemoryCompositionRepository_Factory(t) { return new (t || InMemoryCompositionRepository)(i0.ɵɵinject(i1$1.DomainEventBus), i0.ɵɵinject(InMemoryCompositionReadStore)); };
InMemoryCompositionRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: InMemoryCompositionRepository, factory: InMemoryCompositionRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(InMemoryCompositionRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }, { type: InMemoryCompositionReadStore }]; }, null); })();

const inMemoryCompositionCommandProviders = [
    InMemoryCompositionAggregateStore,
    {
        provide: CompositionAggregateRepository,
        useClass: InMemoryCompositionAggregateRepository
    }
];
const inMemoryCompositionReadModelProviders = [
    InMemoryCompositionReadStore,
    {
        provide: CompositionReadModelRootRepository,
        useClass: InMemoryCompositionRepository
    }
];
const inMemoryCompositionProviders = [
    InMemoryCompositionStore
];

class SetGroupsCommandHandler {
    constructor(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
        this.compositionAggregateRepository = compositionAggregateRepository;
        this.domainEventPublisher = domainEventPublisher;
        this.compositionEventConverter = compositionEventConverter;
    }
    forCommand() {
        return SetGroupsCommand;
    }
    handle(aggregate, command) {
        const groupConfigs = command.getConfigs();
        aggregate.setGroups(groupConfigs);
    }
    publish(aggregate, command) {
        this.publishEvents(aggregate, command);
    }
    publishEvents(composition, command) {
        const events = composition.getEvents();
        const domainEvents = this.compositionEventConverter.convert(events);
        this.domainEventPublisher.publish(domainEvents);
    }
}
SetGroupsCommandHandler.ɵfac = function SetGroupsCommandHandler_Factory(t) { return new (t || SetGroupsCommandHandler)(i0.ɵɵinject(CompositionAggregateRepository), i0.ɵɵinject(i1$1.DomainEventPublisher), i0.ɵɵinject(CompositionEventConverter)); };
SetGroupsCommandHandler.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: SetGroupsCommandHandler, factory: SetGroupsCommandHandler.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SetGroupsCommandHandler, [{
        type: Injectable
    }], function () { return [{ type: CompositionAggregateRepository }, { type: i1$1.DomainEventPublisher }, { type: CompositionEventConverter }]; }, null); })();

class ColumnHighlightManager {
    constructor() {
        this.enabled = true;
        this.highlightedColumns = new Set(); // should be set of ColumnId
    }
    isHighlighted(columnId) {
        return this.highlightedColumns.has(columnId.toString());
    }
    toggle(columnId) {
        if (this.highlightedColumns.has(columnId.toString())) {
            this.highlightedColumns.delete(columnId.toString());
        }
        else {
            this.highlightedColumns.add(columnId.toString());
        }
    }
    remove(columnId) {
        this.highlightedColumns.delete(columnId.toString());
    }
}

class ColumnHighlightArchive extends AggregateArchive {
    constructor() {
        super(new ColumnHighlightManager());
    }
    toggle(key, value) {
        this.get(key)
            .ifPresent((manager) => {
            manager.toggle(value);
            this.next(key, manager);
        });
    }
    equals(a, b) {
        return false;
    }
    createDefaultValue(defaultValue) {
        return new ColumnHighlightManager();
    }
}
ColumnHighlightArchive.ɵfac = function ColumnHighlightArchive_Factory(t) { return new (t || ColumnHighlightArchive)(); };
ColumnHighlightArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: ColumnHighlightArchive, factory: ColumnHighlightArchive.ɵfac });
__decorate([
    Override
], ColumnHighlightArchive.prototype, "equals", null);
__decorate([
    Override
], ColumnHighlightArchive.prototype, "createDefaultValue", null);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnHighlightArchive, [{
        type: Injectable
    }], function () { return []; }, { equals: [], createDefaultValue: [] }); })();

class CompositionDomainModule extends DomainModule {
    constructor() {
        super();
    }
    static commandHandlers() {
        return [
            HermesModule.registerCommandHandler(SetColumnsCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(SetCompositionWidthCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(SetCompositionResizeWidthCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(SetCompositionContainerWidthCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(CompositionSetColumnEnabledCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(CompositionChangeSortStatusCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(CompositionMoveLeftColumnCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(CompositionMoveRightColumnCommandHandler, compositionKey),
            HermesModule.registerCommandHandler(SetGroupsCommandHandler, compositionKey)
        ];
    }
    static domainEventHandlers() {
        return [
            HermesModule.registerMultiDomainEventHandler(CompositionChangeSortStatusEventHandler)
        ];
    }
}
CompositionDomainModule.ɵfac = function CompositionDomainModule_Factory(t) { return new (t || CompositionDomainModule)(); };
CompositionDomainModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: CompositionDomainModule });
CompositionDomainModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        inMemoryCompositionCommandProviders,
        CompositionDispatcher,
        ColumnEntityFactory,
        ColumnPresentationConverter,
        CompositionEventConverter,
        ColumnFieldFactory,
        CompositionGroupFactory,
        ColumnHighlightArchive
    ], imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionDomainModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                providers: [
                    inMemoryCompositionCommandProviders,
                    CompositionDispatcher,
                    ColumnEntityFactory,
                    ColumnPresentationConverter,
                    CompositionEventConverter,
                    ColumnFieldFactory,
                    CompositionGroupFactory,
                    ColumnHighlightArchive
                ],
                declarations: [],
                exports: []
            }]
    }], function () { return []; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(CompositionDomainModule, { imports: [CommonModule] }); })();

class GroupCollection {
    constructor(groups, showGroups) {
        this.groups = groups;
        this.showGroups = showGroups;
    }
    getGroups() {
        return this.groups;
    }
    isVisible() {
        return this.showGroups;
    }
}

class CompositionGroupArchive extends AggregateArchive {
    constructor() {
        super(CompositionGroupArchive.default);
    }
}
CompositionGroupArchive.default = new GroupCollection([], false);
CompositionGroupArchive.ɵfac = function CompositionGroupArchive_Factory(t) { return new (t || CompositionGroupArchive)(); };
CompositionGroupArchive.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionGroupArchive, factory: CompositionGroupArchive.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionGroupArchive, [{
        type: Injectable
    }], function () { return []; }, null); })();

class CompositionDomainCommandInvoker extends CompositionCommandInvoker {
    constructor(compositionDispatcher, compositionGroupRepository, columnHighlightArchive) {
        super();
        this.compositionDispatcher = compositionDispatcher;
        this.compositionGroupRepository = compositionGroupRepository;
        this.columnHighlightArchive = columnHighlightArchive;
    }
    create(compositionId) {
        this.compositionDispatcher.createComposition(compositionId);
    }
    setColumns(params, compositionId) {
        this.compositionDispatcher.setColumns(compositionId, params);
    }
    setGroups(configs, compositionId) {
        // this.compositionGroupRepository.next(compositionId, CompositionGroupRepository.default);
        this.compositionDispatcher.setGroups(compositionId, configs);
    }
    setWidth(width, compositionId) {
        this.compositionDispatcher.setWidth(compositionId, width);
    }
    setContainerWidth(width, compositionId) {
        this.compositionDispatcher.setContainerWidth(compositionId, width);
    }
    setResizeWidth(enabled, compositionId) {
        this.compositionDispatcher.setResizeWidth(compositionId, enabled);
    }
    enableColumn(columnDefinitionId, compositionId) {
        this.compositionDispatcher.setColumnEnabled(compositionId, this.toColumnId(columnDefinitionId), true);
    }
    disableColumn(columnDefinitionId, compositionId) {
        this.compositionDispatcher.setColumnEnabled(compositionId, this.toColumnId(columnDefinitionId), false);
    }
    moveLeft(columnDefinitionId, compositionId) {
        this.compositionDispatcher.moveLeft(compositionId, this.toColumnId(columnDefinitionId));
    }
    moveRight(columnDefinitionId, compositionId) {
        this.compositionDispatcher.moveRight(compositionId, this.toColumnId(columnDefinitionId));
    }
    highlightColumn(columnDefinitionId, compositionId) {
        this.columnHighlightArchive.toggle(compositionId, new ColumnId(columnDefinitionId.getId()));
    }
    toColumnId(defId) {
        return new ColumnId(defId.getId());
    }
}
CompositionDomainCommandInvoker.ɵfac = function CompositionDomainCommandInvoker_Factory(t) { return new (t || CompositionDomainCommandInvoker)(i0.ɵɵinject(CompositionDispatcher), i0.ɵɵinject(CompositionGroupArchive), i0.ɵɵinject(ColumnHighlightArchive)); };
CompositionDomainCommandInvoker.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionDomainCommandInvoker, factory: CompositionDomainCommandInvoker.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionDomainCommandInvoker, [{
        type: Injectable
    }], function () { return [{ type: CompositionDispatcher }, { type: CompositionGroupArchive }, { type: ColumnHighlightArchive }]; }, null); })();

class CompositionDomainEventRepository extends CompositionEventRepository {
    constructor(domainEventBus) {
        super(domainEventBus);
    }
    onColumnsChanged(compositionId) {
        return this.onEvent(compositionId, CompositionColumnsSetEvent);
    }
    onContainerWidthChanged(compositionId) {
        return this.onEvent(compositionId, CompositionContainerWidthSetEvent)
            .pipe(hermesMap((event) => {
            return event.getPayload();
        }), hermesFilter((width) => !!width));
    }
}
CompositionDomainEventRepository.ɵfac = function CompositionDomainEventRepository_Factory(t) { return new (t || CompositionDomainEventRepository)(i0.ɵɵinject(i1$1.DomainEventBus)); };
CompositionDomainEventRepository.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionDomainEventRepository, factory: CompositionDomainEventRepository.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionDomainEventRepository, [{
        type: Injectable
    }], function () { return [{ type: i1$1.DomainEventBus }]; }, null); })();

class CompositionDomainWarehouse extends CompositionWarehouse {
    constructor(compositionRepository, compositionGroupArchive, columnHighlightArchive) {
        super();
        this.compositionRepository = compositionRepository;
        this.compositionGroupArchive = compositionGroupArchive;
        this.columnHighlightArchive = columnHighlightArchive;
    }
    onWidth(compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.getWidth()));
    }
    onContainerWidth(compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.getContainerWidth()));
    }
    onWidthForEachColumn(compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.getAllColumns().map(c => c.width)));
    }
    onHeaderColumns(compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.getActiveHeaderColumns()));
    }
    onAllColumns(compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.getHeaderColumns()));
    }
    onSortOrder(fieldId, compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.getActiveHeaderColumns()), hermesMap((columns) => {
            return columns.filter((c) => c.getFieldId().equals(fieldId));
        }), hermesFilter((columns) => {
            return columns.length > 0;
        }), hermesMap(columns => columns[0].getSortStatus()));
    }
    onTemplateColumns(compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.getTemplateColumns()));
    }
    onResizeWidth(compositionId) {
        return this.compositionRepository
            .on(compositionId)
            .pipe(hermesMap((composition) => composition.isResizeWidthEnabled()));
    }
    onGroups(compositionId) {
        return this.compositionGroupArchive.on(compositionId);
    }
    onHighlightedColumn(columnId, compositionId) {
        return this.columnHighlightArchive
            .on(compositionId)
            .pipe(hermesMap((manager) => manager.isHighlighted(columnId)));
    }
}
CompositionDomainWarehouse.ɵfac = function CompositionDomainWarehouse_Factory(t) { return new (t || CompositionDomainWarehouse)(i0.ɵɵinject(CompositionReadModelRootRepository), i0.ɵɵinject(CompositionGroupArchive), i0.ɵɵinject(ColumnHighlightArchive)); };
CompositionDomainWarehouse.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CompositionDomainWarehouse, factory: CompositionDomainWarehouse.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionDomainWarehouse, [{
        type: Injectable
    }], function () { return [{ type: CompositionReadModelRootRepository }, { type: CompositionGroupArchive }, { type: ColumnHighlightArchive }]; }, null); })();

class DomainColumnAutoConfigurator extends ColumnAutoConfigurator {
    configure(source) {
        if (source !== undefined && source !== null && Array.isArray(source) && source.length === 0) {
            return [];
        }
        const rawItem = source[0];
        return Object.keys(rawItem)
            .map((key, index) => {
            return this.toColumnConfig(key, rawItem);
        });
    }
    toColumnConfig(key, rawItem) {
        return {
            field: this.getField(key),
            header: this.getHeader(key),
            type: this.getType(key, rawItem)
        };
    }
    getField(key) {
        return key;
    }
    getHeader(key) {
        return key[0].toUpperCase() + key.slice(1);
    }
    getType(key, rawItem) {
        if (typeof rawItem[key] === 'string') {
            return DataType.STRING;
        }
        else if (typeof rawItem[key] === 'number') {
            return DataType.NUMBER;
        }
        else if (rawItem[key] instanceof Date) {
            return DataType.DATE;
        }
        else if (typeof rawItem[key] === 'boolean') {
            return DataType.BOOLEAN;
        }
        else {
            return DataType.UNKNOWN;
        }
    }
}
DomainColumnAutoConfigurator.ɵfac = /*@__PURE__*/ function () { let ɵDomainColumnAutoConfigurator_BaseFactory; return function DomainColumnAutoConfigurator_Factory(t) { return (ɵDomainColumnAutoConfigurator_BaseFactory || (ɵDomainColumnAutoConfigurator_BaseFactory = i0.ɵɵgetInheritedFactory(DomainColumnAutoConfigurator)))(t || DomainColumnAutoConfigurator); }; }();
DomainColumnAutoConfigurator.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: DomainColumnAutoConfigurator, factory: DomainColumnAutoConfigurator.ɵfac });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(DomainColumnAutoConfigurator, [{
        type: Injectable
    }], null, null); })();

class CompositionApiModule {
}
CompositionApiModule.ɵfac = function CompositionApiModule_Factory(t) { return new (t || CompositionApiModule)(); };
CompositionApiModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: CompositionApiModule });
CompositionApiModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        inMemoryCompositionReadModelProviders,
        ColumnDefinitionFactory,
        ViewTemplateRepository,
        ViewTemplateFactory,
        EditTemplateFactory,
        EditTemplateRepository,
        inMemoryCompositionProviders,
        CompositionReadModelRootConverter,
        CompositionGroupArchive,
        {
            provide: CompositionCommandInvoker,
            useClass: CompositionDomainCommandInvoker
        },
        {
            provide: CompositionWarehouse,
            useClass: CompositionDomainWarehouse
        },
        {
            provide: CompositionEventRepository,
            useClass: CompositionDomainEventRepository
        },
        {
            provide: ColumnAutoConfigurator,
            useClass: DomainColumnAutoConfigurator
        }
    ], imports: [[
            CommonModule,
            HermesModule.defineAggregate(compositionKey, CompositionAggregateFactory, InMemoryCompositionAggregateRepository, CreateCompositionCommandHandler, [
                CompositionDomainModule.commandHandlers()
            ], [
                CompositionDomainModule.domainEventHandlers()
            ]),
            CompositionDomainModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionApiModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    HermesModule.defineAggregate(compositionKey, CompositionAggregateFactory, InMemoryCompositionAggregateRepository, CreateCompositionCommandHandler, [
                        CompositionDomainModule.commandHandlers()
                    ], [
                        CompositionDomainModule.domainEventHandlers()
                    ]),
                    CompositionDomainModule
                ],
                providers: [
                    inMemoryCompositionReadModelProviders,
                    ColumnDefinitionFactory,
                    ViewTemplateRepository,
                    ViewTemplateFactory,
                    EditTemplateFactory,
                    EditTemplateRepository,
                    inMemoryCompositionProviders,
                    CompositionReadModelRootConverter,
                    CompositionGroupArchive,
                    {
                        provide: CompositionCommandInvoker,
                        useClass: CompositionDomainCommandInvoker
                    },
                    {
                        provide: CompositionWarehouse,
                        useClass: CompositionDomainWarehouse
                    },
                    {
                        provide: CompositionEventRepository,
                        useClass: CompositionDomainEventRepository
                    },
                    {
                        provide: ColumnAutoConfigurator,
                        useClass: DomainColumnAutoConfigurator
                    }
                ],
                declarations: [],
                exports: []
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(CompositionApiModule, { imports: [CommonModule, i1$1.HermesDomainModule, CompositionDomainModule] }); })();

class SanitizeModule {
}
SanitizeModule.ɵfac = function SanitizeModule_Factory(t) { return new (t || SanitizeModule)(); };
SanitizeModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: SanitizeModule });
SanitizeModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SanitizeModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule
                ],
                declarations: [
                    SafePipe
                ],
                exports: [
                    SafePipe
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(SanitizeModule, { declarations: [SafePipe], imports: [CommonModule], exports: [SafePipe] }); })();

const _c0 = ["header", ""];
class ColumnQueryComponent {
}
ColumnQueryComponent.ɵfac = function ColumnQueryComponent_Factory(t) { return new (t || ColumnQueryComponent)(); };
ColumnQueryComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: ColumnQueryComponent, selectors: [["gui-column", "header", ""]], contentQueries: function ColumnQueryComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        i0.ɵɵcontentQuery(dirIndex, TemplateRef, 5);
    } if (rf & 2) {
        let _t;
        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.cellTemplate = _t.first);
    } }, inputs: { header: "header" }, attrs: _c0, decls: 0, vars: 0, template: function ColumnQueryComponent_Template(rf, ctx) { }, encapsulation: 2 });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ColumnQueryComponent, [{
        type: Component,
        args: [{
                selector: 'gui-column[header]',
                template: ''
            }]
    }], null, { cellTemplate: [{
            type: ContentChild,
            args: [TemplateRef, { static: false }]
        }], header: [{
            type: Input
        }] }); })();

const components = [
    ViewTemplatesComponent,
    EditTemplatesComponent,
    StringEditTemplateComponent,
    NumberEditTemplateComponent,
    BooleanEditTemplateComponent,
    DateEditTemplateComponent,
    ColumnQueryComponent,
    FunctionViewComponent,
    BarViewComponent,
    PercentageViewComponent,
    TextViewComponent
];
const exportDeclarations$2 = [
    ViewTemplatesComponent,
    EditTemplatesComponent,
    ColumnQueryComponent,
    FabricChipModule,
    FabricCheckboxModule,
    FabricButtonModule,
    FabricInputModule,
    FunctionViewComponent,
    BarViewComponent,
    PercentageViewComponent
];
class CompositionFeatureModule extends FeatureModule {
    static forComponent() {
        return [];
    }
}
CompositionFeatureModule.ɵfac = /*@__PURE__*/ function () { let ɵCompositionFeatureModule_BaseFactory; return function CompositionFeatureModule_Factory(t) { return (ɵCompositionFeatureModule_BaseFactory || (ɵCompositionFeatureModule_BaseFactory = i0.ɵɵgetInheritedFactory(CompositionFeatureModule)))(t || CompositionFeatureModule); }; }();
CompositionFeatureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: CompositionFeatureModule });
CompositionFeatureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CommonModule,
            CompositionApiModule,
            ReactiveFormsModule,
            SanitizeModule,
            FabricChipModule,
            FabricCheckboxModule,
            FabricButtonModule,
            FabricInputModule,
            FabricDatePickerModule
        ], FabricChipModule,
        FabricCheckboxModule,
        FabricButtonModule,
        FabricInputModule] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CompositionFeatureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CommonModule,
                    CompositionApiModule,
                    ReactiveFormsModule,
                    SanitizeModule,
                    FabricChipModule,
                    FabricCheckboxModule,
                    FabricButtonModule,
                    FabricInputModule,
                    FabricDatePickerModule
                ],
                declarations: [
                    components
                ],
                exports: [
                    exportDeclarations$2
                ],
                entryComponents: [
                    ViewTemplatesComponent,
                    EditTemplatesComponent,
                    FabricChipComponent,
                    FabricCheckboxComponent,
                    FabricButtonComponent,
                    FabricInputComponent
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(CompositionFeatureModule, { declarations: [ViewTemplatesComponent,
        EditTemplatesComponent,
        StringEditTemplateComponent,
        NumberEditTemplateComponent,
        BooleanEditTemplateComponent,
        DateEditTemplateComponent,
        ColumnQueryComponent,
        FunctionViewComponent,
        BarViewComponent,
        PercentageViewComponent,
        TextViewComponent], imports: [CommonModule,
        CompositionApiModule,
        ReactiveFormsModule,
        SanitizeModule,
        FabricChipModule,
        FabricCheckboxModule,
        FabricButtonModule,
        FabricInputModule,
        FabricDatePickerModule], exports: [ViewTemplatesComponent,
        EditTemplatesComponent,
        ColumnQueryComponent,
        FabricChipModule,
        FabricCheckboxModule,
        FabricButtonModule,
        FabricInputModule,
        FunctionViewComponent,
        BarViewComponent,
        PercentageViewComponent] }); })();

class StructureSearchingGate extends SearchingGate {
    constructor(structureId, searchEventRepository, searchCommandInvoker) {
        super(structureId, searchEventRepository, searchCommandInvoker);
    }
}
StructureSearchingGate.ɵfac = function StructureSearchingGate_Factory(t) { return new (t || StructureSearchingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SearchEventRepository), i0.ɵɵdirectiveInject(SearchCommandInvoker)); };
StructureSearchingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureSearchingGate, selectors: [["gui-structure", "searching", ""]], features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSearchingGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[searching]'
            }]
    }], function () { return [{ type: StructureId }, { type: SearchEventRepository }, { type: SearchCommandInvoker }]; }, null); })();

class StructureColumnHeaderGate extends Gate {
    constructor(structureHeaderTopEnabledArchive, structureHeaderBottomEnabledArchive) {
        super();
        this.structureHeaderTopEnabledArchive = structureHeaderTopEnabledArchive;
        this.structureHeaderBottomEnabledArchive = structureHeaderBottomEnabledArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('columnHeaderTop', changes)) {
            this.structureHeaderTopEnabledArchive.next(this.columnHeaderTop);
        }
        if (this.isDefined('columnHeaderBottom', changes)) {
            this.structureHeaderBottomEnabledArchive.next(this.columnHeaderBottom);
        }
    }
}
StructureColumnHeaderGate.ɵfac = function StructureColumnHeaderGate_Factory(t) { return new (t || StructureColumnHeaderGate)(i0.ɵɵdirectiveInject(StructureHeaderTopEnabledArchive), i0.ɵɵdirectiveInject(StructureHeaderBottomEnabledArchive)); };
StructureColumnHeaderGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureColumnHeaderGate, selectors: [["gui-structure", "columnHeaderTop", "", "columnHeaderBottom", ""], ["gui-structure", "columnHeaderTop", ""], ["gui-structure", "columnHeaderBottom", ""]], inputs: { columnHeaderTop: "columnHeaderTop", columnHeaderBottom: "columnHeaderBottom" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnHeaderGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[columnHeaderTop][columnHeaderBottom], gui-structure[columnHeaderTop], gui-structure[columnHeaderBottom]'
            }]
    }], function () { return [{ type: StructureHeaderTopEnabledArchive }, { type: StructureHeaderBottomEnabledArchive }]; }, { columnHeaderTop: [{
            type: Input
        }], columnHeaderBottom: [{
            type: Input
        }] }); })();

class StructurePagingGate extends PagingGate {
    constructor(structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository, pagingDisplayModeArchive) {
        super(structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository);
        this.pagingDisplayModeArchive = pagingDisplayModeArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('paging', changes)) {
            let pagingConfig;
            if (typeof this.paging === 'boolean') {
                pagingConfig = {
                    enabled: this.paging
                };
            }
            else {
                pagingConfig = this.paging;
                if (this.paging.displayMode !== undefined) {
                    this.pagingDisplayModeArchive.next(this.paging.displayMode);
                }
            }
            this.pagingCommandInvoker.setPaging(pagingConfig, this.structureId);
        }
    }
}
StructurePagingGate.ɵfac = function StructurePagingGate_Factory(t) { return new (t || StructurePagingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(CompositionId), i0.ɵɵdirectiveInject(PagingCommandInvoker), i0.ɵɵdirectiveInject(PagingEventRepository), i0.ɵɵdirectiveInject(PagingDisplayModeArchive)); };
StructurePagingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructurePagingGate, selectors: [["gui-structure", "paging", ""]], features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
__decorate([
    Override
], StructurePagingGate.prototype, "ngOnChanges", null);
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructurePagingGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[paging]'
            }]
    }], function () { return [{ type: StructureId }, { type: CompositionId }, { type: PagingCommandInvoker }, { type: PagingEventRepository }, { type: PagingDisplayModeArchive }]; }, { ngOnChanges: [] }); })();

class SelectionGate extends Gate {
    constructor(structureId, formationEventService, formationCommandDispatcher, rowSelectionTypeArchive) {
        super();
        this.structureId = structureId;
        this.formationEventService = formationEventService;
        this.formationCommandDispatcher = formationCommandDispatcher;
        this.rowSelectionTypeArchive = rowSelectionTypeArchive;
        this.itemsSelected = new EventEmitter();
        this.selectedRows = new EventEmitter();
    }
    ngOnChanges(changes) {
        if (this.isDefined('rowSelection', changes)) {
            if (this.rowSelection.isEnabledDefined()) {
                this.formationCommandDispatcher.setSelection(this.rowSelection.isEnabled(), this.structureId);
            }
            if (this.rowSelection.isTypeDefined()) {
                this.rowSelectionTypeArchive.next(this.rowSelection.getType());
            }
            if (this.rowSelection.isModeDefined()) {
                this.formationCommandDispatcher.changeMode(this.rowSelection.getMode(), this.structureId);
            }
        }
    }
    ngOnInit() {
        this.formationEventService
            .onItemSelected(this.structureId)
            .pipe(this.hermesTakeUntil())
            .subscribe((items) => {
            this.itemsSelected.emit(items.map(i => i.getSource()));
            this.selectedRows.emit(items);
        });
    }
    ngOnDestroy() {
        super.ngOnDestroy();
    }
}
SelectionGate.ɵfac = function SelectionGate_Factory(t) { return new (t || SelectionGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FormationEventRepository), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(RowSelectionTypeArchive)); };
SelectionGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: SelectionGate, inputs: { rowSelection: "rowSelection" }, outputs: { itemsSelected: "itemsSelected", selectedRows: "selectedRows" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SelectionGate, [{
        type: Directive
    }], function () { return [{ type: StructureId }, { type: FormationEventRepository }, { type: FormationCommandInvoker }, { type: RowSelectionTypeArchive }]; }, { rowSelection: [{
            type: Input
        }], itemsSelected: [{
            type: Output
        }], selectedRows: [{
            type: Output
        }] }); })();

class StructureSelectionGate extends SelectionGate {
    constructor(structureId, formationEventService, formationCommandDispatcher, rowSelectionTypeArchive) {
        super(structureId, formationEventService, formationCommandDispatcher, rowSelectionTypeArchive);
    }
}
StructureSelectionGate.ɵfac = function StructureSelectionGate_Factory(t) { return new (t || StructureSelectionGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(FormationEventRepository), i0.ɵɵdirectiveInject(FormationCommandInvoker), i0.ɵɵdirectiveInject(RowSelectionTypeArchive)); };
StructureSelectionGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureSelectionGate, selectors: [["gui-structure", "rowSelection", ""], ["gui-structure", "selectionGate", ""]], inputs: { selectionGate: "selectionGate" }, features: [i0.ɵɵInheritDefinitionFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSelectionGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[rowSelection], gui-structure[selectionGate]'
            }]
    }], function () { return [{ type: StructureId }, { type: FormationEventRepository }, { type: FormationCommandInvoker }, { type: RowSelectionTypeArchive }]; }, { selectionGate: [{
            type: Input
        }] }); })();

class StructureL10nGate extends Gate {
    constructor(translationService) {
        super();
        this.translationService = translationService;
    }
    ngOnChanges(changes) {
        if (this.isDefined('localization', changes)) {
            if (this.localization.translationResolver) {
                this.translationService.setResolver(this.localization.translationResolver);
            }
            if (this.localization.translation) {
                this.translationService.changeTranslation(this.localization.translation);
            }
        }
    }
}
StructureL10nGate.ɵfac = function StructureL10nGate_Factory(t) { return new (t || StructureL10nGate)(i0.ɵɵdirectiveInject(TranslationFacade)); };
StructureL10nGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureL10nGate, selectors: [["gui-structure", "localization", ""]], inputs: { localization: "localization" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureL10nGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[localization]'
            }]
    }], function () { return [{ type: TranslationFacade }]; }, { localization: [{
            type: Input
        }] }); })();

class StructurePanelGate extends Gate {
    constructor(structureTitlePanelConfigArchive, structureFooterPanelConfigArchive) {
        super();
        this.structureTitlePanelConfigArchive = structureTitlePanelConfigArchive;
        this.structureFooterPanelConfigArchive = structureFooterPanelConfigArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('titlePanel', changes)) {
            this.structureTitlePanelConfigArchive.next(this.titlePanel);
        }
        if (this.isDefined('footerPanel', changes)) {
            this.structureFooterPanelConfigArchive.next(this.footerPanel);
        }
    }
}
StructurePanelGate.ɵfac = function StructurePanelGate_Factory(t) { return new (t || StructurePanelGate)(i0.ɵɵdirectiveInject(StructureTitlePanelConfigArchive), i0.ɵɵdirectiveInject(StructureFooterPanelConfigArchive)); };
StructurePanelGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructurePanelGate, selectors: [["gui-structure", "titlePanel", "", "footerPanel", ""]], inputs: { titlePanel: "titlePanel", footerPanel: "footerPanel" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructurePanelGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[titlePanel][footerPanel]'
            }]
    }], function () { return [{ type: StructureTitlePanelConfigArchive }, { type: StructureFooterPanelConfigArchive }]; }, { titlePanel: [{
            type: Input
        }], footerPanel: [{
            type: Input
        }] }); })();

class StructureRowDetailGate extends Gate {
    constructor(structureDetailViewConfigArchive) {
        super();
        this.structureDetailViewConfigArchive = structureDetailViewConfigArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('rowDetail', changes)) {
            this.structureDetailViewConfigArchive.next(this.rowDetail);
        }
    }
}
StructureRowDetailGate.ɵfac = function StructureRowDetailGate_Factory(t) { return new (t || StructureRowDetailGate)(i0.ɵɵdirectiveInject(StructureRowDetailConfigArchive)); };
StructureRowDetailGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureRowDetailGate, selectors: [["gui-structure", "rowDetail", ""]], inputs: { rowDetail: "rowDetail" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowDetailGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[rowDetail]'
            }]
    }], function () { return [{ type: StructureRowDetailConfigArchive }]; }, { rowDetail: [{
            type: Input
        }] }); })();

class StructureColumnMenuGate extends Gate {
    constructor(structureColumnMenuConfigArchive) {
        super();
        this.structureColumnMenuConfigArchive = structureColumnMenuConfigArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('columnMenu', changes)) {
            this.structureColumnMenuConfigArchive.nextConfig(this.columnMenu);
        }
    }
}
StructureColumnMenuGate.ɵfac = function StructureColumnMenuGate_Factory(t) { return new (t || StructureColumnMenuGate)(i0.ɵɵdirectiveInject(StructureColumnMenuConfigArchive)); };
StructureColumnMenuGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureColumnMenuGate, selectors: [["gui-structure", "columnMenu", ""]], inputs: { columnMenu: "columnMenu" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureColumnMenuGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[columnMenu]'
            }]
    }], function () { return [{ type: StructureColumnMenuConfigArchive }]; }, { columnMenu: [{
            type: Input
        }] }); })();

class StructureSummariesGate extends Gate {
    constructor(structureId, summariesCommandInvoker) {
        super();
        this.structureId = structureId;
        this.summariesCommandInvoker = summariesCommandInvoker;
    }
    ngOnChanges(changes) {
        if (this.isDefined('summaries', changes)) {
            this.summariesCommandInvoker.setConfig(this.summaries, this.structureId);
        }
    }
}
StructureSummariesGate.ɵfac = function StructureSummariesGate_Factory(t) { return new (t || StructureSummariesGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SummariesCommandInvoker)); };
StructureSummariesGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureSummariesGate, selectors: [["gui-structure", "summaries", ""]], inputs: { summaries: "summaries" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSummariesGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[summaries]'
            }]
    }], function () { return [{ type: StructureId }, { type: SummariesCommandInvoker }]; }, { summaries: [{
            type: Input
        }] }); })();

class StructureInfoPanelGate extends Gate {
    constructor(structureInfoPanelConfigService) {
        super();
        this.structureInfoPanelConfigService = structureInfoPanelConfigService;
    }
    ngOnChanges(changes) {
        if (this.isDefined('infoPanel', changes)) {
            if (typeof this.infoPanel === 'boolean') {
                this.infoPanel = {
                    enabled: this.infoPanel
                };
            }
            this.structureInfoPanelConfigService.set(this.infoPanel);
        }
    }
}
StructureInfoPanelGate.ɵfac = function StructureInfoPanelGate_Factory(t) { return new (t || StructureInfoPanelGate)(i0.ɵɵdirectiveInject(StructureInfoPanelConfigService)); };
StructureInfoPanelGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureInfoPanelGate, selectors: [["gui-structure", "infoPanel", ""]], inputs: { infoPanel: "infoPanel" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureInfoPanelGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[infoPanel]'
            }]
    }], function () { return [{ type: StructureInfoPanelConfigService }]; }, { infoPanel: [{
            type: Input
        }] }); })();

class StructureRowClassGate extends Gate {
    constructor(schemaRowClassArchive) {
        super();
        this.schemaRowClassArchive = schemaRowClassArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('rowClass', changes)) {
            this.schemaRowClassArchive.next(this.rowClass);
        }
    }
}
StructureRowClassGate.ɵfac = function StructureRowClassGate_Factory(t) { return new (t || StructureRowClassGate)(i0.ɵɵdirectiveInject(SchemaRowClassArchive)); };
StructureRowClassGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureRowClassGate, selectors: [["gui-structure", "rowClass", ""]], inputs: { rowClass: "rowClass" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowClassGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[rowClass]'
            }]
    }], function () { return [{ type: SchemaRowClassArchive }]; }, { rowClass: [{
            type: Input
        }] }); })();

class StructureRowColoringGate extends Gate {
    constructor(schemaId, schemaCommandInvoker, schemaEventRepository) {
        super();
        this.schemaId = schemaId;
        this.schemaCommandInvoker = schemaCommandInvoker;
        this.schemaEventRepository = schemaEventRepository;
        this.rowColoringChanged = new EventEmitter();
    }
    ngOnChanges(changes) {
        if (this.isDefined('rowColoring', changes)) {
            this.schemaCommandInvoker.setRowColoring(this.rowColoring, this.schemaId);
        }
    }
    ngOnInit() {
        this.subscribeAndEmit(this.schemaEventRepository.onRowColoring(this.schemaId), this.rowColoringChanged);
    }
    ngOnDestroy() {
        super.ngOnDestroy();
    }
}
StructureRowColoringGate.ɵfac = function StructureRowColoringGate_Factory(t) { return new (t || StructureRowColoringGate)(i0.ɵɵdirectiveInject(SchemaReadModelRootId), i0.ɵɵdirectiveInject(SchemaCommandInvoker), i0.ɵɵdirectiveInject(SchemaEventRepository)); };
StructureRowColoringGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureRowColoringGate, selectors: [["gui-structure", "rowColoring", ""]], inputs: { rowColoring: "rowColoring" }, outputs: { rowColoringChanged: "rowColoringChanged" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowColoringGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[rowColoring]'
            }]
    }], function () { return [{ type: SchemaReadModelRootId }, { type: SchemaCommandInvoker }, { type: SchemaEventRepository }]; }, { rowColoring: [{
            type: Input
        }], rowColoringChanged: [{
            type: Output
        }] }); })();

class StructureRowStyleGate extends Gate {
    constructor(schemaRowStyleArchive) {
        super();
        this.schemaRowStyleArchive = schemaRowStyleArchive;
    }
    ngOnChanges(changes) {
        if (this.isDefined('rowStyle', changes)) {
            this.schemaRowStyleArchive.next(this.rowStyle);
        }
    }
}
StructureRowStyleGate.ɵfac = function StructureRowStyleGate_Factory(t) { return new (t || StructureRowStyleGate)(i0.ɵɵdirectiveInject(SchemaRowStyleArchive)); };
StructureRowStyleGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureRowStyleGate, selectors: [["gui-structure", "rowStyle", ""]], inputs: { rowStyle: "rowStyle" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureRowStyleGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[rowStyle]'
            }]
    }], function () { return [{ type: SchemaRowStyleArchive }]; }, { rowStyle: [{
            type: Input
        }] }); })();

class ThemeGridGate extends Gate {
    constructor(schemaId, schemaCommandInvoker, schemaEventRepository) {
        super();
        this.schemaId = schemaId;
        this.schemaCommandInvoker = schemaCommandInvoker;
        this.schemaEventRepository = schemaEventRepository;
        this.horizontalGridChanged = new EventEmitter();
        this.verticalGridChanged = new EventEmitter();
    }
    ngOnChanges(changes) {
        if (this.isDefined('verticalGrid', changes)) {
            this.schemaCommandInvoker.setVerticalGrid(this.verticalGrid, this.schemaId);
        }
        if (this.isDefined('horizontalGrid', changes)) {
            this.schemaCommandInvoker.setHorizontalGrid(this.horizontalGrid, this.schemaId);
        }
    }
    ngOnInit() {
        this.subscribeAndEmit(this.schemaEventRepository.onHorizontalGridChanged(this.schemaId), this.horizontalGridChanged);
        this.subscribeAndEmit(this.schemaEventRepository.onVerticalGridChanged(this.schemaId), this.verticalGridChanged);
    }
}
ThemeGridGate.ɵfac = function ThemeGridGate_Factory(t) { return new (t || ThemeGridGate)(i0.ɵɵdirectiveInject(SchemaReadModelRootId), i0.ɵɵdirectiveInject(SchemaCommandInvoker), i0.ɵɵdirectiveInject(SchemaEventRepository)); };
ThemeGridGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: ThemeGridGate, selectors: [["gui-structure", "verticalGrid", "", "horizontalGrid", ""]], inputs: { verticalGrid: "verticalGrid", horizontalGrid: "horizontalGrid" }, outputs: { horizontalGridChanged: "horizontalGridChanged", verticalGridChanged: "verticalGridChanged" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ThemeGridGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[verticalGrid][horizontalGrid]'
            }]
    }], function () { return [{ type: SchemaReadModelRootId }, { type: SchemaCommandInvoker }, { type: SchemaEventRepository }]; }, { verticalGrid: [{
            type: Input
        }], horizontalGrid: [{
            type: Input
        }], horizontalGridChanged: [{
            type: Output
        }], verticalGridChanged: [{
            type: Output
        }] }); })();

class SourceLoadingGate extends Gate {
    constructor(structureId, sourceCommandInvoker) {
        super();
        this.structureId = structureId;
        this.sourceCommandInvoker = sourceCommandInvoker;
    }
    ngOnChanges(changes) {
        if (this.isDefined('loading', changes)) {
            this.sourceCommandInvoker.setLoading(this.loading, this.structureId);
        }
    }
    ngOnInit() {
    }
}
SourceLoadingGate.ɵfac = function SourceLoadingGate_Factory(t) { return new (t || SourceLoadingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SourceCommandInvoker)); };
SourceLoadingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: SourceLoadingGate, selectors: [["gui-structure", "loading", ""]], inputs: { loading: "loading" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(SourceLoadingGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[loading]'
            }]
    }], function () { return [{ type: StructureId }, { type: SourceCommandInvoker }]; }, { loading: [{
            type: Input
        }] }); })();

class VerticalFormationGate extends Gate {
    constructor(structureId, structureCommandInvoker) {
        super();
        this.structureId = structureId;
        this.structureCommandInvoker = structureCommandInvoker;
    }
    ngOnChanges(changes) {
        if (this.isDefined('virtualScroll', changes)) {
            if (this.virtualScroll) {
                this.structureCommandInvoker.enableVirtualScroll(this.structureId);
            }
            else {
                this.structureCommandInvoker.disableVirtualScroll(this.structureId);
            }
        }
    }
}
VerticalFormationGate.ɵfac = function VerticalFormationGate_Factory(t) { return new (t || VerticalFormationGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(StructureCommandInvoker)); };
VerticalFormationGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: VerticalFormationGate, selectors: [["gui-structure", "virtualScroll", ""]], inputs: { virtualScroll: "virtualScroll" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(VerticalFormationGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[virtualScroll]'
            }]
    }], function () { return [{ type: StructureId }, { type: StructureCommandInvoker }]; }, { virtualScroll: [{
            type: Input
        }] }); })();

class StructureSortingGate extends Gate {
    constructor(structureId, sortingCommandInvoker) {
        super();
        this.structureId = structureId;
        this.sortingCommandInvoker = sortingCommandInvoker;
    }
    ngOnChanges(changes) {
        if (this.isDefined('sorting', changes)) {
            let sorting;
            if (typeof this.sorting === 'boolean') {
                sorting = {
                    enabled: this.sorting
                };
            }
            else {
                sorting = this.sorting;
            }
            this.sortingCommandInvoker.setSortingConfig(sorting, this.structureId);
        }
    }
}
StructureSortingGate.ɵfac = function StructureSortingGate_Factory(t) { return new (t || StructureSortingGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(SortingCommandInvoker)); };
StructureSortingGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureSortingGate, selectors: [["gui-structure", "sorting", ""]], inputs: { sorting: "sorting" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSortingGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[sorting]'
            }]
    }], function () { return [{ type: StructureId }, { type: SortingCommandInvoker }]; }, { sorting: [{
            type: Input
        }] }); })();

class StructureFilterGate extends Gate {
    constructor(structureId, structureCommandInvoker) {
        super();
        this.structureId = structureId;
        this.structureCommandInvoker = structureCommandInvoker;
    }
    ngOnChanges(changes) {
        if (this.isDefined('filtering', changes)) {
            let filtering;
            if (typeof this.filtering === 'boolean') {
                filtering = {
                    enabled: this.filtering
                };
            }
            else {
                filtering = this.filtering;
            }
            this.structureCommandInvoker.setFilterConfig(filtering, this.structureId);
        }
    }
}
StructureFilterGate.ɵfac = function StructureFilterGate_Factory(t) { return new (t || StructureFilterGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(StructureCommandInvoker)); };
StructureFilterGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureFilterGate, selectors: [["gui-structure", "filtering", ""]], inputs: { filtering: "filtering" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureFilterGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[filtering]'
            }]
    }], function () { return [{ type: StructureId }, { type: StructureCommandInvoker }]; }, { filtering: [{
            type: Input
        }] }); })();

class StructureQuickFiltersGate extends Gate {
    constructor(structureId, structureCommandInvoker) {
        super();
        this.structureId = structureId;
        this.structureCommandInvoker = structureCommandInvoker;
    }
    ngOnChanges(changes) {
        if (this.isDefined('quickFilters', changes)) {
            let quickFilters;
            if (typeof this.quickFilters === 'boolean') {
                quickFilters = {
                    enabled: this.quickFilters
                };
            }
            else {
                quickFilters = this.quickFilters;
            }
            this.structureCommandInvoker.setQuickFiltersConfig(quickFilters, this.structureId);
        }
    }
}
StructureQuickFiltersGate.ɵfac = function StructureQuickFiltersGate_Factory(t) { return new (t || StructureQuickFiltersGate)(i0.ɵɵdirectiveInject(StructureId), i0.ɵɵdirectiveInject(StructureCommandInvoker)); };
StructureQuickFiltersGate.ɵdir = /*@__PURE__*/ i0.ɵɵdefineDirective({ type: StructureQuickFiltersGate, selectors: [["gui-structure", "quickFilters", ""]], inputs: { quickFilters: "quickFilters" }, features: [i0.ɵɵInheritDefinitionFeature, i0.ɵɵNgOnChangesFeature] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureQuickFiltersGate, [{
        type: Directive,
        args: [{
                selector: 'gui-structure[quickFilters]'
            }]
    }], function () { return [{ type: StructureId }, { type: StructureCommandInvoker }]; }, { quickFilters: [{
            type: Input
        }] }); })();

const structureGates = [
    StructureColumnHeaderGate,
    StructurePagingGate,
    StructureSearchingGate,
    // StructureSourceGate,
    StructureSelectionGate,
    StructureL10nGate,
    StructurePanelGate,
    StructureRowDetailGate,
    StructureColumnMenuGate,
    StructureSummariesGate,
    StructureInfoPanelGate,
    StructureRowClassGate,
    StructureRowStyleGate,
    StructureRowColoringGate,
    ThemeGridGate,
    StructureSortingGate,
    SourceLoadingGate,
    StructureFilterGate,
    StructureQuickFiltersGate,
    VerticalFormationGate
];

class CssClassModule {
}
CssClassModule.ɵfac = function CssClassModule_Factory(t) { return new (t || CssClassModule)(); };
CssClassModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: CssClassModule });
CssClassModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        CssClassModifier
    ] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(CssClassModule, [{
        type: NgModule,
        args: [{
                providers: [
                    CssClassModifier
                ]
            }]
    }], null, null); })();

class StructureSharedModule {
}
StructureSharedModule.ɵfac = function StructureSharedModule_Factory(t) { return new (t || StructureSharedModule)(); };
StructureSharedModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: StructureSharedModule });
StructureSharedModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            CssClassModule
        ]] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureSharedModule, [{
        type: NgModule,
        args: [{
                imports: [
                    CssClassModule
                ]
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(StructureSharedModule, { imports: [CssClassModule] }); })();

class ResizeDetectorModule {
}
ResizeDetectorModule.ɵfac = function ResizeDetectorModule_Factory(t) { return new (t || ResizeDetectorModule)(); };
ResizeDetectorModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: ResizeDetectorModule });
ResizeDetectorModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ providers: [
        ResizeDetector
    ] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(ResizeDetectorModule, [{
        type: NgModule,
        args: [{
                providers: [
                    ResizeDetector
                ]
            }]
    }], null, null); })();

function createStructureDefinition() {
    return new StructureDefinition.DefaultBuilder().build();
}
const imports$1 = [
    CommonModule,
    ReactiveFormsModule,
    TranslationFeatureModule,
    HermesModule,
    HermesModule.defineAggregate(structureKey, StructureAggregateFactory, InMemoryStructureAggregateRepository, CreateStructureCommandHandler, [
        PagingDomainModule.commandHandlers(),
        SortingDomainModule.commandHandlers(),
        FieldDomainModule.commandHandlers(),
        SearchDomainModule.commandHandlers(),
        FilterDomainModule.commandHandlers(),
        SourceDomainModule.commandHandlers(),
        SummariesDomainModule.commandHandlers(),
        VerticalFormationDomainModule.commandHandlers(),
        structureCommandHandlers
    ], [
        structureDomainEventHandlers,
        SearchDomainModule.domainEventHandlers(),
        FilterDomainModule.domainEventHandlers(),
        SourceDomainModule.domainEventHandlers(),
        SummariesDomainModule.domainEventHandlers(),
        FieldDomainModule.domainEventHandlers(),
        VerticalFormationDomainModule.domainEventHandlers()
    ]),
    // .withConfig({
    // 	loggers: false
    // }),
    fabricImports,
    ResizeDetectorModule,
    PagingFeatureModule,
    SortingFeatureModule,
    FieldFeatureModule,
    SearchFeatureModule,
    FilterMenuFeatureModule,
    SourceFeatureModule,
    SummariesFeatureModule,
    VerticalFormationFeatureModule,
    SchemaFeatureModule,
    StructureSharedModule,
    StructureInfoPanelModule,
    StructureTopPanelModule,
    StructureColumnMenuModule,
    StructureColumnManagerModule,
    SchemaManagerModule,
    EmptySourceFeatureModule,
    CompositionFeatureModule,
    LoggerModule,
    SanitizeModule
];
const declarations$1 = [
    StructureComponent,
    StructureHeaderComponent,
    StructureHeaderColumnsComponent,
    StructureHeaderGroupsComponent,
    StructureHeaderFiltersComponent,
    StructureHeaderFilterComponent,
    SelectAllComponent,
    StructureContentComponent,
    StructureRowComponent,
    StructureCellComponent,
    StructureCellEditComponent,
    StructureCellEditBooleanComponent,
    StructureContainerComponent,
    StructureQuickFiltersComponent,
    StructureBlueprintComponent,
    StructureRowDetailViewComponent,
    StructureTitlePanelComponent,
    StructureFooterPanelComponent,
    structureGates
];
const entryComponents$1 = [
    StructureColumnConfigComponent,
    StructureRowDetailViewComponent
];
const exportDeclarations$1 = [
    FabricModule,
    StructureComponent,
    StructureHeaderComponent,
    StructureContentComponent,
    StructureRowComponent,
    StructureContainerComponent,
    fabricImports,
    PagingFeatureModule,
    structureGates
];
class StructureModule {
    constructor(platformId) {
        this.platformId = platformId;
        if (isPlatformBrowser(this.platformId)) {
            window[StructureModule.HERMES_API].loggers = false;
        }
    }
    static withConfig(structureConfig = {
        cssClassName: '',
        hermesModuleConfig: { loggers: false }
    }) {
        return {
            ngModule: StructureModule,
            providers: [
                {
                    provide: STRUCTURE_CSS_CLASS_NAME,
                    useValue: structureConfig.cssClassName
                },
                { provide: COMMAND_LOGGER_ENABLED, useValue: structureConfig.hermesModuleConfig.loggers },
                { provide: EVENT_LOGGER_ENABLED, useValue: structureConfig.hermesModuleConfig.loggers },
                {
                    provide: STRUCTURE_CSS_CLASS_NAME,
                    useValue: 'structure'
                },
                {
                    provide: StructureDefinition,
                    useFactory: createStructureDefinition
                },
                ItemEntityFactory,
                StructureThemeConverter,
                StructureIdGenerator,
                StructureCellEditArchive,
                structureProviders
            ]
        };
    }
}
StructureModule.HERMES_API = 'hermesApi';
StructureModule.exportDeclarations = Array.from(exportDeclarations$1);
StructureModule.ɵfac = function StructureModule_Factory(t) { return new (t || StructureModule)(i0.ɵɵinject(PLATFORM_ID)); };
StructureModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: StructureModule });
StructureModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [[
            imports$1
        ], FabricModule, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, PagingFeatureModule] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(StructureModule, [{
        type: NgModule,
        args: [{
                imports: [
                    imports$1
                ],
                declarations: declarations$1,
                exports: exportDeclarations$1,
                entryComponents: entryComponents$1
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: Inject,
                args: [PLATFORM_ID]
            }] }]; }, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(StructureModule, { declarations: [StructureComponent,
        StructureHeaderComponent,
        StructureHeaderColumnsComponent,
        StructureHeaderGroupsComponent,
        StructureHeaderFiltersComponent,
        StructureHeaderFilterComponent,
        SelectAllComponent,
        StructureContentComponent,
        StructureRowComponent,
        StructureCellComponent,
        StructureCellEditComponent,
        StructureCellEditBooleanComponent,
        StructureContainerComponent,
        StructureQuickFiltersComponent,
        StructureBlueprintComponent,
        StructureRowDetailViewComponent,
        StructureTitlePanelComponent,
        StructureFooterPanelComponent, StructureColumnHeaderGate, StructurePagingGate, StructureSearchingGate, StructureSelectionGate, StructureL10nGate, StructurePanelGate, StructureRowDetailGate, StructureColumnMenuGate, StructureSummariesGate, StructureInfoPanelGate, StructureRowClassGate, StructureRowStyleGate, StructureRowColoringGate, ThemeGridGate, StructureSortingGate, SourceLoadingGate, StructureFilterGate, StructureQuickFiltersGate, VerticalFormationGate], imports: [CommonModule,
        ReactiveFormsModule,
        TranslationFeatureModule,
        HermesModule, i1$1.HermesDomainModule, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, ResizeDetectorModule,
        PagingFeatureModule,
        SortingFeatureModule,
        FieldFeatureModule,
        SearchFeatureModule,
        FilterMenuFeatureModule,
        SourceFeatureModule,
        SummariesFeatureModule,
        VerticalFormationFeatureModule,
        SchemaFeatureModule,
        StructureSharedModule,
        StructureInfoPanelModule,
        StructureTopPanelModule,
        StructureColumnMenuModule,
        StructureColumnManagerModule,
        SchemaManagerModule,
        EmptySourceFeatureModule,
        CompositionFeatureModule,
        LoggerModule,
        SanitizeModule], exports: [FabricModule,
        StructureComponent,
        StructureHeaderComponent,
        StructureContentComponent,
        StructureRowComponent,
        StructureContainerComponent, i1.FabricBadgeModule, i1.FabricButtonModule, i1.FabricButtonGroupModule, i1.FabricCheckboxModule, i1.FabricChipModule, i1.FabricDrawerModule, i1.FabricDropdownModule, i1.FabricRadioButtonModule, i1.FabricRadioGroupModule, i1.FabricProgressBarModule, i1.FabricProgressSpinnerModule, i1.FabricSelectModule, i1.FabricSpinnerModule, i1.FabricTabModule, i1.FabricTooltipModule, i1.FabricToggleButtonModule, i1.FabricInputModule, i1.FabricDialogModule, i1.FabricInlineDialogModule, i1.FabricTabModule, PagingFeatureModule, StructureColumnHeaderGate, StructurePagingGate, StructureSearchingGate, StructureSelectionGate, StructureL10nGate, StructurePanelGate, StructureRowDetailGate, StructureColumnMenuGate, StructureSummariesGate, StructureInfoPanelGate, StructureRowClassGate, StructureRowStyleGate, StructureRowColoringGate, ThemeGridGate, StructureSortingGate, SourceLoadingGate, StructureFilterGate, StructureQuickFiltersGate, VerticalFormationGate] }); })();

const imports = [
    CommonModule,
    ListViewFeatureModule,
    StructureModule.withConfig({
        cssClassName: 'list',
        hermesModuleConfig: {
            loggers: true
        }
    })
];
const declarations = [
    GuiListComponent,
    GuiListItemComponent,
    GuiListCardComponent
];
const providers = [];
const exportDeclarations = [
    GuiListComponent,
    GuiListItemComponent,
    GuiListCardComponent
];
const entryComponents = [];
class GuiListModule {
    static forRoot() {
        return {
            ngModule: GuiListModule,
            providers: providers
        };
    }
    static forChild() {
        return {
            ngModule: GuiListModule,
            providers: []
        };
    }
}
GuiListModule.ɵfac = function GuiListModule_Factory(t) { return new (t || GuiListModule)(); };
GuiListModule.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: GuiListModule });
GuiListModule.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [imports] });
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && i0.ɵsetClassMetadata(GuiListModule, [{
        type: NgModule,
        args: [{
                imports,
                declarations,
                exports: exportDeclarations,
                entryComponents
            }]
    }], null, null); })();
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && i0.ɵɵsetNgModuleScope(GuiListModule, { declarations: [GuiListComponent,
        GuiListItemComponent,
        GuiListCardComponent], imports: [CommonModule,
        ListViewFeatureModule, StructureModule], exports: [GuiListComponent,
        GuiListItemComponent,
        GuiListCardComponent] }); })();

/**
 * Generated bundle index. Do not edit.
 */

export { GuiListCardComponent, GuiListComponent, GuiListDefaultTranslation, GuiListFieldType, GuiListItemComponent, GuiListMode, GuiListModule, StructureComponent };
//# sourceMappingURL=generic-ui-ngx-list.js.map
