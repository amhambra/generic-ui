import { ChangeDetectionStrategy, Component, Input, ViewEncapsulation } from '@angular/core';
import { PagingDisplayMode } from './mode/paging-display-mode';
import { PagingPosition } from './paging-position';
import { CssClass } from '../../common/src/css-class/css-class';
import { GuiState } from '../../../gui-angular/state/gui.state';
import { hermesMap } from '@generic-ui/hermes';
import { GuiComponent } from '../../../common/component';
import * as i0 from "@angular/core";
import * as i1 from "../../../gui-angular/state/gui.state";
import * as i2 from "../../common/src/css-class/css-class.modifier";
import * as i3 from "../../../../core/structure/structure-core/src/api/global/structure.id";
import * as i4 from "../../../../core/structure/paging/src/api/paging.warehouse";
import * as i5 from "../../../../core/structure/paging/src/api/paging.publisher";
import * as i6 from "../../../../core/structure/source/src/api/source.warehouse";
import * as i7 from "./mode/paging-display-mode.archive";
import * as i8 from "@angular/common";
import * as i9 from "../../../gui-angular/template/let/gui.let.directive";
import * as i10 from "./basic/navigator/paging-navigator.component";
import * as i11 from "./select/paging-select.component";
import * as i12 from "./basic/stats/paging-stats.component";
import * as i13 from "./advanced/navigator/alternative-paging-navigator.component";
import * as i14 from "./advanced/pages/alternative-paging-pages.component";
export class PagingComponent extends GuiComponent {
    elRef;
    state;
    cssClassModifier;
    structureId;
    pagingWarehouse;
    pagingCommandInvoker;
    sourceWarehouse;
    pagingDisplayModeArchive;
    position;
    minimal;
    // @ts-ignore
    state$ = this.state.select();
    constructor(elRef, state, cssClassModifier, structureId, pagingWarehouse, pagingCommandInvoker, sourceWarehouse, pagingDisplayModeArchive) {
        super(elRef);
        this.elRef = elRef;
        this.state = state;
        this.cssClassModifier = cssClassModifier;
        this.structureId = structureId;
        this.pagingWarehouse = pagingWarehouse;
        this.pagingCommandInvoker = pagingCommandInvoker;
        this.sourceWarehouse = sourceWarehouse;
        this.pagingDisplayModeArchive = pagingDisplayModeArchive;
        this.addClassToHost('gui-flex');
        this.addClassToHost('gui-justify-end');
        this.addClassToHost('gui-items-center');
        this.addClassToHost('gui-p-4');
        this.state.setValue({
            alternativeDisplay: false,
            isPagingVisible: false
        });
        this.state.connect('sourceSize', this.sourceWarehouse.onOriginSize(this.structureId));
        this.state.connect('alternativeDisplay', this.selectIsAdvancedPagingEnabled());
        this.state.connect('paging', this.pagingWarehouse.onPaging(this.structureId));
        this.state.connect('isPagingVisible', this.selectIsPagingVisible());
    }
    ngOnChanges(changes) {
        if (changes.position) {
            if (this.position === PagingPosition.BOTTOM) {
                this.cssClassModifier.remove(this.elRef.nativeElement, CssClass.PAGING_TOP_CLASS_NAME);
                this.cssClassModifier.add(this.elRef.nativeElement, CssClass.PAGING_BOTTOM_CLASS_NAME);
            }
            else {
                this.cssClassModifier.remove(this.elRef.nativeElement, CssClass.PAGING_BOTTOM_CLASS_NAME);
                this.cssClassModifier.add(this.elRef.nativeElement, CssClass.PAGING_TOP_CLASS_NAME);
            }
        }
    }
    changePageSize(pageSize) {
        this.pagingCommandInvoker.changePageSize(pageSize, this.structureId);
    }
    nextPage(sourceSize) {
        if (!sourceSize) {
            return;
        }
        this.pagingCommandInvoker.nextPage(this.structureId);
    }
    prevPage() {
        this.pagingCommandInvoker.prevPage(this.structureId);
    }
    getSelectorName() {
        return 'gui-paging';
    }
    selectIsPagingVisible() {
        return this.pagingWarehouse
            .onPaging(this.structureId)
            .pipe(hermesMap((paging) => {
            return this.mapIsPagingVisible(paging);
        }));
    }
    mapIsPagingVisible(paging) {
        return paging && paging.isEnabled() &&
            (((this.position === PagingPosition.TOP) && paging.isPagerTop()) ||
                ((this.position === PagingPosition.BOTTOM) && paging.isPagerBottom()));
    }
    selectIsAdvancedPagingEnabled() {
        return this.pagingDisplayModeArchive
            .on()
            .pipe(hermesMap((mode) => {
            return mode === PagingDisplayMode.ADVANCED;
        }));
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: PagingComponent, deps: [{ token: i0.ElementRef }, { token: i1.GuiState }, { token: i2.CssClassModifier }, { token: i3.StructureId }, { token: i4.PagingWarehouse }, { token: i5.PagingPublisher }, { token: i6.SourceWarehouse }, { token: i7.PagingDisplayModeArchive }], target: i0.ɵɵFactoryTarget.Component });
    static ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "16.2.12", type: PagingComponent, selector: "div[gui-paging][position]", inputs: { position: "position", minimal: "minimal" }, providers: [
            GuiState
        ], usesInheritance: true, usesOnChanges: true, ngImport: i0, template: "<ng-container *guiLet=\"state$; let localState\">\n\n\t<ng-container *ngIf=\"localState.isPagingVisible && !localState.alternativeDisplay\">\n\n\t\t<ng-container *ngIf=\"!minimal; else minimalTemplate\">\n\n\t\t\t<div (pageSizeChanged)=\"changePageSize($event)\"\n\t\t\t\t [paging]=\"localState.paging\"\n\t\t\t\t gui-paging-select>\n\t\t\t</div>\n\n\t\t\t<div [paging]=\"localState.paging\"\n\t\t\t\t gui-paging-stats>\n\t\t\t</div>\n\n\t\t\t<div (nextPageChanged)=\"nextPage(localState.sourceSize)\"\n\t\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t\t [paging]=\"localState.paging\"\n\t\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t\t gui-paging-navigator>\n\t\t\t</div>\n\n\t\t</ng-container>\n\n\t\t<ng-template #minimalTemplate>\n\n\t\t\t<div [paging]=\"localState.paging\"\n\t\t\t\t gui-paging-stats>\n\t\t\t</div>\n\n\t\t\t<div (nextPageChanged)=\"nextPage(localState.sourceSize)\"\n\t\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t\t [paging]=\"localState.paging\"\n\t\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t\t gui-paging-navigator>\n\t\t\t</div>\n\n\t\t</ng-template>\n\n\t</ng-container>\n\n\t<ng-container *ngIf=\"localState.isPagingVisible && localState.alternativeDisplay\">\n\n\t\t<div (pageSizeChanged)=\"changePageSize($event)\"\n\t\t\t [paging]=\"localState.paging\"\n\t\t\t gui-paging-select>\n\t\t</div>\n\n\t\t<div (nextPageChanged)=\"nextPage(localState.sourceSize)\"\n\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t [paging]=\"localState.paging\"\n\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t class=\"gui-flex gui-p-0\"\n\t\t\t gui-paging-alternative-navigator>\n\n\t\t\t<div [paging]=\"localState.paging\"\n\t\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t\t class=\"gui-flex gui-justify-center\"\n\t\t\t\t gui-paging-alternative-pages>\n\t\t\t</div>\n\n\t\t</div>\n\n\t</ng-container>\n</ng-container>\n", styles: [".gui-paging-alternative-navigator .gui-button{-ms-flex-line-pack:center;align-content:center;background:transparent;display:-ms-flexbox;display:flex;font-size:14px;line-height:21px;margin:0 2px;padding:0}.gui-paging-alternative-navigator .gui-button svg{-ms-flex-item-align:center;align-self:center;height:12px;margin:-1px 2px 0;width:auto}.gui-paging-alternative-navigator .gui-button svg path{stroke:#ccc;transition:stroke .3s ease-in-out}.gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-paging-alternative-navigator .gui-button:hover svg path{stroke:#333}.gui-paging-alternative-navigator .gui-button:disabled svg{opacity:.4}.gui-paging-alternative-navigator .gui-material .gui-button{padding:2px 16px}.gui-paging-alternative-pages{line-height:21px}.gui-paging-alternative-pages .gui-paging-page{display:none}.gui-paging-alternative-pages .gui-paging-visible-page .gui-paging-page{display:block;font-family:Arial,serif}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page{color:#333}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page .gui-paging-page{font-weight:700}.gui-paging-bottom{border-top:1px solid;border-top-color:inherit}.gui-paging-top{border-bottom:1px solid;border-bottom-color:inherit}\n", ".gui-generic .gui-paging,.gui-generic .gui-paging *{border-color:#2224261a;font-size:14px}\n"], dependencies: [{ kind: "directive", type: i8.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i9.GuiLetDirective, selector: "[guiLet]", inputs: ["guiLet"] }, { kind: "component", type: i10.PagingNavigatorComponent, selector: "div[gui-paging-navigator][paging]", inputs: ["paging", "sourceSize"], outputs: ["nextPageChanged", "prevPageChanged"] }, { kind: "component", type: i11.PagingSelectComponent, selector: "div[gui-paging-select][paging]", inputs: ["paging"], outputs: ["pageSizeChanged"] }, { kind: "component", type: i12.PagingStatsComponent, selector: "div[gui-paging-stats][paging]", inputs: ["paging"] }, { kind: "component", type: i13.AlternativePagingNavigatorComponent, selector: "div[gui-paging-alternative-navigator][paging][sourceSize]", inputs: ["paging", "sourceSize"], outputs: ["nextPageChanged", "prevPageChanged"] }, { kind: "component", type: i14.AlternativePagingPagesComponent, selector: "div[gui-paging-alternative-pages][paging]", inputs: ["paging", "sourceSize"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: PagingComponent, decorators: [{
            type: Component,
            args: [{ selector: 'div[gui-paging][position]', changeDetection: ChangeDetectionStrategy.OnPush, encapsulation: ViewEncapsulation.None, providers: [
                        GuiState
                    ], template: "<ng-container *guiLet=\"state$; let localState\">\n\n\t<ng-container *ngIf=\"localState.isPagingVisible && !localState.alternativeDisplay\">\n\n\t\t<ng-container *ngIf=\"!minimal; else minimalTemplate\">\n\n\t\t\t<div (pageSizeChanged)=\"changePageSize($event)\"\n\t\t\t\t [paging]=\"localState.paging\"\n\t\t\t\t gui-paging-select>\n\t\t\t</div>\n\n\t\t\t<div [paging]=\"localState.paging\"\n\t\t\t\t gui-paging-stats>\n\t\t\t</div>\n\n\t\t\t<div (nextPageChanged)=\"nextPage(localState.sourceSize)\"\n\t\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t\t [paging]=\"localState.paging\"\n\t\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t\t gui-paging-navigator>\n\t\t\t</div>\n\n\t\t</ng-container>\n\n\t\t<ng-template #minimalTemplate>\n\n\t\t\t<div [paging]=\"localState.paging\"\n\t\t\t\t gui-paging-stats>\n\t\t\t</div>\n\n\t\t\t<div (nextPageChanged)=\"nextPage(localState.sourceSize)\"\n\t\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t\t [paging]=\"localState.paging\"\n\t\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t\t gui-paging-navigator>\n\t\t\t</div>\n\n\t\t</ng-template>\n\n\t</ng-container>\n\n\t<ng-container *ngIf=\"localState.isPagingVisible && localState.alternativeDisplay\">\n\n\t\t<div (pageSizeChanged)=\"changePageSize($event)\"\n\t\t\t [paging]=\"localState.paging\"\n\t\t\t gui-paging-select>\n\t\t</div>\n\n\t\t<div (nextPageChanged)=\"nextPage(localState.sourceSize)\"\n\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t [paging]=\"localState.paging\"\n\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t class=\"gui-flex gui-p-0\"\n\t\t\t gui-paging-alternative-navigator>\n\n\t\t\t<div [paging]=\"localState.paging\"\n\t\t\t\t [sourceSize]=\"localState.sourceSize\"\n\t\t\t\t class=\"gui-flex gui-justify-center\"\n\t\t\t\t gui-paging-alternative-pages>\n\t\t\t</div>\n\n\t\t</div>\n\n\t</ng-container>\n</ng-container>\n", styles: [".gui-paging-alternative-navigator .gui-button{-ms-flex-line-pack:center;align-content:center;background:transparent;display:-ms-flexbox;display:flex;font-size:14px;line-height:21px;margin:0 2px;padding:0}.gui-paging-alternative-navigator .gui-button svg{-ms-flex-item-align:center;align-self:center;height:12px;margin:-1px 2px 0;width:auto}.gui-paging-alternative-navigator .gui-button svg path{stroke:#ccc;transition:stroke .3s ease-in-out}.gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-paging-alternative-navigator .gui-button:hover svg path{stroke:#333}.gui-paging-alternative-navigator .gui-button:disabled svg{opacity:.4}.gui-paging-alternative-navigator .gui-material .gui-button{padding:2px 16px}.gui-paging-alternative-pages{line-height:21px}.gui-paging-alternative-pages .gui-paging-page{display:none}.gui-paging-alternative-pages .gui-paging-visible-page .gui-paging-page{display:block;font-family:Arial,serif}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page{color:#333}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page .gui-paging-page{font-weight:700}.gui-paging-bottom{border-top:1px solid;border-top-color:inherit}.gui-paging-top{border-bottom:1px solid;border-bottom-color:inherit}\n", ".gui-generic .gui-paging,.gui-generic .gui-paging *{border-color:#2224261a;font-size:14px}\n"] }]
        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i1.GuiState }, { type: i2.CssClassModifier }, { type: i3.StructureId }, { type: i4.PagingWarehouse }, { type: i5.PagingPublisher }, { type: i6.SourceWarehouse }, { type: i7.PagingDisplayModeArchive }]; }, propDecorators: { position: [{
                type: Input
            }], minimal: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnaW5nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL2J1aWxkLWNsaS9wcm9qZWN0cy9uZ3gtbGlzdC9zcmMvZmVhdHVyZS9zdHJ1Y3R1cmUvcGFnaW5nL3NyYy9wYWdpbmcuY29tcG9uZW50LnRzIiwiLi4vLi4vLi4vLi4vLi4vLi4vYnVpbGQtY2xpL3Byb2plY3RzL25neC1saXN0L3NyYy9mZWF0dXJlL3N0cnVjdHVyZS9wYWdpbmcvc3JjL3BhZ2luZy5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsU0FBUyxFQUFjLEtBQUssRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQU96RyxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUMvRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFFbkQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLHNDQUFzQyxDQUFDO0FBR2hFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUNoRSxPQUFPLEVBQUUsU0FBUyxFQUFvQixNQUFNLG9CQUFvQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7OztBQTJCekQsTUFBTSxPQUFPLGVBQWdCLFNBQVEsWUFBWTtJQVduQjtJQUNUO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBZnBCLFFBQVEsQ0FBa0I7SUFHMUIsT0FBTyxDQUFXO0lBRWxCLGFBQWE7SUFDSixNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztJQUV0QyxZQUE2QixLQUFpQixFQUMxQixLQUFxQyxFQUNyQyxnQkFBa0MsRUFDbEMsV0FBd0IsRUFDeEIsZUFBZ0MsRUFDaEMsb0JBQXFDLEVBQ3JD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dCB7IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIEVsZW1lbnRSZWYsIElucHV0LCBWaWV3RW5jYXBzdWxhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBQYWdpbmdNb2RlbCB9IGZyb20gJy4uLy4uLy4uLy4uL2NvcmUvc3RydWN0dXJlL3BhZ2luZy9zcmMvYXBpL21vZGVsL3BhZ2luZy5tb2RlbCc7XG5pbXBvcnQgeyBQYWdpbmdXYXJlaG91c2UgfSBmcm9tICcuLi8uLi8uLi8uLi9jb3JlL3N0cnVjdHVyZS9wYWdpbmcvc3JjL2FwaS9wYWdpbmcud2FyZWhvdXNlJztcbmltcG9ydCB7IFBhZ2luZ1B1Ymxpc2hlciB9IGZyb20gJy4uLy4uLy4uLy4uL2NvcmUvc3RydWN0dXJlL3BhZ2luZy9zcmMvYXBpL3BhZ2luZy5wdWJsaXNoZXInO1xuaW1wb3J0IHsgU291cmNlV2FyZWhvdXNlIH0gZnJvbSAnLi4vLi4vLi4vLi4vY29yZS9zdHJ1Y3R1cmUvc291cmNlL3NyYy9hcGkvc291cmNlLndhcmVob3VzZSc7XG5pbXBvcnQgeyBQYWdpbmdEaXNwbGF5TW9kZUFyY2hpdmUgfSBmcm9tICcuL21vZGUvcGFnaW5nLWRpc3BsYXktbW9kZS5hcmNoaXZlJztcbmltcG9ydCB7IFBhZ2luZ0Rpc3BsYXlNb2RlIH0gZnJvbSAnLi9tb2RlL3BhZ2luZy1kaXNwbGF5LW1vZGUnO1xuaW1wb3J0IHsgUGFnaW5nUG9zaXRpb24gfSBmcm9tICcuL3BhZ2luZy1wb3NpdGlvbic7XG5pbXBvcnQgeyBDc3NDbGFzc01vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29tbW9uL3NyYy9jc3MtY2xhc3MvY3NzLWNsYXNzLm1vZGlmaWVyJztcbmltcG9ydCB7IENzc0NsYXNzIH0gZnJvbSAnLi4vLi4vY29tbW9uL3NyYy9jc3MtY2xhc3MvY3NzLWNsYXNzJztcbmltcG9ydCB7IE5nQ2hhbmdlcyB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9jb21wb25lbnQvc3JjL25nLWNoYW5nZXMnO1xuaW1wb3J0IHsgU3RydWN0dXJlSWQgfSBmcm9tICcuLi8uLi8uLi8uLi9jb3JlL3N0cnVjdHVyZS9zdHJ1Y3R1cmUtY29yZS9zcmMvYXBpL2dsb2JhbC9zdHJ1Y3R1cmUuaWQnO1xuaW1wb3J0IHsgR3VpU3RhdGUgfSBmcm9tICcuLi8uLi8uLi9ndWktYW5ndWxhci9zdGF0ZS9ndWkuc3RhdGUnO1xuaW1wb3J0IHsgaGVybWVzTWFwLCBIZXJtZXNPYnNlcnZhYmxlIH0gZnJvbSAnQGdlbmVyaWMtdWkvaGVybWVzJztcbmltcG9ydCB7IEd1aUNvbXBvbmVudCB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9jb21wb25lbnQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBhZ2luZ0NvbXBvbmVudFN0YXRlIHtcblxuXHRhbHRlcm5hdGl2ZURpc3BsYXk6IGJvb2xlYW47XG5cblx0c291cmNlU2l6ZTogbnVtYmVyO1xuXG5cdHBhZ2luZzogUGFnaW5nTW9kZWw7XG5cblx0aXNQYWdpbmdWaXNpYmxlOiBib29sZWFuO1xuXG59XG5cbkBDb21wb25lbnQoe1xuXHRzZWxlY3RvcjogJ2RpdltndWktcGFnaW5nXVtwb3NpdGlvbl0nLFxuXHR0ZW1wbGF0ZVVybDogJy4vcGFnaW5nLmNvbXBvbmVudC5odG1sJyxcblx0c3R5bGVVcmxzOiBbXG5cdFx0Jy4vc3R5bGUvcGFnaW5nLmNvbXBvbmVudC5zY3NzJyxcblx0XHQnLi9zdHlsZS90aGVtZS9nZW5lcmljLnBhZ2luZy5jb21wb25lbnQuc2Nzcydcblx0XSxcblx0Y2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG5cdGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG5cdHByb3ZpZGVyczogW1xuXHRcdEd1aVN0YXRlXG5cdF1cbn0pXG5leHBvcnQgY2xhc3MgUGFnaW5nQ29tcG9uZW50IGV4dGVuZHMgR3VpQ29tcG9uZW50IHtcblxuXHRASW5wdXQoKVxuXHRwb3NpdGlvbiE6IFBhZ2luZ1Bvc2l0aW9uO1xuXG5cdEBJbnB1dCgpXG5cdG1pbmltYWw/OiBib29sZWFuO1xuXG5cdC8vIEB0cy1pZ25vcmVcblx0cmVhZG9ubHkgc3RhdGUkID0gdGhpcy5zdGF0ZS5zZWxlY3QoKTtcblxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGVsUmVmOiBFbGVtZW50UmVmLFxuXHRcdFx0XHRwcml2YXRlIHJlYWRvbmx5IHN0YXRlOiBHdWlTdGF0ZTxQYWdpbmdDb21wb25lbnRTdGF0ZT4sXG5cdFx0XHRcdHByaXZhdGUgcmVhZG9ubHkgY3NzQ2xhc3NNb2RpZmllcjogQ3NzQ2xhc3NNb2RpZmllcixcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSBzdHJ1Y3R1cmVJZDogU3RydWN0dXJlSWQsXG5cdFx0XHRcdHByaXZhdGUgcmVhZG9ubHkgcGFnaW5nV2FyZWhvdXNlOiBQYWdpbmdXYXJlaG91c2UsXG5cdFx0XHRcdHByaXZhdGUgcmVhZG9ubHkgcGFnaW5nQ29tbWFuZEludm9rZXI6IFBhZ2luZ1B1Ymxpc2hlcixcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSBzb3VyY2VXYXJlaG91c2U6IFNvdXJjZVdhcmVob3VzZSxcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSBwYWdpbmdEaXNwbGF5TW9kZUFyY2hpdmU6IFBhZ2luZ0Rpc3BsYXlNb2RlQXJjaGl2ZSkge1xuXHRcdHN1cGVyKGVsUmVmKTtcblx0XHR0aGlzLmFkZENsYXNzVG9Ib3N0KCdndWktZmxleCcpO1xuXHRcdHRoaXMuYWRkQ2xhc3NUb0hvc3QoJ2d1aS1qdXN0aWZ5LWVuZCcpO1xuXHRcdHRoaXMuYWRkQ2xhc3NUb0hvc3QoJ2d1aS1pdGVtcy1jZW50ZXInKTtcblx0XHR0aGlzLmFkZENsYXNzVG9Ib3N0KCdndWktcC00Jyk7XG5cblx0XHR0aGlzLnN0YXRlLnNldFZhbHVlKHtcblx0XHRcdGFsdGVybmF0aXZlRGlzcGxheTogZmFsc2UsXG5cdFx0XHRpc1BhZ2luZ1Zpc2libGU6IGZhbHNlXG5cdFx0fSk7XG5cblx0XHR0aGlzLnN0YXRlLmNvbm5lY3QoJ3NvdXJjZVNpemUnLCB0aGlzLnNvdXJjZVdhcmVob3VzZS5vbk9yaWdpblNpemUodGhpcy5zdHJ1Y3R1cmVJZCkpO1xuXHRcdHRoaXMuc3RhdGUuY29ubmVjdCgnYWx0ZXJuYXRpdmVEaXNwbGF5JywgdGhpcy5zZWxlY3RJc0FkdmFuY2VkUGFnaW5nRW5hYmxlZCgpKTtcblx0XHR0aGlzLnN0YXRlLmNvbm5lY3QoJ3BhZ2luZycsIHRoaXMucGFnaW5nV2FyZWhvdXNlLm9uUGFnaW5nKHRoaXMuc3RydWN0dXJlSWQpKTtcblx0XHR0aGlzLnN0YXRlLmNvbm5lY3QoJ2lzUGFnaW5nVmlzaWJsZScsIHRoaXMuc2VsZWN0SXNQYWdpbmdWaXNpYmxlKCkpO1xuXHR9XG5cblx0bmdPbkNoYW5nZXMoY2hhbmdlczogTmdDaGFuZ2VzPFBhZ2luZ0NvbXBvbmVudD4pIHtcblxuXHRcdGlmIChjaGFuZ2VzLnBvc2l0aW9uKSB7XG5cblx0XHRcdGlmICh0aGlzLnBvc2l0aW9uID09PSBQYWdpbmdQb3NpdGlvbi5CT1RUT00pIHtcblx0XHRcdFx0dGhpcy5jc3NDbGFzc01vZGlmaWVyLnJlbW92ZSh0aGlzLmVsUmVmLm5hdGl2ZUVsZW1lbnQsIENzc0NsYXNzLlBBR0lOR19UT1BfQ0xBU1NfTkFNRSk7XG5cdFx0XHRcdHRoaXMuY3NzQ2xhc3NNb2RpZmllci5hZGQodGhpcy5lbFJlZi5uYXRpdmVFbGVtZW50LCBDc3NDbGFzcy5QQUdJTkdfQk9UVE9NX0NMQVNTX05BTUUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5jc3NDbGFzc01vZGlmaWVyLnJlbW92ZSh0aGlzLmVsUmVmLm5hdGl2ZUVsZW1lbnQsIENzc0NsYXNzLlBBR0lOR19CT1RUT01fQ0xBU1NfTkFNRSk7XG5cdFx0XHRcdHRoaXMuY3NzQ2xhc3NNb2RpZmllci5hZGQodGhpcy5lbFJlZi5uYXRpdmVFbGVtZW50LCBDc3NDbGFzcy5QQUdJTkdfVE9QX0NMQVNTX05BTUUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGNoYW5nZVBhZ2VTaXplKHBhZ2VTaXplOiBudW1iZXIpIHtcblx0XHR0aGlzLnBhZ2luZ0NvbW1hbmRJbnZva2VyLmNoYW5nZVBhZ2VTaXplKHBhZ2VTaXplLCB0aGlzLnN0cnVjdHVyZUlkKTtcblx0fVxuXG5cdG5leHRQYWdlKHNvdXJjZVNpemU6IG51bWJlcik6IHZvaWQge1xuXG5cdFx0aWYgKCFzb3VyY2VTaXplKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5wYWdpbmdDb21tYW5kSW52b2tlci5uZXh0UGFnZSh0aGlzLnN0cnVjdHVyZUlkKTtcblx0fVxuXG5cdHByZXZQYWdlKCk6IHZvaWQge1xuXHRcdHRoaXMucGFnaW5nQ29tbWFuZEludm9rZXIucHJldlBhZ2UodGhpcy5zdHJ1Y3R1cmVJZCk7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZ2V0U2VsZWN0b3JOYW1lKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuICdndWktcGFnaW5nJztcblx0fVxuXG5cdHByaXZhdGUgc2VsZWN0SXNQYWdpbmdWaXNpYmxlKCk6IEhlcm1lc09ic2VydmFibGU8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiB0aGlzLnBhZ2luZ1dhcmVob3VzZVxuXHRcdFx0XHQgICAub25QYWdpbmcodGhpcy5zdHJ1Y3R1cmVJZClcblx0XHRcdFx0ICAgLnBpcGUoXG5cdFx0XHRcdFx0ICAgaGVybWVzTWFwKChwYWdpbmc6IFBhZ2luZ01vZGVsKSA9PiB7XG5cdFx0XHRcdFx0XHQgICByZXR1cm4gdGhpcy5tYXBJc1BhZ2luZ1Zpc2libGUocGFnaW5nKTtcblx0XHRcdFx0XHQgICB9KVxuXHRcdFx0XHQgICApO1xuXHR9XG5cblx0cHJpdmF0ZSBtYXBJc1BhZ2luZ1Zpc2libGUocGFnaW5nOiBQYWdpbmdNb2RlbCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiBwYWdpbmcgJiYgcGFnaW5nLmlzRW5hYmxlZCgpICYmXG5cdFx0XHQoKCh0aGlzLnBvc2l0aW9uID09PSBQYWdpbmdQb3NpdGlvbi5UT1ApICYmIHBhZ2luZy5pc1BhZ2VyVG9wKCkpIHx8XG5cdFx0XHRcdCgodGhpcy5wb3NpdGlvbiA9PT0gUGFnaW5nUG9zaXRpb24uQk9UVE9NKSAmJiBwYWdpbmcuaXNQYWdlckJvdHRvbSgpKSk7XG5cdH1cblxuXHRwcml2YXRlIHNlbGVjdElzQWR2YW5jZWRQYWdpbmdFbmFibGVkKCk6IEhlcm1lc09ic2VydmFibGU8Ym9vbGVhbj4ge1xuXHRcdHJldHVybiB0aGlzLnBhZ2luZ0Rpc3BsYXlNb2RlQXJjaGl2ZVxuXHRcdFx0XHQgICAub24oKVxuXHRcdFx0XHQgICAucGlwZShcblx0XHRcdFx0XHQgICBoZXJtZXNNYXAoKG1vZGU6IFBhZ2luZ0Rpc3BsYXlNb2RlKSA9PiB7XG5cdFx0XHRcdFx0XHQgICByZXR1cm4gbW9kZSA9PT0gUGFnaW5nRGlzcGxheU1vZGUuQURWQU5DRUQ7XG5cdFx0XHRcdFx0ICAgfSlcblx0XHRcdFx0ICAgKTtcblx0fVxuXG59XG4iLCI8bmctY29udGFpbmVyICpndWlMZXQ9XCJzdGF0ZSQ7IGxldCBsb2NhbFN0YXRlXCI+XG5cblx0PG5nLWNvbnRhaW5lciAqbmdJZj1cImxvY2FsU3RhdGUuaXNQYWdpbmdWaXNpYmxlICYmICFsb2NhbFN0YXRlLmFsdGVybmF0aXZlRGlzcGxheVwiPlxuXG5cdFx0PG5nLWNvbnRhaW5lciAqbmdJZj1cIiFtaW5pbWFsOyBlbHNlIG1pbmltYWxUZW1wbGF0ZVwiPlxuXG5cdFx0XHQ8ZGl2IChwYWdlU2l6ZUNoYW5nZWQpPVwiY2hhbmdlUGFnZVNpemUoJGV2ZW50KVwiXG5cdFx0XHRcdCBbcGFnaW5nXT1cImxvY2FsU3RhdGUucGFnaW5nXCJcblx0XHRcdFx0IGd1aS1wYWdpbmctc2VsZWN0PlxuXHRcdFx0PC9kaXY+XG5cblx0XHRcdDxkaXYgW3BhZ2luZ109XCJsb2NhbFN0YXRlLnBhZ2luZ1wiXG5cdFx0XHRcdCBndWktcGFnaW5nLXN0YXRzPlxuXHRcdFx0PC9kaXY+XG5cblx0XHRcdDxkaXYgKG5leHRQYWdlQ2hhbmdlZCk9XCJuZXh0UGFnZShsb2NhbFN0YXRlLnNvdXJjZVNpemUpXCJcblx0XHRcdFx0IChwcmV2UGFnZUNoYW5nZWQpPVwicHJldlBhZ2UoKVwiXG5cdFx0XHRcdCBbcGFnaW5nXT1cImxvY2FsU3RhdGUucGFnaW5nXCJcblx0XHRcdFx0IFtzb3VyY2VTaXplXT1cImxvY2FsU3RhdGUuc291cmNlU2l6ZVwiXG5cdFx0XHRcdCBndWktcGFnaW5nLW5hdmlnYXRvcj5cblx0XHRcdDwvZGl2PlxuXG5cdFx0PC9uZy1jb250YWluZXI+XG5cblx0XHQ8bmctdGVtcGxhdGUgI21pbmltYWxUZW1wbGF0ZT5cblxuXHRcdFx0PGRpdiBbcGFnaW5nXT1cImxvY2FsU3RhdGUucGFnaW5nXCJcblx0XHRcdFx0IGd1aS1wYWdpbmctc3RhdHM+XG5cdFx0XHQ8L2Rpdj5cblxuXHRcdFx0PGRpdiAobmV4dFBhZ2VDaGFuZ2VkKT1cIm5leHRQYWdlKGxvY2FsU3RhdGUuc291cmNlU2l6ZSlcIlxuXHRcdFx0XHQgKHByZXZQYWdlQ2hhbmdlZCk9XCJwcmV2UGFnZSgpXCJcblx0XHRcdFx0IFtwYWdpbmddPVwibG9jYWxTdGF0ZS5wYWdpbmdcIlxuXHRcdFx0XHQgW3NvdXJjZVNpemVdPVwibG9jYWxTdGF0ZS5zb3VyY2VTaXplXCJcblx0XHRcdFx0IGd1aS1wYWdpbmctbmF2aWdhdG9yPlxuXHRcdFx0PC9kaXY+XG5cblx0XHQ8L25nLXRlbXBsYXRlPlxuXG5cdDwvbmctY29udGFpbmVyPlxuXG5cdDxuZy1jb250YWluZXIgKm5nSWY9XCJsb2NhbFN0YXRlLmlzUGFnaW5nVmlzaWJsZSAmJiBsb2NhbFN0YXRlLmFsdGVybmF0aXZlRGlzcGxheVwiPlxuXG5cdFx0PGRpdiAocGFnZVNpemVDaGFuZ2VkKT1cImNoYW5nZVBhZ2VTaXplKCRldmVudClcIlxuXHRcdFx0IFtwYWdpbmddPVwibG9jYWxTdGF0ZS5wYWdpbmdcIlxuXHRcdFx0IGd1aS1wYWdpbmctc2VsZWN0PlxuXHRcdDwvZGl2PlxuXG5cdFx0PGRpdiAobmV4dFBhZ2VDaGFuZ2VkKT1cIm5leHRQYWdlKGxvY2FsU3RhdGUuc291cmNlU2l6ZSlcIlxuXHRcdFx0IChwcmV2UGFnZUNoYW5nZWQpPVwicHJldlBhZ2UoKVwiXG5cdFx0XHQgW3BhZ2luZ109XCJsb2NhbFN0YXRlLnBhZ2luZ1wiXG5cdFx0XHQgW3NvdXJjZVNpemVdPVwibG9jYWxTdGF0ZS5zb3VyY2VTaXplXCJcblx0XHRcdCBjbGFzcz1cImd1aS1mbGV4IGd1aS1wLTBcIlxuXHRcdFx0IGd1aS1wYWdpbmctYWx0ZXJuYXRpdmUtbmF2aWdhdG9yPlxuXG5cdFx0XHQ8ZGl2IFtwYWdpbmddPVwibG9jYWxTdGF0ZS5wYWdpbmdcIlxuXHRcdFx0XHQgW3NvdXJjZVNpemVdPVwibG9jYWxTdGF0ZS5zb3VyY2VTaXplXCJcblx0XHRcdFx0IGNsYXNzPVwiZ3VpLWZsZXggZ3VpLWp1c3RpZnktY2VudGVyXCJcblx0XHRcdFx0IGd1aS1wYWdpbmctYWx0ZXJuYXRpdmUtcGFnZXM+XG5cdFx0XHQ8L2Rpdj5cblxuXHRcdDwvZGl2PlxuXG5cdDwvbmctY29udGFpbmVyPlxuPC9uZy1jb250YWluZXI+XG4iXX0=