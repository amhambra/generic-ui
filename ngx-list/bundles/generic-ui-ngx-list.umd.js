(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('@angular/common'), require('@generic-ui/fabric'), require('@generic-ui/hermes'), require('@angular/forms'), require('rxjs/operators'), require('@angular/platform-browser'), require('rxjs')) :
    typeof define === 'function' && define.amd ? define('@generic-ui/ngx-list', ['exports', '@angular/core', '@angular/common', '@generic-ui/fabric', '@generic-ui/hermes', '@angular/forms', 'rxjs/operators', '@angular/platform-browser', 'rxjs'], factory) :
    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory((global["generic-ui"] = global["generic-ui"] || {}, global["generic-ui"]["ngx-list"] = {}), global.ng.core, global.ng.common, global["@generic-ui/fabric"], global["@generic-ui/hermes"], global.ng.forms, global.rxjs.operators, global.ng.platformBrowser, global.rxjs));
})(this, (function (exports, core, common, fabric, hermes, forms, operators, platformBrowser, rxjs) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
    /* global Reflect, Promise */
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b)
                if (b.hasOwnProperty(p))
                    d[p] = b[p]; };
        return extendStatics(d, b);
    };
    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };
    function __rest(s, e) {
        var t = {};
        for (var p in s)
            if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
                t[p] = s[p];
        if (s != null && typeof Object.getOwnPropertySymbols === "function")
            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
                if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                    t[p[i]] = s[p[i]];
            }
        return t;
    }
    function __decorate(decorators, target, key, desc) {
        var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
        if (typeof Reflect === "object" && typeof Reflect.decorate === "function")
            r = Reflect.decorate(decorators, target, key, desc);
        else
            for (var i = decorators.length - 1; i >= 0; i--)
                if (d = decorators[i])
                    r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
        return c > 3 && r && Object.defineProperty(target, key, r), r;
    }
    function __param(paramIndex, decorator) {
        return function (target, key) { decorator(target, key, paramIndex); };
    }
    function __metadata(metadataKey, metadataValue) {
        if (typeof Reflect === "object" && typeof Reflect.metadata === "function")
            return Reflect.metadata(metadataKey, metadataValue);
    }
    function __awaiter(thisArg, _arguments, P, generator) {
        function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
        return new (P || (P = Promise))(function (resolve, reject) {
            function fulfilled(value) { try {
                step(generator.next(value));
            }
            catch (e) {
                reject(e);
            } }
            function rejected(value) { try {
                step(generator["throw"](value));
            }
            catch (e) {
                reject(e);
            } }
            function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }
    function __generator(thisArg, body) {
        var _ = { label: 0, sent: function () { if (t[0] & 1)
                throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
        return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function () { return this; }), g;
        function verb(n) { return function (v) { return step([n, v]); }; }
        function step(op) {
            if (f)
                throw new TypeError("Generator is already executing.");
            while (_)
                try {
                    if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done)
                        return t;
                    if (y = 0, t)
                        op = [op[0] & 2, t.value];
                    switch (op[0]) {
                        case 0:
                        case 1:
                            t = op;
                            break;
                        case 4:
                            _.label++;
                            return { value: op[1], done: false };
                        case 5:
                            _.label++;
                            y = op[1];
                            op = [0];
                            continue;
                        case 7:
                            op = _.ops.pop();
                            _.trys.pop();
                            continue;
                        default:
                            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {
                                _ = 0;
                                continue;
                            }
                            if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) {
                                _.label = op[1];
                                break;
                            }
                            if (op[0] === 6 && _.label < t[1]) {
                                _.label = t[1];
                                t = op;
                                break;
                            }
                            if (t && _.label < t[2]) {
                                _.label = t[2];
                                _.ops.push(op);
                                break;
                            }
                            if (t[2])
                                _.ops.pop();
                            _.trys.pop();
                            continue;
                    }
                    op = body.call(thisArg, _);
                }
                catch (e) {
                    op = [6, e];
                    y = 0;
                }
                finally {
                    f = t = 0;
                }
            if (op[0] & 5)
                throw op[1];
            return { value: op[0] ? op[1] : void 0, done: true };
        }
    }
    function __createBinding(o, m, k, k2) {
        if (k2 === undefined)
            k2 = k;
        o[k2] = m[k];
    }
    function __exportStar(m, exports) {
        for (var p in m)
            if (p !== "default" && !exports.hasOwnProperty(p))
                exports[p] = m[p];
    }
    function __values(o) {
        var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
        if (m)
            return m.call(o);
        if (o && typeof o.length === "number")
            return {
                next: function () {
                    if (o && i >= o.length)
                        o = void 0;
                    return { value: o && o[i++], done: !o };
                }
            };
        throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
    }
    function __read(o, n) {
        var m = typeof Symbol === "function" && o[Symbol.iterator];
        if (!m)
            return o;
        var i = m.call(o), r, ar = [], e;
        try {
            while ((n === void 0 || n-- > 0) && !(r = i.next()).done)
                ar.push(r.value);
        }
        catch (error) {
            e = { error: error };
        }
        finally {
            try {
                if (r && !r.done && (m = i["return"]))
                    m.call(i);
            }
            finally {
                if (e)
                    throw e.error;
            }
        }
        return ar;
    }
    function __spread() {
        for (var ar = [], i = 0; i < arguments.length; i++)
            ar = ar.concat(__read(arguments[i]));
        return ar;
    }
    function __spreadArrays() {
        for (var s = 0, i = 0, il = arguments.length; i < il; i++)
            s += arguments[i].length;
        for (var r = Array(s), k = 0, i = 0; i < il; i++)
            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
                r[k] = a[j];
        return r;
    }
    ;
    function __await(v) {
        return this instanceof __await ? (this.v = v, this) : new __await(v);
    }
    function __asyncGenerator(thisArg, _arguments, generator) {
        if (!Symbol.asyncIterator)
            throw new TypeError("Symbol.asyncIterator is not defined.");
        var g = generator.apply(thisArg, _arguments || []), i, q = [];
        return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
        function verb(n) { if (g[n])
            i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
        function resume(n, v) { try {
            step(g[n](v));
        }
        catch (e) {
            settle(q[0][3], e);
        } }
        function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
        function fulfill(value) { resume("next", value); }
        function reject(value) { resume("throw", value); }
        function settle(f, v) { if (f(v), q.shift(), q.length)
            resume(q[0][0], q[0][1]); }
    }
    function __asyncDelegator(o) {
        var i, p;
        return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
        function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
    }
    function __asyncValues(o) {
        if (!Symbol.asyncIterator)
            throw new TypeError("Symbol.asyncIterator is not defined.");
        var m = o[Symbol.asyncIterator], i;
        return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
        function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
        function settle(resolve, reject, d, v) { Promise.resolve(v).then(function (v) { resolve({ value: v, done: d }); }, reject); }
    }
    function __makeTemplateObject(cooked, raw) {
        if (Object.defineProperty) {
            Object.defineProperty(cooked, "raw", { value: raw });
        }
        else {
            cooked.raw = raw;
        }
        return cooked;
    }
    ;
    function __importStar(mod) {
        if (mod && mod.__esModule)
            return mod;
        var result = {};
        if (mod != null)
            for (var k in mod)
                if (Object.hasOwnProperty.call(mod, k))
                    result[k] = mod[k];
        result.default = mod;
        return result;
    }
    function __importDefault(mod) {
        return (mod && mod.__esModule) ? mod : { default: mod };
    }
    function __classPrivateFieldGet(receiver, privateMap) {
        if (!privateMap.has(receiver)) {
            throw new TypeError("attempted to get private field on non-instance");
        }
        return privateMap.get(receiver);
    }
    function __classPrivateFieldSet(receiver, privateMap, value) {
        if (!privateMap.has(receiver)) {
            throw new TypeError("attempted to set private field on non-instance");
        }
        privateMap.set(receiver, value);
        return value;
    }

    var GuiListItemComponent = /** @class */ (function () {
        function GuiListItemComponent() {
        }
        return GuiListItemComponent;
    }());
    GuiListItemComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-list-item',
                    template: ''
                },] }
    ];
    GuiListItemComponent.propDecorators = {
        templateRef: [{ type: core.ContentChild, args: [core.TemplateRef, { static: true },] }]
    };

    var PagingDisplayMode;
    (function (PagingDisplayMode) {
        PagingDisplayMode[PagingDisplayMode["BASIC"] = 0] = "BASIC";
        PagingDisplayMode[PagingDisplayMode["ADVANCED"] = 1] = "ADVANCED";
    })(PagingDisplayMode || (PagingDisplayMode = {}));

    var GuiListPagingConverter = /** @class */ (function () {
        function GuiListPagingConverter() {
        }
        GuiListPagingConverter.prototype.convert = function (guiListPaging) {
            var pagingConfig = {};
            if (guiListPaging.enabled !== undefined && guiListPaging.enabled !== null) {
                pagingConfig.enabled = guiListPaging.enabled;
            }
            if (guiListPaging.page !== undefined && guiListPaging.page !== null) {
                pagingConfig.page = guiListPaging.page;
            }
            if (guiListPaging.pageSize !== undefined && guiListPaging.pageSize !== null) {
                pagingConfig.pageSize = guiListPaging.pageSize;
            }
            if (guiListPaging.pageSizes !== undefined && guiListPaging.pageSizes !== null) {
                pagingConfig.pageSizes = guiListPaging.pageSizes;
            }
            if (guiListPaging.pagerTop !== undefined && guiListPaging.pagerTop !== null) {
                pagingConfig.pagerTop = guiListPaging.pagerTop;
            }
            else {
                pagingConfig.pagerTop = true;
            }
            if (guiListPaging.pagerBottom !== undefined && guiListPaging.pagerBottom !== null) {
                pagingConfig.pagerBottom = guiListPaging.pagerBottom;
            }
            pagingConfig.displayMode = PagingDisplayMode.BASIC;
            return pagingConfig;
        };
        return GuiListPagingConverter;
    }());

    var GuiListCardComponent = /** @class */ (function () {
        function GuiListCardComponent() {
        }
        return GuiListCardComponent;
    }());
    GuiListCardComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-list-card',
                    template: ''
                },] }
    ];
    GuiListCardComponent.propDecorators = {
        templateRef: [{ type: core.ContentChild, args: [core.TemplateRef, { static: true },] }]
    };

    var ListViewMode;
    (function (ListViewMode) {
        ListViewMode["LIST"] = "List";
        ListViewMode["CARD"] = "Card";
    })(ListViewMode || (ListViewMode = {}));

    var enTranslation = {
        sourceEmpty: 'There are no items to show.',
        pagingItemsPerPage: 'Items per page:',
        pagingOf: 'of',
        pagingNextPage: 'Next',
        pagingPrevPage: 'Prev',
        pagingNoItems: 'There is no items.',
        infoPanelShowing: 'Showing',
        infoPanelItems: 'items',
        infoPanelOutOf: 'out of',
        infoPanelThemeMangerTooltipText: 'Theme manager',
        infoPanelColumnManagerTooltipText: 'Column manager',
        infoPanelInfoTooltipText: 'info',
        themeManagerModalTitle: 'Theme manager',
        themeManagerModalTheme: 'Theme:',
        themeManagerModalRowColoring: 'Row coloring:',
        themeManagerModalVerticalGrid: 'Vertical grid',
        themeManagerModalHorizontalGrid: 'HorizontalGrid',
        columnManagerModalTitle: 'Manage columns',
        headerMenuMainTab: 'Menu',
        headerMenuMainTabColumnSort: 'Column sort',
        headerMenuMainTabHideColumn: 'Hide column',
        headerMenuMainTabHighlightColumn: 'Highlight',
        headerMenuMainTabMoveLeft: 'Move left',
        headerMenuMainTabMoveRight: 'Move right',
        headerMenuMainTabColumnSortAscending: 'Ascending',
        headerMenuMainTabColumnSortDescending: 'Descending',
        headerMenuMainTabColumnSortNone: 'None',
        headerMenuFilterTab: 'Filter',
        headerMenuColumnsTab: 'Columns',
        summariesCount: 'Count',
        summariesDist: 'Dist',
        summariesSum: 'Sum',
        summariesAvg: 'Avg',
        summariesMin: 'Min',
        summariesMax: 'Max',
        summariesMed: 'Med',
        summariesTruthy: 'Truthy',
        summariesFalsy: 'Falsy',
        summariesDistinctValuesTooltip: 'Distinct values',
        summariesAverageTooltip: 'Average',
        summariesMinTooltip: 'Min',
        summariesMaxTooltip: 'Max',
        summariesMedTooltip: 'Median',
        summariesCountTooltip: 'Number of items in the grid'
    };

    var defaultTranslation = enTranslation;

    exports.GuiListMode = void 0;
    (function (GuiListMode) {
        GuiListMode[GuiListMode["LIST"] = 0] = "LIST";
        GuiListMode[GuiListMode["CARD"] = 1] = "CARD";
    })(exports.GuiListMode || (exports.GuiListMode = {}));
    exports.GuiListFieldType = void 0;
    (function (GuiListFieldType) {
        GuiListFieldType[GuiListFieldType["UNKNOWN"] = 0] = "UNKNOWN";
        GuiListFieldType[GuiListFieldType["NUMBER"] = 1] = "NUMBER";
        GuiListFieldType[GuiListFieldType["STRING"] = 2] = "STRING";
        GuiListFieldType[GuiListFieldType["BOOLEAN"] = 3] = "BOOLEAN";
        GuiListFieldType[GuiListFieldType["DATE"] = 4] = "DATE";
        GuiListFieldType[GuiListFieldType["CUSTOM"] = 5] = "CUSTOM";
    })(exports.GuiListFieldType || (exports.GuiListFieldType = {}));
    var GuiListDefaultTranslation = defaultTranslation;

    var GuiListModeConverter = /** @class */ (function () {
        function GuiListModeConverter() {
        }
        GuiListModeConverter.prototype.convert = function (mode) {
            if (mode === exports.GuiListMode.LIST) {
                return ListViewMode.LIST;
            }
            else {
                return ListViewMode.CARD;
            }
        };
        return GuiListModeConverter;
    }());

    var ListViewCardTemplate = /** @class */ (function () {
        function ListViewCardTemplate(template, templRef) {
            this.template = template;
            this.templRef = templRef;
        }
        ListViewCardTemplate.prototype.hasTemplateRef = function () {
            return !!this.templRef;
        };
        ListViewCardTemplate.prototype.getTemplateRef = function () {
            return this.templRef;
        };
        ListViewCardTemplate.prototype.getTemplateMethod = function () {
            return this.template;
        };
        return ListViewCardTemplate;
    }());

    var ListViewTemplate = /** @class */ (function () {
        function ListViewTemplate(template, templRef) {
            this.template = template;
            this.templRef = templRef;
        }
        ListViewTemplate.prototype.hasTemplateRef = function () {
            return !!this.templRef;
        };
        ListViewTemplate.prototype.getTemplateRef = function () {
            return this.templRef;
        };
        ListViewTemplate.prototype.getTemplateMethod = function () {
            return this.template;
        };
        return ListViewTemplate;
    }());

    function checkInput(prop) {
        return {
            isChanged: function () {
                return hasChanged(prop);
            },
            ifChanged: function (callback) {
                if (hasChanged(prop)) {
                    callback();
                }
            }
        };
    }
    function ifChanged(prop, callback) {
        if (hasChanged(prop)) {
            callback(prop.currentValue);
        }
    }
    function hasChanged(prop) {
        return prop !== undefined && prop.currentValue !== undefined;
    }

    var GuiListGateway = /** @class */ (function () {
        function GuiListGateway() {
            this.pageChanged = new core.EventEmitter();
            this.pageSizeChanged = new core.EventEmitter();
            this.searchPhraseChanged = new core.EventEmitter();
            this.guiListPagingConverter = new GuiListPagingConverter();
            this.guiListModeConverter = new GuiListModeConverter();
        }
        GuiListGateway.prototype.ngOnChanges = function (changes) {
            var _this = this;
            var templateRef = this.listItem ? this.listItem.templateRef : null;
            this.containerTemplate = new ListViewTemplate(this.template, templateRef);
            var cardTemplateRef = this.listCard ? this.listCard.templateRef : null;
            this.listCardTemplate = new ListViewCardTemplate(this.cardTemplate, cardTemplateRef);
            ifChanged(changes.paging, function () {
                if (typeof _this.paging !== 'boolean') {
                    _this.paging = _this.guiListPagingConverter.convert(_this.paging);
                }
            });
            ifChanged(changes.view, function () {
                if (_this.view.active !== undefined) {
                    _this.listViewMode = _this.guiListModeConverter.convert(_this.view.active);
                }
                if (_this.view.selector !== undefined) {
                    _this.listViewModeSelector = _this.view.selector;
                }
            });
            ifChanged(changes.fields, function () {
                _this.listFields = _this.fields.map(function (f) {
                    return {
                        field: f.field,
                        type: f.type // DataType
                    };
                });
            });
            ifChanged(changes.searching, function () {
                _this.searchConfig = _this.searching;
            });
        };
        return GuiListGateway;
    }());
    GuiListGateway.decorators = [
        { type: core.Directive }
    ];
    GuiListGateway.propDecorators = {
        listItem: [{ type: core.ContentChild, args: [GuiListItemComponent, { static: true },] }],
        listCard: [{ type: core.ContentChild, args: [GuiListCardComponent, { static: true },] }],
        source: [{ type: core.Input }],
        template: [{ type: core.Input }],
        cardTemplate: [{ type: core.Input }],
        paging: [{ type: core.Input }],
        view: [{ type: core.Input }],
        fields: [{ type: core.Input }],
        searching: [{ type: core.Input }],
        localization: [{ type: core.Input }],
        pageChanged: [{ type: core.Output }],
        pageSizeChanged: [{ type: core.Output }],
        searchPhraseChanged: [{ type: core.Output }]
    };

    var guiListProviders = [];

    var GuiListComponent = /** @class */ (function (_super) {
        __extends(GuiListComponent, _super);
        function GuiListComponent(platformId) {
            var _this = _super.call(this) || this;
            _this.platformId = platformId;
            return _this;
        }
        GuiListComponent.prototype.onPageChange = function (page) {
            this.pageChanged.emit(page);
        };
        GuiListComponent.prototype.onPageSizeChange = function (pageSize) {
            this.pageSizeChanged.emit(pageSize);
        };
        GuiListComponent.prototype.onSearchPhraseChange = function (phrase) {
            this.searchPhraseChanged.emit(phrase);
        };
        return GuiListComponent;
    }(GuiListGateway));
    GuiListComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-list',
                    template: "<gui-list-view\n\t(pageChanged)=\"onPageChange($event)\"\n\t(pageSizeChanged)=\"onPageSizeChange($event)\"\n\t(searchPhraseChanged)=\"onSearchPhraseChange($event)\"\n\t[cardTemplate]=\"listCardTemplate\"\n\t[fields]=\"listFields\"\n\t[items]=\"source\"\n\t[localization]=\"localization\"\n\t[modeSelector]=\"listViewModeSelector\"\n\t[mode]=\"listViewMode\"\n\t[paging]=\"paging\"\n\t[searching]=\"searchConfig\"\n\t[template]=\"containerTemplate\"\n>\n</gui-list-view>\n",
                    providers: guiListProviders,
                    host: {
                        '[class.gui-list]': '"true"'
                    },
                    encapsulation: core.ViewEncapsulation.None,
                    styles: [""]
                },] }
    ];
    GuiListComponent.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: core.Inject, args: [core.PLATFORM_ID,] }] }
    ]; };

    var StructureReadModelRootId = /** @class */ (function (_super) {
        __extends(StructureReadModelRootId, _super);
        function StructureReadModelRootId(id) {
            return _super.call(this, id) || this;
        }
        StructureReadModelRootId.prototype.toAggregateId = function () {
            return new StructureId(this.toString());
        };
        return StructureReadModelRootId;
    }(hermes.ReadModelRootId));

    var StructureId = /** @class */ (function (_super) {
        __extends(StructureId, _super);
        function StructureId(id) {
            return _super.call(this, id) || this;
        }
        StructureId.prototype.toReadModelRootId = function () {
            return new StructureReadModelRootId(this.getId());
        };
        return StructureId;
    }(hermes.AggregateId));

    var StructureIdGenerator = /** @class */ (function () {
        function StructureIdGenerator() {
            this.increment = 0;
        }
        StructureIdGenerator.prototype.generateId = function () {
            this.increment++;
            return this.increment;
        };
        return StructureIdGenerator;
    }());

    var StructureCommandInvoker = /** @class */ (function () {
        function StructureCommandInvoker() {
        }
        return StructureCommandInvoker;
    }());
    StructureCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    StructureCommandInvoker.ctorParameters = function () { return []; };

    var ListViewTemplateArchive = /** @class */ (function (_super) {
        __extends(ListViewTemplateArchive, _super);
        function ListViewTemplateArchive() {
            return _super.call(this) || this;
        }
        return ListViewTemplateArchive;
    }(hermes.Archive));
    ListViewTemplateArchive.decorators = [
        { type: core.Injectable }
    ];
    ListViewTemplateArchive.ctorParameters = function () { return []; };

    var ListViewCardTemplateArchive = /** @class */ (function (_super) {
        __extends(ListViewCardTemplateArchive, _super);
        function ListViewCardTemplateArchive() {
            return _super.call(this) || this;
        }
        return ListViewCardTemplateArchive;
    }(hermes.Archive));
    ListViewCardTemplateArchive.decorators = [
        { type: core.Injectable }
    ];
    ListViewCardTemplateArchive.ctorParameters = function () { return []; };

    var listViewProviders = [
        ListViewTemplateArchive,
        ListViewCardTemplateArchive
    ];

    var Modifier = /** @class */ (function () {
        function Modifier(hostElement) {
            this.hostElement = hostElement;
        }
        Modifier.prototype.getElement = function (htmlElement) {
            return this.createModifier(htmlElement);
        };
        Modifier.prototype.getHost = function () {
            if (!this.hostElement) {
                throw new Error('Missing host element in DomRenderer constructor.');
            }
            return this.createModifier(this.hostElement);
        };
        return Modifier;
    }());

    var _a$1;
    var ClassModifier = /** @class */ (function (_super) {
        __extends(ClassModifier, _super);
        function ClassModifier(htmlElement) {
            var _this = _super.call(this, htmlElement) || this;
            _this.htmlElement = htmlElement;
            return _this;
        }
        ClassModifier.prototype.createModifier = function (htmlElement) {
            return new ClassModifier.ClassModifier(htmlElement);
        };
        return ClassModifier;
    }(Modifier));
    // eslint-disable-next-line
    ClassModifier.ClassModifier = (_a$1 = /** @class */ (function () {
        function _a(htmlElement) {
            this.htmlElement = htmlElement;
        }
        _a.prototype.add = function () {
            var classes = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                classes[_i] = arguments[_i];
            }
            this.addClassToDomElement(this.htmlElement, classes);
        };
        _a.prototype.remove = function () {
            var classes = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                classes[_i] = arguments[_i];
            }
            this.removeClassFromDomElement(this.htmlElement, classes);
        };
        _a.prototype.clear = function () {
            this.htmlElement.removeAttribute(ClassModifier.ClassModifier.CLASS);
        };
        _a.prototype.addClassToDomElement = function (htmlElement, classes) {
            for (var i = 0; i < classes.length; i++) {
                htmlElement.classList.add(classes[i]);
            }
        };
        _a.prototype.removeClassFromDomElement = function (htmlElement, classes) {
            for (var i = 0; i < classes.length; i++) {
                htmlElement.classList.remove(classes[i]);
            }
        };
        return _a;
    }()),
        _a$1.CLASS = 'class',
        _a$1);

    var GuiComponent = /** @class */ (function () {
        function GuiComponent(innerElementRef) {
            this.innerElementRef = innerElementRef;
            this.innerClassModifier = new ClassModifier(this.innerElementRef.nativeElement);
            this.addHostClass();
        }
        GuiComponent.prototype.addClassToHost = function (className) {
            this.innerClassModifier.getHost().add(className);
        };
        GuiComponent.prototype.removeClassFromHost = function (className) {
            this.innerClassModifier.getHost().remove(className);
        };
        GuiComponent.prototype.hasChanged = function (prop) {
            return prop !== undefined && prop.currentValue !== undefined;
        };
        GuiComponent.prototype.ifChanged = function (prop, callback) {
            if (this.hasChanged(prop)) {
                callback();
            }
        };
        GuiComponent.prototype.addHostClass = function () {
            this.innerClassModifier.getHost().add(this.getSelectorName());
        };
        return GuiComponent;
    }());
    GuiComponent.decorators = [
        { type: core.Directive }
    ];
    GuiComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };

    var SmartComponent = /** @class */ (function (_super) {
        __extends(SmartComponent, _super);
        function SmartComponent(detector, elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.detector = detector;
            _this.viewInDom = false;
            _this.unsubscribe$ = new hermes.HermesSubject();
            return _this;
        }
        SmartComponent.prototype.ngAfterViewInit = function () {
            this.viewInDom = true;
        };
        SmartComponent.prototype.ngOnDestroy = function () {
            this.unsubscribe();
        };
        SmartComponent.prototype.reRender = function () {
            if (this.isViewInDom()) {
                this.detector.detectChanges();
            }
        };
        SmartComponent.prototype.isViewInDom = function () {
            return this.viewInDom;
        };
        SmartComponent.prototype.subscribe = function (stream$, callback) {
            var _this = this;
            stream$
                .pipe(this.takeUntil())
                .subscribe(function (streamValues) {
                callback(streamValues);
                _this.reRender();
            });
        };
        SmartComponent.prototype.subscribeWithoutRender = function (stream$, callback) {
            stream$
                .pipe(this.takeUntil())
                .subscribe(function (streamValues) {
                callback(streamValues);
            });
        };
        // for gate
        SmartComponent.prototype.subscribeAndEmit = function (stream$, emitter, mapper) {
            if (mapper === void 0) { mapper = function (value) { return value; }; }
            stream$
                .pipe(this.takeUntil())
                .subscribe(function (value) {
                emitter.emit(mapper(value));
            });
        };
        SmartComponent.prototype.unsubscribe = function () {
            this.unsubscribe$.next();
            this.unsubscribe$.complete();
        };
        SmartComponent.prototype.takeUntil = function () {
            return hermes.hermesTakeUntil(this.unsubscribe$);
        };
        return SmartComponent;
    }(GuiComponent));
    SmartComponent.decorators = [
        { type: core.Directive }
    ];
    SmartComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };

    var PagingWarehouse = /** @class */ (function () {
        function PagingWarehouse() {
        }
        return PagingWarehouse;
    }());
    PagingWarehouse.decorators = [
        { type: core.Injectable }
    ];
    PagingWarehouse.ctorParameters = function () { return []; };

    var PagingCommandInvoker = /** @class */ (function () {
        function PagingCommandInvoker() {
        }
        return PagingCommandInvoker;
    }());
    PagingCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    PagingCommandInvoker.ctorParameters = function () { return []; };

    var SourceWarehouse = /** @class */ (function () {
        function SourceWarehouse() {
        }
        return SourceWarehouse;
    }());
    SourceWarehouse.decorators = [
        { type: core.Injectable }
    ];
    SourceWarehouse.ctorParameters = function () { return []; };

    var PagingDisplayModeArchive = /** @class */ (function (_super) {
        __extends(PagingDisplayModeArchive, _super);
        function PagingDisplayModeArchive() {
            return _super.call(this, PagingDisplayMode.BASIC) || this;
        }
        return PagingDisplayModeArchive;
    }(hermes.Archive));
    PagingDisplayModeArchive.decorators = [
        { type: core.Injectable }
    ];
    PagingDisplayModeArchive.ctorParameters = function () { return []; };

    var PagingPosition;
    (function (PagingPosition) {
        PagingPosition[PagingPosition["TOP"] = 0] = "TOP";
        PagingPosition[PagingPosition["BOTTOM"] = 1] = "BOTTOM";
    })(PagingPosition || (PagingPosition = {}));

    var StreamCloser = /** @class */ (function () {
        function StreamCloser() {
            this.unsubscribe$ = new hermes.HermesSubject();
        }
        StreamCloser.prototype.takeUntil = function () {
            return hermes.hermesTakeUntil(this.unsubscribe$);
        };
        StreamCloser.prototype.unsubscribe = function () {
            if (this.unsubscribe$.isCompleted) {
                return;
            }
            this.unsubscribe$.next();
            this.unsubscribe$.complete();
        };
        return StreamCloser;
    }());

    var CssClass;
    (function (CssClass) {
        CssClass["SELECTED"] = "selected";
        CssClass["PAGING_TOP_CLASS_NAME"] = "gui-paging-top";
        CssClass["PAGING_BOTTOM_CLASS_NAME"] = "gui-paging-bottom";
    })(CssClass || (CssClass = {}));

    var CssClassModifier = /** @class */ (function () {
        function CssClassModifier() {
            this.classModifier = new ClassModifier();
        }
        CssClassModifier.prototype.select = function (htmlElement) {
            this.classModifier.getElement(htmlElement).add(CssClass.SELECTED);
        };
        CssClassModifier.prototype.unselect = function (htmlElement) {
            this.classModifier.getElement(htmlElement).remove(CssClass.SELECTED);
        };
        CssClassModifier.prototype.add = function (htmlElement, clazzName) {
            this.classModifier.getElement(htmlElement).add(clazzName);
        };
        CssClassModifier.prototype.remove = function (htmlElement, clazzName) {
            this.classModifier.getElement(htmlElement).remove(clazzName);
        };
        CssClassModifier.prototype.toggle = function (htmlElement) {
        };
        return CssClassModifier;
    }());
    CssClassModifier.decorators = [
        { type: core.Injectable }
    ];

    var PagingComponent = /** @class */ (function (_super) {
        __extends(PagingComponent, _super);
        function PagingComponent(elRef, changeDetectorRef, cssClassModifier, structureId, pagingWarehouse, pagingCommandInvoker, sourceWarehouse, pagingDisplayModeArchive) {
            var _this = _super.call(this, changeDetectorRef, elRef) || this;
            _this.elRef = elRef;
            _this.changeDetectorRef = changeDetectorRef;
            _this.cssClassModifier = cssClassModifier;
            _this.structureId = structureId;
            _this.pagingWarehouse = pagingWarehouse;
            _this.pagingCommandInvoker = pagingCommandInvoker;
            _this.sourceWarehouse = sourceWarehouse;
            _this.pagingDisplayModeArchive = pagingDisplayModeArchive;
            _this.alternativeDisplay = false;
            _this.isPagingVisible = false;
            _this.localStreamCloser = new StreamCloser();
            _this.addClassToHost('gui-flex');
            _this.addClassToHost('gui-justify-end');
            _this.addClassToHost('gui-items-center');
            _this.addClassToHost('gui-p-4');
            return _this;
        }
        PagingComponent.prototype.ngOnChanges = function (changes) {
            if (changes.position) {
                if (this.position === PagingPosition.BOTTOM) {
                    this.cssClassModifier.remove(this.elRef.nativeElement, CssClass.PAGING_TOP_CLASS_NAME);
                    this.cssClassModifier.add(this.elRef.nativeElement, CssClass.PAGING_BOTTOM_CLASS_NAME);
                }
                else {
                    this.cssClassModifier.remove(this.elRef.nativeElement, CssClass.PAGING_BOTTOM_CLASS_NAME);
                    this.cssClassModifier.add(this.elRef.nativeElement, CssClass.PAGING_TOP_CLASS_NAME);
                }
            }
        };
        PagingComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.pagingDisplayModeArchive.on(), function (mode) {
                _this.alternativeDisplay = mode === PagingDisplayMode.ADVANCED;
            });
            this.subscribe(this.pagingWarehouse.onPaging(this.structureId), function (paging) {
                _this.paging = paging;
                _this.calculatePagingVisibility();
            });
            this.subscribe(this.sourceWarehouse.onOriginSize(this.structureId), function (size) {
                _this.sourceSize = size;
            });
        };
        PagingComponent.prototype.ngOnDestroy = function () {
            this.localStreamCloser.unsubscribe();
            _super.prototype.ngOnDestroy.call(this);
        };
        PagingComponent.prototype.changePageSize = function (pageSize) {
            this.pagingCommandInvoker.changePageSize(pageSize, this.structureId);
        };
        PagingComponent.prototype.nextPage = function () {
            if (!this.sourceSize) {
                return;
            }
            this.pagingCommandInvoker.nextPage(this.structureId);
        };
        PagingComponent.prototype.prevPage = function () {
            this.pagingCommandInvoker.prevPage(this.structureId);
        };
        PagingComponent.prototype.getSelectorName = function () {
            return 'gui-paging';
        };
        PagingComponent.prototype.calculatePagingVisibility = function () {
            this.isPagingVisible = this.paging && this.paging.isEnabled() &&
                (((this.position === PagingPosition.TOP) && this.paging.isPagerTop()) ||
                    ((this.position === PagingPosition.BOTTOM) && this.paging.isPagerBottom()));
        };
        return PagingComponent;
    }(SmartComponent));
    PagingComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-paging][position]',
                    template: "<ng-container *ngIf=\"isPagingVisible && !alternativeDisplay\">\n\n\t<ng-container *ngIf=\"!minimal; else minimalTemplate\">\n\n\t\t<div (pageSizeChanged)=\"changePageSize($event)\"\n\t\t\t [paging]=\"paging\"\n\t\t\t gui-paging-select>\n\t\t</div>\n\n\t\t<div [paging]=\"paging\"\n\t\t\t gui-paging-stats>\n\t\t</div>\n\n\t\t<div (nextPageChanged)=\"nextPage()\"\n\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t [paging]=\"paging\"\n\t\t\t [sourceSize]=\"sourceSize\"\n\t\t\t gui-paging-navigator>\n\t\t</div>\n\n\t</ng-container>\n\n\t<ng-template #minimalTemplate>\n\n\t\t<div [paging]=\"paging\"\n\t\t\t gui-paging-stats>\n\t\t</div>\n\n\t\t<div (nextPageChanged)=\"nextPage()\"\n\t\t\t (prevPageChanged)=\"prevPage()\"\n\t\t\t [paging]=\"paging\"\n\t\t\t [sourceSize]=\"sourceSize\"\n\t\t\t gui-paging-navigator>\n\t\t</div>\n\n\t</ng-template>\n\n</ng-container>\n\n<ng-container *ngIf=\"isPagingVisible && alternativeDisplay\">\n\n\t<div (pageSizeChanged)=\"changePageSize($event)\"\n\t\t [paging]=\"paging\"\n\t\t gui-paging-select>\n\t</div>\n\n\t<div (nextPageChanged)=\"nextPage()\"\n\t\t (prevPageChanged)=\"prevPage()\"\n\t\t [paging]=\"paging\"\n\t\t [sourceSize]=\"sourceSize\"\n\t\t class=\"gui-flex gui-p-0\"\n\t\t gui-paging-alternative-navigator>\n\n\t\t<div [paging]=\"paging\"\n\t\t\t [sourceSize]=\"sourceSize\"\n\t\t\t class=\"gui-flex gui-justify-center\"\n\t\t\t gui-paging-alternative-pages>\n\t\t</div>\n\n\t</div>\n\n</ng-container>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None,
                    styles: [".gui-paging-alternative-navigator .gui-button{-ms-flex-line-pack:center;align-content:center;background:transparent;display:-ms-flexbox;display:flex;font-size:14px;line-height:21px;margin:0 2px;padding:0}.gui-paging-alternative-navigator .gui-button svg{-ms-flex-item-align:center;align-self:center;height:12px;margin:-1px 2px 0;width:auto}.gui-paging-alternative-navigator .gui-button svg path{stroke:#ccc;transition:stroke .3s ease-in-out}.gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-paging-alternative-navigator .gui-button:hover svg path{stroke:#333}.gui-paging-alternative-navigator .gui-button:disabled svg{opacity:.4}.gui-paging-alternative-navigator .gui-material .gui-button{padding:2px 16px}.gui-paging-alternative-pages{line-height:21px}.gui-paging-alternative-pages .gui-paging-page{display:none}.gui-paging-alternative-pages .gui-paging-visible-page .gui-paging-page{display:block;font-family:Arial,serif}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page{color:#333}.gui-paging-alternative-pages .gui-paging-visible-page.gui-paging-active-page .gui-paging-page{font-weight:bold}.gui-paging-bottom{border-top:1px solid;border-top-color:inherit}.gui-paging-top{border-bottom:1px solid;border-bottom-color:inherit}\n", ".gui-generic .gui-paging{border-color:rgba(34,36,38,.102);font-size:14px}.gui-generic .gui-paging *{border-color:rgba(34,36,38,.102);font-size:14px}\n"]
                },] }
    ];
    PagingComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef },
        { type: CssClassModifier },
        { type: StructureId },
        { type: PagingWarehouse },
        { type: PagingCommandInvoker },
        { type: SourceWarehouse },
        { type: PagingDisplayModeArchive }
    ]; };
    PagingComponent.propDecorators = {
        position: [{ type: core.Input }],
        minimal: [{ type: core.Input }]
    };

    var PureComponent = /** @class */ (function (_super) {
        __extends(PureComponent, _super);
        function PureComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.subClassConstructor = _this.constructor;
            _this.subClassNgOnInit = _this.ngOnInit;
            if (!_this.hasConstructorOnlyElementRefInjected(arguments)) {
                _this.throwError('it should not inject services');
            }
            if (_this.subClassNgOnInit) {
                _this.throwError('it should not use ngOnInit');
            }
            return _this;
        }
        PureComponent.prototype.hasConstructorOnlyElementRefInjected = function (args) {
            if (arguments.length > 1) {
                return false;
            }
            if (arguments.length === 1) {
                return this.isElementRef(arguments[0]);
            }
            return false;
        };
        PureComponent.prototype.isElementRef = function (elRef) {
            return elRef.nativeElement !== null;
        };
        PureComponent.prototype.throwError = function (reason) {
            throw new Error("Component \"" + this.subClassConstructor.name + "\" is a PureComponent, " + reason + ".");
        };
        return PureComponent;
    }(GuiComponent));
    PureComponent.decorators = [
        { type: core.Directive }
    ];
    PureComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };

    var PagingSelectComponent = /** @class */ (function (_super) {
        __extends(PagingSelectComponent, _super);
        function PagingSelectComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.pageSizeChanged = new core.EventEmitter();
            return _this;
        }
        PagingSelectComponent.prototype.ngOnChanges = function (changes) {
            var _this = this;
            ifChanged(changes.paging, function () {
                if (_this.paging) {
                    _this.selectPageSizes = _this.getSelectPageSizes();
                    _this.selectPageSize = _this.getSelectPageSize(_this.paging.getPageSize());
                }
            });
        };
        PagingSelectComponent.prototype.changePageSize = function (pageSize) {
            this.pageSizeChanged.emit(+pageSize.value);
        };
        PagingSelectComponent.prototype.getSelectorName = function () {
            return 'gui-paging-select';
        };
        PagingSelectComponent.prototype.getSelectPageSizes = function () {
            var _this = this;
            var selectPageSizes = [], pageSizes = this.paging.getPageSizes();
            pageSizes.forEach(function (pageSize) {
                var selectOption = _this.getSelectPageSize(pageSize);
                selectPageSizes.push(selectOption);
            });
            return selectPageSizes;
        };
        PagingSelectComponent.prototype.getSelectPageSize = function (pageSize) {
            return { name: pageSize.toString(), value: pageSize.toString() };
        };
        return PagingSelectComponent;
    }(PureComponent));
    PagingSelectComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-paging-select][paging]',
                    template: "<span class=\"gui-inline-block gui-mr-5\">\n\t{{ 'pagingItemsPerPage' | guiTranslate }}\n</span>\n\n<gui-select (optionChanged)=\"changePageSize($event)\"\n\t\t\t[options]=\"selectPageSizes\"\n\t\t\t[selected]=\"selectPageSize\"\n\t\t\t[width]=\"25\">\n</gui-select>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    PagingSelectComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    PagingSelectComponent.propDecorators = {
        paging: [{ type: core.Input }],
        pageSizeChanged: [{ type: core.Output }]
    };

    var AlternativePagingNavigatorComponent = /** @class */ (function (_super) {
        __extends(AlternativePagingNavigatorComponent, _super);
        function AlternativePagingNavigatorComponent(elRef, structureId, pagingCommandInvoker) {
            var _this = _super.call(this, elRef) || this;
            _this.structureId = structureId;
            _this.pagingCommandInvoker = pagingCommandInvoker;
            _this.nextPageChanged = new core.EventEmitter();
            _this.prevPageChanged = new core.EventEmitter();
            _this.prevDisabled = false;
            _this.nextDisabled = false;
            return _this;
        }
        AlternativePagingNavigatorComponent.prototype.ngOnChanges = function () {
            this.calculatePrev();
            this.calculateNext();
        };
        AlternativePagingNavigatorComponent.prototype.prevPage = function () {
            this.prevPageChanged.emit();
        };
        AlternativePagingNavigatorComponent.prototype.nextPage = function () {
            this.nextPageChanged.emit();
        };
        AlternativePagingNavigatorComponent.prototype.firstPage = function () {
            this.pagingCommandInvoker.goToPage(1, this.paging.getPage(), this.structureId);
        };
        AlternativePagingNavigatorComponent.prototype.lastPage = function () {
            var numberOfPages = Math.ceil(this.sourceSize / this.paging.getPageSize());
            this.pagingCommandInvoker.goToPage(numberOfPages, this.paging.getPage(), this.structureId);
        };
        AlternativePagingNavigatorComponent.prototype.getSelectorName = function () {
            return 'gui-paging-alternative-navigator';
        };
        AlternativePagingNavigatorComponent.prototype.calculatePrev = function () {
            if (!this.paging) {
                return;
            }
            this.prevDisabled = this.paging.isPrevPageDisabled();
        };
        AlternativePagingNavigatorComponent.prototype.calculateNext = function () {
            if (!this.paging && !this.sourceSize) {
                return;
            }
            this.nextDisabled = this.paging.isNextPageDisabled();
        };
        return AlternativePagingNavigatorComponent;
    }(PureComponent));
    AlternativePagingNavigatorComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-paging-alternative-navigator][paging][sourceSize]',
                    template: "<button (click)=\"firstPage()\"\n\t\t[disabled]=\"prevDisabled\"\n\t\tgui-button>\n\t<svg height=\"10.661\" viewBox=\"0 0 11.081 10.661\" width=\"11.081\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<g transform=\"translate(-522.98 669.601) rotate(180)\">\n\t\t\t<path d=\"M.75.75,5.02,5.02.75,9.29\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t\t\t\t  stroke-width=\"1.5\" transform=\"translate(-533.75 659.25)\"/>\n\t\t\t<path d=\"M.75.75,5.02,5.02.75,9.29\" fill=\"none\" stroke-linecap=\"round\"\n\t\t\t\t  stroke-linejoin=\"round\" stroke-width=\"1.5\" transform=\"translate(-528.75 659.25)\"/>\n\t\t</g>\n\t</svg>\n</button>\n\n<button (click)=\"prevPage()\"\n\t\t[disabled]=\"prevDisabled\"\n\t\tclass=\"gui-paging-navigator-prev\"\n\t\tgui-button>\n\t<svg height=\"10.661\" viewBox=\"0 0 6.081 10.661\" width=\"6.081\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<path d=\"M.75.75,5.02,5.02.75,9.29\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t\t\t  stroke-width=\"1.5\" transform=\"translate(5.77 10.351) rotate(180)\"/>\n\t</svg>\n</button>\n\n<ng-content></ng-content>\n\n<button (click)=\"nextPage()\"\n\t\t[disabled]=\"nextDisabled\"\n\t\tclass=\"gui-paging-navigator-next\"\n\t\tgui-button>\n\t<svg height=\"10.661\" viewBox=\"0 0 6.081 10.661\" width=\"6.081\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<path d=\"M.75.75,5.02,5.02.75,9.29\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t\t\t  stroke-width=\"1.5\" transform=\"translate(0.311 0.311)\"/>\n\t</svg>\n</button>\n\n<button (click)=\"lastPage()\"\n\t\t[disabled]=\"nextDisabled\"\n\t\tgui-button>\n\t<svg height=\"10.661\" viewBox=\"0 0 11.081 10.661\" width=\"11.081\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t<g transform=\"translate(534.061 -658.939)\">\n\t\t\t<path d=\"M.75.75,5.02,5.02.75,9.29\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\"\n\t\t\t\t  stroke-width=\"1.5\" transform=\"translate(-533.75 659.25)\"/>\n\t\t\t<path d=\"M.75.75,5.02,5.02.75,9.29\" fill=\"none\" stroke-linecap=\"round\"\n\t\t\t\t  stroke-linejoin=\"round\" stroke-width=\"1.5\" transform=\"translate(-528.75 659.25)\"/>\n\t\t</g>\n\t</svg>\n</button>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    AlternativePagingNavigatorComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: StructureId },
        { type: PagingCommandInvoker }
    ]; };
    AlternativePagingNavigatorComponent.propDecorators = {
        paging: [{ type: core.Input }],
        sourceSize: [{ type: core.Input }],
        nextPageChanged: [{ type: core.Output }],
        prevPageChanged: [{ type: core.Output }]
    };

    var AlternativePagingPagesComponent = /** @class */ (function (_super) {
        __extends(AlternativePagingPagesComponent, _super);
        function AlternativePagingPagesComponent(elRef, structureId, pagingCommandService) {
            var _this = _super.call(this, elRef) || this;
            _this.structureId = structureId;
            _this.pagingCommandService = pagingCommandService;
            _this.sourceSize = 0;
            _this.numberOfVisiblePages = 3;
            return _this;
        }
        AlternativePagingPagesComponent.prototype.ngOnChanges = function (changes) {
            this.calculate();
        };
        AlternativePagingPagesComponent.prototype.calculate = function () {
            if (this.paging && this.sourceSize) {
                var numberOfPages = Math.ceil(this.sourceSize / this.paging.getPageSize());
                this.currentPage = this.paging.getPage();
                this.pages = [];
                if (this.pages.length <= numberOfPages) {
                    for (var i = 1; i <= numberOfPages; i++) {
                        this.pages.push(i);
                    }
                }
            }
        };
        AlternativePagingPagesComponent.prototype.isSourceNotEmpty = function () {
            return this.sourceSize > 0;
        };
        AlternativePagingPagesComponent.prototype.goToPage = function (pageNumber) {
            var currentPage = this.paging.getPage();
            this.pagingCommandService.goToPage(pageNumber, currentPage, this.structureId);
        };
        AlternativePagingPagesComponent.prototype.calculateVisiblePages = function (page) {
            return this.paging.calculateVisiblePages(this.currentPage, this.numberOfVisiblePages, page);
        };
        AlternativePagingPagesComponent.prototype.activePage = function (page) {
            return this.currentPage === page;
        };
        AlternativePagingPagesComponent.prototype.getSelectorName = function () {
            return 'gui-paging-alternative-pages';
        };
        return AlternativePagingPagesComponent;
    }(PureComponent));
    AlternativePagingPagesComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-paging-alternative-pages][paging]',
                    template: "<ng-container *ngIf=\"isSourceNotEmpty(); else noSource;\">\n\n\t<div *ngFor=\"let page of pages\">\n\t\t<div [class.gui-paging-active-page]=\"activePage(page)\"\n\t\t\t [class.gui-paging-visible-page]=\"calculateVisiblePages(page)\"\n\t\t\t class=\"relative\">\n\t\t\t<div (click)=\"goToPage(page)\"\n\t\t\t\t class=\"gui-paging-page gui-select-none gui-cursor-pointer gui-py-0 gui-px-6 gui-font-base\">\n\t\t\t\t{{page}}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n</ng-container>\n\n<ng-template #noSource>\n\t<span class=\"gui-paging-source-stats gui-paging-no-items\">\n\t\t{{'pagingNoItems' | guiTranslate}}\n\t</span>\n</ng-template>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    AlternativePagingPagesComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: StructureId },
        { type: PagingCommandInvoker }
    ]; };
    AlternativePagingPagesComponent.propDecorators = {
        paging: [{ type: core.Input }],
        sourceSize: [{ type: core.Input }]
    };

    var PagingEventRepository = /** @class */ (function (_super) {
        __extends(PagingEventRepository, _super);
        function PagingEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        return PagingEventRepository;
    }(hermes.EventRepository));
    PagingEventRepository.decorators = [
        { type: core.Injectable }
    ];
    PagingEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var Logger = /** @class */ (function () {
        function Logger() {
        }
        return Logger;
    }());

    var StructureDomainEvent = /** @class */ (function (_super) {
        __extends(StructureDomainEvent, _super);
        function StructureDomainEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return StructureDomainEvent;
    }(hermes.DomainEvent));

    var PageChangedEvent = /** @class */ (function (_super) {
        __extends(PageChangedEvent, _super);
        function PageChangedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'PageChangedEvent') || this;
        }
        return PageChangedEvent;
    }(StructureDomainEvent));

    var StructureAggregateEvent = /** @class */ (function (_super) {
        __extends(StructureAggregateEvent, _super);
        function StructureAggregateEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return StructureAggregateEvent;
    }(hermes.AggregateEvent));

    var PageChangedAggregateEvent = /** @class */ (function (_super) {
        __extends(PageChangedAggregateEvent, _super);
        function PageChangedAggregateEvent(structureId) {
            return _super.call(this, structureId, 'PageChangedAggregateEvent') || this;
        }
        PageChangedAggregateEvent.prototype.toDomainEvent = function () {
            return new PageChangedEvent(this.getAggregateId());
        };
        return PageChangedAggregateEvent;
    }(StructureAggregateEvent));

    var PagesizeChangedEvent = /** @class */ (function (_super) {
        __extends(PagesizeChangedEvent, _super);
        function PagesizeChangedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'PagesizeChangedEvent') || this;
        }
        return PagesizeChangedEvent;
    }(StructureDomainEvent));

    var PagesizeChangedAggregateEvent = /** @class */ (function (_super) {
        __extends(PagesizeChangedAggregateEvent, _super);
        function PagesizeChangedAggregateEvent(structureId) {
            return _super.call(this, structureId, 'PagesizeChangedAggregateEvent') || this;
        }
        PagesizeChangedAggregateEvent.prototype.toDomainEvent = function () {
            return new PagesizeChangedEvent(this.getAggregateId());
        };
        return PagesizeChangedAggregateEvent;
    }(StructureAggregateEvent));

    var PagingManager = /** @class */ (function () {
        function PagingManager(enabled, page, pageSize, pageSizes, pagerTop, pagerBottom, sourceSize, logger) {
            this.enabled = enabled;
            this.page = page;
            this.pageSize = pageSize;
            this.pageSizes = pageSizes;
            this.pagerTop = pagerTop;
            this.pagerBottom = pagerBottom;
            this.sourceSize = sourceSize;
            // TODO
            this.events = [];
            this.logger = logger;
        }
        // TODO Remove
        PagingManager.default = function (logger) {
            return new PagingManager(false, 1, 25, [10, 25, 50, 100], false, true, 0, logger);
        };
        // TODO Remove
        PagingManager.fromConfig = function (paging, logger) {
            var defaultPagingDefinition = PagingManager.default(logger), enabled = paging.enabled || defaultPagingDefinition.isEnabled(), page = paging.page || defaultPagingDefinition.getPage(), pageSize = paging.pageSize || defaultPagingDefinition.getPageSize(), pageSizes = paging.pageSizes || defaultPagingDefinition.getPageSizes(), pagerTop = paging.pagerTop || defaultPagingDefinition.isPagerTop(), pagerBottom = paging.pagerBottom || defaultPagingDefinition.isPagerBottom();
            return new PagingManager(enabled, page, pageSize, pageSizes, pagerTop, pagerBottom, 0, logger);
        };
        PagingManager.prototype.isEnabled = function () {
            return this.enabled;
        };
        PagingManager.prototype.isDisabled = function () {
            return !this.enabled;
        };
        PagingManager.prototype.getPage = function () {
            return this.page;
        };
        PagingManager.prototype.getPageSize = function () {
            return this.pageSize;
        };
        PagingManager.prototype.getPageSizes = function () {
            return this.pageSizes;
        };
        PagingManager.prototype.isPagerTop = function () {
            if (this.isDisabled()) {
                return false;
            }
            return this.pagerTop;
        };
        PagingManager.prototype.isPagerBottom = function () {
            if (this.isDisabled()) {
                return false;
            }
            return this.pagerBottom;
        };
        PagingManager.prototype.getSourceSize = function () {
            return this.sourceSize;
        };
        PagingManager.prototype.change = function (pagingConfig) {
            if (pagingConfig.enabled !== undefined) {
                this.enabled = pagingConfig.enabled;
            }
            if (pagingConfig.page !== undefined) {
                this.page = pagingConfig.page;
                if (pagingConfig.enabled === undefined) {
                    this.enabled = true;
                }
            }
            if (pagingConfig.pageSize !== undefined) {
                this.pageSize = pagingConfig.pageSize;
                if (pagingConfig.enabled === undefined) {
                    this.enabled = true;
                }
            }
            if (pagingConfig.pageSizes !== undefined) {
                this.pageSizes = pagingConfig.pageSizes;
                if (pagingConfig.enabled === undefined) {
                    this.enabled = true;
                }
            }
            if (pagingConfig.pagerTop !== undefined) {
                this.pagerTop = pagingConfig.pagerTop;
                if (pagingConfig.enabled === undefined) {
                    this.enabled = true;
                }
            }
            if (pagingConfig.pagerBottom !== undefined) {
                this.pagerBottom = pagingConfig.pagerBottom;
                if (pagingConfig.enabled === undefined) {
                    this.enabled = true;
                }
            }
            if (this.enabled === true &&
                pagingConfig.pagerTop === false &&
                pagingConfig.pagerBottom === false) {
                this.pagerBottom = true;
                this.logger.warn('Pagers cannot be turn off when paging is enabled.');
            }
        };
        PagingManager.prototype.setSourceSize = function (size) {
            this.sourceSize = size;
        };
        PagingManager.prototype.nextPage = function () {
            var nextPage = this.page;
            if (!this.isNextPageDisabled()) {
                nextPage += 1;
            }
            this.page = nextPage;
        };
        PagingManager.prototype.prevPage = function () {
            var prevPage = this.page;
            if (!this.isPrevPageDisabled()) {
                prevPage -= 1;
            }
            this.page = prevPage;
        };
        PagingManager.prototype.changePageSize = function (pageSize) {
            if (this.pageSizes.find(function (ps) { return ps === pageSize; })) {
                this.setPage(1);
                this.setPageSize(pageSize);
            }
            return this.events;
        };
        PagingManager.prototype.isNextPageDisabled = function () {
            if (this.sourceSize === 0) {
                return true;
            }
            return this.page === Math.ceil(this.sourceSize / this.pageSize);
        };
        PagingManager.prototype.isPrevPageDisabled = function () {
            return this.page === 1;
        };
        PagingManager.prototype.calculateStart = function () {
            var firstItem = 1 + ((this.page - 1) * this.pageSize);
            if (this.sourceSize < firstItem) {
                return 0;
            }
            return firstItem;
        };
        PagingManager.prototype.calculateEnd = function () {
            var lastItem = this.page * this.pageSize;
            if (this.sourceSize < lastItem) {
                return this.sourceSize;
            }
            return lastItem;
        };
        PagingManager.prototype.sample = function (source) {
            if (this.isDisabled()) {
                return source;
            }
            var start = this.calculateStart();
            if (start !== 0) {
                start -= 1;
            }
            return source.slice(start, this.calculateEnd());
        };
        PagingManager.prototype.clearEvents = function () {
            this.events.length = 0;
        };
        PagingManager.prototype.setPage = function (page) {
            this.page = page;
            this.events.push(new PageChangedAggregateEvent(new StructureId('TODO need to be changed')));
        };
        PagingManager.prototype.setPageSize = function (pageSize) {
            this.pageSize = pageSize;
            this.events.push(new PagesizeChangedAggregateEvent(new StructureId('TODO need to be changed')));
        };
        return PagingManager;
    }());

    var PagingManagerFactory = /** @class */ (function () {
        function PagingManagerFactory(logger) {
            this.logger = logger;
        }
        PagingManagerFactory.prototype.createDefault = function () {
            return PagingManager.default(this.logger);
        };
        PagingManagerFactory.prototype.createFromConfig = function (config) {
            return PagingManager.fromConfig(config, this.logger);
        };
        return PagingManagerFactory;
    }());
    PagingManagerFactory.decorators = [
        { type: core.Injectable }
    ];
    PagingManagerFactory.ctorParameters = function () { return [
        { type: Logger }
    ]; };

    var StructureCommand = /** @class */ (function (_super) {
        __extends(StructureCommand, _super);
        function StructureCommand() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return StructureCommand;
    }(hermes.Command));

    var SetPagingCommand = /** @class */ (function (_super) {
        __extends(SetPagingCommand, _super);
        function SetPagingCommand(structureId, config) {
            var _this = _super.call(this, structureId, 'SetPagingCommand') || this;
            _this.config = config;
            return _this;
        }
        SetPagingCommand.prototype.getPagingConfig = function () {
            return this.config;
        };
        return SetPagingCommand;
    }(StructureCommand));

    var ChangePagesizeCommand = /** @class */ (function (_super) {
        __extends(ChangePagesizeCommand, _super);
        function ChangePagesizeCommand(structureId, pageSize) {
            var _this = _super.call(this, structureId, 'ChangePagesizeCommand') || this;
            _this.pageSize = pageSize;
            return _this;
        }
        ChangePagesizeCommand.prototype.getPageSize = function () {
            return this.pageSize;
        };
        return ChangePagesizeCommand;
    }(StructureCommand));

    var NextPageCommand = /** @class */ (function (_super) {
        __extends(NextPageCommand, _super);
        function NextPageCommand(structureId) {
            return _super.call(this, structureId, 'NextPageCommand') || this;
        }
        return NextPageCommand;
    }(StructureCommand));

    var PrevPageCommand = /** @class */ (function (_super) {
        __extends(PrevPageCommand, _super);
        function PrevPageCommand(structureId) {
            return _super.call(this, structureId, 'PrevPageCommand') || this;
        }
        return PrevPageCommand;
    }(StructureCommand));

    var PagingDispatcher = /** @class */ (function () {
        function PagingDispatcher(commandDispatcher) {
            this.commandDispatcher = commandDispatcher;
        }
        PagingDispatcher.prototype.setPaging = function (structureId, paging) {
            this.commandDispatcher.dispatch(new SetPagingCommand(structureId, paging));
        };
        PagingDispatcher.prototype.changePageSize = function (structureId, pageSize) {
            this.commandDispatcher.dispatch(new ChangePagesizeCommand(structureId, pageSize));
        };
        PagingDispatcher.prototype.nextPage = function (structureId) {
            this.commandDispatcher.dispatch(new NextPageCommand(structureId));
        };
        PagingDispatcher.prototype.prevPage = function (structureId) {
            this.commandDispatcher.dispatch(new PrevPageCommand(structureId));
        };
        return PagingDispatcher;
    }());
    PagingDispatcher.decorators = [
        { type: core.Injectable }
    ];
    PagingDispatcher.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var StructureAggregateRepository = /** @class */ (function (_super) {
        __extends(StructureAggregateRepository, _super);
        function StructureAggregateRepository() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return StructureAggregateRepository;
    }(hermes.AggregateRepository));

    var PagingSetEvent = /** @class */ (function (_super) {
        __extends(PagingSetEvent, _super);
        function PagingSetEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'PagingSetEvent') || this;
        }
        return PagingSetEvent;
    }(StructureDomainEvent));

    var SetPagingCommandHandler = /** @class */ (function () {
        function SetPagingCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        SetPagingCommandHandler.prototype.forCommand = function () {
            return SetPagingCommand;
        };
        SetPagingCommandHandler.prototype.handle = function (structureAggregate, command) {
            var pagingConfig = command.getPagingConfig();
            structureAggregate.changePaging(pagingConfig);
        };
        SetPagingCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new PagingSetEvent(command.getAggregateId()));
        };
        return SetPagingCommandHandler;
    }());
    SetPagingCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetPagingCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var NextPageEvent = /** @class */ (function (_super) {
        __extends(NextPageEvent, _super);
        function NextPageEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'NextPageEvent') || this;
        }
        return NextPageEvent;
    }(StructureDomainEvent));

    var NextPageCommandHandler = /** @class */ (function () {
        function NextPageCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        NextPageCommandHandler.prototype.forCommand = function () {
            return NextPageCommand;
        };
        NextPageCommandHandler.prototype.handle = function (aggregate, command) {
            // missing implementation
            aggregate.nextPage();
        };
        NextPageCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new NextPageEvent(command.getAggregateId()));
        };
        return NextPageCommandHandler;
    }());
    NextPageCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    NextPageCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var PrevPageEvent = /** @class */ (function (_super) {
        __extends(PrevPageEvent, _super);
        function PrevPageEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'PrevPageEvent') || this;
        }
        return PrevPageEvent;
    }(StructureDomainEvent));

    var PrevPageCommandHandler = /** @class */ (function () {
        function PrevPageCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        PrevPageCommandHandler.prototype.forCommand = function () {
            return PrevPageCommand;
        };
        PrevPageCommandHandler.prototype.handle = function (structure, command) {
            structure.prevPage();
        };
        PrevPageCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new PrevPageEvent(command.getAggregateId()));
        };
        return PrevPageCommandHandler;
    }());
    PrevPageCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    PrevPageCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var ChangePagesizeCommandHandler = /** @class */ (function () {
        function ChangePagesizeCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        ChangePagesizeCommandHandler.prototype.forCommand = function () {
            return ChangePagesizeCommand;
        };
        ChangePagesizeCommandHandler.prototype.handle = function (structureAggregate, command) {
            var pageSize = command.getPageSize();
            structureAggregate.changePageSize(pageSize);
        };
        ChangePagesizeCommandHandler.prototype.publish = function (aggregate, command) {
            var aggregateEvents = aggregate.getEvents();
            aggregateEvents.forEach(function (event) {
                event.aggregateId = aggregate.getId();
            });
            this.publishAggregateEvents(aggregateEvents, command);
            aggregate.clearEvents();
        };
        ChangePagesizeCommandHandler.prototype.publishAggregateEvents = function (events, command) {
            var e_1, _a;
            try {
                for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {
                    var event = events_1_1.value;
                    this.publishAggregateEvent(event, command);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        };
        ChangePagesizeCommandHandler.prototype.publishAggregateEvent = function (event, command) {
            switch (event.getType()) {
                case 'PageChangedAggregateEvent':
                    var pageChangedEvent = new PageChangedEvent(command.getAggregateId());
                    this.domainEventPublisher.publish(pageChangedEvent);
                    break;
                case 'PagesizeChangedAggregateEvent':
                    var pagesizeChangedEvent = new PagesizeChangedEvent(command.getAggregateId());
                    this.domainEventPublisher.publish(pagesizeChangedEvent);
                    break;
                case 'StructurePreparedEntitiesSetAggregateEvent':
                    this.domainEventPublisher.publish(event.toDomainEvent());
                    break;
                default:
                    break;
            }
        };
        return ChangePagesizeCommandHandler;
    }());
    ChangePagesizeCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    ChangePagesizeCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var structureKey = 'StructureAggregate';

    var PagingDomainModule = /** @class */ (function (_super) {
        __extends(PagingDomainModule, _super);
        function PagingDomainModule() {
            return _super.call(this) || this;
        }
        PagingDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SetPagingCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(NextPageCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(PrevPageCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(ChangePagesizeCommandHandler, structureKey)
            ];
        };
        return PagingDomainModule;
    }(hermes.DomainModule));
    PagingDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [
                        PagingDispatcher,
                        PagingManagerFactory
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    PagingDomainModule.ctorParameters = function () { return []; };

    var Paging = /** @class */ (function () {
        function Paging(enabled, page, pageSize, pageSizes, pagerTop, pagerBottom, isNextDisabled, isPrevDisabled, start, end, sourceSize) {
            this.enabled = enabled;
            this.page = page;
            this.pageSize = pageSize;
            this.pageSizes = pageSizes;
            this.pagerTop = pagerTop;
            this.pagerBottom = pagerBottom;
            this.isNextDisabled = isNextDisabled;
            this.isPrevDisabled = isPrevDisabled;
            this.start = start;
            this.end = end;
            this.sourceSize = sourceSize;
        }
        Paging.prototype.isEnabled = function () {
            return this.enabled;
        };
        Paging.prototype.getPage = function () {
            return this.page;
        };
        Paging.prototype.getPageSize = function () {
            return this.pageSize;
        };
        Paging.prototype.getPageSizes = function () {
            return this.pageSizes;
        };
        Paging.prototype.isPagerTop = function () {
            return this.pagerTop;
        };
        Paging.prototype.isPagerBottom = function () {
            return this.pagerBottom;
        };
        Paging.prototype.isNextPageDisabled = function () {
            return this.isNextDisabled;
        };
        Paging.prototype.isPrevPageDisabled = function () {
            return this.isPrevDisabled;
        };
        Paging.prototype.getStart = function () {
            return this.start;
        };
        Paging.prototype.getEnd = function () {
            return this.end;
        };
        Paging.prototype.getSourceSize = function () {
            return this.sourceSize;
        };
        Paging.prototype.calculateVisiblePages = function (currentPage, numberOfVisiblePages, page) {
            return currentPage - numberOfVisiblePages < page && page < currentPage + numberOfVisiblePages;
        };
        Paging.prototype.sample = function (source) {
            var start = this.getStart();
            if (start !== 0) {
                start -= 1;
            }
            return source.slice(start, this.getEnd());
        };
        // TODO
        Paging.prototype.compare = function (target) {
            return JSON.stringify(this) === JSON.stringify(target);
        };
        return Paging;
    }());
    Paging = __decorate([
        hermes.ReadModelObject
    ], Paging);

    var PagingConverter = /** @class */ (function () {
        function PagingConverter() {
        }
        PagingConverter.prototype.convert = function (aggregate) {
            return new Paging(aggregate.isEnabled(), aggregate.getPage(), aggregate.getPageSize(), aggregate.getPageSizes(), aggregate.isPagerTop(), aggregate.isPagerBottom(), aggregate.isNextPageDisabled(), aggregate.isPrevPageDisabled(), aggregate.calculateStart(), aggregate.calculateEnd(), aggregate.getSourceSize());
        };
        return PagingConverter;
    }());
    PagingConverter.decorators = [
        { type: core.Injectable }
    ];

    var StructureReadModelRepository = /** @class */ (function (_super) {
        __extends(StructureReadModelRepository, _super);
        function StructureReadModelRepository(domainEventBus) {
            var _this = _super.call(this) || this;
            domainEventBus
                .ofEvents(_this.forEvents())
                .pipe(_this.hermesTakeUntil())
                .subscribe(function (event) {
                try {
                    _this.subs(event);
                }
                catch (e) {
                    // eslint-disable-next-line no-console
                    console.error(e);
                }
            });
            return _this;
        }
        return StructureReadModelRepository;
    }(hermes.Reactive));

    var PagingRepository = /** @class */ (function () {
        function PagingRepository(structureRepository) {
            this.structureRepository = structureRepository;
        }
        PagingRepository.prototype.on = function (structureId) {
            return this.structureRepository
                .on(structureId)
                .pipe(hermes.hermesFilter(function (structure) { return structure.getId().toString() === structureId.toString(); }), hermes.hermesMap(function (structure) { return structure.getPaging(); }));
        };
        return PagingRepository;
    }());
    PagingRepository.decorators = [
        { type: core.Injectable }
    ];
    PagingRepository.ctorParameters = function () { return [
        { type: StructureReadModelRepository }
    ]; };

    var PagingDomainWarehouse = /** @class */ (function (_super) {
        __extends(PagingDomainWarehouse, _super);
        function PagingDomainWarehouse(pagingRepository) {
            var _this = _super.call(this) || this;
            _this.pagingRepository = pagingRepository;
            return _this;
        }
        PagingDomainWarehouse.prototype.onPaging = function (structureId) {
            return this.pagingRepository.on(structureId);
        };
        PagingDomainWarehouse.prototype.oncePaging = function (structureId) {
            return this.pagingRepository
                .on(structureId)
                .pipe(hermes.hermesTake(1));
        };
        return PagingDomainWarehouse;
    }(PagingWarehouse));
    PagingDomainWarehouse.decorators = [
        { type: core.Injectable }
    ];
    PagingDomainWarehouse.ctorParameters = function () { return [
        { type: PagingRepository }
    ]; };

    var PagingDomainCommandInvoker = /** @class */ (function (_super) {
        __extends(PagingDomainCommandInvoker, _super);
        function PagingDomainCommandInvoker(pagingDispatcher) {
            var _this = _super.call(this) || this;
            _this.pagingDispatcher = pagingDispatcher;
            return _this;
        }
        PagingDomainCommandInvoker.prototype.enable = function (structureId) {
            this.pagingDispatcher.setPaging(structureId, { enabled: true });
        };
        PagingDomainCommandInvoker.prototype.disable = function (structureId) {
            this.pagingDispatcher.setPaging(structureId, { enabled: false });
        };
        PagingDomainCommandInvoker.prototype.setPaging = function (paging, structureId) {
            this.pagingDispatcher.setPaging(structureId, paging);
        };
        PagingDomainCommandInvoker.prototype.changePageSize = function (pageSize, structureId) {
            this.pagingDispatcher.changePageSize(structureId, pageSize);
        };
        PagingDomainCommandInvoker.prototype.nextPage = function (structureId) {
            this.pagingDispatcher.nextPage(structureId);
        };
        PagingDomainCommandInvoker.prototype.prevPage = function (structureId) {
            this.pagingDispatcher.prevPage(structureId);
        };
        PagingDomainCommandInvoker.prototype.goToPage = function (pageNumber, currentPage, structureId) {
            if (currentPage < pageNumber) {
                while (currentPage !== pageNumber) {
                    this.nextPage(structureId);
                    currentPage += 1;
                }
            }
            else {
                while (currentPage !== pageNumber) {
                    this.prevPage(structureId);
                    currentPage -= 1;
                }
            }
        };
        PagingDomainCommandInvoker.prototype.changePagerTop = function (enabled, structureId) {
            this.pagingDispatcher.setPaging(structureId, { pagerTop: enabled });
        };
        PagingDomainCommandInvoker.prototype.changePagerBottom = function (enabled, structureId) {
            this.pagingDispatcher.setPaging(structureId, { pagerBottom: enabled });
        };
        return PagingDomainCommandInvoker;
    }(PagingCommandInvoker));
    PagingDomainCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    PagingDomainCommandInvoker.ctorParameters = function () { return [
        { type: PagingDispatcher }
    ]; };

    var PagingDomainEventRepository = /** @class */ (function (_super) {
        __extends(PagingDomainEventRepository, _super);
        function PagingDomainEventRepository(eventBus, pagingWarehouse) {
            var _this = _super.call(this, eventBus) || this;
            _this.eventBus = eventBus;
            _this.pagingWarehouse = pagingWarehouse;
            return _this;
        }
        PagingDomainEventRepository.prototype.onPageChange = function (structureId) {
            var _this = this;
            return this.eventBus
                .ofEvents([
                PrevPageEvent,
                NextPageEvent,
                PageChangedEvent
            ])
                .pipe(hermes.hermesFilter(function (event) { return event.getAggregateId().toString() === structureId.toAggregateId().toString(); }), hermes.hermesSwitchMap(function (event) {
                return _this.pagingWarehouse
                    .oncePaging(structureId.toAggregateId())
                    .pipe(hermes.hermesMap(function (paging) { return paging.getPage(); }));
            }));
        };
        PagingDomainEventRepository.prototype.onPageSizeChange = function (structureId) {
            var _this = this;
            return this.eventBus
                .ofEvents([
                PagesizeChangedEvent
            ])
                .pipe(hermes.hermesFilter(function (event) { return event.getAggregateId().toString() === structureId.toAggregateId().toString(); }), hermes.hermesSwitchMap(function (event) {
                return _this.pagingWarehouse
                    .oncePaging(structureId.toAggregateId())
                    .pipe(hermes.hermesMap(function (paging) { return paging.getPageSize(); }));
            }));
        };
        return PagingDomainEventRepository;
    }(PagingEventRepository));
    PagingDomainEventRepository.decorators = [
        { type: core.Injectable }
    ];
    PagingDomainEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus },
        { type: PagingWarehouse }
    ]; };

    var PagingApiModule = /** @class */ (function (_super) {
        __extends(PagingApiModule, _super);
        function PagingApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return PagingApiModule;
    }(hermes.ApiModule));
    PagingApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        PagingDomainModule
                    ],
                    providers: [
                        {
                            provide: PagingCommandInvoker,
                            useClass: PagingDomainCommandInvoker
                        },
                        {
                            provide: PagingWarehouse,
                            useClass: PagingDomainWarehouse
                        },
                        {
                            provide: PagingEventRepository,
                            useClass: PagingDomainEventRepository
                        },
                        PagingRepository,
                        PagingConverter
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var PagingNavigatorComponent = /** @class */ (function (_super) {
        __extends(PagingNavigatorComponent, _super);
        function PagingNavigatorComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.nextPageChanged = new core.EventEmitter();
            _this.prevPageChanged = new core.EventEmitter();
            _this.prevDisabled = false;
            _this.nextDisabled = false;
            return _this;
        }
        PagingNavigatorComponent.prototype.ngOnChanges = function () {
            this.calculatePrev();
            this.calculateNext();
        };
        PagingNavigatorComponent.prototype.prevPage = function () {
            this.prevPageChanged.emit();
        };
        PagingNavigatorComponent.prototype.nextPage = function () {
            this.nextPageChanged.emit();
        };
        PagingNavigatorComponent.prototype.getSelectorName = function () {
            return 'gui-paging-navigator';
        };
        PagingNavigatorComponent.prototype.calculatePrev = function () {
            if (!this.paging) {
                return;
            }
            this.prevDisabled = this.paging.isPrevPageDisabled();
        };
        PagingNavigatorComponent.prototype.calculateNext = function () {
            if (!this.paging && !this.sourceSize) {
                return;
            }
            this.nextDisabled = this.paging.isNextPageDisabled();
        };
        return PagingNavigatorComponent;
    }(PureComponent));
    PagingNavigatorComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-paging-navigator][paging]',
                    template: "<gui-button-group>\n\t<button (click)=\"prevPage()\"\n\t\t\t[disabled]=\"prevDisabled\"\n\t\t\tclass=\"gui-paging-navigator-prev gui-mr-5\"\n\t\t\tgui-button>\n\t\t{{ 'pagingPrevPage' | guiTranslate }}\n\t</button>\n\n\t<button (click)=\"nextPage()\"\n\t\t\t[disabled]=\"nextDisabled\"\n\t\t\tclass=\"gui-paging-navigator-next gui-mr-0\"\n\t\t\tgui-button>\n\t\t{{ 'pagingNextPage' | guiTranslate }}\n\t</button>\n</gui-button-group>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    PagingNavigatorComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    PagingNavigatorComponent.propDecorators = {
        paging: [{ type: core.Input }],
        sourceSize: [{ type: core.Input }],
        nextPageChanged: [{ type: core.Output }],
        prevPageChanged: [{ type: core.Output }]
    };

    var PagingStatsComponent = /** @class */ (function (_super) {
        __extends(PagingStatsComponent, _super);
        function PagingStatsComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.addClassToHost('gui-mx-6');
            return _this;
        }
        PagingStatsComponent.prototype.ngOnChanges = function () {
            this.calculate();
        };
        PagingStatsComponent.prototype.calculate = function () {
            if (this.paging) {
                this.firstItemIndex = this.paging.getStart();
                this.lastItemIndex = this.paging.getEnd();
                this.sourceSize = this.paging.getSourceSize();
            }
        };
        PagingStatsComponent.prototype.isSourceNotEmpty = function () {
            return this.sourceSize > 0;
        };
        PagingStatsComponent.prototype.getSelectorName = function () {
            return 'gui-paging-stats';
        };
        return PagingStatsComponent;
    }(PureComponent));
    PagingStatsComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-paging-stats][paging]',
                    template: "<ng-container *ngIf=\"isSourceNotEmpty(); else noSource;\">\n\t<span class=\"gui-paging-source-stats\">\n\t\t<span>{{firstItemIndex}}</span>\n\t\t-\n\t\t<span>{{lastItemIndex}}</span>\n\t</span>\n\t<span>\n\t\t{{ 'pagingOf' | guiTranslate }}\n\t</span>\n\t<span class=\"gui-paging-source-size\">\n\t\t{{sourceSize}}\n\t</span>\n</ng-container>\n\n<ng-template #noSource>\n\t<span class=\"gui-paging-source-stats gui-paging-no-items\">\n\t\t{{'pagingNoItems' | guiTranslate}}\n\t</span>\n</ng-template>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    PagingStatsComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    PagingStatsComponent.propDecorators = {
        paging: [{ type: core.Input }]
    };

    var TranslationApiModule = /** @class */ (function (_super) {
        __extends(TranslationApiModule, _super);
        function TranslationApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return TranslationApiModule;
    }(hermes.ApiModule));
    TranslationApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [],
                    declarations: [],
                    exports: []
                },] }
    ];

    var TranslationFacade = /** @class */ (function () {
        function TranslationFacade() {
        }
        return TranslationFacade;
    }());

    var TranslationPipe = /** @class */ (function () {
        function TranslationPipe(changeDetectorRef, translationService) {
            this.changeDetectorRef = changeDetectorRef;
            this.translationService = translationService;
            this.actualTranslationValue = '';
        }
        TranslationPipe.prototype.ngOnDestroy = function () {
            if (this.subscription) {
                this.subscription.unsubscribe();
            }
        };
        TranslationPipe.prototype.transform = function (key) {
            var _this = this;
            if (this.subscription) {
                this.subscription.unsubscribe();
            }
            this.subscription =
                this.translationService
                    .onTranslation()
                    .subscribe(function (translation) {
                    var value = translation[key];
                    if (!value) {
                        _this.actualTranslationValue = key;
                    }
                    _this.actualTranslationValue = value;
                    _this.changeDetectorRef.markForCheck();
                });
            return this.actualTranslationValue;
        };
        return TranslationPipe;
    }());
    TranslationPipe.decorators = [
        { type: core.Pipe, args: [{
                    name: 'guiTranslate',
                    pure: false
                },] }
    ];
    TranslationPipe.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: TranslationFacade }
    ]; };

    var Dictionary = /** @class */ (function () {
        function Dictionary() {
            this.translation = new Map();
            this.resolver = function (key, value) { return value; };
        }
        Dictionary.prototype.changeTranslation = function (change) {
            var e_1, _a;
            try {
                for (var _b = __values(Object.keys(change)), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var key = _c.value;
                    this.translation.set(key, change[key]);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        };
        Dictionary.prototype.getTranslation = function () {
            var _this = this;
            return Array.from(this.translation)
                .reduce(function (obj, _a) {
                var _b;
                var _c = __read(_a, 2), key = _c[0], value = _c[1];
                return (Object.assign(obj, (_b = {}, _b[key] = _this.resolver(key, value), _b)));
            }, {});
        };
        Dictionary.prototype.setResolver = function (resolver) {
            this.resolver = resolver;
        };
        return Dictionary;
    }());

    var TranslationDomainFacade = /** @class */ (function (_super) {
        __extends(TranslationDomainFacade, _super);
        function TranslationDomainFacade() {
            var _this = _super.call(this) || this;
            _this.defaultTranslation = enTranslation;
            _this.dictionary = new Dictionary();
            _this.dictionary$ = new hermes.HermesReplaySubject(1);
            return _this;
        }
        TranslationDomainFacade.prototype.getTranslation = function () {
            return this.dictionary.getTranslation();
        };
        TranslationDomainFacade.prototype.onTranslation = function () {
            return this.dictionary$.toObservable();
        };
        TranslationDomainFacade.prototype.setDefaultTranslation = function () {
            this.changeTranslationAndPropagate(this.defaultTranslation);
        };
        TranslationDomainFacade.prototype.changeTranslation = function (change) {
            this.changeTranslationAndPropagate(change);
        };
        TranslationDomainFacade.prototype.setResolver = function (resolver) {
            this.setResolverAndPropagate(resolver);
        };
        TranslationDomainFacade.prototype.changeTranslationAndPropagate = function (change) {
            this.dictionary.changeTranslation(change);
            this.dictionary$.next(this.dictionary.getTranslation());
        };
        TranslationDomainFacade.prototype.setResolverAndPropagate = function (resolver) {
            this.dictionary.setResolver(resolver);
            this.dictionary$.next(this.dictionary.getTranslation());
        };
        return TranslationDomainFacade;
    }(TranslationFacade));
    TranslationDomainFacade.decorators = [
        { type: core.Injectable }
    ];
    TranslationDomainFacade.ctorParameters = function () { return []; };

    var TranslationFeatureModule = /** @class */ (function (_super) {
        __extends(TranslationFeatureModule, _super);
        function TranslationFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        TranslationFeatureModule.forComponent = function () {
            return [{ provide: TranslationFacade, useClass: TranslationDomainFacade }];
        };
        return TranslationFeatureModule;
    }(hermes.FeatureModule));
    TranslationFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        TranslationApiModule
                    ],
                    declarations: [
                        TranslationPipe
                    ],
                    exports: [
                        TranslationPipe
                    ]
                },] }
    ];

    var PagingFeatureModule = /** @class */ (function (_super) {
        __extends(PagingFeatureModule, _super);
        function PagingFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        PagingFeatureModule.forComponent = function () {
            return [
                PagingDisplayModeArchive
            ];
        };
        return PagingFeatureModule;
    }(hermes.FeatureModule));
    PagingFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabric.FabricModule,
                        PagingApiModule,
                        TranslationFeatureModule
                    ],
                    declarations: [
                        PagingComponent,
                        PagingNavigatorComponent,
                        PagingSelectComponent,
                        PagingStatsComponent,
                        AlternativePagingNavigatorComponent,
                        AlternativePagingPagesComponent
                    ],
                    exports: [
                        PagingComponent,
                        PagingNavigatorComponent,
                        PagingSelectComponent,
                        PagingStatsComponent,
                        AlternativePagingNavigatorComponent,
                        AlternativePagingPagesComponent
                    ]
                },] }
    ];

    var ListViewId = /** @class */ (function (_super) {
        __extends(ListViewId, _super);
        function ListViewId(id) {
            return _super.call(this, id) || this;
        }
        ListViewId.prototype.toReadModelRootId = function () {
            return new ListViewReadModelRootId(this.getId());
        };
        return ListViewId;
    }(hermes.AggregateId));

    var ListViewReadModelRootId = /** @class */ (function (_super) {
        __extends(ListViewReadModelRootId, _super);
        function ListViewReadModelRootId(id) {
            return _super.call(this, id) || this;
        }
        ListViewReadModelRootId.prototype.toAggregateId = function () {
            return new ListViewId(this.getId());
        };
        return ListViewReadModelRootId;
    }(hermes.ReadModelRootId));

    var CreateListViewCommand = /** @class */ (function (_super) {
        __extends(CreateListViewCommand, _super);
        function CreateListViewCommand(listViewId) {
            return _super.call(this, listViewId, 'CreateListViewCommand') || this;
        }
        return CreateListViewCommand;
    }(hermes.CreateAggregateCommand));

    var ListViewCommand = /** @class */ (function (_super) {
        __extends(ListViewCommand, _super);
        function ListViewCommand() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return ListViewCommand;
    }(hermes.Command));

    var SetListViewModeCommand = /** @class */ (function (_super) {
        __extends(SetListViewModeCommand, _super);
        function SetListViewModeCommand(listViewId, mode) {
            var _this = _super.call(this, listViewId, 'SetListViewModeCommand') || this;
            _this.mode = mode;
            return _this;
        }
        SetListViewModeCommand.prototype.getMode = function () {
            return this.mode;
        };
        return SetListViewModeCommand;
    }(ListViewCommand));

    var ToggleListViewSelectorCommand = /** @class */ (function (_super) {
        __extends(ToggleListViewSelectorCommand, _super);
        function ToggleListViewSelectorCommand(listViewId, enabled) {
            var _this = _super.call(this, listViewId, 'ToggleListViewSelectorCommand') || this;
            _this.enabled = enabled;
            return _this;
        }
        ToggleListViewSelectorCommand.prototype.iseEnabled = function () {
            return this.enabled;
        };
        return ToggleListViewSelectorCommand;
    }(ListViewCommand));

    var ListViewDispatcher = /** @class */ (function () {
        function ListViewDispatcher(commandDispatcher) {
            this.commandDispatcher = commandDispatcher;
        }
        ListViewDispatcher.prototype.create = function (listViewId) {
            this.commandDispatcher.dispatch(new CreateListViewCommand(listViewId));
        };
        ListViewDispatcher.prototype.setMode = function (mode, listViewId) {
            this.commandDispatcher.dispatch(new SetListViewModeCommand(listViewId, mode));
        };
        ListViewDispatcher.prototype.toggleSelector = function (enabled, listViewId) {
            this.commandDispatcher.dispatch(new ToggleListViewSelectorCommand(listViewId, enabled));
        };
        return ListViewDispatcher;
    }());
    ListViewDispatcher.decorators = [
        { type: core.Injectable }
    ];
    ListViewDispatcher.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var listViewGlobalId = new ListViewReadModelRootId('-1');

    var ListViewCommandInvoker = /** @class */ (function () {
        function ListViewCommandInvoker(listViewDispatcher) {
            this.listViewDispatcher = listViewDispatcher;
        }
        ListViewCommandInvoker.prototype.create = function (listViewReadModelRootId) {
            if (listViewReadModelRootId === void 0) { listViewReadModelRootId = listViewGlobalId; }
            this.listViewDispatcher.create(listViewReadModelRootId.toAggregateId());
        };
        ListViewCommandInvoker.prototype.setMode = function (mode, listViewReadModelRootId) {
            if (listViewReadModelRootId === void 0) { listViewReadModelRootId = listViewGlobalId; }
            this.listViewDispatcher.setMode(mode, listViewReadModelRootId.toAggregateId());
        };
        ListViewCommandInvoker.prototype.toggleSelector = function (enabled, listViewReadModelRootId) {
            if (listViewReadModelRootId === void 0) { listViewReadModelRootId = listViewGlobalId; }
            this.listViewDispatcher.toggleSelector(enabled, listViewReadModelRootId.toAggregateId());
        };
        return ListViewCommandInvoker;
    }());
    ListViewCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    ListViewCommandInvoker.ctorParameters = function () { return [
        { type: ListViewDispatcher }
    ]; };

    var filterContainerToken = new core.InjectionToken('Filter container token');

    var CompositionReadModelRootId = /** @class */ (function (_super) {
        __extends(CompositionReadModelRootId, _super);
        function CompositionReadModelRootId(id) {
            return _super.call(this, id) || this;
        }
        CompositionReadModelRootId.prototype.toAggregateId = function () {
            return new CompositionId(this.toString());
        };
        return CompositionReadModelRootId;
    }(hermes.ReadModelRootId));

    var CompositionId = /** @class */ (function (_super) {
        __extends(CompositionId, _super);
        function CompositionId(id) {
            return _super.call(this, id) || this;
        }
        CompositionId.prototype.toReadModelRootId = function () {
            return new CompositionReadModelRootId(this.getId());
        };
        return CompositionId;
    }(hermes.AggregateId));

    var SchemaId = /** @class */ (function (_super) {
        __extends(SchemaId, _super);
        function SchemaId(id) {
            return _super.call(this, id) || this;
        }
        SchemaId.prototype.toReadModelRootId = function () {
            return new SchemaReadModelRootId(this.getId());
        };
        return SchemaId;
    }(hermes.AggregateId));

    var SchemaReadModelRootId = /** @class */ (function (_super) {
        __extends(SchemaReadModelRootId, _super);
        function SchemaReadModelRootId(id) {
            return _super.call(this, id) || this;
        }
        SchemaReadModelRootId.prototype.toAggregateId = function () {
            return new SchemaId(this.getId());
        };
        return SchemaReadModelRootId;
    }(hermes.ReadModelRootId));

    var LayoutComponent = /** @class */ (function (_super) {
        __extends(LayoutComponent, _super);
        function LayoutComponent(elRef) {
            return _super.call(this, elRef) || this;
        }
        return LayoutComponent;
    }(GuiComponent));
    LayoutComponent.decorators = [
        { type: core.Directive }
    ];
    LayoutComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };

    /** @internal */
    function listViewIdFactoryForList(generator) {
        return new ListViewReadModelRootId('gui-list-' + generator.generateId());
    }
    /** @internal */
    function structureIdFactoryForList(generator) {
        return new StructureId('gui-list-' + generator.generateId());
    }
    /** @internal */
    function compositionIdFactoryForList(generator) {
        return new CompositionId('gui-list-' + generator.generateId());
    }
    /** @internal */
    function schemaIdFactoryForList(generator) {
        return new SchemaReadModelRootId('gui-list-' + generator.generateId());
    }
    var componentListProviders = [
        {
            provide: StructureId,
            useFactory: structureIdFactoryForList,
            deps: [
                StructureIdGenerator
            ]
        },
        {
            provide: CompositionId,
            useFactory: compositionIdFactoryForList,
            deps: [
                StructureIdGenerator
            ]
        },
        {
            provide: SchemaReadModelRootId,
            useFactory: schemaIdFactoryForList,
            deps: [
                StructureIdGenerator
            ]
        },
        {
            provide: ListViewReadModelRootId,
            useFactory: listViewIdFactoryForList,
            deps: [
                StructureIdGenerator
            ]
        },
        listViewProviders,
        PagingFeatureModule.forComponent(),
        TranslationFeatureModule.forComponent()
    ];
    var ListViewComponent = /** @class */ (function (_super) {
        __extends(ListViewComponent, _super);
        function ListViewComponent(structureId, listViewReadModelRootId, elementRef, structureCommandService, listViewCommandDispatcher, translationService) {
            var _this = _super.call(this, elementRef) || this;
            _this.structureId = structureId;
            _this.listViewReadModelRootId = listViewReadModelRootId;
            _this.elementRef = elementRef;
            _this.addClassToHost('gui-generic');
            translationService.setDefaultTranslation();
            structureCommandService.create(_this.structureId);
            listViewCommandDispatcher.create(_this.listViewReadModelRootId);
            return _this;
        }
        ListViewComponent.prototype.getElementRef = function () {
            return this.elementRef;
        };
        ListViewComponent.prototype.getSelectorName = function () {
            return 'gui-list-view';
        };
        return ListViewComponent;
    }(LayoutComponent));
    ListViewComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-list-view',
                    template: "<div gui-list-view-layout></div>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    providers: [
                        {
                            provide: StructureId,
                            useFactory: structureIdFactoryForList,
                            deps: [
                                StructureIdGenerator
                            ]
                        },
                        {
                            provide: CompositionId,
                            useFactory: compositionIdFactoryForList,
                            deps: [
                                StructureIdGenerator
                            ]
                        },
                        {
                            provide: SchemaReadModelRootId,
                            useFactory: schemaIdFactoryForList,
                            deps: [
                                StructureIdGenerator
                            ]
                        },
                        {
                            provide: ListViewReadModelRootId,
                            useFactory: listViewIdFactoryForList,
                            deps: [
                                StructureIdGenerator
                            ]
                        },
                        listViewProviders,
                        PagingFeatureModule.forComponent(),
                        TranslationFeatureModule.forComponent(),
                        {
                            provide: filterContainerToken,
                            useExisting: ListViewComponent
                        }
                    ],
                    host: {
                        '[id]': 'structureId.toString()'
                    },
                    styles: [".gui-box-border{box-sizing:border-box}.gui-bg-transparent{background-color:transparent}.gui-border{border-width:1px}.gui-border-0{border-width:0}.gui-border-b{border-bottom-width:1px}.gui-border-t{border-top-width:1px}.gui-border-solid{border-style:solid}.gui-border-b-solid{border-bottom-style:solid}.gui-border-t-solid{border-top-style:solid}.gui-border-none{border-style:none}.gui-rounded{border-radius:4px}.gui-cursor-pointer{cursor:pointer}.gui-block{display:block}.gui-inline-block{display:inline-block}.gui-inline{display:inline}.gui-flex{display:-ms-flexbox;display:flex}.gui-hidden{display:none}.gui-display-grid{display:grid}.gui-flex-row{-ms-flex-direction:row;flex-direction:row}.gui-flex-row-reverse{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.gui-flex-col{-ms-flex-direction:column;flex-direction:column}.gui-flex-col-reverse{-ms-flex-direction:column-reverse;flex-direction:column-reverse}.gui-justify-start{-ms-flex-pack:start;justify-content:flex-start}.gui-justify-end{-ms-flex-pack:end;justify-content:flex-end}.gui-justify-center{-ms-flex-pack:center;justify-content:center}.gui-justify-between{-ms-flex-pack:justify;justify-content:space-between}.gui-justify-around{-ms-flex-pack:distribute;justify-content:space-around}.gui-justify-evenly{-ms-flex-pack:space-evenly;justify-content:space-evenly}.gui-items-start{-ms-flex-align:start;align-items:flex-start}.gui-items-end{-ms-flex-align:end;align-items:flex-end}.gui-items-center{-ms-flex-align:center;align-items:center}.gui-items-between{-ms-flex-align:space-between;align-items:space-between}.gui-items-around{-ms-flex-align:space-around;align-items:space-around}.gui-items-evenly{-ms-flex-align:space-evenly;align-items:space-evenly}.gui-flex-wrap{-ms-flex-wrap:wrap;flex-wrap:wrap}.gui-flex-wrap-reverse{-ms-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse}.gui-flex-nowrap{-ms-flex-wrap:nowrap;flex-wrap:nowrap}.gui-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.gui-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.gui-grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.gui-grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.gui-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.gui-grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}.gui-grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.gui-grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))}.gui-grid-cols-9{grid-template-columns:repeat(9,minmax(0,1fr))}.gui-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.gui-grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.gui-grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))}.gui-grid-rows-4{grid-template-rows:repeat(4,minmax(0,1fr))}.gui-grid-rows-5{grid-template-rows:repeat(5,minmax(0,1fr))}.gui-grid-rows-6{grid-template-rows:repeat(6,minmax(0,1fr))}.gui-grid-rows-7{grid-template-rows:repeat(7,minmax(0,1fr))}.gui-grid-rows-8{grid-template-rows:repeat(8,minmax(0,1fr))}.gui-grid-rows-9{grid-template-rows:repeat(9,minmax(0,1fr))}.gui-grid-rows-gap-0{grid-row-gap:0}.gui-grid-rows-gap-1{grid-row-gap:1px}.gui-grid-rows-gap-2{grid-row-gap:2px}.gui-grid-rows-gap-3{grid-row-gap:3px}.gui-grid-rows-gap-4{grid-row-gap:4px}.gui-grid-rows-gap-5{grid-row-gap:6px}.gui-grid-rows-gap-6{grid-row-gap:8px}.gui-grid-rows-gap-7{grid-row-gap:10px}.gui-grid-rows-gap-8{grid-row-gap:12px}.gui-grid-rows-gap-23{grid-row-gap:42px}.gui-grid-cols-gap-0{grid-column-gap:0}.gui-grid-cols-gap-1{grid-column-gap:1px}.gui-grid-cols-gap-2{grid-column-gap:2px}.gui-grid-cols-gap-3{grid-column-gap:3px}.gui-grid-cols-gap-4{grid-column-gap:4px}.gui-grid-cols-gap-5{grid-column-gap:6px}.gui-grid-cols-gap-6{grid-column-gap:8px}.gui-grid-cols-gap-7{grid-column-gap:10px}.gui-grid-cols-gap-8{grid-column-gap:12px}.gui-grid-cols-gap-23{grid-column-gap:42px}.gui-h-full{height:100%}.gui-list-none{list-style-type:none}.gui-m-0{margin:0}.gui-mx-0{margin-left:0;margin-right:0}.gui-my-0{margin-bottom:0;margin-top:0}.gui-m-1{margin:1px}.gui-mx-1{margin-left:1px;margin-right:1px}.gui-my-1{margin-bottom:1px;margin-top:1px}.gui-m-2{margin:2px}.gui-mx-2{margin-left:2px;margin-right:2px}.gui-my-2{margin-bottom:2px;margin-top:2px}.gui-m-3{margin:3px}.gui-mx-3{margin-left:3px;margin-right:3px}.gui-my-3{margin-bottom:3px;margin-top:3px}.gui-m-4{margin:4px}.gui-mx-4{margin-left:4px;margin-right:4px}.gui-my-4{margin-bottom:4px;margin-top:4px}.gui-m-5{margin:6px}.gui-mx-5{margin-left:6px;margin-right:6px}.gui-my-5{margin-bottom:6px;margin-top:6px}.gui-m-6{margin:8px}.gui-mx-6{margin-left:8px;margin-right:8px}.gui-my-6{margin-bottom:8px;margin-top:8px}.gui-m-7{margin:10px}.gui-mx-7{margin-left:10px;margin-right:10px}.gui-my-7{margin-bottom:10px;margin-top:10px}.gui-m-8{margin:12px}.gui-mx-8{margin-left:12px;margin-right:12px}.gui-my-8{margin-bottom:12px;margin-top:12px}.gui-m-23{margin:42px}.gui-mx-23{margin-left:42px;margin-right:42px}.gui-my-23{margin-bottom:42px;margin-top:42px}.gui-mb-4{margin-bottom:4px}.gui-mb-6{margin-bottom:8px}.gui-mb-8{margin-bottom:12px}.gui-mb-10{margin-bottom:16px}.gui-mb-18{margin-bottom:32px}.gui-mr-0{margin-right:0}.gui-mr-5{margin-right:6px}.gui-mr-auto{margin-right:auto}.gui-ml-auto{margin-left:auto}.gui-mt-4{margin-top:4px}.gui-mt-6{margin-top:8px}.gui-mt-10{margin-top:16px}.gui-mt-14{margin-top:24px}.gui-overflow-hidden{overflow:hidden}.gui-overflow-y-scroll{overflow-y:scroll}.gui-overflow-x-hidden{overflow-x:hidden}.gui-overflow-auto{overflow:auto}.gui-p-0{padding:0}.gui-px-0{padding-left:0;padding-right:0}.gui-py-0{padding-bottom:0;padding-top:0}.gui-p-1{padding:1px}.gui-px-1{padding-left:1px;padding-right:1px}.gui-py-1{padding-bottom:1px;padding-top:1px}.gui-p-2{padding:2px}.gui-px-2{padding-left:2px;padding-right:2px}.gui-py-2{padding-bottom:2px;padding-top:2px}.gui-p-3{padding:3px}.gui-px-3{padding-left:3px;padding-right:3px}.gui-py-3{padding-bottom:3px;padding-top:3px}.gui-p-4{padding:4px}.gui-px-4{padding-left:4px;padding-right:4px}.gui-py-4{padding-bottom:4px;padding-top:4px}.gui-p-5{padding:6px}.gui-px-5{padding-left:6px;padding-right:6px}.gui-py-5{padding-bottom:6px;padding-top:6px}.gui-p-6{padding:8px}.gui-px-6{padding-left:8px;padding-right:8px}.gui-py-6{padding-bottom:8px;padding-top:8px}.gui-p-7{padding:10px}.gui-px-7{padding-left:10px;padding-right:10px}.gui-py-7{padding-bottom:10px;padding-top:10px}.gui-p-8{padding:12px}.gui-px-8{padding-left:12px;padding-right:12px}.gui-py-8{padding-bottom:12px;padding-top:12px}.gui-p-23{padding:42px}.gui-px-23{padding-left:42px;padding-right:42px}.gui-py-23{padding-bottom:42px;padding-top:42px}.gui-pr-10{padding-right:16px}.gui-pl-9{padding-right:10px}.gui-pb-6{padding-bottom:8px}.gui-pb-12{padding-bottom:20px}.gui-pl-21{padding-left:38px}.gui-pt-4{padding-top:4px}.gui-pt-6{padding-top:8px}.gui-pt-10{padding-top:16px}.gui-pt-12{padding-top:20px}.gui-pt-14{padding-top:24px}.gui-static{position:static}.gui-fixed{position:fixed}.gui-relative{position:relative}.gui-absolute{position:absolute}.gui-text-xxs{font-size:11px}.gui-text-xs{font-size:12px}.gui-text-sm{font-size:13px}.gui-text-base{font-size:14px}.gui-text-lg{font-size:16px}.gui-text-xl{font-size:18px}.gui-text-2xl{font-size:20px}.gui-text-3xl{font-size:22px}.gui-leading-4{line-height:16px}.gui-leading-6{line-height:24px}.gui-font-thin{font-weight:100}.gui-font-extralight{font-weight:200}.gui-font-light{font-weight:300}.gui-font-normal{font-weight:400}.gui-font-medium{font-weight:500}.gui-font-semibold{font-weight:600}.gui-font-bold{font-weight:700}.gui-font-extrabold{font-weight:800}.gui-font-black{font-weight:900}.gui-italic{font-style:italic}.gui-not-italic{font-style:normal}.gui-whitespace-nowrap{white-space:nowrap}.gui-overflow-ellipsis{text-overflow:ellipsis}.gui-no-underline{text-decoration:none}.gui-w-full{width:100%}.gui-w-96{width:384px}.gui-w-3\\/5{width:60%}.gui-list-view{border-color:#d6d6d6}.gui-list-view *,.gui-list-view *:after,.gui-list-view *:before{box-sizing:border-box}.gui-list-view input{font-size:13px;outline:0}.gui-list-view *{border-color:#d6d6d6}.gui-list-view .gui-search-bar form .gui-search-icon-svg{top:10px}.gui-list-view .gui-search-bar form input{font-size:14px;padding:10px 6px 10px 38px}.gui-list-card-wrapper{border:1px solid transparent;min-height:100px;transition:.2s all}.gui-list-card-wrapper:hover{border:1px solid #d6d6d6;box-shadow:0 2px 6px rgba(0,0,0,.149)}.gui-list-container-card{border-top:1px solid #d6d6d6}\n", ".gui-list-item{border:1px solid rgba(0,0,0,.1);box-shadow:0 2px 6px rgba(0,0,0,.149)}@media (min-width: 480px){.gui-list-card{width:100%}.gui-list-item-container{padding-left:8px;padding-right:8px}}@media (min-width: 768px){.gui-list-card{width:50%}.gui-list-item-container{padding-left:12px;padding-right:12px}}@media (min-width: 992px){.gui-list-card{width:33.3333%}.gui-list-item-container{padding-left:12px;padding-right:12px}}@media (min-width: 1200px){.gui-list-card{width:33.3333%}.gui-list-item-container{padding-left:16px;padding-right:16px}}\n", ".gui-list-view.gui-generic .gui-paging{border:0}\n"]
                },] }
    ];
    ListViewComponent.ctorParameters = function () { return [
        { type: StructureId },
        { type: ListViewReadModelRootId },
        { type: core.ElementRef },
        { type: StructureCommandInvoker },
        { type: ListViewCommandInvoker },
        { type: TranslationFacade }
    ]; };

    var ListViewSourceComponent = /** @class */ (function (_super) {
        __extends(ListViewSourceComponent, _super);
        function ListViewSourceComponent(changeDetectorRef, elementRef, structureId, structureSourceWarehouse, containerTemplateArchive) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.structureSourceWarehouse = structureSourceWarehouse;
            _this.containerTemplateArchive = containerTemplateArchive;
            _this.source = [];
            _this.addClassToHost('gui-block');
            return _this;
        }
        ListViewSourceComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.structureSourceWarehouse.onEntities(this.structureId), function (items) {
                _this.source = items.map(function (i) { return i.getSourceItem(); });
            });
            this.subscribe(this.containerTemplateArchive.on(), function (template) {
                _this.template = template;
            });
        };
        ListViewSourceComponent.prototype.getSelectorName = function () {
            return 'gui-list-view-source';
        };
        return ListViewSourceComponent;
    }(SmartComponent));
    ListViewSourceComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-list-view-source]',
                    template: "<div *ngFor=\"let element of source\"\n\t [item]=\"element\"\n\t [template]=\"template\"\n\t gui-list-view-item>\n</div>\n\n<div [items]=\"source\" gui-empty-source>\n</div>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush
                },] }
    ];
    ListViewSourceComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: SourceWarehouse },
        { type: ListViewTemplateArchive }
    ]; };

    var ListViewModeArchive = /** @class */ (function (_super) {
        __extends(ListViewModeArchive, _super);
        function ListViewModeArchive() {
            return _super.call(this, ListViewModeArchive.default) || this;
        }
        return ListViewModeArchive;
    }(hermes.AggregateArchive));
    ListViewModeArchive.default = ListViewMode.LIST;
    ListViewModeArchive.decorators = [
        { type: core.Injectable }
    ];
    ListViewModeArchive.ctorParameters = function () { return []; };

    var ListViewSelectorArchive = /** @class */ (function (_super) {
        __extends(ListViewSelectorArchive, _super);
        function ListViewSelectorArchive() {
            return _super.call(this, ListViewSelectorArchive.default) || this;
        }
        return ListViewSelectorArchive;
    }(hermes.AggregateArchive));
    ListViewSelectorArchive.default = false;
    ListViewSelectorArchive.decorators = [
        { type: core.Injectable }
    ];
    ListViewSelectorArchive.ctorParameters = function () { return []; };

    var ListViewWarehouse = /** @class */ (function () {
        function ListViewWarehouse(listViewModeArchive, listViewSelectorArchive) {
            this.listViewModeArchive = listViewModeArchive;
            this.listViewSelectorArchive = listViewSelectorArchive;
        }
        ListViewWarehouse.prototype.onMode = function (id) {
            return this.listViewModeArchive.on(id);
        };
        ListViewWarehouse.prototype.onSelector = function (id) {
            return this.listViewSelectorArchive.on(id);
        };
        return ListViewWarehouse;
    }());
    ListViewWarehouse.decorators = [
        { type: core.Injectable }
    ];
    ListViewWarehouse.ctorParameters = function () { return [
        { type: ListViewModeArchive },
        { type: ListViewSelectorArchive }
    ]; };

    var ListViewLayoutComponent = /** @class */ (function (_super) {
        __extends(ListViewLayoutComponent, _super);
        function ListViewLayoutComponent(changeDetectorRef, elementRef, listViewReadModelRootId, listViewWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.listViewReadModelRootId = listViewReadModelRootId;
            _this.listViewWarehouse = listViewWarehouse;
            _this.listModeEnabled = false;
            _this.cardModeEnabled = false;
            _this.selectorEnabled = false;
            _this.searchBarEnabled = true;
            return _this;
        }
        ListViewLayoutComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.listViewWarehouse.onMode(this.listViewReadModelRootId.toAggregateId()), function (mode) {
                _this.listModeEnabled = mode === ListViewMode.LIST;
                _this.cardModeEnabled = mode === ListViewMode.CARD;
            });
            this.subscribe(this.listViewWarehouse.onSelector(this.listViewReadModelRootId.toAggregateId()), function (enabled) {
                _this.selectorEnabled = enabled;
            });
        };
        ListViewLayoutComponent.prototype.getSelectorName = function () {
            return 'gui-list-view-layout';
        };
        return ListViewLayoutComponent;
    }(SmartComponent));
    ListViewLayoutComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-list-view-layout]',
                    template: "<div class=\"gui-flex\">\n\n\t<div *ngIf=\"searchBarEnabled\" class=\"gui-flex gui-items-center gui-h-full gui-w-3/5 gui-mr-auto\" gui-search-bar></div>\n\n\t<!--\t\t\t<div gui-sorting-selector></div>-->\n\t<!--\t\t\t<gui-filter-menu-trigger></gui-filter-menu-trigger>-->\n\t<!--\t\t\t<gui-filter-menu-trigger></gui-filter-menu-trigger>-->\n\n</div>\n<div class=\"gui-list-panel-top gui-items-center gui-flex gui-px-6\">\n\t<div *ngIf=\"selectorEnabled\" gui-list-mode-select></div>\n\n\t<div [minimal]=\"true\" [position]=\"0\" class=\"gui-ml-auto\" gui-paging></div>\n</div>\n\n<div *ngIf=\"listModeEnabled\" gui-list-view-source></div>\n\n<div *ngIf=\"cardModeEnabled\" gui-list-container-card></div>\n\n<div [position]=\"1\" class=\"gui-ml-auto\" gui-paging></div>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush
                },] }
    ];
    ListViewLayoutComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: ListViewReadModelRootId },
        { type: ListViewWarehouse }
    ]; };

    var ListViewItemComponent = /** @class */ (function (_super) {
        __extends(ListViewItemComponent, _super);
        function ListViewItemComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.context = 'Template not provided';
            _this.addClassToHost('gui-w-full');
            _this.addClassToHost('gui-my-6');
            _this.addClassToHost('gui-mx-0');
            _this.addClassToHost('gui-block');
            return _this;
        }
        ListViewItemComponent.prototype.ngOnChanges = function () {
            if (this.template && this.item) {
                this.hasTemplateRef = this.template.hasTemplateRef();
                if (!this.hasTemplateRef) {
                    this.context = this.template.getTemplateMethod()(this.item);
                }
            }
        };
        ListViewItemComponent.prototype.getSelectorName = function () {
            return 'gui-list-item';
        };
        return ListViewItemComponent;
    }(PureComponent));
    ListViewItemComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-list-view-item][item][template]',
                    template: "<ng-container *ngIf=\"hasTemplateRef; else templateMethod\">\n\t<div class=\"gui-list-item-container gui-py-8\">\n\t\t<ng-template *ngTemplateOutlet=\"template.getTemplateRef(); context: {item: item}\"></ng-template>\n\t</div>\n</ng-container>\n\n<ng-template #templateMethod>\n\t<div [innerHTML]=\"context\"\n\t\t class=\"gui-list-item-container gui-py-8\"></div>\n</ng-template>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush
                },] }
    ];
    ListViewItemComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    ListViewItemComponent.propDecorators = {
        item: [{ type: core.Input }],
        template: [{ type: core.Input }]
    };

    var EmptySourceComponent = /** @class */ (function (_super) {
        __extends(EmptySourceComponent, _super);
        function EmptySourceComponent(elRef) {
            var _this = _super.call(this, elRef) || this;
            _this.addClassToHost('gui-py-23');
            _this.addClassToHost('gui-px-6');
            return _this;
        }
        EmptySourceComponent.prototype.ngOnChanges = function (changes) {
            if (this.hasChanged(changes.items)) {
                if (this.items.length === 0) {
                    this.removeClassFromHost('gui-hidden');
                    this.addClassToHost('gui-block');
                }
                else {
                    this.removeClassFromHost('gui-block');
                    this.addClassToHost('gui-hidden');
                }
            }
        };
        EmptySourceComponent.prototype.getSelectorName = function () {
            return 'gui-empty-source';
        };
        return EmptySourceComponent;
    }(PureComponent));
    EmptySourceComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-empty-source][items]',
                    template: "<ng-container *ngIf=\"items.length === 0\">\n\t{{'sourceEmpty' | guiTranslate}}\n</ng-container>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    EmptySourceComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    EmptySourceComponent.propDecorators = {
        items: [{ type: core.Input }]
    };

    var EmptySourceFeatureModule = /** @class */ (function (_super) {
        __extends(EmptySourceFeatureModule, _super);
        function EmptySourceFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        EmptySourceFeatureModule.forComponent = function () {
            return [];
        };
        return EmptySourceFeatureModule;
    }(hermes.FeatureModule));
    EmptySourceFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        TranslationFeatureModule
                    ],
                    declarations: [
                        EmptySourceComponent
                    ],
                    exports: [
                        EmptySourceComponent
                    ]
                },] }
    ];

    var ListViewContainerCardComponent = /** @class */ (function (_super) {
        __extends(ListViewContainerCardComponent, _super);
        function ListViewContainerCardComponent(changeDetectorRef, elementRef, structureId, structureSourceWarehouse, listCardTemplateArchive) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.structureSourceWarehouse = structureSourceWarehouse;
            _this.listCardTemplateArchive = listCardTemplateArchive;
            _this.items = [];
            _this.addClassToHost('gui-flex');
            _this.addClassToHost('gui-flex-wrap');
            _this.addClassToHost('gui-m-0');
            _this.addClassToHost('gui-p-0');
            _this.addClassToHost('gui-rounded');
            return _this;
        }
        ListViewContainerCardComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.structureSourceWarehouse.onEntities(this.structureId), function (items) {
                _this.items = items.map(function (i) { return i.getSourceItem(); });
            });
            this.subscribe(this.listCardTemplateArchive.on(), function (template) {
                _this.cardTemplate = template;
                _this.changeDetectorRef.detectChanges();
            });
        };
        ListViewContainerCardComponent.prototype.getSelectorName = function () {
            return 'gui-list-container-card';
        };
        return ListViewContainerCardComponent;
    }(SmartComponent));
    ListViewContainerCardComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-list-container-card]',
                    template: "<div *ngFor=\"let element of items\" [item]=\"element\"\n\t [template]=\"cardTemplate\"\n\t gui-list-card-item>\n</div>\n\n<div [items]=\"items\" gui-empty-source>\n</div>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush
                },] }
    ];
    ListViewContainerCardComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: SourceWarehouse },
        { type: ListViewCardTemplateArchive }
    ]; };

    var ListViewCardItemComponent = /** @class */ (function (_super) {
        __extends(ListViewCardItemComponent, _super);
        function ListViewCardItemComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.context = 'Template not provided';
            _this.addClassToHost('gui-cursor-pointer');
            _this.addClassToHost('gui-block');
            _this.addClassToHost('gui-m-0');
            _this.addClassToHost('gui-p-0');
            _this.addClassToHost('gui-relative');
            return _this;
        }
        ListViewCardItemComponent.prototype.ngOnChanges = function () {
            if (this.template && this.item) {
                this.hasTemplateRef = this.template.hasTemplateRef();
                if (!this.hasTemplateRef) {
                    this.context = this.template.getTemplateMethod()(this.item);
                }
            }
        };
        ListViewCardItemComponent.prototype.getSelectorName = function () {
            return 'gui-list-card';
        };
        return ListViewCardItemComponent;
    }(PureComponent));
    ListViewCardItemComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-list-card-item][item][template]',
                    template: "<ng-container *ngIf=\"hasTemplateRef; else templateMethod\">\n\t<div class=\"gui-list-card-wrapper gui-h-full gui-m-0 gui-py-0 gui-px-8 gui-relative\">\n\t\t<ng-template *ngTemplateOutlet=\"template.getTemplateRef(); context: {item: item}\"></ng-template>\n\t</div>\n</ng-container>\n\n<ng-template #templateMethod>\n\t<div [innerHTML]=\"context\"\n\t\t class=\"gui-list-card-wrapper gui-h-full gui-m-0 gui-py-0 gui-px-8 gui-relative\"></div>\n</ng-template>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush
                },] }
    ];
    ListViewCardItemComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    ListViewCardItemComponent.propDecorators = {
        item: [{ type: core.Input }],
        template: [{ type: core.Input }]
    };

    var ListViewContainerModeSelectComponent = /** @class */ (function (_super) {
        __extends(ListViewContainerModeSelectComponent, _super);
        function ListViewContainerModeSelectComponent(changeDetectorRef, elementRef, listViewReadModelRootId, listViewWarehouse, listViewModeRepository) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.listViewReadModelRootId = listViewReadModelRootId;
            _this.listViewWarehouse = listViewWarehouse;
            _this.listViewModeRepository = listViewModeRepository;
            _this.options = Object.keys(ListViewMode)
                .map(function (key) { return ListViewMode[key]; })
                .filter(function (val) { return !Number.isInteger(val); })
                .map(function (val) {
                return _this.toGuiSelectOption(val);
            });
            return _this;
        }
        ListViewContainerModeSelectComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.listViewWarehouse.onMode(this.listViewReadModelRootId.toAggregateId()), function (mode) {
                _this.listContainerMode = _this.toGuiSelectOption(mode);
            });
        };
        ListViewContainerModeSelectComponent.prototype.changeContainerMode = function (mode) {
            var selectedMode = this.toListViewMode(mode.value);
            this.listViewModeRepository.next(this.listViewReadModelRootId.toAggregateId(), selectedMode);
        };
        ListViewContainerModeSelectComponent.prototype.getSelectorName = function () {
            return 'gui-list-mode-select';
        };
        ListViewContainerModeSelectComponent.prototype.toGuiSelectOption = function (value) {
            return { value: value, name: value };
        };
        ListViewContainerModeSelectComponent.prototype.toListViewMode = function (mode) {
            switch (mode) {
                case 'List':
                    return ListViewMode.LIST;
                case 'Card':
                    return ListViewMode.CARD;
                default:
                    return ListViewMode.LIST;
            }
        };
        return ListViewContainerModeSelectComponent;
    }(SmartComponent));
    ListViewContainerModeSelectComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-list-mode-select]',
                    template: "<gui-select (optionChanged)=\"changeContainerMode($event)\"\n\t\t\t[options]=\"options\"\n\t\t\t[selected]=\"listContainerMode\">\n</gui-select>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush
                },] }
    ];
    ListViewContainerModeSelectComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: ListViewReadModelRootId },
        { type: ListViewWarehouse },
        { type: ListViewModeArchive }
    ]; };

    var ListViewDomainEvent = /** @class */ (function (_super) {
        __extends(ListViewDomainEvent, _super);
        function ListViewDomainEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return ListViewDomainEvent;
    }(hermes.DomainEvent));

    var ListViewCreatedEvent = /** @class */ (function (_super) {
        __extends(ListViewCreatedEvent, _super);
        function ListViewCreatedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'ListViewCreatedEvent') || this;
        }
        return ListViewCreatedEvent;
    }(ListViewDomainEvent));

    var ListViewAggregateEvent = /** @class */ (function (_super) {
        __extends(ListViewAggregateEvent, _super);
        function ListViewAggregateEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return ListViewAggregateEvent;
    }(hermes.AggregateEvent));

    var ListViewCreatedAggregateEvent = /** @class */ (function (_super) {
        __extends(ListViewCreatedAggregateEvent, _super);
        function ListViewCreatedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'ListViewCreatedAggregateEvent') || this;
        }
        ListViewCreatedAggregateEvent.prototype.toDomainEvent = function () {
            return new ListViewCreatedEvent(this.getAggregateId());
        };
        return ListViewCreatedAggregateEvent;
    }(ListViewAggregateEvent));

    var ListViewModeSetEvent = /** @class */ (function (_super) {
        __extends(ListViewModeSetEvent, _super);
        function ListViewModeSetEvent(schemaId, mode) {
            var _this = _super.call(this, schemaId, mode, 'ListViewModeSetEvent') || this;
            _this.mode = mode;
            return _this;
        }
        ListViewModeSetEvent.prototype.getTheme = function () {
            return this.mode;
        };
        return ListViewModeSetEvent;
    }(ListViewDomainEvent));

    var ListViewModeSetAggregateEvent = /** @class */ (function (_super) {
        __extends(ListViewModeSetAggregateEvent, _super);
        function ListViewModeSetAggregateEvent(listViewId, mode) {
            var _this = _super.call(this, listViewId, 'ListViewModeSetAggregateEvent') || this;
            _this.mode = mode;
            return _this;
        }
        ListViewModeSetAggregateEvent.prototype.toDomainEvent = function () {
            return new ListViewModeSetEvent(this.getAggregateId(), this.mode);
        };
        return ListViewModeSetAggregateEvent;
    }(ListViewAggregateEvent));

    var SelectorVisibility = /** @class */ (function () {
        function SelectorVisibility() {
            this.enabled = null;
            this.visible = false;
        }
        SelectorVisibility.prototype.isVisible = function () {
            if (this.enabled !== null) {
                return this.enabled;
            }
            return this.visible;
        };
        SelectorVisibility.prototype.setEnabled = function (enabled) {
            this.enabled = enabled;
        };
        SelectorVisibility.prototype.setVisible = function (visible) {
            this.visible = visible;
        };
        return SelectorVisibility;
    }());

    var ListViewSelectorToggledEvent = /** @class */ (function (_super) {
        __extends(ListViewSelectorToggledEvent, _super);
        function ListViewSelectorToggledEvent(schemaId, enabled) {
            var _this = _super.call(this, schemaId, enabled, 'ListViewSelectorToggledEvent') || this;
            _this.enabled = enabled;
            return _this;
        }
        ListViewSelectorToggledEvent.prototype.isEnabled = function () {
            return this.enabled;
        };
        return ListViewSelectorToggledEvent;
    }(ListViewDomainEvent));

    var ListViewSelectorToggledAggregateEvent = /** @class */ (function (_super) {
        __extends(ListViewSelectorToggledAggregateEvent, _super);
        function ListViewSelectorToggledAggregateEvent(listViewId, enabled) {
            var _this = _super.call(this, listViewId, 'ListViewSelectorToggledAggregateEvent') || this;
            _this.enabled = enabled;
            return _this;
        }
        ListViewSelectorToggledAggregateEvent.prototype.toDomainEvent = function () {
            return new ListViewSelectorToggledEvent(this.getAggregateId(), this.enabled);
        };
        return ListViewSelectorToggledAggregateEvent;
    }(ListViewAggregateEvent));

    var ListViewAggregate = /** @class */ (function (_super) {
        __extends(ListViewAggregate, _super);
        function ListViewAggregate(listViewId) {
            var _this = _super.call(this, listViewId, 'ListViewAggregate') || this;
            _this.setMode(ListViewMode.LIST);
            _this.initSelectorVisibility();
            return _this;
        }
        ListViewAggregate.prototype.createEvent = function () {
            return ListViewCreatedAggregateEvent;
        };
        ListViewAggregate.prototype.setMode = function (mode) {
            this.mode = mode;
            this.addEvent(new ListViewModeSetAggregateEvent(this.getId(), this.mode));
        };
        ListViewAggregate.prototype.toggleModeSelector = function (enabled) {
            this.selectorVisibility.setEnabled(enabled);
            this.emitEventAfterSelectorVisibilityChange();
        };
        ListViewAggregate.prototype.initSelectorVisibility = function () {
            this.selectorVisibility = new SelectorVisibility();
            this.emitEventAfterSelectorVisibilityChange();
        };
        ListViewAggregate.prototype.emitEventAfterSelectorVisibilityChange = function () {
            this.addEvent(new ListViewSelectorToggledAggregateEvent(this.getId(), this.selectorVisibility.isVisible()));
        };
        return ListViewAggregate;
    }(hermes.AggregateRoot));

    var ListViewAggregateFactory = /** @class */ (function (_super) {
        __extends(ListViewAggregateFactory, _super);
        function ListViewAggregateFactory() {
            return _super.call(this) || this;
        }
        ListViewAggregateFactory.prototype.create = function (id) {
            return new ListViewAggregate(id);
        };
        return ListViewAggregateFactory;
    }(hermes.AggregateFactory));
    ListViewAggregateFactory.decorators = [
        { type: core.Injectable }
    ];
    ListViewAggregateFactory.ctorParameters = function () { return []; };

    var CreateListViewCommandHandler = /** @class */ (function () {
        function CreateListViewCommandHandler() {
        }
        CreateListViewCommandHandler.prototype.forCommand = function () {
            return CreateListViewCommand;
        };
        return CreateListViewCommandHandler;
    }());
    CreateListViewCommandHandler.decorators = [
        { type: core.Injectable }
    ];

    var InMemoryListViewStore = /** @class */ (function (_super) {
        __extends(InMemoryListViewStore, _super);
        function InMemoryListViewStore() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return InMemoryListViewStore;
    }(hermes.InMemoryStore));
    InMemoryListViewStore.decorators = [
        { type: core.Injectable }
    ];

    var InMemoryListViewAggregateStore = /** @class */ (function (_super) {
        __extends(InMemoryListViewAggregateStore, _super);
        function InMemoryListViewAggregateStore(inMemorySchemaStore, aggregateStoreRegister) {
            return _super.call(this, inMemorySchemaStore, aggregateStoreRegister) || this;
        }
        return InMemoryListViewAggregateStore;
    }(hermes.InMemoryAggregateStore));
    InMemoryListViewAggregateStore.decorators = [
        { type: core.Injectable }
    ];
    InMemoryListViewAggregateStore.ctorParameters = function () { return [
        { type: InMemoryListViewStore },
        { type: hermes.AggregateStoreRegister }
    ]; };

    var ListViewAggregateRepository = /** @class */ (function (_super) {
        __extends(ListViewAggregateRepository, _super);
        function ListViewAggregateRepository() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return ListViewAggregateRepository;
    }(hermes.AggregateRepository));

    var InMemoryListViewAggregateRepository = /** @class */ (function (_super) {
        __extends(InMemoryListViewAggregateRepository, _super);
        function InMemoryListViewAggregateRepository(inMemorySchemaAggregateStore) {
            var _this = _super.call(this) || this;
            _this.inMemorySchemaAggregateStore = inMemorySchemaAggregateStore;
            return _this;
        }
        InMemoryListViewAggregateRepository.prototype.findById = function (listViewId) {
            return this.inMemorySchemaAggregateStore.findById(listViewId);
        };
        InMemoryListViewAggregateRepository.prototype.save = function (listViewAggregate) {
            this.inMemorySchemaAggregateStore.save(listViewAggregate);
        };
        return InMemoryListViewAggregateRepository;
    }(ListViewAggregateRepository));
    InMemoryListViewAggregateRepository.decorators = [
        { type: core.Injectable }
    ];
    InMemoryListViewAggregateRepository.ctorParameters = function () { return [
        { type: InMemoryListViewAggregateStore }
    ]; };

    var ListViewEventRepository = /** @class */ (function (_super) {
        __extends(ListViewEventRepository, _super);
        function ListViewEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        ListViewEventRepository.prototype.onModeChange = function (listViewReadModelRootId) {
            return this.onEvent(listViewReadModelRootId, ListViewModeSetEvent);
        };
        return ListViewEventRepository;
    }(hermes.EventRepository));
    ListViewEventRepository.decorators = [
        { type: core.Injectable }
    ];
    ListViewEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var SetListViewModeCommandHandler = /** @class */ (function () {
        function SetListViewModeCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetListViewModeCommandHandler.prototype.forCommand = function () {
            return SetListViewModeCommand;
        };
        SetListViewModeCommandHandler.prototype.handle = function (listViewAggregate, command) {
            var mode = command.getMode();
            listViewAggregate.setMode(mode);
        };
        SetListViewModeCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SetListViewModeCommandHandler;
    }());
    SetListViewModeCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetListViewModeCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var ToggleListViewSelectorCommandHandler = /** @class */ (function () {
        function ToggleListViewSelectorCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        ToggleListViewSelectorCommandHandler.prototype.forCommand = function () {
            return ToggleListViewSelectorCommand;
        };
        ToggleListViewSelectorCommandHandler.prototype.handle = function (listViewAggregate, command) {
            var enabled = command.iseEnabled();
            listViewAggregate.toggleModeSelector(enabled);
        };
        ToggleListViewSelectorCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return ToggleListViewSelectorCommandHandler;
    }());
    ToggleListViewSelectorCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    ToggleListViewSelectorCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var ListViewDomainModule = /** @class */ (function () {
        function ListViewDomainModule() {
        }
        ListViewDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SetListViewModeCommandHandler, listViewKey),
                hermes.HermesModule.registerCommandHandler(ToggleListViewSelectorCommandHandler, listViewKey)
            ];
        };
        return ListViewDomainModule;
    }());
    ListViewDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [],
                    providers: [
                        ListViewDispatcher
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var ListViewModeSetEventHandler = /** @class */ (function () {
        function ListViewModeSetEventHandler(listViewModeRepository) {
            this.listViewModeRepository = listViewModeRepository;
        }
        ListViewModeSetEventHandler.prototype.forEvent = function () {
            return ListViewModeSetEvent;
        };
        ListViewModeSetEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('ListViewModeSetEvent')) {
                this.listViewModeRepository.next(event.getAggregateId(), event.getTheme());
            }
        };
        return ListViewModeSetEventHandler;
    }());
    ListViewModeSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    ListViewModeSetEventHandler.ctorParameters = function () { return [
        { type: ListViewModeArchive }
    ]; };

    var ListViewSelectorToggledEventHandler = /** @class */ (function () {
        function ListViewSelectorToggledEventHandler(listViewSelectorRepository) {
            this.listViewSelectorRepository = listViewSelectorRepository;
        }
        ListViewSelectorToggledEventHandler.prototype.forEvent = function () {
            return ListViewSelectorToggledEvent;
        };
        ListViewSelectorToggledEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('ListViewSelectorToggledEvent')) {
                this.listViewSelectorRepository.next(event.getAggregateId(), event.isEnabled());
            }
        };
        return ListViewSelectorToggledEventHandler;
    }());
    ListViewSelectorToggledEventHandler.decorators = [
        { type: core.Injectable }
    ];
    ListViewSelectorToggledEventHandler.ctorParameters = function () { return [
        { type: ListViewSelectorArchive }
    ]; };

    var listViewKey = 'ListViewKey';
    var ListViewApiModule = /** @class */ (function () {
        function ListViewApiModule() {
        }
        return ListViewApiModule;
    }());
    ListViewApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        hermes.HermesModule,
                        hermes.HermesModule.defineAggregate(listViewKey, ListViewAggregateFactory, InMemoryListViewAggregateRepository, CreateListViewCommandHandler, [
                            ListViewDomainModule.commandHandlers()
                        ], [
                            hermes.HermesModule.registerDomainEventHandler(ListViewModeSetEventHandler),
                            hermes.HermesModule.registerDomainEventHandler(ListViewSelectorToggledEventHandler)
                        ]),
                        ListViewDomainModule
                    ],
                    providers: [
                        ListViewCommandInvoker,
                        ListViewEventRepository,
                        ListViewWarehouse,
                        ListViewModeArchive,
                        ListViewSelectorArchive,
                        InMemoryListViewAggregateStore,
                        InMemoryListViewStore
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var Gate = /** @class */ (function () {
        function Gate() {
            this.streamCloser = new StreamCloser();
            this.hermesUnsubscribe$ = new hermes.HermesSubject();
        }
        Gate.prototype.ngOnDestroy = function () {
            this.streamCloser.unsubscribe();
            this.hermesUnsubscribe();
        };
        Gate.prototype.isDefined = function (propertyName, changes) {
            return changes[propertyName] !== undefined && changes[propertyName].currentValue !== undefined;
        };
        Gate.prototype.subscribeAndEmit = function (stream$, emitter) {
            stream$
                .pipe(this.hermesTakeUntil())
                .subscribe(function (value) {
                emitter.emit(value);
            });
        };
        Gate.prototype.unsubscribe = function () {
            this.streamCloser.unsubscribe();
        };
        Gate.prototype.hermesUnsubscribe = function () {
            this.hermesUnsubscribe$.next();
            this.hermesUnsubscribe$.complete();
        };
        Gate.prototype.hermesTakeUntil = function () {
            return hermes.hermesTakeUntil(this.hermesUnsubscribe$);
        };
        Gate.prototype.takeUntil = function () {
            return this.streamCloser.takeUntil();
        };
        return Gate;
    }());
    Gate.decorators = [
        { type: core.Directive }
    ];
    Gate.ctorParameters = function () { return []; };

    var PagingGate = /** @class */ (function (_super) {
        __extends(PagingGate, _super);
        function PagingGate(structureId, compositionId, pagingCommandInvoker, pagingEventRepository) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.compositionId = compositionId;
            _this.pagingCommandInvoker = pagingCommandInvoker;
            _this.pagingEventRepository = pagingEventRepository;
            _this.pageChanged = new core.EventEmitter();
            _this.pageSizeChanged = new core.EventEmitter();
            return _this;
        }
        PagingGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('paging', changes)) {
                var pagingConfig = void 0;
                if (typeof this.paging === 'boolean') {
                    pagingConfig = {
                        enabled: this.paging
                    };
                }
                else {
                    pagingConfig = this.paging;
                }
                this.pagingCommandInvoker.setPaging(pagingConfig, this.compositionId);
            }
        };
        PagingGate.prototype.ngOnInit = function () {
            this.subscribeAndEmit(this.pagingEventRepository.onPageChange(this.structureId.toReadModelRootId()), this.pageChanged);
            this.subscribeAndEmit(this.pagingEventRepository.onPageSizeChange(this.structureId.toReadModelRootId()), this.pageSizeChanged);
        };
        PagingGate.prototype.onPageChange = function (page) {
            this.pageChanged.emit(page);
        };
        return PagingGate;
    }(Gate));
    PagingGate.decorators = [
        { type: core.Directive }
    ];
    PagingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: CompositionId },
        { type: PagingCommandInvoker },
        { type: PagingEventRepository }
    ]; };
    PagingGate.propDecorators = {
        paging: [{ type: core.Input }],
        pageChanged: [{ type: core.Output }],
        pageSizeChanged: [{ type: core.Output }]
    };

    var ListViewPagingGate = /** @class */ (function (_super) {
        __extends(ListViewPagingGate, _super);
        function ListViewPagingGate(structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository) {
            return _super.call(this, structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository) || this;
        }
        return ListViewPagingGate;
    }(PagingGate));
    ListViewPagingGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-list-view[paging]'
                },] }
    ];
    ListViewPagingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: CompositionId },
        { type: PagingCommandInvoker },
        { type: PagingEventRepository }
    ]; };

    var ListViewModeGate = /** @class */ (function (_super) {
        __extends(ListViewModeGate, _super);
        function ListViewModeGate(listViewReadModelRootId, listViewCommandDispatcher) {
            var _this = _super.call(this) || this;
            _this.listViewReadModelRootId = listViewReadModelRootId;
            _this.listViewCommandDispatcher = listViewCommandDispatcher;
            return _this;
        }
        ListViewModeGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('mode', changes)) {
                this.listViewCommandDispatcher.setMode(this.mode, this.listViewReadModelRootId);
            }
            if (this.isDefined('modeSelector', changes)) {
                this.listViewCommandDispatcher.toggleSelector(this.modeSelector, this.listViewReadModelRootId);
            }
        };
        return ListViewModeGate;
    }(Gate));
    ListViewModeGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-list-view[mode]'
                },] }
    ];
    ListViewModeGate.ctorParameters = function () { return [
        { type: ListViewReadModelRootId },
        { type: ListViewCommandInvoker }
    ]; };
    ListViewModeGate.propDecorators = {
        mode: [{ type: core.Input }],
        modeSelector: [{ type: core.Input }]
    };

    var ListViewTemplateGate = /** @class */ (function (_super) {
        __extends(ListViewTemplateGate, _super);
        function ListViewTemplateGate(containerTemplateArchive, listCardTemplateArchive) {
            var _this = _super.call(this) || this;
            _this.containerTemplateArchive = containerTemplateArchive;
            _this.listCardTemplateArchive = listCardTemplateArchive;
            return _this;
        }
        ListViewTemplateGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('template', changes)) {
                this.containerTemplateArchive.next(this.template);
            }
            if (this.isDefined('cardTemplate', changes)) {
                this.listCardTemplateArchive.next(this.cardTemplate);
            }
        };
        return ListViewTemplateGate;
    }(Gate));
    ListViewTemplateGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-list-view[mode]'
                },] }
    ];
    ListViewTemplateGate.ctorParameters = function () { return [
        { type: ListViewTemplateArchive },
        { type: ListViewCardTemplateArchive }
    ]; };
    ListViewTemplateGate.propDecorators = {
        template: [{ type: core.Input }],
        cardTemplate: [{ type: core.Input }]
    };

    var InitFieldsCommand = /** @class */ (function (_super) {
        __extends(InitFieldsCommand, _super);
        function InitFieldsCommand(structureId, fieldConfigs) {
            var _this = _super.call(this, structureId, 'InitFieldsCommand') || this;
            _this.fieldConfigs = fieldConfigs;
            return _this;
        }
        InitFieldsCommand.prototype.getFieldConfigs = function () {
            return this.fieldConfigs;
        };
        return InitFieldsCommand;
    }(StructureCommand));

    var FieldCommandInvoker = /** @class */ (function () {
        function FieldCommandInvoker(domainEventBus, commandDispatcher) {
            this.domainEventBus = domainEventBus;
            this.commandDispatcher = commandDispatcher;
        }
        FieldCommandInvoker.prototype.initFields = function (fieldConfigs, structureId) {
            this.commandDispatcher.dispatch(new InitFieldsCommand(structureId, fieldConfigs));
        };
        return FieldCommandInvoker;
    }());
    FieldCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    FieldCommandInvoker.ctorParameters = function () { return [
        { type: hermes.DomainEventBus },
        { type: hermes.CommandDispatcher }
    ]; };

    var ListViewFieldGate = /** @class */ (function (_super) {
        __extends(ListViewFieldGate, _super);
        function ListViewFieldGate(structureId, fieldCommandDispatcher) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.fieldCommandDispatcher = fieldCommandDispatcher;
            return _this;
        }
        ListViewFieldGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('fields', changes)) {
                this.fieldCommandDispatcher.initFields(this.fields, this.structureId);
            }
        };
        return ListViewFieldGate;
    }(Gate));
    ListViewFieldGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-list-view[fields]'
                },] }
    ];
    ListViewFieldGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: FieldCommandInvoker }
    ]; };
    ListViewFieldGate.propDecorators = {
        fields: [{ type: core.Input }]
    };

    var SearchCommandInvoker = /** @class */ (function () {
        function SearchCommandInvoker() {
        }
        return SearchCommandInvoker;
    }());
    SearchCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SearchCommandInvoker.ctorParameters = function () { return []; };

    var SearchEventRepository = /** @class */ (function (_super) {
        __extends(SearchEventRepository, _super);
        function SearchEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        return SearchEventRepository;
    }(hermes.EventRepository));
    SearchEventRepository.decorators = [
        { type: core.Injectable }
    ];
    SearchEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var SearchingGate = /** @class */ (function (_super) {
        __extends(SearchingGate, _super);
        function SearchingGate(structureId, searchEventRepository, searchCommandInvoker) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.searchEventRepository = searchEventRepository;
            _this.searchCommandInvoker = searchCommandInvoker;
            _this.searchPhraseChanged = new core.EventEmitter();
            return _this;
        }
        SearchingGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('searching', changes)) {
                var searching = void 0;
                if (typeof this.searching === 'boolean') {
                    searching = {
                        enabled: this.searching
                    };
                }
                else {
                    searching = this.searching;
                }
                this.searchCommandInvoker.setSearchingConfig(searching, this.structureId);
            }
        };
        SearchingGate.prototype.ngOnInit = function () {
            this.subscribeAndEmit(this.searchEventRepository.onSearchPhrase(this.structureId.toReadModelRootId()), this.searchPhraseChanged);
        };
        return SearchingGate;
    }(Gate));
    SearchingGate.decorators = [
        { type: core.Directive }
    ];
    SearchingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SearchEventRepository },
        { type: SearchCommandInvoker }
    ]; };
    SearchingGate.propDecorators = {
        searching: [{ type: core.Input }],
        searchPhraseChanged: [{ type: core.Output }]
    };

    var ListViewSearchingGate = /** @class */ (function (_super) {
        __extends(ListViewSearchingGate, _super);
        function ListViewSearchingGate(structureId, searchEventRepository, searchCommandInvoker) {
            return _super.call(this, structureId, searchEventRepository, searchCommandInvoker) || this;
        }
        return ListViewSearchingGate;
    }(SearchingGate));
    ListViewSearchingGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-list-view[searching]'
                },] }
    ];
    ListViewSearchingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SearchEventRepository },
        { type: SearchCommandInvoker }
    ]; };

    var ListViewL10nGate = /** @class */ (function (_super) {
        __extends(ListViewL10nGate, _super);
        function ListViewL10nGate(translationService) {
            var _this = _super.call(this) || this;
            _this.translationService = translationService;
            return _this;
        }
        ListViewL10nGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('localization', changes)) {
                if (this.localization.translationResolver) {
                    this.translationService.setResolver(this.localization.translationResolver);
                }
                if (this.localization.translation) {
                    this.translationService.changeTranslation(this.localization.translation);
                }
            }
        };
        return ListViewL10nGate;
    }(Gate));
    ListViewL10nGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-list-view[localization]'
                },] }
    ];
    ListViewL10nGate.ctorParameters = function () { return [
        { type: TranslationFacade }
    ]; };
    ListViewL10nGate.propDecorators = {
        localization: [{ type: core.Input }]
    };

    var SourceCommandInvoker = /** @class */ (function () {
        function SourceCommandInvoker() {
        }
        return SourceCommandInvoker;
    }());
    SourceCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SourceCommandInvoker.ctorParameters = function () { return []; };

    var EditemItemValues = /** @class */ (function () {
        function EditemItemValues(after, before) {
            this.after = after;
            this.before = before;
        }
        return EditemItemValues;
    }());

    var StructureSourceItemEditedEvent = /** @class */ (function (_super) {
        __extends(StructureSourceItemEditedEvent, _super);
        function StructureSourceItemEditedEvent(aggregateId, beforeItem, afterItem) {
            var _this = _super.call(this, aggregateId, { beforeItem: beforeItem, afterItem: afterItem }, 'StructureSourceItemEditedEvent') || this;
            _this.beforeItem = beforeItem;
            _this.afterItem = afterItem;
            return _this;
        }
        StructureSourceItemEditedEvent.prototype.getBeforeItem = function () {
            return this.beforeItem;
        };
        StructureSourceItemEditedEvent.prototype.getAfterItem = function () {
            return this.afterItem;
        };
        return StructureSourceItemEditedEvent;
    }(StructureDomainEvent));

    var SourceEventService = /** @class */ (function () {
        function SourceEventService(domainEventBus) {
            this.domainEventBus = domainEventBus;
        }
        SourceEventService.prototype.onSourceEdited = function (structureId) {
            return this.domainEventBus
                .ofEvents([
                StructureSourceItemEditedEvent
            ])
                .pipe(hermes.hermesFilter(function (event) { return event.getAggregateId().toString() === structureId.toString(); }), hermes.hermesMap(function (event) {
                var afterItem = event.getAfterItem().getSourceItem(), beforeItem = event.getBeforeItem().getSourceItem();
                return new EditemItemValues(afterItem, beforeItem);
            }));
        };
        return SourceEventService;
    }());
    SourceEventService.decorators = [
        { type: core.Injectable }
    ];
    SourceEventService.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var SourceGate = /** @class */ (function (_super) {
        __extends(SourceGate, _super);
        function SourceGate(structureId, sourceCommandInvoker, sourceEventService) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.sourceCommandInvoker = sourceCommandInvoker;
            _this.sourceEventService = sourceEventService;
            _this.source = [];
            _this.items = [];
            _this.sourceEdited = new core.EventEmitter();
            return _this;
        }
        SourceGate.prototype.ngOnChanges = function (changes) {
            /**
             * Setting source should be last step
             */
            if (this.isDefined('source', changes)) {
                this.sourceCommandInvoker.setOrigin(this.source, this.structureId);
            }
            if (this.isDefined('items', changes)) {
                this.sourceCommandInvoker.setOrigin(this.items, this.structureId);
            }
        };
        SourceGate.prototype.ngOnInit = function () {
            this.subscribeAndEmit(this.sourceEventService.onSourceEdited(this.structureId), this.sourceEdited);
        };
        SourceGate.prototype.ngOnDestroy = function () {
            _super.prototype.ngOnDestroy.call(this);
        };
        return SourceGate;
    }(Gate));
    SourceGate.decorators = [
        { type: core.Directive }
    ];
    SourceGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SourceCommandInvoker },
        { type: SourceEventService }
    ]; };
    SourceGate.propDecorators = {
        source: [{ type: core.Input }],
        items: [{ type: core.Input }],
        sourceEdited: [{ type: core.Output }]
    };

    var ListViewSourceGate = /** @class */ (function (_super) {
        __extends(ListViewSourceGate, _super);
        function ListViewSourceGate(structureId, sourceCommandService, sourceEventService) {
            var _this = _super.call(this, structureId, sourceCommandService, sourceEventService) || this;
            _this.sourceCommandService = sourceCommandService;
            _this.sourceEventService = sourceEventService;
            return _this;
        }
        return ListViewSourceGate;
    }(SourceGate));
    ListViewSourceGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-list-view[items]'
                },] }
    ];
    ListViewSourceGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SourceCommandInvoker },
        { type: SourceEventService }
    ]; };

    var listViewGatewayDeclarations = [
        ListViewPagingGate,
        ListViewModeGate,
        ListViewTemplateGate,
        ListViewFieldGate,
        ListViewSearchingGate,
        ListViewL10nGate,
        ListViewSourceGate
    ];

    var SetConfigSearchingCommand = /** @class */ (function (_super) {
        __extends(SetConfigSearchingCommand, _super);
        function SetConfigSearchingCommand(structureId, searchConfig) {
            var _this = _super.call(this, structureId, 'SetConfigSearchingCommand') || this;
            _this.searchConfig = searchConfig;
            return _this;
        }
        SetConfigSearchingCommand.prototype.getConfig = function () {
            return this.searchConfig;
        };
        return SetConfigSearchingCommand;
    }(StructureCommand));

    var ConfigSearchingSetEvent = /** @class */ (function (_super) {
        __extends(ConfigSearchingSetEvent, _super);
        function ConfigSearchingSetEvent(aggregateId, enabled) {
            var _this = _super.call(this, aggregateId, enabled, 'ConfigSearchingSetEvent') || this;
            _this.enabled = enabled;
            return _this;
        }
        ConfigSearchingSetEvent.prototype.isEnabled = function () {
            return this.enabled;
        };
        return ConfigSearchingSetEvent;
    }(StructureDomainEvent));

    var SetConfigSearchingCommandHandler = /** @class */ (function () {
        function SetConfigSearchingCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetConfigSearchingCommandHandler.prototype.forCommand = function () {
            return SetConfigSearchingCommand;
        };
        SetConfigSearchingCommandHandler.prototype.handle = function (aggregate, command) {
            var searchingConfig = command.getConfig();
            aggregate.setSearchingConfig(searchingConfig);
        };
        SetConfigSearchingCommandHandler.prototype.publish = function (aggregate, command) {
            var searchingConfig = command.getConfig();
            this.domainEventPublisher.publish(new ConfigSearchingSetEvent(command.getAggregateId(), searchingConfig.enabled));
        };
        return SetConfigSearchingCommandHandler;
    }());
    SetConfigSearchingCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetConfigSearchingCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetSearchPhraseCommand = /** @class */ (function (_super) {
        __extends(SetSearchPhraseCommand, _super);
        function SetSearchPhraseCommand(structureId, phrase, initial) {
            var _this = _super.call(this, structureId, 'SetSearchPhraseCommand') || this;
            _this.phrase = phrase;
            _this.initial = initial;
            return _this;
        }
        SetSearchPhraseCommand.prototype.getPhrase = function () {
            return this.phrase;
        };
        SetSearchPhraseCommand.prototype.isInitial = function () {
            return this.initial;
        };
        return SetSearchPhraseCommand;
    }(StructureCommand));

    var SearchPhraseSetDomainEvent = /** @class */ (function (_super) {
        __extends(SearchPhraseSetDomainEvent, _super);
        function SearchPhraseSetDomainEvent(aggregateId, phrase, initial) {
            var _this = _super.call(this, aggregateId, { phrase: phrase, initial: initial }, 'SearchPhraseSetDomainEvent') || this;
            _this.phrase = phrase;
            _this.initial = initial;
            return _this;
        }
        SearchPhraseSetDomainEvent.prototype.getPhrase = function () {
            return this.phrase;
        };
        SearchPhraseSetDomainEvent.prototype.isInitial = function () {
            return this.initial;
        };
        return SearchPhraseSetDomainEvent;
    }(StructureDomainEvent));

    var OriginSetEvent = /** @class */ (function (_super) {
        __extends(OriginSetEvent, _super);
        function OriginSetEvent(aggregateId, origin) {
            var _this = _super.call(this, aggregateId, origin, 'OriginSetEvent') || this;
            _this.origin = origin;
            return _this;
        }
        OriginSetEvent.prototype.getOrigin = function () {
            return this.origin;
        };
        return OriginSetEvent;
    }(StructureDomainEvent));

    var StructureSummariesChangedEvent = /** @class */ (function (_super) {
        __extends(StructureSummariesChangedEvent, _super);
        function StructureSummariesChangedEvent(structureId, values) {
            var _this = _super.call(this, structureId, values, 'StructureSummariesChangedEvent') || this;
            _this.values = values;
            return _this;
        }
        StructureSummariesChangedEvent.prototype.getSummaries = function () {
            return this.values;
        };
        return StructureSummariesChangedEvent;
    }(StructureDomainEvent));

    var StructurePreparedEntitiesSetEvent = /** @class */ (function (_super) {
        __extends(StructurePreparedEntitiesSetEvent, _super);
        function StructurePreparedEntitiesSetEvent(aggregateId, preparedItems) {
            var _this = _super.call(this, aggregateId, preparedItems, 'StructurePreparedEntitiesSetEvent') || this;
            _this.preparedItems = preparedItems;
            return _this;
        }
        StructurePreparedEntitiesSetEvent.prototype.getPreparedItems = function () {
            return this.preparedItems;
        };
        return StructurePreparedEntitiesSetEvent;
    }(StructureDomainEvent));

    var SourceDomainEventPublisher = /** @class */ (function () {
        function SourceDomainEventPublisher(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SourceDomainEventPublisher.prototype.publish = function (events) {
            var _this = this;
            events.forEach(function (event) {
                _this.publishEvent(event);
            });
        };
        SourceDomainEventPublisher.prototype.publishEvent = function (event) {
            if (event.getType() === 'StructureOriginChangedAggregateEvent') {
                var structureOriginChangedAggregateEvent = event;
                var domainEvent = new OriginSetEvent(structureOriginChangedAggregateEvent.getAggregateId(), structureOriginChangedAggregateEvent.getOrigin());
                this.domainEventPublisher.publish(domainEvent);
            }
            if (event.getType() === 'StructureSourceItemEditedAggregateEvent') {
                var structureSourceItemEditedAggregateEvent = event;
                var domainEvent = new StructureSourceItemEditedEvent(structureSourceItemEditedAggregateEvent.getAggregateId(), structureSourceItemEditedAggregateEvent.getBeforeItem(), structureSourceItemEditedAggregateEvent.getAfterItem());
                this.domainEventPublisher.publish(domainEvent);
            }
            if (event.getType() === 'StructureSummariesChangedAggregateEvent') {
                var structureSummariesChangedAggregateEvent = event;
                var domainEvent = new StructureSummariesChangedEvent(structureSummariesChangedAggregateEvent.getAggregateId(), structureSummariesChangedAggregateEvent.getSummaries());
                this.domainEventPublisher.publish(domainEvent);
            }
            if (event.getType() === 'StructurePreparedEntitiesSetAggregateEvent') {
                var structurePreparedEntitiesSetAggregateEvent = event;
                var domainEvent = new StructurePreparedEntitiesSetEvent(structurePreparedEntitiesSetAggregateEvent.getAggregateId(), structurePreparedEntitiesSetAggregateEvent.getPreparedItems());
                this.domainEventPublisher.publish(domainEvent);
            }
            if (event.getType() === 'UniqueFilterCalculatedAggregateEvent') {
                var uniqueFilterCalculatedAggregateEvent = event;
                var domainEvent = uniqueFilterCalculatedAggregateEvent.toDomainEvent();
                this.domainEventPublisher.publish(domainEvent);
            }
        };
        return SourceDomainEventPublisher;
    }());
    SourceDomainEventPublisher.decorators = [
        { type: core.Injectable }
    ];
    SourceDomainEventPublisher.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var StructureSetSearchPhraseCommandHandler = /** @class */ (function () {
        function StructureSetSearchPhraseCommandHandler(structureSourceDomainEventPublisher, domainEventPublisher) {
            this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
            this.domainEventPublisher = domainEventPublisher;
        }
        StructureSetSearchPhraseCommandHandler.prototype.forCommand = function () {
            return SetSearchPhraseCommand;
        };
        StructureSetSearchPhraseCommandHandler.prototype.handle = function (aggregate, command) {
            var phrase = command.getPhrase();
            aggregate.addSearchPhrase(phrase);
        };
        StructureSetSearchPhraseCommandHandler.prototype.publish = function (aggregate, command) {
            var phrase = command.getPhrase(), initial = command.isInitial();
            this.domainEventPublisher.publish(new SearchPhraseSetDomainEvent(command.getAggregateId(), phrase, initial));
            this.structureSourceDomainEventPublisher.publish(aggregate.getEvents());
        };
        return StructureSetSearchPhraseCommandHandler;
    }());
    StructureSetSearchPhraseCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    StructureSetSearchPhraseCommandHandler.ctorParameters = function () { return [
        { type: SourceDomainEventPublisher },
        { type: hermes.DomainEventPublisher }
    ]; };

    var DataType;
    (function (DataType) {
        DataType[DataType["UNKNOWN"] = 0] = "UNKNOWN";
        DataType[DataType["NUMBER"] = 1] = "NUMBER";
        DataType[DataType["STRING"] = 2] = "STRING";
        DataType[DataType["BOOLEAN"] = 3] = "BOOLEAN";
        DataType[DataType["DATE"] = 4] = "DATE";
        DataType[DataType["CUSTOM"] = 5] = "CUSTOM";
    })(DataType || (DataType = {}));

    var SearchManager = /** @class */ (function () {
        function SearchManager() {
            this.searchFields = [];
            this.enabledDataTypes = [
                DataType.STRING
            ];
        }
        SearchManager.prototype.addSearchPhrase = function (fields, searchPhrase) {
            var _this = this;
            if (!searchPhrase) {
                this.searchFields = [];
                return;
            }
            var searchableFields = fields.filter(function (field) {
                return _this.enabledDataTypes.some(function (dt) { return dt === field.getDataType(); });
            });
            if (searchableFields.length === 0) {
                return;
            }
            this.searchFields = searchableFields;
            this.searchPhrase = searchPhrase;
        };
        SearchManager.prototype.removeSearchFilters = function () {
            this.searchFields = [];
        };
        SearchManager.prototype.search = function (entities) {
            var _this = this;
            if (entities.length === 0 || this.searchFields.length === 0) {
                return entities;
            }
            var searchedItems = new Set();
            var _loop_1 = function (i) {
                this_1.searchFields
                    .filter(function (field) { return field.search(entities[i], _this.searchPhrase); })
                    .forEach(function () {
                    searchedItems.add(entities[i]);
                });
            };
            var this_1 = this;
            for (var i = 0; i < entities.length; i += 1) {
                _loop_1(i);
            }
            return Array.from(searchedItems);
        };
        return SearchManager;
    }());

    var SearchManagerFactory = /** @class */ (function () {
        function SearchManagerFactory() {
        }
        SearchManagerFactory.prototype.create = function () {
            return new SearchManager();
        };
        return SearchManagerFactory;
    }());
    SearchManagerFactory.decorators = [
        { type: core.Injectable }
    ];

    var SearchHighlightArchive = /** @class */ (function (_super) {
        __extends(SearchHighlightArchive, _super);
        function SearchHighlightArchive() {
            return _super.call(this, SearchHighlightArchive.HIGHLIGHTING) || this;
        }
        return SearchHighlightArchive;
    }(hermes.AggregateArchive));
    SearchHighlightArchive.HIGHLIGHTING = true;
    SearchHighlightArchive.decorators = [
        { type: core.Injectable }
    ];
    SearchHighlightArchive.ctorParameters = function () { return []; };

    var SearchPlaceholderArchive = /** @class */ (function (_super) {
        __extends(SearchPlaceholderArchive, _super);
        function SearchPlaceholderArchive() {
            return _super.call(this, SearchPlaceholderArchive.PLACEHOLDER) || this;
        }
        return SearchPlaceholderArchive;
    }(hermes.AggregateArchive));
    SearchPlaceholderArchive.PLACEHOLDER = 'Search...';
    SearchPlaceholderArchive.decorators = [
        { type: core.Injectable }
    ];
    SearchPlaceholderArchive.ctorParameters = function () { return []; };

    var SearchDispatcher = /** @class */ (function () {
        function SearchDispatcher(commandDispatcher, searchHighlightArchive, searchPlaceholderArchive) {
            this.commandDispatcher = commandDispatcher;
            this.searchHighlightArchive = searchHighlightArchive;
            this.searchPlaceholderArchive = searchPlaceholderArchive;
        }
        SearchDispatcher.prototype.setSearchingConfig = function (config, structureId) {
            if (config.highlighting !== undefined && config.highlighting !== null) {
                this.searchHighlightArchive.next(structureId, config.highlighting);
            }
            if (config.placeholder !== undefined && config.placeholder !== null) {
                this.searchPlaceholderArchive.next(structureId, config.placeholder);
            }
            if (config.phrase !== undefined && config.phrase !== null) {
                this.searchOnInit(config.phrase, structureId);
            }
            this.commandDispatcher.dispatch(new SetConfigSearchingCommand(structureId, config));
        };
        SearchDispatcher.prototype.search = function (phrase, structureId) {
            this.commandDispatcher.dispatch(new SetSearchPhraseCommand(structureId, phrase, false));
        };
        SearchDispatcher.prototype.searchOnInit = function (phrase, structureId) {
            this.commandDispatcher.dispatch(new SetSearchPhraseCommand(structureId, phrase, true));
        };
        return SearchDispatcher;
    }());
    SearchDispatcher.decorators = [
        { type: core.Injectable }
    ];
    SearchDispatcher.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher },
        { type: SearchHighlightArchive },
        { type: SearchPlaceholderArchive }
    ]; };

    var SearchPhraseArchive = /** @class */ (function (_super) {
        __extends(SearchPhraseArchive, _super);
        function SearchPhraseArchive() {
            return _super.call(this, SearchPhraseArchive.SEARCH_PHRASE) || this;
        }
        return SearchPhraseArchive;
    }(hermes.AggregateArchive));
    SearchPhraseArchive.SEARCH_PHRASE = '';
    SearchPhraseArchive.decorators = [
        { type: core.Injectable }
    ];
    SearchPhraseArchive.ctorParameters = function () { return []; };

    var SearchPhraseSetEventHandler = /** @class */ (function () {
        function SearchPhraseSetEventHandler(searchPhraseRepository) {
            this.searchPhraseRepository = searchPhraseRepository;
        }
        SearchPhraseSetEventHandler.prototype.forEvent = function () {
            return SearchPhraseSetDomainEvent;
        };
        SearchPhraseSetEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('SearchPhraseSetDomainEvent')) {
                this.searchPhraseRepository.next(event.getAggregateId(), event.getPhrase());
            }
        };
        return SearchPhraseSetEventHandler;
    }());
    SearchPhraseSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    SearchPhraseSetEventHandler.ctorParameters = function () { return [
        { type: SearchPhraseArchive }
    ]; };

    var SearchingEnabledArchive = /** @class */ (function (_super) {
        __extends(SearchingEnabledArchive, _super);
        function SearchingEnabledArchive() {
            return _super.call(this, SearchingEnabledArchive.ENABLED) || this;
        }
        return SearchingEnabledArchive;
    }(hermes.AggregateArchive));
    SearchingEnabledArchive.ENABLED = false;
    SearchingEnabledArchive.decorators = [
        { type: core.Injectable }
    ];
    SearchingEnabledArchive.ctorParameters = function () { return []; };

    var ConfigSearchingSetEventHandler = /** @class */ (function () {
        function ConfigSearchingSetEventHandler(structureSearchingRepository) {
            this.structureSearchingRepository = structureSearchingRepository;
        }
        ConfigSearchingSetEventHandler.prototype.forEvent = function () {
            return ConfigSearchingSetEvent;
        };
        ConfigSearchingSetEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('ConfigSearchingSetEvent')) {
                this.structureSearchingRepository.next(event.getAggregateId(), event.isEnabled());
            }
        };
        return ConfigSearchingSetEventHandler;
    }());
    ConfigSearchingSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    ConfigSearchingSetEventHandler.ctorParameters = function () { return [
        { type: SearchingEnabledArchive }
    ]; };

    var SearchDomainModule = /** @class */ (function (_super) {
        __extends(SearchDomainModule, _super);
        function SearchDomainModule() {
            return _super.call(this) || this;
        }
        SearchDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SetConfigSearchingCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(StructureSetSearchPhraseCommandHandler, structureKey)
            ];
        };
        SearchDomainModule.domainEventHandlers = function () {
            return [
                hermes.HermesModule.registerDomainEventHandler(SearchPhraseSetEventHandler),
                hermes.HermesModule.registerDomainEventHandler(ConfigSearchingSetEventHandler)
            ];
        };
        return SearchDomainModule;
    }(hermes.DomainModule));
    SearchDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [
                        SearchManagerFactory,
                        SearchDispatcher
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    SearchDomainModule.ctorParameters = function () { return []; };

    var SearchWarehouse = /** @class */ (function () {
        function SearchWarehouse() {
        }
        return SearchWarehouse;
    }());
    SearchWarehouse.decorators = [
        { type: core.Injectable }
    ];
    SearchWarehouse.ctorParameters = function () { return []; };

    var SearchDomainWarehouse = /** @class */ (function (_super) {
        __extends(SearchDomainWarehouse, _super);
        function SearchDomainWarehouse(searchingEnabledArchive, searchPhraseArchive, searchHighlightArchive, searchPlaceholderArchive) {
            var _this = _super.call(this) || this;
            _this.searchingEnabledArchive = searchingEnabledArchive;
            _this.searchPhraseArchive = searchPhraseArchive;
            _this.searchHighlightArchive = searchHighlightArchive;
            _this.searchPlaceholderArchive = searchPlaceholderArchive;
            return _this;
        }
        SearchDomainWarehouse.prototype.onSearchEnabled = function (structureId) {
            return this.searchingEnabledArchive.on(structureId);
        };
        SearchDomainWarehouse.prototype.onPhrase = function (structureId) {
            return this.searchPhraseArchive.on(structureId);
        };
        SearchDomainWarehouse.prototype.onHighlight = function (structureId) {
            return this.searchHighlightArchive.on(structureId);
        };
        SearchDomainWarehouse.prototype.onPlaceholder = function (structureId) {
            return this.searchPlaceholderArchive.on(structureId);
        };
        return SearchDomainWarehouse;
    }(SearchWarehouse));
    SearchDomainWarehouse.decorators = [
        { type: core.Injectable }
    ];
    SearchDomainWarehouse.ctorParameters = function () { return [
        { type: SearchingEnabledArchive },
        { type: SearchPhraseArchive },
        { type: SearchHighlightArchive },
        { type: SearchPlaceholderArchive }
    ]; };

    var SearchDomainEventRepository = /** @class */ (function (_super) {
        __extends(SearchDomainEventRepository, _super);
        function SearchDomainEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        SearchDomainEventRepository.prototype.onSearchPhrase = function (structureId) {
            return this.onEvent(structureId, SearchPhraseSetDomainEvent)
                .pipe(hermes.hermesFilter(function (event) { return event.isInitial() === false; }), hermes.hermesMap(function (event) { return event.getPhrase(); }), hermes.hermesFilter(function (phrase) { return phrase !== null; }));
        };
        return SearchDomainEventRepository;
    }(SearchEventRepository));
    SearchDomainEventRepository.decorators = [
        { type: core.Injectable }
    ];
    SearchDomainEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var SearchDomainCommandInvoker = /** @class */ (function (_super) {
        __extends(SearchDomainCommandInvoker, _super);
        function SearchDomainCommandInvoker(searchDispatcher) {
            var _this = _super.call(this) || this;
            _this.searchDispatcher = searchDispatcher;
            return _this;
        }
        SearchDomainCommandInvoker.prototype.setSearchingConfig = function (config, structureId) {
            this.searchDispatcher.setSearchingConfig(config, structureId);
        };
        SearchDomainCommandInvoker.prototype.search = function (phrase, structureId) {
            this.searchDispatcher.search(phrase, structureId);
        };
        return SearchDomainCommandInvoker;
    }(SearchCommandInvoker));
    SearchDomainCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SearchDomainCommandInvoker.ctorParameters = function () { return [
        { type: SearchDispatcher }
    ]; };

    var SearchApiModule = /** @class */ (function (_super) {
        __extends(SearchApiModule, _super);
        function SearchApiModule() {
            return _super.call(this) || this;
        }
        return SearchApiModule;
    }(hermes.ApiModule));
    SearchApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        SearchDomainModule
                    ],
                    providers: [
                        {
                            provide: SearchCommandInvoker,
                            useClass: SearchDomainCommandInvoker
                        },
                        {
                            provide: SearchWarehouse,
                            useClass: SearchDomainWarehouse
                        },
                        {
                            provide: SearchEventRepository,
                            useClass: SearchDomainEventRepository
                        },
                        SearchPhraseArchive,
                        SearchHighlightArchive,
                        SearchPlaceholderArchive,
                        SearchingEnabledArchive
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    SearchApiModule.ctorParameters = function () { return []; };

    var StaticComponent = /** @class */ (function (_super) {
        __extends(StaticComponent, _super);
        function StaticComponent(elementRef, changeDetectorRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            return _this;
        }
        StaticComponent.prototype.ngOnInit = function () {
            this.changeDetectorRef.detach();
        };
        return StaticComponent;
    }(GuiComponent));
    StaticComponent.decorators = [
        { type: core.Directive }
    ];
    StaticComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var IconComponent = /** @class */ (function (_super) {
        __extends(IconComponent, _super);
        function IconComponent(elementRef, changeDetectorRef) {
            var _this = _super.call(this, elementRef, changeDetectorRef) || this;
            _this.addClassToHost('gui-icon');
            return _this;
        }
        return IconComponent;
    }(StaticComponent));
    IconComponent.decorators = [
        { type: core.Directive }
    ];
    IconComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var SearchIconComponent = /** @class */ (function (_super) {
        __extends(SearchIconComponent, _super);
        function SearchIconComponent(elementRef, changeDetectorRef) {
            return _super.call(this, elementRef, changeDetectorRef) || this;
        }
        SearchIconComponent.prototype.getSelectorName = function () {
            return 'gui-search-icon';
        };
        return SearchIconComponent;
    }(IconComponent));
    SearchIconComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-search-icon]',
                    template: "\n\t\t<svg class=\"gui-search-icon-svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"10.231\" height=\"10.601\" viewBox=\"0 0 10.231 10.601\">\n\t\t\t<line x2=\"1.77\" y2=\"1.77\" transform=\"translate(7.4 7.77)\" fill=\"none\" stroke-linecap=\"round\"\n\t\t\t\t  stroke-linejoin=\"round\" stroke-width=\"1.5\"/>\n\t\t\t<circle cx=\"4.02\" cy=\"4.02\" r=\"4.02\" transform=\"translate(0.5 0.5)\" stroke-width=\"1\"\n\t\t\t\t\tstroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\"/>\n\t\t</svg>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    SearchIconComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var CellEditorManager = /** @class */ (function () {
        function CellEditorManager(config) {
            this.enabled = false;
            this.rowEdit = function () { return true; };
            this.cellEdit = function () { return true; };
            if (config.enabled !== undefined) {
                this.enabled = config.enabled;
            }
            if (config.rowEdit !== undefined) {
                this.rowEdit = config.rowEdit;
            }
            if (config.cellEdit !== undefined) {
                this.cellEdit = config.cellEdit;
            }
        }
        CellEditorManager.prototype.isEnabled = function (value, item, index) {
            return this.enabled && this.rowEdit(value, item, index) && this.cellEdit(value, item, index);
        };
        return CellEditorManager;
    }());

    var StructureCellEditArchive = /** @class */ (function (_super) {
        __extends(StructureCellEditArchive, _super);
        function StructureCellEditArchive() {
            return _super.call(this, StructureCellEditArchive.default) || this;
        }
        return StructureCellEditArchive;
    }(hermes.AggregateArchive));
    StructureCellEditArchive.default = new CellEditorManager({ enabled: false });
    StructureCellEditArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureCellEditArchive.ctorParameters = function () { return []; };

    var StructureWarehouse = /** @class */ (function () {
        function StructureWarehouse(structureRepository, structureCellEditArchive) {
            this.structureRepository = structureRepository;
            this.structureCellEditArchive = structureCellEditArchive;
        }
        StructureWarehouse.prototype.on = function (structureId) {
            return this.structureRepository.on(structureId);
        };
        StructureWarehouse.prototype.onEditManager = function (structureId) {
            return this.structureCellEditArchive
                .on(structureId);
        };
        return StructureWarehouse;
    }());
    StructureWarehouse.decorators = [
        { type: core.Injectable }
    ];
    StructureWarehouse.ctorParameters = function () { return [
        { type: StructureReadModelRepository },
        { type: StructureCellEditArchive }
    ]; };

    var SearchComponent = /** @class */ (function (_super) {
        __extends(SearchComponent, _super);
        function SearchComponent(formBuilder, changeDetectorRef, elementRef, structureId, searchCommandDispatcher, structureWarehouse, searchWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.formBuilder = formBuilder;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.searchCommandDispatcher = searchCommandDispatcher;
            _this.structureWarehouse = structureWarehouse;
            _this.searchWarehouse = searchWarehouse;
            var controlsConfig = {};
            controlsConfig[SearchComponent.FORM_SEARCH_NAME] = '';
            _this.searchForm = _this.formBuilder.group(controlsConfig);
            return _this;
        }
        SearchComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.observeChanges();
            this.subscribe(this.searchWarehouse.onPlaceholder(this.structureId), function (placeholder) {
                _this.placeholder = placeholder;
            });
            this.subscribe(this.searchWarehouse.onSearchEnabled(this.structureId), function (searchingEnabled) {
                _this.searchingEnabled = searchingEnabled;
            });
            this.subscribeWithoutRender(this.searchWarehouse.onPhrase(this.structureId), function (phrase) {
                if (phrase === undefined) {
                    phrase = null;
                }
                var controlsConfig = {};
                controlsConfig[SearchComponent.FORM_SEARCH_NAME] = phrase;
                if (phrase !== _this.searchForm.get([SearchComponent.FORM_SEARCH_NAME]).value) {
                    _this.stopObserveChanges();
                    _this.searchForm.setValue(controlsConfig);
                    _this.observeChanges();
                }
            });
        };
        SearchComponent.prototype.clear = function () {
            this.searchForm.reset();
        };
        SearchComponent.prototype.getSelectorName = function () {
            return 'gui-search-bar';
        };
        SearchComponent.prototype.observeChanges = function () {
            var _this = this;
            this.searchInputSubscription =
                hermes.fromRxJsObservable(this.searchForm
                    .controls[SearchComponent.FORM_SEARCH_NAME]
                    .valueChanges
                    .pipe(operators.debounceTime(200)))
                    .pipe(this.takeUntil())
                    .subscribe(function (phrase) {
                    _this.searchCommandDispatcher.search(phrase, _this.structureId);
                });
        };
        SearchComponent.prototype.stopObserveChanges = function () {
            this.searchInputSubscription.unsubscribe();
        };
        return SearchComponent;
    }(SmartComponent));
    SearchComponent.FORM_SEARCH_NAME = 'searchPhrase';
    SearchComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-search-bar]',
                    template: "<ng-container *ngIf=\"searchingEnabled\">\n\t<form #formRef\n\t\t  [formGroup]=\"searchForm\"\n\t\t  class=\"gui-flex gui-relative gui-w-full\">\n\n\t\t<div gui-search-icon></div>\n\n\t\t<input [placeholder]=\"placeholder\"\n\t\t\t   class=\"gui-border-0 gui-w-full gui-h-full gui-py-5 gui-pr-5 gui-pl-21\"\n\t\t\t   formControlName=\"searchPhrase\">\n\n\t\t<span (click)=\"clear()\"\n\t\t\t  *ngIf=\"searchForm.controls['searchPhrase'].value\"\n\t\t\t  class=\"gui-clear-search-icon\">\n\t\t\t\t</span>\n\t</form>\n</ng-container>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None,
                    styles: [".gui-search-bar form{background:#fff}.gui-search-bar form:hover .gui-search-icon-svg line,.gui-search-bar form:hover .gui-search-icon-svg circle{stroke:#333}.gui-search-bar .gui-search-icon-svg{height:17px;left:10px;position:absolute;top:6px;width:17px}.gui-search-bar .gui-search-icon-svg line,.gui-search-bar .gui-search-icon-svg circle{stroke:#ccc;transition:stroke .3s ease-in-out}\n"]
                },] }
    ];
    SearchComponent.ctorParameters = function () { return [
        { type: forms.FormBuilder },
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: SearchCommandInvoker },
        { type: StructureWarehouse },
        { type: SearchWarehouse }
    ]; };
    SearchComponent.propDecorators = {
        formRef: [{ type: core.ViewChild, args: ['formRef', { static: false },] }]
    };

    var SearchFeatureModule = /** @class */ (function (_super) {
        __extends(SearchFeatureModule, _super);
        function SearchFeatureModule(searchApiModule) {
            var _this = _super.call(this) || this;
            if (searchApiModule === null) {
                throw new Error('SearchApiModule is required');
            }
            return _this;
        }
        SearchFeatureModule.forComponent = function () {
            return [];
        };
        return SearchFeatureModule;
    }(hermes.FeatureModule));
    SearchFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabric.FabricModule,
                        SearchApiModule,
                        forms.ReactiveFormsModule
                    ],
                    declarations: [
                        SearchIconComponent,
                        SearchComponent
                    ],
                    exports: [
                        SearchIconComponent,
                        SearchComponent
                    ]
                },] }
    ];
    SearchFeatureModule.ctorParameters = function () { return [
        { type: SearchApiModule }
    ]; };

    var SortingSelectorComponent = /** @class */ (function (_super) {
        __extends(SortingSelectorComponent, _super);
        function SortingSelectorComponent(detector, elementRef) {
            var _this = _super.call(this, detector, elementRef) || this;
            _this.sortingOptions = [
                'Name: A-Z',
                'Name: Z-A',
                'Price: Low to High',
                'Price: High to Low',
                'None'
            ];
            _this.selectedSorting = _this.sortingOptions[0];
            return _this;
        }
        SortingSelectorComponent.prototype.changeSorting = function (sorting) {
        };
        SortingSelectorComponent.prototype.getSelectorName = function () {
            return 'gui-sorting-selector';
        };
        return SortingSelectorComponent;
    }(SmartComponent));
    SortingSelectorComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-sorting-selector]',
                    template: "<gui-select (optionChanged)=\"changeSorting($event)\"\n\t\t\t[options]=\"sortingOptions\"\n\t\t\t[selected]=\"selectedSorting\"\n\t\t\t[width]=\"200\">\n</gui-select>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    SortingSelectorComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };

    var SortingSelectorFeatureModule = /** @class */ (function () {
        function SortingSelectorFeatureModule() {
        }
        return SortingSelectorFeatureModule;
    }());
    SortingSelectorFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabric.FabricSelectModule
                    ],
                    declarations: [
                        SortingSelectorComponent
                    ],
                    exports: [
                        SortingSelectorComponent
                    ]
                },] }
    ];

    var FilterIconComponent = /** @class */ (function (_super) {
        __extends(FilterIconComponent, _super);
        function FilterIconComponent(elementRef, changeDetectorRef) {
            return _super.call(this, elementRef, changeDetectorRef) || this;
        }
        FilterIconComponent.prototype.getSelectorName = function () {
            return 'gui-filter-icon';
        };
        return FilterIconComponent;
    }(IconComponent));
    FilterIconComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-filter-icon]',
                    template: "\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 10.32 7.23\">\n\t\t\t<line class=\"cls-1\" x1=\"9.57\" y1=\"0.75\" x2=\"0.75\" y2=\"0.75\"/>\n\t\t\t<line class=\"cls-1\" x1=\"8.14\" y1=\"3.62\" x2=\"2.18\" y2=\"3.62\"/>\n\t\t\t<line class=\"cls-1\" x1=\"6.71\" y1=\"6.48\" x2=\"3.62\" y2=\"6.48\"/>\n\t\t</svg>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    FilterIconComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var CompositionWarehouse = /** @class */ (function () {
        function CompositionWarehouse() {
        }
        return CompositionWarehouse;
    }());
    CompositionWarehouse.decorators = [
        { type: core.Injectable }
    ];
    CompositionWarehouse.ctorParameters = function () { return []; };

    var FieldReadModelArchive = /** @class */ (function (_super) {
        __extends(FieldReadModelArchive, _super);
        function FieldReadModelArchive() {
            return _super.call(this, FieldReadModelArchive.default) || this;
        }
        return FieldReadModelArchive;
    }(hermes.AggregateArchive));
    FieldReadModelArchive.default = [];
    FieldReadModelArchive.decorators = [
        { type: core.Injectable }
    ];
    FieldReadModelArchive.ctorParameters = function () { return []; };

    var FieldWarehouse = /** @class */ (function () {
        function FieldWarehouse(fieldReadModelArchive) {
            this.fieldReadModelArchive = fieldReadModelArchive;
        }
        FieldWarehouse.prototype.onFields = function (structureId) {
            return this.fieldReadModelArchive.on(structureId);
        };
        return FieldWarehouse;
    }());
    FieldWarehouse.decorators = [
        { type: core.Injectable }
    ];
    FieldWarehouse.ctorParameters = function () { return [
        { type: FieldReadModelArchive }
    ]; };

    var FilterWarehouse = /** @class */ (function () {
        function FilterWarehouse() {
        }
        return FilterWarehouse;
    }());
    FilterWarehouse.decorators = [
        { type: core.Injectable }
    ];
    FilterWarehouse.ctorParameters = function () { return []; };

    var FilterCommandInvoker = /** @class */ (function () {
        function FilterCommandInvoker() {
        }
        return FilterCommandInvoker;
    }());
    FilterCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    FilterCommandInvoker.ctorParameters = function () { return []; };

    var FilterMenuComponent = /** @class */ (function (_super) {
        __extends(FilterMenuComponent, _super);
        function FilterMenuComponent(changeDetectorRef, elementRef, structureId, compositionId, fieldWarehouse, filterWarehouse, filterCommandInvoker, compositionWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.structureId = structureId;
            _this.compositionId = compositionId;
            _this.fieldWarehouse = fieldWarehouse;
            _this.filterWarehouse = filterWarehouse;
            _this.filterCommandInvoker = filterCommandInvoker;
            _this.compositionWarehouse = compositionWarehouse;
            _this.columns = [];
            _this.fields = [];
            _this.activeFilters = [];
            _this.addClassToHost('gui-block');
            return _this;
        }
        FilterMenuComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.filterWarehouse.onActiveFilters(this.structureId), function (activeFilters) {
                _this.activeFilters = activeFilters;
            });
            this.subscribe(this.filterWarehouse.onFilterTypes(this.structureId), function (filterTypeMap) {
                _this.filterTypeMap = filterTypeMap;
            });
            this.subscribe(this.fieldWarehouse.onFields(this.structureId), function (fieldReadModels) {
                _this.fields = fieldReadModels;
            });
            this.subscribe(this.compositionWarehouse.onHeaderColumns(this.compositionId), function (columns) {
                _this.columns = columns;
            });
        };
        FilterMenuComponent.prototype.onFieldSelect = function (field) {
            this.selectedField = field;
            this.filterTypes = this.filterTypeMap.getFilterTypes(this.selectedField.getFieldId());
            this.reRender();
        };
        FilterMenuComponent.prototype.onFilterTypeSelect = function (filterTypeId) {
            this.selectedFilterTypeId = filterTypeId;
            this.reRender();
        };
        FilterMenuComponent.prototype.removeAllFilters = function () {
            this.filterCommandInvoker.removeAll(this.structureId);
        };
        FilterMenuComponent.prototype.onValueChanged = function (value) {
            this.selectedValue = value;
        };
        FilterMenuComponent.prototype.addFilter = function () {
            var fieldId = this.selectedField.getFieldId(), filterTypeId = this.selectedFilterTypeId, value = this.selectedValue;
            this.filterCommandInvoker.add(fieldId, filterTypeId, value, this.structureId);
            this.clearAddFilterForm();
        };
        FilterMenuComponent.prototype.onRemovedFilter = function (filterId) {
            event.preventDefault();
            this.filterCommandInvoker.remove(filterId, this.structureId);
        };
        FilterMenuComponent.prototype.removeFilter = function () { };
        FilterMenuComponent.prototype.clearAddFilterForm = function () {
            this.selectedColumn = null;
            this.selectedField = null;
            this.selectedFilterTypeId = null;
            this.selectedValue = null;
            this.reRender();
        };
        FilterMenuComponent.prototype.getSelectorName = function () {
            return 'gui-filter-menu';
        };
        return FilterMenuComponent;
    }(SmartComponent));
    FilterMenuComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-filter-menu]',
                    template: "<!--<div>-->\n<!--\t<div gui-active-filter-list></div>-->\n<!--</div>-->\n\n<!--\t\t<div>--><!--\t\t\t<div gui-column-selector--><!--\t\t\t\t\t[columns]=\"columns\"--><!--\t\t\t\t\t(columnSelected)\n=\"onColumnSelect($event)\">--><!--\t\t\t</div>-->\n\n<!--\t\t\t<ng-container *ngIf=\"selectedColumn\">--><!--\t\t\t\t{{selectedColumn.getFieldId()}}--><!--\t\t\t</ng-container>--><!--\t\t</div>-->\n\n<!--<div>-->\n<!--\t<div (fieldSelected)=\"onFieldSelect($event)\"-->\n<!--\t\t [fields]=\"fields\" gui-field-selector></div>-->\n\n<!--\t<ng-container *ngIf=\"selectedColumn\">-->\n<!--\t\t{{selectedColumn.getFieldId()}}-->\n<!--\t</ng-container>-->\n<!--</div>-->\n\n<!--<div>-->\n<!--\t<div (filterTypeSelected)=\"onFilterTypeSelect($event)\"-->\n<!--\t\t [filterTypes]=\"filterTypes\" gui-filter-type-selector></div>-->\n\n<!--\t<ng-container *ngIf=\"selectedFilterTypeId\">-->\n<!--\t\t{{selectedFilterTypeId.toString()}}-->\n<!--\t</ng-container>-->\n<!--</div>-->\n\n<!--<div>-->\n\n<!--\t<div (valueChanged)=\"onValueChanged($event)\" *ngIf=\"selectedFilterTypeId\" gui-filter-value></div>-->\n\n<!--</div>-->\n\n<h1>Filter menu</h1>\n\n\n<div gui-filter-menu-active-filters\n\t (removedFilter)=\"onRemovedFilter($event)\"\n\t [activeFilters]=\"activeFilters\">\n</div>\n\n<div class=\"gui-flex gui-flex-row gui-pb-12\">\n\n\t<div (fieldSelected)=\"onFieldSelect($event)\"\n\t\t [fields]=\"fields\"\n\t\t gui-field-selector>\n\t</div>\n\n\t<div (filterTypeSelected)=\"onFilterTypeSelect($event)\"\n\t\t [filterTypes]=\"filterTypes\"\n\t\t gui-filter-type-selector>\n\t</div>\n\n\t<div *ngIf=\"selectedFilterTypeId\"\n\t\t (valueChanged)=\"onValueChanged($event)\"\n\t\t gui-filter-value>\n\t</div>\n\n\t<button (click)=\"addFilter()\">Filter</button>\n\t<button (click)=\"removeFilter()\">Remove</button>\n\n</div>\n\n<br/>\n<br/>\n<br/>\n\n<button\n\t[primary]=\"true\" gui-button>\n\tAdd filter\n</button>\n\n<br/>\n<br/>\n<br/>\n\n<div class=\"gui-flex gui-flex-row gui-justify-between gui-pt-12\">\n\n\t<button (click)=\"removeAllFilters()\"\n\t\t\t[outline]=\"false\"\n\t\t\tgui-button>\n\t\tClear filters\n\t</button>\n\n\t<!--\t<div>-->\n\t<!--\t\t<button (click)=\"close()\"-->\n\t<!--\t\t\t\t[outline]=\"false\" gui-button>-->\n\t<!--\t\t\tCancel-->\n\t<!--\t\t</button>-->\n\t<!--\t</div>-->\n</div>\n\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    FilterMenuComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: CompositionId },
        { type: FieldWarehouse },
        { type: FilterWarehouse },
        { type: FilterCommandInvoker },
        { type: CompositionWarehouse }
    ]; };

    var FilterMenuTriggerComponent = /** @class */ (function (_super) {
        __extends(FilterMenuTriggerComponent, _super);
        function FilterMenuTriggerComponent(detector, elementRef, injector, drawerService, fabricDialogService, structureId, filterWarehouse, filterContainerRef) {
            var _this = _super.call(this, detector, elementRef) || this;
            _this.injector = injector;
            _this.drawerService = drawerService;
            _this.fabricDialogService = fabricDialogService;
            _this.structureId = structureId;
            _this.filterWarehouse = filterWarehouse;
            _this.filterContainerRef = filterContainerRef;
            _this.activeFiltersExist = false;
            return _this;
        }
        FilterMenuTriggerComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.filterWarehouse.onActiveFilters(this.structureId), function (activeFilters) {
                _this.activeFiltersExist = activeFilters.length > 0;
            });
        };
        FilterMenuTriggerComponent.prototype.openDrawer = function () {
            var elementRef = this.filterContainerRef.getElementRef();
            this.fabricDialogService.open(FilterMenuComponent, { injector: this.injector });
            // this.drawerService.open(elementRef, FilterMenuComponent, { injector: this.injector });
        };
        FilterMenuTriggerComponent.prototype.getSelectorName = function () {
            return 'gui-filter-menu-trigger';
        };
        return FilterMenuTriggerComponent;
    }(SmartComponent));
    FilterMenuTriggerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-filter-menu-trigger]',
                    template: "<div (click)=\"openDrawer()\"\n\t [gui-tooltip]=\"'Filters'\"\n\t class=\"gui-filter-icon-wrapper\">\n\n\t<div *ngIf=\"activeFiltersExist\" class=\"gui-filter-active\"></div>\n\n\t<div gui-filter-icon></div>\n</div>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    styles: [".gui-filter-icon-wrapper{margin-right:24px;position:relative;width:19px;height:19px}.gui-filter-active{position:absolute;top:-6px;left:-6px;border:2px solid #aaa!important;width:27px;height:27px;border-radius:50%}.gui-filter-menu{width:600px}.gui-filter-icon svg{height:16px;width:16px}.gui-filter-icon svg .cls-1{fill:none;stroke:#aaa;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;transition:stroke .3s ease-in-out}.gui-filter-icon:hover .cls-1{stroke:#464646}\n"]
                },] }
    ];
    FilterMenuTriggerComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: core.Injector },
        { type: fabric.FabricDrawerService },
        { type: fabric.FabricDialogService },
        { type: StructureId },
        { type: FilterWarehouse },
        { type: undefined, decorators: [{ type: core.Inject, args: [filterContainerToken,] }] }
    ]; };

    var ColumnSelectorComponent = /** @class */ (function (_super) {
        __extends(ColumnSelectorComponent, _super);
        function ColumnSelectorComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.columnSelected = new core.EventEmitter();
            return _this;
        }
        ColumnSelectorComponent.prototype.onSelectChange = function (column) {
            this.columnSelected.emit(column);
        };
        ColumnSelectorComponent.prototype.getSelectorName = function () {
            return 'gui-column-selector';
        };
        return ColumnSelectorComponent;
    }(PureComponent));
    ColumnSelectorComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-column-selector][columns]',
                    template: "\n\n\t\tColumn:\n\n\t\t<gui-dropdown>\n\t\t\t<gui-dropdown-item *ngFor=\"let column of columns\"\n\t\t\t\t\t\t\t   (click)=\"onSelectChange(column)\">\n\t\t\t\t<ng-container\n\t\t\t\t\t*ngTemplateOutlet=\"column.viewTemplate;\n\t\t\t\t\t\t   context: column.context\">\n\t\t\t\t</ng-container>\n\t\t\t</gui-dropdown-item>\n\t\t</gui-dropdown>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    ColumnSelectorComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    ColumnSelectorComponent.propDecorators = {
        columns: [{ type: core.Input }],
        columnSelected: [{ type: core.Output }]
    };

    var FilterTypeSelectorComponent = /** @class */ (function (_super) {
        __extends(FilterTypeSelectorComponent, _super);
        function FilterTypeSelectorComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.filterTypeSelected = new core.EventEmitter();
            _this.filterTypesAsOptions = [];
            _this.disabled = true;
            return _this;
        }
        FilterTypeSelectorComponent.prototype.ngOnChanges = function (changes) {
            var _this = this;
            this.ifChanged(changes.filterTypes, function () {
                _this.filterTypesAsOptions = _this.filterTypes.map(function (filter) {
                    return {
                        name: filter.getId().toString(),
                        value: filter.getName()
                    };
                });
                _this.disabled = _this.filterTypesAsOptions.length === 0;
            });
        };
        FilterTypeSelectorComponent.prototype.onSelectChange = function (option) {
            var filterType = this.filterTypes.find(function (filterType) {
                return filterType.getId().toString() === option.name;
            });
            this.filterTypeSelected.emit(filterType.getId());
        };
        FilterTypeSelectorComponent.prototype.getSelectorName = function () {
            return 'gui-filter-type-selector';
        };
        return FilterTypeSelectorComponent;
    }(PureComponent));
    FilterTypeSelectorComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-filter-type-selector][filterTypes]',
                    template: "<gui-select (optionChanged)=\"onSelectChange($event)\"\n\t\t\t[options]=\"filterTypesAsOptions\"\n\t\t\t[disabled]=\"disabled\"\n\t\t\t[placeholder]=\"'Select filter type'\">\n</gui-select>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    FilterTypeSelectorComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    FilterTypeSelectorComponent.propDecorators = {
        filterTypes: [{ type: core.Input }],
        filterTypeSelected: [{ type: core.Output }]
    };

    var FilterValueComponent = /** @class */ (function (_super) {
        __extends(FilterValueComponent, _super);
        function FilterValueComponent(detector, elementRef, formBuilder) {
            var _this = _super.call(this, detector, elementRef) || this;
            _this.formBuilder = formBuilder;
            _this.valueChanged = new core.EventEmitter();
            var controlsConfig = {};
            controlsConfig[FilterValueComponent.FORM_FILTER_VALUE] = '';
            _this.filterForm = _this.formBuilder.group(controlsConfig);
            return _this;
        }
        FilterValueComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.filterForm
                .controls[FilterValueComponent.FORM_FILTER_VALUE]
                .valueChanges
                // .pipe(
                // 	this.takeUntil()
                // )
                .subscribe(function (value) {
                _this.valueChanged.emit(value);
            });
        };
        FilterValueComponent.prototype.getSelectorName = function () {
            return 'gui-filter-value';
        };
        return FilterValueComponent;
    }(SmartComponent));
    FilterValueComponent.FORM_FILTER_VALUE = 'filterValue';
    FilterValueComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-filter-value]',
                    template: "<form #formRef\n\t  [formGroup]=\"filterForm\">\n\n\t<input formControlName=\"filterValue\"/>\n</form>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    FilterValueComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: forms.FormBuilder }
    ]; };
    FilterValueComponent.propDecorators = {
        formRef: [{ type: core.ViewChild, args: ['formRef', { static: false },] }],
        valueChanged: [{ type: core.Output }]
    };

    var FieldSelectorComponent = /** @class */ (function (_super) {
        __extends(FieldSelectorComponent, _super);
        function FieldSelectorComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.fieldSelected = new core.EventEmitter();
            return _this;
        }
        FieldSelectorComponent.prototype.ngOnChanges = function (changes) {
            var _this = this;
            ifChanged(changes.fields, function () {
                _this.fieldsAsOptions = _this.fields.map(function (field) {
                    return {
                        name: field.getFieldId().toString(),
                        value: field.getName()
                    };
                });
            });
        };
        FieldSelectorComponent.prototype.onFieldSelected = function (fieldId) {
            var field = this.fields.find(function (field) { return field.getFieldId().toString() === fieldId.name; });
            this.fieldSelected.emit(field);
        };
        FieldSelectorComponent.prototype.getSelectorName = function () {
            return 'gui-field-selector';
        };
        return FieldSelectorComponent;
    }(PureComponent));
    FieldSelectorComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-field-selector][fields]',
                    template: "\n\t\t<gui-select (optionChanged)=\"onFieldSelected($event)\"\n\t\t\t\t\t[options]=\"fieldsAsOptions\"\n\t\t\t\t\t[placeholder]=\"'Select column'\">\n\t\t</gui-select>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    FieldSelectorComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    FieldSelectorComponent.propDecorators = {
        fields: [{ type: core.Input }],
        fieldSelected: [{ type: core.Output }]
    };

    var ToggleFilterCommand = /** @class */ (function (_super) {
        __extends(ToggleFilterCommand, _super);
        function ToggleFilterCommand(structureId, fieldId, externalFilterId, filterValue) {
            var _this = _super.call(this, structureId, 'ToggleFilterCommand') || this;
            _this.fieldId = fieldId;
            _this.externalFilterId = externalFilterId;
            _this.filterValue = filterValue;
            return _this;
        }
        ToggleFilterCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        ToggleFilterCommand.prototype.getExternalFilterId = function () {
            return this.externalFilterId;
        };
        ToggleFilterCommand.prototype.getFilterValue = function () {
            return this.filterValue;
        };
        return ToggleFilterCommand;
    }(StructureCommand));

    var FilterToggledEvent = /** @class */ (function (_super) {
        __extends(FilterToggledEvent, _super);
        function FilterToggledEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'FilterToggledEvent') || this;
        }
        return FilterToggledEvent;
    }(StructureDomainEvent));

    var ToggleFilterCommandHandler = /** @class */ (function () {
        function ToggleFilterCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        ToggleFilterCommandHandler.prototype.forCommand = function () {
            return ToggleFilterCommand;
        };
        ToggleFilterCommandHandler.prototype.handle = function (aggregate, command) {
            var fieldId = command.getFieldId(), externalFieldId = command.getExternalFilterId(), filterValue = command.getFilterValue();
            aggregate.toggleFilter(fieldId, externalFieldId, filterValue);
        };
        ToggleFilterCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new FilterToggledEvent(command.getAggregateId()));
        };
        return ToggleFilterCommandHandler;
    }());
    ToggleFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    ToggleFilterCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var AddFilterCommand = /** @class */ (function (_super) {
        __extends(AddFilterCommand, _super);
        function AddFilterCommand(structureId, fieldId, filterTypeId, value) {
            var _this = _super.call(this, structureId, 'AddFilterCommand') || this;
            _this.fieldId = fieldId;
            _this.filterTypeId = filterTypeId;
            _this.value = value;
            return _this;
        }
        AddFilterCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        AddFilterCommand.prototype.getFilterTypeId = function () {
            return this.filterTypeId;
        };
        AddFilterCommand.prototype.getValue = function () {
            return this.value;
        };
        return AddFilterCommand;
    }(StructureCommand));

    var AddFilterCommandHandler = /** @class */ (function () {
        function AddFilterCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        AddFilterCommandHandler.prototype.forCommand = function () {
            return AddFilterCommand;
        };
        AddFilterCommandHandler.prototype.handle = function (structure, command) {
            var fieldId = command.getFieldId(), filterTypeId = command.getFilterTypeId(), value = command.getValue();
            structure.addFilter(fieldId, filterTypeId, value);
        };
        AddFilterCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return AddFilterCommandHandler;
    }());
    AddFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    AddFilterCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var RemoveAllFiltersCommand = /** @class */ (function (_super) {
        __extends(RemoveAllFiltersCommand, _super);
        function RemoveAllFiltersCommand(structureId) {
            return _super.call(this, structureId, 'RemoveAllFiltersCommand') || this;
        }
        return RemoveAllFiltersCommand;
    }(StructureCommand));

    var RemoveAllFiltersCommandHandler = /** @class */ (function () {
        function RemoveAllFiltersCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        RemoveAllFiltersCommandHandler.prototype.forCommand = function () {
            return RemoveAllFiltersCommand;
        };
        RemoveAllFiltersCommandHandler.prototype.handle = function (structure, command) {
            structure.removeAllFilters();
        };
        RemoveAllFiltersCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return RemoveAllFiltersCommandHandler;
    }());
    RemoveAllFiltersCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    RemoveAllFiltersCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var RemoveFilterCommand = /** @class */ (function (_super) {
        __extends(RemoveFilterCommand, _super);
        function RemoveFilterCommand(structureId, filterId) {
            var _this = _super.call(this, structureId, 'RemoveFilterCommand') || this;
            _this.filterId = filterId;
            return _this;
        }
        RemoveFilterCommand.prototype.getFilterId = function () {
            return this.filterId;
        };
        return RemoveFilterCommand;
    }(StructureCommand));

    var RemoveFilterCommandHandler = /** @class */ (function () {
        function RemoveFilterCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        RemoveFilterCommandHandler.prototype.forCommand = function () {
            return RemoveFilterCommand;
        };
        RemoveFilterCommandHandler.prototype.handle = function (structure, command) {
            var filterId = command.getFilterId();
            structure.removeFilter(filterId);
        };
        RemoveFilterCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return RemoveFilterCommandHandler;
    }());
    RemoveFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    RemoveFilterCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetConfigFilterCommand = /** @class */ (function (_super) {
        __extends(SetConfigFilterCommand, _super);
        function SetConfigFilterCommand(structureId, filterConfig) {
            var _this = _super.call(this, structureId, 'SetConfigFilterCommand') || this;
            _this.filterConfig = filterConfig;
            return _this;
        }
        SetConfigFilterCommand.prototype.getConfig = function () {
            return this.filterConfig;
        };
        return SetConfigFilterCommand;
    }(StructureCommand));

    var ConfigFilterSetEvent = /** @class */ (function (_super) {
        __extends(ConfigFilterSetEvent, _super);
        function ConfigFilterSetEvent(aggregateId, enabled) {
            var _this = _super.call(this, aggregateId, enabled, 'ConfigFilterSetEvent') || this;
            _this.enabled = enabled;
            return _this;
        }
        ConfigFilterSetEvent.prototype.getEnabled = function () {
            return this.enabled;
        };
        return ConfigFilterSetEvent;
    }(StructureDomainEvent));

    var SetConfigFilterCommandHandler = /** @class */ (function () {
        function SetConfigFilterCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetConfigFilterCommandHandler.prototype.forCommand = function () {
            return SetConfigFilterCommand;
        };
        SetConfigFilterCommandHandler.prototype.handle = function (aggregate, command) {
            var filterConfig = command.getConfig();
            aggregate.setFilterConfig(filterConfig);
        };
        SetConfigFilterCommandHandler.prototype.publish = function (aggregate, command) {
            var filterConfig = command.getConfig();
            this.domainEventPublisher.publish(new ConfigFilterSetEvent(command.getAggregateId(), filterConfig.enabled));
        };
        return SetConfigFilterCommandHandler;
    }());
    SetConfigFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetConfigFilterCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetConfigQuickFilterCommand = /** @class */ (function (_super) {
        __extends(SetConfigQuickFilterCommand, _super);
        function SetConfigQuickFilterCommand(structureId, quickFiltersConfig) {
            var _this = _super.call(this, structureId, 'SetConfigQuickFilterCommand') || this;
            _this.quickFiltersConfig = quickFiltersConfig;
            return _this;
        }
        SetConfigQuickFilterCommand.prototype.getConfig = function () {
            return this.quickFiltersConfig;
        };
        return SetConfigQuickFilterCommand;
    }(StructureCommand));

    var ConfigQuickFilterSetEvent = /** @class */ (function (_super) {
        __extends(ConfigQuickFilterSetEvent, _super);
        function ConfigQuickFilterSetEvent(aggregateId, enabled) {
            var _this = _super.call(this, aggregateId, enabled, 'ConfigQuickFilterSetEvent') || this;
            _this.enabled = enabled;
            return _this;
        }
        ConfigQuickFilterSetEvent.prototype.getEnabled = function () {
            return this.enabled;
        };
        return ConfigQuickFilterSetEvent;
    }(StructureDomainEvent));

    var SetConfigQuickFilterCommandHandler = /** @class */ (function () {
        function SetConfigQuickFilterCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        SetConfigQuickFilterCommandHandler.prototype.forCommand = function () {
            return SetConfigQuickFilterCommand;
        };
        SetConfigQuickFilterCommandHandler.prototype.handle = function (aggregate, command) {
            var quickFiltersConfig = command.getConfig();
            aggregate.setQuickFiltersConfig(quickFiltersConfig);
        };
        SetConfigQuickFilterCommandHandler.prototype.publish = function (aggregate, command) {
            var structureId = command.getAggregateId(), quickFiltersConfig = command.getConfig();
            this.domainEventPublisher.publish(new ConfigQuickFilterSetEvent(structureId, quickFiltersConfig.enabled));
        };
        return SetConfigQuickFilterCommandHandler;
    }());
    SetConfigQuickFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetConfigQuickFilterCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var Filter = /** @class */ (function () {
        function Filter(filterId, fieldId, filterTypeId, filterValue) {
            this.filterId = filterId;
            this.fieldId = fieldId;
            this.filterTypeId = filterTypeId;
            this.filterValue = filterValue;
        }
        Filter.prototype.getFilterId = function () {
            return this.filterId;
        };
        Filter.prototype.getFilterTypeId = function () {
            return this.filterTypeId;
        };
        Filter.prototype.getFieldId = function () {
            return this.fieldId;
        };
        Filter.prototype.getFilterValue = function () {
            return this.filterValue;
        };
        return Filter;
    }());

    var FilterSettings = /** @class */ (function () {
        function FilterSettings(filteringEnabled, searchEnabled, quickFiltersEnabled) {
            if (filteringEnabled === void 0) { filteringEnabled = false; }
            if (searchEnabled === void 0) { searchEnabled = false; }
            if (quickFiltersEnabled === void 0) { quickFiltersEnabled = false; }
            this.filteringEnabled = false;
            this.searchEnabled = false;
            this.quickFiltersEnabled = false;
            this.filteringEnabled = filteringEnabled;
            this.searchEnabled = searchEnabled;
            this.quickFiltersEnabled = quickFiltersEnabled;
        }
        FilterSettings.prototype.isFilteringEnabled = function () {
            return this.filteringEnabled;
        };
        FilterSettings.prototype.isQuickFilteringEnabled = function () {
            return this.quickFiltersEnabled;
        };
        FilterSettings.prototype.isSearchingEnabled = function () {
            return this.searchEnabled;
        };
        FilterSettings.prototype.setFilterConfig = function (config) {
            if (config && config.enabled !== undefined && config.enabled !== null) {
                this.filteringEnabled = config.enabled;
            }
        };
        FilterSettings.prototype.setSearchingConfig = function (config) {
            if (config && config.enabled !== undefined && config.enabled !== null) {
                this.searchEnabled = config.enabled;
            }
        };
        FilterSettings.prototype.setQuickFiltersConfig = function (config) {
            if (config && config.enabled !== undefined && config.enabled !== null) {
                this.quickFiltersEnabled = config.enabled;
            }
        };
        return FilterSettings;
    }());

    var BaseFilterType = /** @class */ (function () {
        function BaseFilterType(filterTypeId) {
            this.filterTypeId = filterTypeId;
        }
        BaseFilterType.prototype.getId = function () {
            return this.filterTypeId;
        };
        BaseFilterType.prototype.filterMany = function (entities, field, value) {
            var _this = this;
            if (entities.length === 0) {
                return entities;
            }
            return entities.filter(function (item) {
                return _this.filterEntity(item, field, value);
            });
        };
        BaseFilterType.prototype.filterOne = function (entity, field, value) {
            return this.filterEntity(entity, field, value);
        };
        return BaseFilterType;
    }());

    var ContainsFilterType = /** @class */ (function (_super) {
        __extends(ContainsFilterType, _super);
        function ContainsFilterType(filterTypeId) {
            return _super.call(this, filterTypeId) || this;
        }
        ContainsFilterType.prototype.getName = function () {
            return 'Contains';
        };
        ContainsFilterType.prototype.filterEntity = function (entity, field, value) {
            var fieldValue = field.getValue(entity);
            return !!fieldValue.includes(value);
        };
        return ContainsFilterType;
    }(BaseFilterType));

    var FilterTypeId = /** @class */ (function () {
        function FilterTypeId(id) {
            this.id = id;
        }
        FilterTypeId.prototype.toString = function () {
            return this.id;
        };
        return FilterTypeId;
    }());

    var FilterTypeIdGenerator = /** @class */ (function () {
        function FilterTypeIdGenerator() {
        }
        FilterTypeIdGenerator.prototype.generate = function () {
            FilterTypeIdGenerator.index += 1;
            return new FilterTypeId("" + FilterTypeIdGenerator.index);
        };
        return FilterTypeIdGenerator;
    }());
    FilterTypeIdGenerator.index = 0;

    var FilterTypeReadModel = /** @class */ (function () {
        function FilterTypeReadModel(id, name) {
            this.filterTypeId = id;
            this.name = name;
        }
        FilterTypeReadModel.prototype.getId = function () {
            return this.filterTypeId;
        };
        FilterTypeReadModel.prototype.getName = function () {
            return this.name;
        };
        return FilterTypeReadModel;
    }());

    var FilterTypeManager = /** @class */ (function () {
        function FilterTypeManager(fields) {
            this.fieldIds = [];
            this.map = new WeakMap();
            this.filterTypeMap = new WeakMap();
            this.dataTypeToFilterType = new Map();
            this.filterTypeIdGenerator = new FilterTypeIdGenerator();
            this.assignFilterTypes();
            this.addFields(fields);
        }
        FilterTypeManager.prototype.getFilterType = function (filterTypeId) {
            return this.filterTypeMap.get(filterTypeId);
        };
        FilterTypeManager.prototype.getFieldIdsToFilterTypes = function () {
            var e_1, _a;
            var map = new Map();
            try {
                for (var _b = __values(this.fieldIds), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var fieldId = _c.value;
                    var filterTypes = this.map.get(fieldId), readModels = filterTypes.map(function (f) {
                        return new FilterTypeReadModel(f.getId(), f.getName());
                    });
                    map.set(fieldId.toString(), readModels);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return map;
        };
        FilterTypeManager.prototype.addFields = function (fields) {
            var e_2, _a;
            try {
                for (var fields_1 = __values(fields), fields_1_1 = fields_1.next(); !fields_1_1.done; fields_1_1 = fields_1.next()) {
                    var field = fields_1_1.value;
                    this.addField(field);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (fields_1_1 && !fields_1_1.done && (_a = fields_1.return)) _a.call(fields_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        };
        FilterTypeManager.prototype.addField = function (field) {
            var fieldId = field.getId(), dataType = field.getDataType();
            var filterTypesFromDataType = this.dataTypeToFilterType.get(dataType);
            this.fieldIds.push(fieldId);
            this.map.set(fieldId, Array.from(filterTypesFromDataType));
        };
        FilterTypeManager.prototype.assignFilterTypes = function () {
            this.assignFilterTypesForDataTypeUnknown();
            this.assignFilterTypesForDataTypeNumber();
            this.assignFilterTypesForDataTypeString();
            this.assignFilterTypesForDataTypeBoolean();
            this.assignFilterTypesForDataTypeDate();
            this.assignFilterTypesForDataTypeCustom();
        };
        FilterTypeManager.prototype.assignFilterTypesForDataTypeUnknown = function () {
            this.dataTypeToFilterType.set(DataType.UNKNOWN, []);
        };
        FilterTypeManager.prototype.assignFilterTypesForDataTypeNumber = function () {
            this.dataTypeToFilterType.set(DataType.NUMBER, []);
        };
        FilterTypeManager.prototype.assignFilterTypesForDataTypeString = function () {
            var filterTypes = [
                new ContainsFilterType(this.generateId())
            ];
            this.dataTypeToFilterType.set(DataType.STRING, filterTypes);
            this.addFilterTypes(filterTypes);
        };
        FilterTypeManager.prototype.assignFilterTypesForDataTypeBoolean = function () {
            this.dataTypeToFilterType.set(DataType.BOOLEAN, []);
        };
        FilterTypeManager.prototype.assignFilterTypesForDataTypeDate = function () {
            this.dataTypeToFilterType.set(DataType.DATE, []);
        };
        FilterTypeManager.prototype.assignFilterTypesForDataTypeCustom = function () {
            this.dataTypeToFilterType.set(DataType.CUSTOM, []);
        };
        FilterTypeManager.prototype.generateId = function () {
            return this.filterTypeIdGenerator.generate();
        };
        FilterTypeManager.prototype.addFilterTypes = function (filterTypes) {
            var e_3, _a;
            try {
                for (var filterTypes_1 = __values(filterTypes), filterTypes_1_1 = filterTypes_1.next(); !filterTypes_1_1.done; filterTypes_1_1 = filterTypes_1.next()) {
                    var filterType = filterTypes_1_1.value;
                    this.filterTypeMap.set(filterType.getId(), filterType);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (filterTypes_1_1 && !filterTypes_1_1.done && (_a = filterTypes_1.return)) _a.call(filterTypes_1);
                }
                finally { if (e_3) throw e_3.error; }
            }
        };
        return FilterTypeManager;
    }());

    var FilterId = /** @class */ (function () {
        function FilterId(filterId) {
            this.id = filterId;
        }
        FilterId.prototype.toString = function () {
            return this.id;
        };
        return FilterId;
    }());

    var FilterIdGenerator = /** @class */ (function () {
        function FilterIdGenerator() {
        }
        FilterIdGenerator.generateId = function () {
            return new FilterId("" + FilterIdGenerator.index);
        };
        return FilterIdGenerator;
    }());
    FilterIdGenerator.index = 0;

    var ActiveFilterReadModel = /** @class */ (function () {
        function ActiveFilterReadModel(filterId, fieldName, filterTypeName, value) {
            this.filterId = filterId;
            this.fieldName = fieldName;
            this.filterTypeName = filterTypeName;
            this.value = value;
        }
        ActiveFilterReadModel.prototype.getText = function () {
            return this.fieldName + ": " + this.filterTypeName + ": " + this.value;
        };
        ActiveFilterReadModel.prototype.getFilterId = function () {
            return this.filterId;
        };
        ActiveFilterReadModel.prototype.getFieldName = function () {
            return this.fieldName;
        };
        ActiveFilterReadModel.prototype.getFilterTypeName = function () {
            return this.filterTypeName;
        };
        ActiveFilterReadModel.prototype.getValue = function () {
            return this.value;
        };
        return ActiveFilterReadModel;
    }());

    var FilterManager = /** @class */ (function () {
        function FilterManager() {
            this.filterSettings = new FilterSettings();
            // string -> FilterId
            this.filters = new Map();
            this.activeFilters = [];
        }
        FilterManager.prototype.getSettings = function () {
            return this.filterSettings;
        };
        FilterManager.prototype.getAll = function () {
            return Array.from(this.filters)
                .map(function (arr) { return arr[1]; });
        };
        FilterManager.prototype.getAllActiveFilters = function (fields) {
            var _this = this;
            return this.activeFilters
                .map(function (af) {
                return new ActiveFilterReadModel(af.getFilterId(), (fields.get(af.getFieldId().toString())).getName(), _this.filterTypeManager.getFilterType(af.getFilterTypeId()).getName(), af.getFilterValue());
            });
        };
        FilterManager.prototype.getFilterTypes = function () {
            return this.filterTypeManager.getFieldIdsToFilterTypes();
        };
        FilterManager.prototype.assignFilterTypes = function (fields) {
            this.filterTypeManager = new FilterTypeManager(fields);
        };
        FilterManager.prototype.add = function (fieldId, filterTypeId, value) {
            var filter = new Filter(FilterIdGenerator.generateId(), fieldId, filterTypeId, value);
            this.activeFilters.push(filter);
        };
        FilterManager.prototype.filter = function (entities, fields) {
            var e_1, _a;
            var filteredEntities = Array.from(entities);
            try {
                for (var _b = __values(this.activeFilters), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var filter = _c.value;
                    var filterTypeId = filter.getFilterTypeId(), filterType = this.getFilterType(filterTypeId), value = filter.getFilterValue();
                    filteredEntities = filterType.filterMany(filteredEntities, fields.get(filter.getFieldId().toString()), value);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return filteredEntities;
        };
        FilterManager.prototype.removeAll = function () {
            this.activeFilters.length = 0;
        };
        FilterManager.prototype.remove = function (filterId) {
            this.activeFilters =
                this.activeFilters.filter(function (filter) {
                    return filter.getFilterId() !== filterId;
                });
        };
        FilterManager.prototype.getFilterType = function (filterTypeId) {
            return this.filterTypeManager.getFilterType(filterTypeId);
        };
        return FilterManager;
    }());

    var FilterManagerFactory = /** @class */ (function () {
        function FilterManagerFactory() {
        }
        FilterManagerFactory.prototype.create = function (enabled) {
            if (enabled === void 0) { enabled = false; }
            return new FilterManager();
        };
        return FilterManagerFactory;
    }());
    FilterManagerFactory.decorators = [
        { type: core.Injectable }
    ];

    var QuickFilterEnabledArchive = /** @class */ (function (_super) {
        __extends(QuickFilterEnabledArchive, _super);
        function QuickFilterEnabledArchive() {
            return _super.call(this, QuickFilterEnabledArchive.default) || this;
        }
        return QuickFilterEnabledArchive;
    }(hermes.AggregateArchive));
    QuickFilterEnabledArchive.default = false;
    QuickFilterEnabledArchive.decorators = [
        { type: core.Injectable }
    ];
    QuickFilterEnabledArchive.ctorParameters = function () { return []; };

    var ConfigQuickFilterSetEventHandler = /** @class */ (function () {
        function ConfigQuickFilterSetEventHandler(structureQuickFilterRepository) {
            this.structureQuickFilterRepository = structureQuickFilterRepository;
        }
        ConfigQuickFilterSetEventHandler.prototype.forEvent = function () {
            return ConfigQuickFilterSetEvent;
        };
        ConfigQuickFilterSetEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('ConfigQuickFilterSetEvent')) {
                this.structureQuickFilterRepository.next(event.getAggregateId(), event.getEnabled());
            }
        };
        return ConfigQuickFilterSetEventHandler;
    }());
    ConfigQuickFilterSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    ConfigQuickFilterSetEventHandler.ctorParameters = function () { return [
        { type: QuickFilterEnabledArchive }
    ]; };

    var FilterEnabledArchive = /** @class */ (function (_super) {
        __extends(FilterEnabledArchive, _super);
        function FilterEnabledArchive() {
            return _super.call(this, FilterEnabledArchive.default) || this;
        }
        return FilterEnabledArchive;
    }(hermes.AggregateArchive));
    FilterEnabledArchive.default = false;
    FilterEnabledArchive.decorators = [
        { type: core.Injectable }
    ];
    FilterEnabledArchive.ctorParameters = function () { return []; };

    var ConfigFilterSetEventHandler = /** @class */ (function () {
        function ConfigFilterSetEventHandler(structureFilterRepository) {
            this.structureFilterRepository = structureFilterRepository;
        }
        ConfigFilterSetEventHandler.prototype.forEvent = function () {
            return ConfigFilterSetEvent;
        };
        ConfigFilterSetEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('ConfigFilterSetEvent')) {
                this.structureFilterRepository.next(event.getAggregateId(), event.getEnabled());
            }
        };
        return ConfigFilterSetEventHandler;
    }());
    ConfigFilterSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    ConfigFilterSetEventHandler.ctorParameters = function () { return [
        { type: FilterEnabledArchive }
    ]; };

    var FilterTypeMap = /** @class */ (function () {
        function FilterTypeMap(map) {
            this.map = map;
        }
        FilterTypeMap.prototype.getFilterTypes = function (fieldId) {
            return this.map.get(fieldId.toString());
        };
        return FilterTypeMap;
    }());

    var FilterTypeArchive = /** @class */ (function (_super) {
        __extends(FilterTypeArchive, _super);
        function FilterTypeArchive() {
            return _super.call(this, FilterTypeArchive.default) || this;
        }
        return FilterTypeArchive;
    }(hermes.AggregateArchive));
    FilterTypeArchive.default = new FilterTypeMap(new Map());
    FilterTypeArchive.decorators = [
        { type: core.Injectable }
    ];
    FilterTypeArchive.ctorParameters = function () { return []; };

    var FilterTypesInitedEvent = /** @class */ (function (_super) {
        __extends(FilterTypesInitedEvent, _super);
        function FilterTypesInitedEvent(aggregateId, map) {
            var _this = _super.call(this, aggregateId, map, 'FilterTypesInitedEvent') || this;
            _this.map = map;
            return _this;
        }
        FilterTypesInitedEvent.prototype.getMap = function () {
            return this.map;
        };
        return FilterTypesInitedEvent;
    }(StructureDomainEvent));

    var FilterTypeConfigFilterSetEventHandler = /** @class */ (function () {
        function FilterTypeConfigFilterSetEventHandler(filterTypeArchive) {
            this.filterTypeArchive = filterTypeArchive;
        }
        FilterTypeConfigFilterSetEventHandler.prototype.forEvent = function () {
            return FilterTypesInitedEvent;
        };
        FilterTypeConfigFilterSetEventHandler.prototype.handle = function (filterTypesInitedEvent) {
            if (filterTypesInitedEvent.ofMessageType('FilterTypesInitedEvent')) {
                var map = filterTypesInitedEvent.getMap();
                this.filterTypeArchive.next(filterTypesInitedEvent.getAggregateId(), new FilterTypeMap(map));
            }
        };
        return FilterTypeConfigFilterSetEventHandler;
    }());
    FilterTypeConfigFilterSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    FilterTypeConfigFilterSetEventHandler.ctorParameters = function () { return [
        { type: FilterTypeArchive }
    ]; };

    var ActiveFiltersSetEvent = /** @class */ (function (_super) {
        __extends(ActiveFiltersSetEvent, _super);
        function ActiveFiltersSetEvent(structureId, filters) {
            var _this = _super.call(this, structureId, filters, 'ActiveFiltersSetEvent') || this;
            _this.filters = filters;
            return _this;
        }
        ActiveFiltersSetEvent.prototype.getFilters = function () {
            return this.filters;
        };
        return ActiveFiltersSetEvent;
    }(StructureDomainEvent));

    var ActiveFilterArchive = /** @class */ (function (_super) {
        __extends(ActiveFilterArchive, _super);
        function ActiveFilterArchive() {
            return _super.call(this, ActiveFilterArchive.default) || this;
        }
        return ActiveFilterArchive;
    }(hermes.AggregateArchive));
    ActiveFilterArchive.default = [];
    ActiveFilterArchive.decorators = [
        { type: core.Injectable }
    ];
    ActiveFilterArchive.ctorParameters = function () { return []; };

    var ActiveFiltersSetEventHandler = /** @class */ (function () {
        function ActiveFiltersSetEventHandler(activeFilterRepository) {
            this.activeFilterRepository = activeFilterRepository;
        }
        ActiveFiltersSetEventHandler.prototype.forEvent = function () {
            return ActiveFiltersSetEvent;
        };
        ActiveFiltersSetEventHandler.prototype.handle = function (activeFiltersSetEvent) {
            if (activeFiltersSetEvent.ofMessageType('ActiveFiltersSetEvent')) {
                var activeFilters = activeFiltersSetEvent.getFilters();
                this.activeFilterRepository.next(activeFiltersSetEvent.getAggregateId(), activeFilters);
            }
        };
        return ActiveFiltersSetEventHandler;
    }());
    ActiveFiltersSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    ActiveFiltersSetEventHandler.ctorParameters = function () { return [
        { type: ActiveFilterArchive }
    ]; };

    var UniqueFilterCalculatedEvent = /** @class */ (function (_super) {
        __extends(UniqueFilterCalculatedEvent, _super);
        function UniqueFilterCalculatedEvent(aggregateId, map) {
            var _this = _super.call(this, aggregateId, map, 'UniqueFilterCalculatedEvent') || this;
            _this.map = map;
            return _this;
        }
        UniqueFilterCalculatedEvent.prototype.getUniqueValues = function () {
            return this.map;
        };
        return UniqueFilterCalculatedEvent;
    }(StructureDomainEvent));

    var UniqueValuesReadModel = /** @class */ (function () {
        function UniqueValuesReadModel(map) {
            this.map = new Map();
            this.allSelected = new Map();
            this.allDisabled = new Map();
            this.map = map;
            this.calculateSelection();
        }
        UniqueValuesReadModel.prototype.getValues = function (fieldId) {
            return this.map.get(fieldId.toString());
        };
        UniqueValuesReadModel.prototype.areAllSelected = function (fieldId) {
            return this.allSelected.get(fieldId.toString());
        };
        UniqueValuesReadModel.prototype.areAllDisabled = function (fieldId) {
            return this.allDisabled.get(fieldId.toString());
        };
        UniqueValuesReadModel.prototype.isSelectAllChecked = function (fieldId) {
            return this.areAllSelected(fieldId);
        };
        UniqueValuesReadModel.prototype.isIndeterminate = function (fieldId) {
            return !(this.areAllSelected(fieldId) || this.areAllDisabled(fieldId));
        };
        UniqueValuesReadModel.prototype.calculateSelection = function () {
            var e_1, _a;
            try {
                for (var _b = __values(Array.from(this.map.keys())), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var key = _c.value;
                    var values = this.map.get(key);
                    this.allSelected.set(key, !values.some(function (r) { return !r.isEnabled(); }));
                    this.allDisabled.set(key, !values.some(function (r) { return r.isEnabled(); }));
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        };
        return UniqueValuesReadModel;
    }());

    var UniqueValuesArchive = /** @class */ (function (_super) {
        __extends(UniqueValuesArchive, _super);
        function UniqueValuesArchive() {
            return _super.call(this, UniqueValuesArchive.default) || this;
        }
        return UniqueValuesArchive;
    }(hermes.AggregateArchive));
    UniqueValuesArchive.default = new UniqueValuesReadModel(new Map());
    UniqueValuesArchive.decorators = [
        { type: core.Injectable }
    ];
    UniqueValuesArchive.ctorParameters = function () { return []; };

    var UniqueValueReadModel = /** @class */ (function () {
        function UniqueValueReadModel(id, value, enabled) {
            this.id = id;
            this.value = value;
            this.enabled = enabled;
        }
        UniqueValueReadModel.prototype.getId = function () {
            return this.id;
        };
        UniqueValueReadModel.prototype.getValue = function () {
            return this.value;
        };
        UniqueValueReadModel.prototype.geDisplayValue = function () {
            return this.displayValue;
        };
        UniqueValueReadModel.prototype.isEnabled = function () {
            return this.enabled;
        };
        return UniqueValueReadModel;
    }());

    var UniqueFilterCalculatedEventHandler = /** @class */ (function () {
        function UniqueFilterCalculatedEventHandler(uniqueValuesRepository) {
            this.uniqueValuesRepository = uniqueValuesRepository;
        }
        UniqueFilterCalculatedEventHandler.prototype.forEvent = function () {
            return UniqueFilterCalculatedEvent;
        };
        UniqueFilterCalculatedEventHandler.prototype.handle = function (calculatedEvent) {
            if (calculatedEvent.ofMessageType('UniqueFilterCalculatedEvent')) {
                var uvRM_1 = new Map();
                calculatedEvent.getUniqueValues()
                    .forEach(function (values, key) {
                    var valuesRM = values.map(function (uv) {
                        return new UniqueValueReadModel(uv.getId(), uv.getDisplayValue(), uv.isEnabled());
                    });
                    uvRM_1.set(key, valuesRM);
                });
                var uniqueValues = new UniqueValuesReadModel(uvRM_1);
                this.uniqueValuesRepository.next(calculatedEvent.getAggregateId(), uniqueValues);
            }
        };
        return UniqueFilterCalculatedEventHandler;
    }());
    UniqueFilterCalculatedEventHandler.decorators = [
        { type: core.Injectable }
    ];
    UniqueFilterCalculatedEventHandler.ctorParameters = function () { return [
        { type: UniqueValuesArchive }
    ]; };

    var FieldsInitedEvent = /** @class */ (function (_super) {
        __extends(FieldsInitedEvent, _super);
        function FieldsInitedEvent(aggregateId, fieldConfigs, // TODO merge
        fields) {
            var _this = _super.call(this, aggregateId, { fieldConfigs: fieldConfigs, fields: fields }, 'FieldsInitedEvent') || this;
            _this.fieldConfigs = fieldConfigs;
            _this.fields = fields;
            return _this;
        }
        FieldsInitedEvent.prototype.getFields = function () {
            return this.fields;
        };
        return FieldsInitedEvent;
    }(StructureDomainEvent));

    // TODO Remove
    var FilterTypeFieldsInitedEventHandler = /** @class */ (function () {
        function FilterTypeFieldsInitedEventHandler() {
        }
        // constructor(private readonly filterTypeManagerRepository: FilterTypeManagerRepository,
        // 			private readonly domainEventPublisher: DomainEventPublisher) {
        // }
        FilterTypeFieldsInitedEventHandler.prototype.forEvent = function () {
            return FieldsInitedEvent;
        };
        FilterTypeFieldsInitedEventHandler.prototype.handle = function (fieldsInitedEvent) {
            // if (fieldsInitedEvent.ofMessageType('FieldsInitedEvent')) {
            //
            // 	const fields = fieldsInitedEvent.getFields();
            //
            // 	const manager = new FilterTypeManager(fields);
            //
            // 	this.filterTypeManagerRepository.next(fieldsInitedEvent.getAggregateId(), manager);
            //
            // 	this.domainEventPublisher.publish(new FilterTypesInitedEvent(fieldsInitedEvent.getAggregateId(), manager.getFieldIdsToFieldTypes()));
            // }
        };
        return FilterTypeFieldsInitedEventHandler;
    }());
    FilterTypeFieldsInitedEventHandler.decorators = [
        { type: core.Injectable }
    ];

    var UnselectAllUniqueFilterCommand = /** @class */ (function (_super) {
        __extends(UnselectAllUniqueFilterCommand, _super);
        function UnselectAllUniqueFilterCommand(structureId, fieldId) {
            var _this = _super.call(this, structureId, 'UnselectAllUniqueFilterCommand') || this;
            _this.fieldId = fieldId;
            return _this;
        }
        UnselectAllUniqueFilterCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        return UnselectAllUniqueFilterCommand;
    }(StructureCommand));

    var UnselectAllUniqueFilterCommandHandler = /** @class */ (function () {
        function UnselectAllUniqueFilterCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        UnselectAllUniqueFilterCommandHandler.prototype.forCommand = function () {
            return UnselectAllUniqueFilterCommand;
        };
        UnselectAllUniqueFilterCommandHandler.prototype.handle = function (structure, command) {
            var fieldId = command.getFieldId();
            structure.unselectAllUniqueFilter(fieldId);
        };
        UnselectAllUniqueFilterCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return UnselectAllUniqueFilterCommandHandler;
    }());
    UnselectAllUniqueFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    UnselectAllUniqueFilterCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var UnselectUniqueFilterCommand = /** @class */ (function (_super) {
        __extends(UnselectUniqueFilterCommand, _super);
        function UnselectUniqueFilterCommand(structureId, fieldId, uniqueValueId) {
            var _this = _super.call(this, structureId, 'UnselectUniqueFilterCommand') || this;
            _this.fieldId = fieldId;
            _this.uniqueValueId = uniqueValueId;
            return _this;
        }
        UnselectUniqueFilterCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        UnselectUniqueFilterCommand.prototype.getUniqueValueId = function () {
            return this.uniqueValueId;
        };
        return UnselectUniqueFilterCommand;
    }(StructureCommand));

    var UnselectUniqueFilterCommandHandler = /** @class */ (function () {
        function UnselectUniqueFilterCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        UnselectUniqueFilterCommandHandler.prototype.forCommand = function () {
            return UnselectUniqueFilterCommand;
        };
        UnselectUniqueFilterCommandHandler.prototype.handle = function (structure, command) {
            var fieldId = command.getFieldId(), uniqueValueId = command.getUniqueValueId();
            structure.unselectUniqueFilter(fieldId, uniqueValueId);
        };
        UnselectUniqueFilterCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return UnselectUniqueFilterCommandHandler;
    }());
    UnselectUniqueFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    UnselectUniqueFilterCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SelectAllUniqueFilterCommand = /** @class */ (function (_super) {
        __extends(SelectAllUniqueFilterCommand, _super);
        function SelectAllUniqueFilterCommand(structureId, fieldId) {
            var _this = _super.call(this, structureId, 'SelectAllUniqueFilterCommand') || this;
            _this.fieldId = fieldId;
            return _this;
        }
        SelectAllUniqueFilterCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        return SelectAllUniqueFilterCommand;
    }(StructureCommand));

    var SelectAllUniqueFilterCommandHandler = /** @class */ (function () {
        function SelectAllUniqueFilterCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SelectAllUniqueFilterCommandHandler.prototype.forCommand = function () {
            return SelectAllUniqueFilterCommand;
        };
        SelectAllUniqueFilterCommandHandler.prototype.handle = function (structure, command) {
            var fieldId = command.getFieldId();
            structure.selectAllUniqueFilter(fieldId);
        };
        SelectAllUniqueFilterCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SelectAllUniqueFilterCommandHandler;
    }());
    SelectAllUniqueFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SelectAllUniqueFilterCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SelectUniqueFilterCommand = /** @class */ (function (_super) {
        __extends(SelectUniqueFilterCommand, _super);
        function SelectUniqueFilterCommand(structureId, fieldId, uniqueValueId) {
            var _this = _super.call(this, structureId, 'SelectUniqueFilterCommand') || this;
            _this.fieldId = fieldId;
            _this.uniqueValueId = uniqueValueId;
            return _this;
        }
        SelectUniqueFilterCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        SelectUniqueFilterCommand.prototype.getUniqueValueId = function () {
            return this.uniqueValueId;
        };
        return SelectUniqueFilterCommand;
    }(StructureCommand));

    var SelectUniqueFilterCommandHandler = /** @class */ (function () {
        function SelectUniqueFilterCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SelectUniqueFilterCommandHandler.prototype.forCommand = function () {
            return SelectUniqueFilterCommand;
        };
        SelectUniqueFilterCommandHandler.prototype.handle = function (structure, command) {
            var fieldId = command.getFieldId(), uniqueValueId = command.getUniqueValueId();
            structure.selectUniqueFilter(fieldId, uniqueValueId);
        };
        SelectUniqueFilterCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SelectUniqueFilterCommandHandler;
    }());
    SelectUniqueFilterCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SelectUniqueFilterCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var FilterDomainModule = /** @class */ (function (_super) {
        __extends(FilterDomainModule, _super);
        function FilterDomainModule() {
            return _super.call(this) || this;
        }
        FilterDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SetConfigFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetConfigQuickFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(ToggleFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(AddFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(RemoveAllFiltersCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(RemoveFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SelectUniqueFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SelectAllUniqueFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(UnselectUniqueFilterCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(UnselectAllUniqueFilterCommandHandler, structureKey)
            ];
        };
        FilterDomainModule.domainEventHandlers = function () {
            return [
                hermes.HermesModule.registerDomainEventHandler(ConfigQuickFilterSetEventHandler),
                hermes.HermesModule.registerDomainEventHandler(ConfigFilterSetEventHandler),
                hermes.HermesModule.registerDomainEventHandler(FilterTypeConfigFilterSetEventHandler),
                hermes.HermesModule.registerDomainEventHandler(ActiveFiltersSetEventHandler),
                hermes.HermesModule.registerDomainEventHandler(UniqueFilterCalculatedEventHandler),
                hermes.HermesModule.registerDomainEventHandler(FilterTypeFieldsInitedEventHandler)
            ];
        };
        return FilterDomainModule;
    }(hermes.DomainModule));
    FilterDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [
                        FilterManagerFactory
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    FilterDomainModule.ctorParameters = function () { return []; };

    var DomainFilterWarehouse = /** @class */ (function (_super) {
        __extends(DomainFilterWarehouse, _super);
        function DomainFilterWarehouse(filterEnabledArchive, structureQuickFilterRepository, filterTypeArchive, uniqueValuesArchive, activeFilterArchive) {
            var _this = _super.call(this) || this;
            _this.filterEnabledArchive = filterEnabledArchive;
            _this.structureQuickFilterRepository = structureQuickFilterRepository;
            _this.filterTypeArchive = filterTypeArchive;
            _this.uniqueValuesArchive = uniqueValuesArchive;
            _this.activeFilterArchive = activeFilterArchive;
            return _this;
        }
        DomainFilterWarehouse.prototype.onFilteringEnabled = function (structureId) {
            return this.filterEnabledArchive.on(structureId);
        };
        DomainFilterWarehouse.prototype.onQuickFiltersEnabled = function (structureId) {
            return this.structureQuickFilterRepository.on(structureId);
        };
        DomainFilterWarehouse.prototype.onFilterTypes = function (structureId) {
            return this.filterTypeArchive.on(structureId);
        };
        DomainFilterWarehouse.prototype.onFilterTypesForFieldId = function (fieldId, structureId) {
            return this.onFilterTypes(structureId)
                .pipe(hermes.hermesMap(function (map) {
                return map.getFilterTypes(fieldId);
            }));
        };
        DomainFilterWarehouse.prototype.onActiveFilters = function (structureId) {
            return this.activeFilterArchive.on(structureId);
        };
        DomainFilterWarehouse.prototype.onUniqueValues = function (structureId) {
            return this.uniqueValuesArchive.on(structureId);
        };
        DomainFilterWarehouse.prototype.onceFilterTypeId = function (fieldId, filterTypeName, structureId) {
            return hermes.singleFromObservable(this.onFilterTypes(structureId)
                .pipe(hermes.hermesMap(function (map) {
                var filterTypes = map.getFilterTypes(fieldId);
                var filterType = filterTypes.find(function (fieldType) { return fieldType.getName() === filterTypeName; });
                return hermes.Optional.of(filterType.getId());
            })));
        };
        return DomainFilterWarehouse;
    }(FilterWarehouse));
    DomainFilterWarehouse.decorators = [
        { type: core.Injectable }
    ];
    DomainFilterWarehouse.ctorParameters = function () { return [
        { type: FilterEnabledArchive },
        { type: QuickFilterEnabledArchive },
        { type: FilterTypeArchive },
        { type: UniqueValuesArchive },
        { type: ActiveFilterArchive }
    ]; };

    var DomainFilterCommandInvoker = /** @class */ (function (_super) {
        __extends(DomainFilterCommandInvoker, _super);
        function DomainFilterCommandInvoker(commandDispatcher) {
            var _this = _super.call(this) || this;
            _this.commandDispatcher = commandDispatcher;
            return _this;
        }
        DomainFilterCommandInvoker.prototype.setConfig = function (config, structureId) {
            this.commandDispatcher.dispatch(new SetConfigFilterCommand(structureId, config));
        };
        DomainFilterCommandInvoker.prototype.add = function (fieldId, filterTypeId, value, structureId) {
            this.commandDispatcher.dispatch(new AddFilterCommand(structureId, fieldId, filterTypeId, value));
        };
        DomainFilterCommandInvoker.prototype.removeAll = function (structureId) {
            this.commandDispatcher.dispatch(new RemoveAllFiltersCommand(structureId));
        };
        DomainFilterCommandInvoker.prototype.remove = function (filterId, structureId) {
            this.commandDispatcher.dispatch(new RemoveFilterCommand(structureId, filterId));
        };
        DomainFilterCommandInvoker.prototype.selectAllUniqueFilter = function (fieldId, structureId) {
            this.commandDispatcher.dispatch(new SelectAllUniqueFilterCommand(structureId, fieldId));
        };
        DomainFilterCommandInvoker.prototype.unselectAllUniqueFilter = function (fieldId, structureId) {
            this.commandDispatcher.dispatch(new UnselectAllUniqueFilterCommand(structureId, fieldId));
        };
        DomainFilterCommandInvoker.prototype.selectUniqueFilter = function (fieldId, uniqueValueId, structureId) {
            this.commandDispatcher.dispatch(new SelectUniqueFilterCommand(structureId, fieldId, uniqueValueId));
        };
        DomainFilterCommandInvoker.prototype.unselectUniqueFilter = function (fieldId, uniqueValueId, structureId) {
            this.commandDispatcher.dispatch(new UnselectUniqueFilterCommand(structureId, fieldId, uniqueValueId));
        };
        return DomainFilterCommandInvoker;
    }(FilterCommandInvoker));
    DomainFilterCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    DomainFilterCommandInvoker.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var FieldId = /** @class */ (function () {
        function FieldId(id) {
            this.id = id;
        }
        FieldId.prototype.getId = function () {
            return this.id;
        };
        FieldId.prototype.equals = function (fieldId) {
            return fieldId.toString() === this.id;
        };
        FieldId.prototype.toString = function () {
            return this.id;
        };
        return FieldId;
    }());

    var FilterIntegration = /** @class */ (function () {
        function FilterIntegration(compositionWarehouse, filterCommandInvoker, filterWarehouse) {
            this.compositionWarehouse = compositionWarehouse;
            this.filterCommandInvoker = filterCommandInvoker;
            this.filterWarehouse = filterWarehouse;
        }
        FilterIntegration.prototype.getFilterTypes = function (columnName, compositionId, structureId) {
            var _this = this;
            var fieldTypes = [];
            this.compositionWarehouse
                .onTemplateColumns(compositionId)
                .pipe(hermes.hermesMap(function (cols) {
                return cols.find(function (col) {
                    return col.getName() === columnName;
                });
            }), hermes.hermesFilter(function (col) {
                return col !== undefined;
            }), hermes.hermesTake(1), hermes.hermesSwitchMap(function (col) {
                return _this.filterWarehouse
                    .onFilterTypesForFieldId(new FieldId(col.columnFieldId.getId()), structureId);
            }))
                .subscribe(function (types) {
                fieldTypes = types.map(function (type) { return type.getName(); });
            });
            return fieldTypes;
        };
        FilterIntegration.prototype.filter = function (columnName, filterType, value, compositionId, structureId) {
            var _this = this;
            this.compositionWarehouse
                .onTemplateColumns(compositionId)
                .pipe(hermes.hermesMap(function (cols) {
                return cols.find(function (col) {
                    return col.getName() === columnName;
                });
            }), hermes.hermesFilter(function (col) {
                return col !== undefined;
            }), hermes.hermesTake(1), hermes.hermesSwitchMap(function (col) {
                return _this.filterWarehouse
                    .onceFilterTypeId(new FieldId(col.columnFieldId.getId()), filterType, structureId)
                    .pipe(hermes.hermesMap(function (filterTypeId) {
                    return {
                        fieldId: new FieldId(col.columnFieldId.getId()),
                        filterTypeId: filterTypeId
                    };
                }));
            }))
                .subscribe(function (params) {
                var fieldId = params.fieldId, filterTypeId = params.filterTypeId;
                filterTypeId.ifPresent(function (ftId) {
                    _this.filterCommandInvoker.add(fieldId, ftId, value, structureId);
                });
            });
        };
        return FilterIntegration;
    }());
    FilterIntegration.decorators = [
        { type: core.Injectable }
    ];
    FilterIntegration.ctorParameters = function () { return [
        { type: CompositionWarehouse },
        { type: FilterCommandInvoker },
        { type: FilterWarehouse }
    ]; };

    var FilterApiModule = /** @class */ (function (_super) {
        __extends(FilterApiModule, _super);
        function FilterApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return FilterApiModule;
    }(hermes.ApiModule));
    FilterApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        FilterDomainModule
                    ],
                    providers: [
                        {
                            provide: FilterCommandInvoker,
                            useClass: DomainFilterCommandInvoker
                        },
                        {
                            provide: FilterWarehouse,
                            useClass: DomainFilterWarehouse
                        },
                        FilterTypeArchive,
                        ActiveFilterArchive,
                        UniqueValuesArchive,
                        FilterEnabledArchive,
                        QuickFilterEnabledArchive,
                        FilterIntegration
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var fabricImports = [
        fabric.FabricBadgeModule,
        fabric.FabricButtonModule,
        fabric.FabricButtonGroupModule,
        fabric.FabricCheckboxModule,
        fabric.FabricChipModule,
        fabric.FabricDrawerModule,
        fabric.FabricDropdownModule,
        fabric.FabricRadioButtonModule,
        fabric.FabricRadioGroupModule,
        fabric.FabricProgressBarModule,
        fabric.FabricProgressSpinnerModule,
        fabric.FabricSelectModule,
        fabric.FabricSpinnerModule,
        fabric.FabricTabModule,
        fabric.FabricTooltipModule,
        fabric.FabricToggleButtonModule,
        fabric.FabricInputModule,
        fabric.FabricDialogModule,
        fabric.FabricInlineDialogModule,
        fabric.FabricTabModule
    ];

    var ActiveFilterListComponent = /** @class */ (function (_super) {
        __extends(ActiveFilterListComponent, _super);
        function ActiveFilterListComponent(changeDetectorRef, elementRef, structureId, filterWarehouse, filterCommandDispatcher) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.structureId = structureId;
            _this.filterWarehouse = filterWarehouse;
            _this.filterCommandDispatcher = filterCommandDispatcher;
            _this.activeFilters = [];
            return _this;
        }
        ActiveFilterListComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.filterWarehouse.onActiveFilters(this.structureId), function (activeFilters) {
                _this.activeFilters = activeFilters;
            });
        };
        ActiveFilterListComponent.prototype.removeFilter = function (filter) {
            this.filterCommandDispatcher.remove(filter.getFilterId(), this.structureId);
        };
        ActiveFilterListComponent.prototype.getSelectorName = function () {
            return 'gui-active-filter-list';
        };
        return ActiveFilterListComponent;
    }(SmartComponent));
    ActiveFilterListComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-active-filter-list]',
                    template: "<div *ngFor=\"let filter of activeFilters\">\n\t{{filter.getText()}}\n\t<span (click)=\"removeFilter(filter)\">X</span>\n</div>\n\n<div gui-active-search></div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    ActiveFilterListComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: FilterWarehouse },
        { type: FilterCommandInvoker }
    ]; };

    var ActiveSearchComponent = /** @class */ (function (_super) {
        __extends(ActiveSearchComponent, _super);
        function ActiveSearchComponent(changeDetectorRef, elementRef, structureId, searchCommandDispatcher, searchWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.searchCommandDispatcher = searchCommandDispatcher;
            _this.searchWarehouse = searchWarehouse;
            return _this;
        }
        ActiveSearchComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.searchWarehouse.onPhrase(this.structureId), function (phrase) {
                _this.phrase = phrase;
            });
        };
        ActiveSearchComponent.prototype.clearSearch = function () {
            event.stopPropagation();
            this.searchCommandDispatcher.search('', this.structureId);
        };
        ActiveSearchComponent.prototype.getSelectorName = function () {
            return 'gui-active-search';
        };
        return ActiveSearchComponent;
    }(SmartComponent));
    ActiveSearchComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-active-search]',
                    template: "<ng-container *ngIf=\"phrase\">\n\t<div>\n\t\tActive search by:\n\t</div>\n\n\t<div>\n\t\t<gui-chip>{{phrase}}</gui-chip>\n\t</div>\n\n\t<div>\n\t\t<button (click)=\"clearSearch()\"\n\t\t\t\t[outline]=\"true\"\n\t\t\t\t[primary]=\"true\"\n\t\t\t\tgui-button>\n\t\t\tClear search\n\t\t</button>\n\t</div>\n</ng-container>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    ActiveSearchComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: SearchCommandInvoker },
        { type: SearchWarehouse }
    ]; };

    var ActiveFilterListModule = /** @class */ (function (_super) {
        __extends(ActiveFilterListModule, _super);
        function ActiveFilterListModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        ActiveFilterListModule.forComponent = function () {
            return [];
        };
        return ActiveFilterListModule;
    }(hermes.FeatureModule));
    ActiveFilterListModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabricImports,
                        FilterApiModule
                    ],
                    declarations: [
                        ActiveFilterListComponent,
                        ActiveSearchComponent
                    ],
                    exports: [
                        ActiveFilterListComponent
                    ]
                },] }
    ];

    var FilterMenuActiveFiltersComponent = /** @class */ (function (_super) {
        __extends(FilterMenuActiveFiltersComponent, _super);
        function FilterMenuActiveFiltersComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.removedFilter = new core.EventEmitter();
            _this.addClassToHost('gui-py-8');
            return _this;
        }
        FilterMenuActiveFiltersComponent.prototype.remove = function (filter) {
            this.removedFilter.emit(filter.getFilterId());
        };
        FilterMenuActiveFiltersComponent.prototype.getSelectorName = function () {
            return 'gui-filter-menu-active-filters';
        };
        return FilterMenuActiveFiltersComponent;
    }(PureComponent));
    FilterMenuActiveFiltersComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-filter-menu-active-filters][activeFilters]',
                    template: "\n\n\t\t<div *ngIf=\"activeFilters && activeFilters.length > 0\"\n\t\tclass=\"\"\n\t\tstyle=\"border-top: 1px dashed; border-bottom: 1px dashed\">\n\n\t\t\t<h4>Active filters:</h4>\n\n\t\t\t<div *ngFor=\"let filter of activeFilters\"\n\t\t\t\t class=\"gui-flex gui-justify-between \">\n\n\t\t\t\t<div>\n\t\t\t\t<span [gui-tooltip]=\"'Column name ' + filter.getFieldName()\">\n\t\t\t\t\t{{filter.getFieldName()}}\n\t\t\t\t</span>\n\n\t\t\t\t\t<span [gui-tooltip]=\"'Filter type ' + filter.getFilterTypeName()\">\n\t\t\t\t\t{{filter.getFilterTypeName()}}\n\t\t\t\t</span>\n\n\t\t\t\t\t<span [gui-tooltip]=\"'Value ' + filter.getValue()\">\n\t\t\t\t\t{{filter.getValue()}}\n\t\t\t\t</span>\n\t\t\t\t</div>\n\n\n\t\t\t\t<button (click)=\"remove(filter)\">Remove</button>\n\t\t\t</div>\n\n\t\t</div>\n\n\t\t<br/>\n\t\t<br/>\n\t\t<br/>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    FilterMenuActiveFiltersComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    FilterMenuActiveFiltersComponent.propDecorators = {
        activeFilters: [{ type: core.Input }],
        removedFilter: [{ type: core.Output }]
    };

    var FilterMenuFeatureModule = /** @class */ (function (_super) {
        __extends(FilterMenuFeatureModule, _super);
        function FilterMenuFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        FilterMenuFeatureModule.forComponent = function () {
            return [];
        };
        return FilterMenuFeatureModule;
    }(hermes.FeatureModule));
    FilterMenuFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabric.FabricModule,
                        forms.ReactiveFormsModule,
                        FilterApiModule,
                        ActiveFilterListModule
                    ],
                    declarations: [
                        FilterIconComponent,
                        FilterMenuComponent,
                        FilterMenuTriggerComponent,
                        ColumnSelectorComponent,
                        FilterTypeSelectorComponent,
                        FilterValueComponent,
                        FieldSelectorComponent,
                        FilterMenuActiveFiltersComponent
                    ],
                    exports: [
                        FilterMenuTriggerComponent
                    ],
                    entryComponents: [
                        FilterMenuComponent
                    ]
                },] }
    ];

    var exportDeclarations$3 = [
        ListViewComponent,
        listViewGatewayDeclarations
    ];
    var ListViewFeatureModule = /** @class */ (function () {
        function ListViewFeatureModule() {
        }
        return ListViewFeatureModule;
    }());
    ListViewFeatureModule.exportDeclarations = Array.from(exportDeclarations$3);
    ListViewFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        ListViewApiModule,
                        fabric.FabricSelectModule,
                        PagingFeatureModule,
                        SearchFeatureModule,
                        EmptySourceFeatureModule,
                        SortingSelectorFeatureModule,
                        FilterMenuFeatureModule
                    ],
                    declarations: [
                        ListViewComponent,
                        ListViewItemComponent,
                        ListViewLayoutComponent,
                        ListViewSourceComponent,
                        ListViewContainerCardComponent,
                        ListViewCardItemComponent,
                        ListViewContainerModeSelectComponent,
                        listViewGatewayDeclarations
                    ],
                    exports: exportDeclarations$3,
                    providers: []
                },] }
    ];

    var NumberFormatterPipe = /** @class */ (function () {
        function NumberFormatterPipe() {
        }
        NumberFormatterPipe.prototype.transform = function (number) {
            return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
        };
        return NumberFormatterPipe;
    }());
    NumberFormatterPipe.decorators = [
        { type: core.Pipe, args: [{ name: 'numberFormatter' },] }
    ];

    var NumberFormatterModule = /** @class */ (function () {
        function NumberFormatterModule() {
        }
        return NumberFormatterModule;
    }());
    NumberFormatterModule.decorators = [
        { type: core.NgModule, args: [{
                    declarations: [
                        NumberFormatterPipe
                    ],
                    exports: [
                        NumberFormatterPipe
                    ]
                },] }
    ];

    var StructureInfoModalComponent = /** @class */ (function (_super) {
        __extends(StructureInfoModalComponent, _super);
        function StructureInfoModalComponent(elementRef, changeDetectorRef) {
            return _super.call(this, elementRef, changeDetectorRef) || this;
        }
        StructureInfoModalComponent.prototype.getSelectorName = function () {
            return 'gui-info-dialog';
        };
        return StructureInfoModalComponent;
    }(StaticComponent));
    StructureInfoModalComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-info-dialog]',
                    template: "<div class=\"gui-structure-info-modal gui-flex gui-flex-col gui-p-0 gui-text-lg gui-w-full\">\n\n\t<p class=\"gui-dialog-title gui-text-3xl gui-mb-8 gui-font-bold\">\n\t\tGeneric UI Grid\n\t</p>\n\n\n\t<p class=\"gui-text-xl gui-mb-18 gui-font-bold\">\n\t\tver. 0.16.2\n\t</p>\n\n\t<p class=\"gui-quote gui-text-2xl gui-italic gui-font-light\">\n\t\t\"The best way to success is to help others succeed.\"\n\t</p>\n\n\t<br/>\n\n\t<section class=\"gui-m-0 gui-px-0 gui-pt-10 gui-pb-6\">\n\t\t<p class=\"gui-font-bold\">Links:</p>\n\t\t<ul class=\"gui-m-0 gui-pl-9 gui-list-none\">\n\n\t\t\t<li>\n\t\t\t\t<a class=\"gui-mb-6 gui-no-underline gui-leading-6\" href=\"https://generic-ui.com/\">Website</a>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<a class=\"gui-mb-6 gui-no-underline gui-leading-6\" href=\"https://generic-ui.com/guide/\">Documentation</a>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<a class=\"gui-mb-6 gui-no-underline gui-leading-6\" href=\"https://github.com/generic-ui/generic-ui/tree/master/ngx-grid\">Github</a>\n\t\t\t</li>\n\t\t</ul>\n\n\t\t<br/>\n\n\t\t<p class=\"gui-font-bold\">Feedback:</p>\n\t\t<ul class=\"gui-m-0 gui-pl-9 gui-list-none\">\n\n\t\t\t<li>\n\t\t\t\t<a class=\"gui-mb-6 gui-no-underline gui-leading-6\" href=\"https://github.com/generic-ui/generic-ui/issues\">Report a bug</a>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<a class=\"gui-mb-6 gui-no-underline gui-leading-6\" href=\"https://github.com/generic-ui/generic-ui/issues\">Suggest an idea</a>\n\t\t\t</li>\n\n\t\t</ul>\n\t</section>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureInfoModalComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var StructureDialogColumnManagerComponent = /** @class */ (function (_super) {
        __extends(StructureDialogColumnManagerComponent, _super);
        function StructureDialogColumnManagerComponent(detector, elementRef) {
            return _super.call(this, detector, elementRef) || this;
        }
        StructureDialogColumnManagerComponent.prototype.getSelectorName = function () {
            return 'gui-structure-dialog-column-manager';
        };
        return StructureDialogColumnManagerComponent;
    }(SmartComponent));
    StructureDialogColumnManagerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-dialog-column-manager]',
                    template: "<div class=\"gui-dialog-title\">{{'columnManagerModalTitle' | guiTranslate}}</div>\n\n<div gui-structure-column-manager>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureDialogColumnManagerComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };

    var SchemaTheme;
    (function (SchemaTheme) {
        SchemaTheme[SchemaTheme["FABRIC"] = 0] = "FABRIC";
        SchemaTheme[SchemaTheme["MATERIAL"] = 1] = "MATERIAL";
        SchemaTheme[SchemaTheme["LIGHT"] = 2] = "LIGHT";
        SchemaTheme[SchemaTheme["DARK"] = 3] = "DARK";
        SchemaTheme[SchemaTheme["GENERIC"] = 4] = "GENERIC";
    })(SchemaTheme || (SchemaTheme = {}));

    var StructureThemeConverter = /** @class */ (function () {
        function StructureThemeConverter() {
        }
        StructureThemeConverter.prototype.convertTheme = function (schemaTheme) {
            switch (schemaTheme) {
                case SchemaTheme.FABRIC:
                    return fabric.Theme.FABRIC;
                case SchemaTheme.MATERIAL:
                    return fabric.Theme.MATERIAL;
                case SchemaTheme.GENERIC:
                    return fabric.Theme.GENERIC;
                case SchemaTheme.LIGHT:
                    return fabric.Theme.LIGHT;
                case SchemaTheme.DARK:
                    return fabric.Theme.DARK;
                default:
                    return fabric.Theme.FABRIC;
            }
        };
        return StructureThemeConverter;
    }());
    StructureThemeConverter.decorators = [
        { type: core.Injectable }
    ];

    var SchemaWarehouse = /** @class */ (function () {
        function SchemaWarehouse() {
        }
        return SchemaWarehouse;
    }());
    SchemaWarehouse.decorators = [
        { type: core.Injectable }
    ];

    var StructureDialogColumnManagerService = /** @class */ (function (_super) {
        __extends(StructureDialogColumnManagerService, _super);
        function StructureDialogColumnManagerService(injector, schemaWarehouse, structureThemeConverter, fabricDialogService) {
            var _this = _super.call(this) || this;
            _this.injector = injector;
            _this.schemaWarehouse = schemaWarehouse;
            _this.structureThemeConverter = structureThemeConverter;
            _this.fabricDialogService = fabricDialogService;
            return _this;
        }
        StructureDialogColumnManagerService.prototype.open = function (compositionId, readModelId, parentInjector) {
            var _this = this;
            if (!parentInjector) {
                parentInjector = this.injector;
            }
            var injector = core.Injector.create({ parent: parentInjector, providers: [{ provide: CompositionId, useValue: compositionId }] });
            this.schemaWarehouse
                .onceTheme(readModelId)
                .pipe(this.hermesTakeUntil())
                .subscribe(function (theme) {
                _this.fabricDialogService.open(StructureDialogColumnManagerComponent, {
                    injector: injector,
                    theme: _this.structureThemeConverter.convertTheme(theme)
                });
            });
        };
        return StructureDialogColumnManagerService;
    }(hermes.Reactive));
    StructureDialogColumnManagerService.decorators = [
        { type: core.Injectable }
    ];
    StructureDialogColumnManagerService.ctorParameters = function () { return [
        { type: core.Injector },
        { type: SchemaWarehouse },
        { type: StructureThemeConverter },
        { type: fabric.FabricDialogService }
    ]; };

    var StructureInfoPanelConfig = /** @class */ (function () {
        function StructureInfoPanelConfig(enabled, infoDialog, columnsManager, schemaManager, sourceSize) {
            this.enabled = false;
            this.infoDialog = true;
            this.columnsManager = true;
            this.schemaManager = true;
            this.sourceSize = true;
            if (this.isNotUndefinedOrNull(enabled)) {
                this.enabled = enabled;
            }
            if (this.isNotUndefinedOrNull(infoDialog)) {
                this.infoDialog = infoDialog;
            }
            if (this.isNotUndefinedOrNull(columnsManager)) {
                this.columnsManager = columnsManager;
            }
            if (this.isNotUndefinedOrNull(sourceSize)) {
                this.sourceSize = sourceSize;
            }
            if (this.isNotUndefinedOrNull(schemaManager)) {
                this.schemaManager = schemaManager;
            }
        }
        StructureInfoPanelConfig.prototype.isEnabled = function () {
            return this.enabled;
        };
        StructureInfoPanelConfig.prototype.isInfoDialogEnabled = function () {
            return this.infoDialog;
        };
        StructureInfoPanelConfig.prototype.isColumnsManagerEnabled = function () {
            return this.columnsManager;
        };
        StructureInfoPanelConfig.prototype.isSourceSizeEnabled = function () {
            return this.sourceSize;
        };
        StructureInfoPanelConfig.prototype.isSchemaManagerEnabled = function () {
            return this.schemaManager;
        };
        StructureInfoPanelConfig.prototype.isNotUndefinedOrNull = function (config) {
            return config !== undefined && config !== null;
        };
        return StructureInfoPanelConfig;
    }());

    var StructureInfoPanelArchive = /** @class */ (function (_super) {
        __extends(StructureInfoPanelArchive, _super);
        function StructureInfoPanelArchive() {
            return _super.call(this, new StructureInfoPanelConfig()) || this;
        }
        return StructureInfoPanelArchive;
    }(hermes.Archive));
    StructureInfoPanelArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureInfoPanelArchive.ctorParameters = function () { return []; };

    var StructureDialogSchemaManagerComponent = /** @class */ (function (_super) {
        __extends(StructureDialogSchemaManagerComponent, _super);
        function StructureDialogSchemaManagerComponent(elRef) {
            var _this = _super.call(this, elRef) || this;
            _this.addClassToHost('gui-pr-10');
            return _this;
        }
        StructureDialogSchemaManagerComponent.prototype.getSelectorName = function () {
            return 'gui-schema-manager-dialog';
        };
        return StructureDialogSchemaManagerComponent;
    }(PureComponent));
    StructureDialogSchemaManagerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-schema-manager-dialog]',
                    template: "\n\t\t<div gui-structure-schema-manager></div>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureDialogSchemaManagerComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };

    var StructureDialogSchemaManagerService = /** @class */ (function (_super) {
        __extends(StructureDialogSchemaManagerService, _super);
        function StructureDialogSchemaManagerService(injector, fabricDialogService) {
            var _this = _super.call(this) || this;
            _this.injector = injector;
            _this.fabricDialogService = fabricDialogService;
            return _this;
        }
        StructureDialogSchemaManagerService.prototype.open = function (readModelId, parentInjector) {
            if (!parentInjector) {
                parentInjector = this.injector;
            }
            var injector = core.Injector.create({
                providers: [{ provide: SchemaReadModelRootId, useValue: readModelId }],
                parent: parentInjector
            });
            this.fabricDialogService.open(StructureDialogSchemaManagerComponent, {
                injector: injector
            });
        };
        return StructureDialogSchemaManagerService;
    }(hermes.Reactive));
    StructureDialogSchemaManagerService.decorators = [
        { type: core.Injectable }
    ];
    StructureDialogSchemaManagerService.ctorParameters = function () { return [
        { type: core.Injector },
        { type: fabric.FabricDialogService }
    ]; };

    var StructureInfoPanelComponent = /** @class */ (function (_super) {
        __extends(StructureInfoPanelComponent, _super);
        function StructureInfoPanelComponent(changeDetectorRef, elementRef, injector, sourceWarehouse, dialog, compositionId, structureId, schemaReadModelRootId, menuColumnManagerService, translationService, schemaManagerService, structureInfoPanelArchive) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.injector = injector;
            _this.sourceWarehouse = sourceWarehouse;
            _this.dialog = dialog;
            _this.compositionId = compositionId;
            _this.structureId = structureId;
            _this.schemaReadModelRootId = schemaReadModelRootId;
            _this.menuColumnManagerService = menuColumnManagerService;
            _this.translationService = translationService;
            _this.schemaManagerService = schemaManagerService;
            _this.structureInfoPanelArchive = structureInfoPanelArchive;
            _this.infoModal = StructureInfoModalComponent;
            return _this;
        }
        StructureInfoPanelComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.structureInfoPanelArchive.on(), function (infoPanel) {
                _this.infoPanelConfig = infoPanel;
            });
            this.subscribe(this.sourceWarehouse.onOriginSize(this.structureId), function (size) {
                _this.totalItemsSize = size;
            });
            this.subscribe(this.sourceWarehouse.onPreparedEntities(this.structureId), function (preparedItems) {
                _this.preparedItemsSize = preparedItems.length;
            });
            this.subscribe(this.translationService.onTranslation(), function (translation) {
                _this.themeManagerTooltipText = translation.infoPanelThemeMangerTooltipText;
                _this.columnManagerTooltipText = translation.infoPanelColumnManagerTooltipText;
                _this.infoTooltipText = translation.infoPanelInfoTooltipText;
            });
        };
        StructureInfoPanelComponent.prototype.openInfo = function () {
            this.dialog.open(this.infoModal);
        };
        StructureInfoPanelComponent.prototype.openColumnManager = function () {
            this.menuColumnManagerService.open(this.compositionId, this.schemaReadModelRootId, this.injector);
        };
        StructureInfoPanelComponent.prototype.openSchemaManager = function () {
            this.schemaManagerService.open(this.schemaReadModelRootId, this.injector);
        };
        StructureInfoPanelComponent.prototype.getSelectorName = function () {
            return 'gui-structure-info-panel';
        };
        return StructureInfoPanelComponent;
    }(SmartComponent));
    StructureInfoPanelComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-info-panel]',
                    template: "<div>\n\t<div *ngIf=\"infoPanelConfig.isSourceSizeEnabled()\">\n\n\t\t<ng-container *ngIf=\"preparedItemsSize !== undefined && totalItemsSize !== undefined\">\n\n\t\t\t<ng-container *ngIf=\"preparedItemsSize === totalItemsSize\">\n\t\t\t\t{{'infoPanelShowing' | guiTranslate}}\n\t\t\t\t<b>{{totalItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelItems' | guiTranslate}}\n\t\t\t</ng-container>\n\n\t\t\t<span *ngIf=\"preparedItemsSize !== totalItemsSize\"\n\t\t\t\t  gui-active-filter-menu-trigger>\n\t\t\t\t\t\t{{'infoPanelShowing' | guiTranslate}}\n\t\t\t\t<b>{{preparedItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelOutOf' | guiTranslate}}\n\t\t\t\t<b>{{totalItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelItems' | guiTranslate}}\n\t\t\t</span>\n\n\t\t</ng-container>\n\n\t</div>\n</div>\n\n<div>\n\t<div class=\"gui-right-section\">\n\n\t\t<div (click)=\"openSchemaManager()\"\n\t\t\t *ngIf=\"infoPanelConfig.isSchemaManagerEnabled()\">\n\t\t\t<div [gui-tooltip]=\"themeManagerTooltipText\" gui-structure-schema-manager-icon></div>\n\t\t</div>\n\n\t\t<div (click)=\"openColumnManager()\"\n\t\t\t *ngIf=\"infoPanelConfig.isColumnsManagerEnabled()\">\n\t\t\t<div [gui-tooltip]=\"columnManagerTooltipText\" gui-structure-column-manager-icon></div>\n\t\t</div>\n\n\t\t<div (click)=\"openInfo()\"\n\t\t\t *ngIf=\"infoPanelConfig.isInfoDialogEnabled()\">\n\t\t\t<div [gui-tooltip]=\"infoTooltipText\" gui-structure-info-icon></div>\n\t\t</div>\n\t</div>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureInfoPanelComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: core.Injector },
        { type: SourceWarehouse },
        { type: fabric.FabricDialogService },
        { type: CompositionId },
        { type: StructureId },
        { type: SchemaReadModelRootId },
        { type: StructureDialogColumnManagerService },
        { type: TranslationFacade },
        { type: StructureDialogSchemaManagerService },
        { type: StructureInfoPanelArchive }
    ]; };

    var CompositionCommandInvoker = /** @class */ (function () {
        function CompositionCommandInvoker() {
        }
        return CompositionCommandInvoker;
    }());
    CompositionCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    CompositionCommandInvoker.ctorParameters = function () { return []; };

    var StructureColumnManagerComponent = /** @class */ (function (_super) {
        __extends(StructureColumnManagerComponent, _super);
        function StructureColumnManagerComponent(changeDetectorRef, elementRef, compositionId, compositionCommandInvoker, compositionWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.compositionId = compositionId;
            _this.compositionCommandInvoker = compositionCommandInvoker;
            _this.compositionWarehouse = compositionWarehouse;
            _this.addClassToHost('gui-block');
            return _this;
        }
        StructureColumnManagerComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.compositionWarehouse.onAllColumns(this.compositionId), function (columns) {
                _this.columns = columns;
                _this.enabledColumnsCount = _this.columns
                    .map(function (c) { return +c.isEnabled(); })
                    .reduce(function (accumulator, currentValue) { return accumulator + currentValue; });
            });
        };
        StructureColumnManagerComponent.prototype.toggleColumn = function (column) {
            event.stopPropagation();
            if (column.isEnabled()) {
                this.compositionCommandInvoker.disableColumn(column.getColumnDefinitionId(), this.compositionId);
            }
            else {
                this.compositionCommandInvoker.enableColumn(column.getColumnDefinitionId(), this.compositionId);
            }
        };
        StructureColumnManagerComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-manager';
        };
        return StructureColumnManagerComponent;
    }(SmartComponent));
    StructureColumnManagerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-manager]',
                    template: "\n\n\t\t<ol class=\"gui-p-0 gui-my-4 gui-mx-0 gui-list-none gui-overflow-auto\">\n\t\t\t<li *ngFor=\"let column of columns\"\n\t\t\t\t(click)=\"toggleColumn(column)\"\n\t\t\t\tclass=\"gui-p-6 gui-cursor-pointer\">\n\n\t\t\t\t<gui-checkbox [checked]=\"column.isEnabled()\"\n\t\t\t\t\t\t\t  [disabled]=\"enabledColumnsCount === 1 && column.isEnabled()\">\n\n\t\t\t\t\t<ng-container\n\t\t\t\t\t\t*ngTemplateOutlet=\"column.viewTemplate;\n\t\t\t\t\t\t\t\t\t\t\tcontext: column.context\">\n\t\t\t\t\t</ng-container>\n\t\t\t\t</gui-checkbox>\n\n\t\t\t</li>\n\t\t</ol>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnManagerComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: CompositionId },
        { type: CompositionCommandInvoker },
        { type: CompositionWarehouse }
    ]; };

    var StructureMenuColumnManagerComponent = /** @class */ (function (_super) {
        __extends(StructureMenuColumnManagerComponent, _super);
        function StructureMenuColumnManagerComponent(elementRef) {
            return _super.call(this, elementRef) || this;
        }
        StructureMenuColumnManagerComponent.prototype.getSelectorName = function () {
            return 'gui-structure-menu-column-manager';
        };
        return StructureMenuColumnManagerComponent;
    }(PureComponent));
    StructureMenuColumnManagerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-menu-column-manager]',
                    template: "<div gui-structure-column-manager></div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureMenuColumnManagerComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };

    var StructureColumnManagerIconComponent = /** @class */ (function (_super) {
        __extends(StructureColumnManagerIconComponent, _super);
        function StructureColumnManagerIconComponent(elementRef, changeDetectorRef) {
            return _super.call(this, elementRef, changeDetectorRef) || this;
        }
        StructureColumnManagerIconComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-manager-icon';
        };
        return StructureColumnManagerIconComponent;
    }(IconComponent));
    StructureColumnManagerIconComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-manager-icon]',
                    template: "\n\t\t<svg data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 10.32 10.31\">\n\t\t\t<line class=\"cls-1\" x1=\"9.57\" y1=\"3.65\" x2=\"0.75\" y2=\"3.65\"/>\n\t\t\t<line class=\"cls-2\" x1=\"9.57\" y1=\"0.75\" x2=\"0.75\" y2=\"0.75\"/>\n\t\t\t<line class=\"cls-2\" x1=\"0.75\" y1=\"9.56\" x2=\"0.75\" y2=\"0.88\"/>\n\t\t\t<line class=\"cls-1\" x1=\"3.69\" y1=\"9.65\" x2=\"3.69\" y2=\"3.89\"/>\n\t\t\t<line class=\"cls-1\" x1=\"6.63\" y1=\"9.56\" x2=\"6.63\" y2=\"3.89\"/>\n\t\t\t<line class=\"cls-2\" x1=\"9.57\" y1=\"9.56\" x2=\"9.57\" y2=\"0.88\"/>\n\t\t</svg>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnManagerIconComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var declarations$3 = [
        StructureColumnManagerComponent,
        StructureDialogColumnManagerComponent,
        StructureMenuColumnManagerComponent,
        StructureColumnManagerIconComponent
    ];
    var StructureColumnManagerModule = /** @class */ (function () {
        function StructureColumnManagerModule() {
        }
        return StructureColumnManagerModule;
    }());
    StructureColumnManagerModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabricImports,
                        TranslationFeatureModule
                    ],
                    declarations: declarations$3,
                    exports: declarations$3,
                    entryComponents: [
                        StructureColumnManagerComponent,
                        StructureDialogColumnManagerComponent,
                        StructureMenuColumnManagerComponent
                    ],
                    providers: [
                        StructureDialogColumnManagerService
                    ]
                },] }
    ];

    var StructureInfoIconComponent = /** @class */ (function (_super) {
        __extends(StructureInfoIconComponent, _super);
        function StructureInfoIconComponent(elRef, cdr) {
            return _super.call(this, elRef, cdr) || this;
        }
        StructureInfoIconComponent.prototype.getSelectorName = function () {
            return 'gui-structure-info-icon';
        };
        return StructureInfoIconComponent;
    }(IconComponent));
    StructureInfoIconComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-info-icon]',
                    template: "<svg data-name=\"Layer 1\" viewBox=\"0 0 10.08 10.08\" xmlns=\"http://www.w3.org/2000/svg\">\n\t<path class=\"cls-1\"\n\t\t  d=\"M401.64,307.76c0-.28.23-.45.54-.45s.55.17.55.45v0a.49.49,0,0,1-.55.46.48.48,0,0,1-.54-.46Zm.05,1.27a.49.49,0,0,1,1,0v2.54a.49.49,0,0,1-1,0Z\"\n\t\t  transform=\"translate(-397.14 -304.64)\"/>\n\t<circle class=\"cls-2\" cx=\"5.04\" cy=\"5.04\" r=\"4.54\"/>\n</svg>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureInfoIconComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var StructureInfoPanelConfigConverter = /** @class */ (function () {
        function StructureInfoPanelConfigConverter() {
        }
        StructureInfoPanelConfigConverter.prototype.convert = function (config) {
            var infoDialog, columnsManager, sourceSize, schemaManager;
            if (config.infoDialog !== undefined) {
                infoDialog = config.infoDialog;
            }
            if (config.columnsManager !== undefined) {
                columnsManager = config.columnsManager;
            }
            if (config.schemaManager !== undefined) {
                schemaManager = config.schemaManager;
            }
            if (config.sourceSize !== undefined) {
                sourceSize = config.sourceSize;
            }
            return new StructureInfoPanelConfig(config.enabled, infoDialog, columnsManager, schemaManager, sourceSize);
        };
        return StructureInfoPanelConfigConverter;
    }());
    StructureInfoPanelConfigConverter.decorators = [
        { type: core.Injectable }
    ];

    var SchemaRowColoring;
    (function (SchemaRowColoring) {
        SchemaRowColoring[SchemaRowColoring["NONE"] = 0] = "NONE";
        SchemaRowColoring[SchemaRowColoring["EVEN"] = 1] = "EVEN";
        SchemaRowColoring[SchemaRowColoring["ODD"] = 2] = "ODD";
    })(SchemaRowColoring || (SchemaRowColoring = {}));

    var SchemaCommandInvoker = /** @class */ (function () {
        function SchemaCommandInvoker() {
        }
        return SchemaCommandInvoker;
    }());
    SchemaCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SchemaCommandInvoker.ctorParameters = function () { return []; };

    var RowColoring;
    (function (RowColoring) {
        RowColoring[RowColoring["NONE"] = 0] = "NONE";
        RowColoring[RowColoring["EVEN"] = 1] = "EVEN";
        RowColoring[RowColoring["ODD"] = 2] = "ODD";
    })(RowColoring || (RowColoring = {}));

    var StructureSchemaMangerComponent = /** @class */ (function (_super) {
        __extends(StructureSchemaMangerComponent, _super);
        function StructureSchemaMangerComponent(changeDetectorRef, elRef, structureId, schemaReadModelRootId, schemaCommandInvoker, schemaWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.schemaReadModelRootId = schemaReadModelRootId;
            _this.schemaCommandInvoker = schemaCommandInvoker;
            _this.schemaWarehouse = schemaWarehouse;
            _this.coloring = Object.keys(SchemaRowColoring)
                .map(function (key) { return SchemaRowColoring[key]; })
                .filter(function (val) { return !Number.isInteger(val); })
                .map(function (value) {
                return {
                    value: value,
                    name: value
                };
            });
            _this.themes = Object.keys(SchemaTheme)
                .map(function (key) { return SchemaTheme[key]; })
                .filter(function (val) { return !Number.isInteger(val); })
                .map(function (value) {
                return {
                    value: value,
                    name: value
                };
            });
            return _this;
        }
        StructureSchemaMangerComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.schemaWarehouse.onRowColoring(this.schemaReadModelRootId), function (rowColoring) {
                _this.selectedRowColoring = {
                    value: SchemaRowColoring[rowColoring],
                    name: SchemaRowColoring[rowColoring]
                };
            });
            this.subscribe(this.schemaWarehouse.onTheme(this.schemaReadModelRootId), function (schemaTheme) {
                _this.selectedTheme = {
                    value: SchemaTheme[schemaTheme],
                    name: SchemaTheme[schemaTheme]
                };
            });
            this.subscribe(this.schemaWarehouse.onVerticalGrid(this.schemaReadModelRootId), function (verticalGrid) {
                _this.verticalGrid = verticalGrid;
            });
            this.subscribe(this.schemaWarehouse.onHorizontalGrid(this.schemaReadModelRootId), function (horizontalGrid) {
                _this.horizontalGrid = horizontalGrid;
            });
        };
        StructureSchemaMangerComponent.prototype.toggleTheme = function (theme) {
            this.schemaCommandInvoker.setTheme(this.toTheme(theme.value), this.schemaReadModelRootId, this.structureId);
        };
        StructureSchemaMangerComponent.prototype.toggleRowColoring = function (schemaRowColoring) {
            this.schemaCommandInvoker.setRowColoring(this.toRowColoring(schemaRowColoring.value), this.schemaReadModelRootId);
        };
        StructureSchemaMangerComponent.prototype.toggleVerticalGrid = function (verticalGrid) {
            this.schemaCommandInvoker.setVerticalGrid(verticalGrid, this.schemaReadModelRootId);
        };
        StructureSchemaMangerComponent.prototype.toggleHorizontalGrid = function (horizontalGrid) {
            this.schemaCommandInvoker.setHorizontalGrid(horizontalGrid, this.schemaReadModelRootId);
        };
        StructureSchemaMangerComponent.prototype.getSelectorName = function () {
            return 'gui-structure-schema-manager';
        };
        StructureSchemaMangerComponent.prototype.toTheme = function (theme) {
            switch (theme.toLowerCase()) {
                case 'fabric':
                    return SchemaTheme.FABRIC;
                case 'material':
                    return SchemaTheme.MATERIAL;
                case 'generic':
                    return SchemaTheme.GENERIC;
                case 'light':
                    return SchemaTheme.LIGHT;
                case 'dark':
                    return SchemaTheme.DARK;
                default:
                    return SchemaTheme.FABRIC;
            }
        };
        StructureSchemaMangerComponent.prototype.toRowColoring = function (coloring) {
            switch (coloring.toLowerCase()) {
                case 'none':
                    return RowColoring.NONE;
                case 'odd':
                    return RowColoring.ODD;
                case 'even':
                    return RowColoring.EVEN;
                default:
                    return RowColoring.NONE;
            }
        };
        return StructureSchemaMangerComponent;
    }(SmartComponent));
    StructureSchemaMangerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-schema-manager]',
                    template: "<div class=\"gui-schema-manager gui-flex gui-flex-col\">\n\n\t<div class=\"gui-dialog-title\">{{'themeManagerModalTitle' | guiTranslate}}</div>\n\n\t<div class=\"gui-structure-schema-manager-select gui-flex gui-flex-col gui-mb-10\">\n\t\t<span class=\"gui-mb-4\">{{'themeManagerModalTheme' | guiTranslate}}</span>\n\t\t<gui-select (optionChanged)=\"toggleTheme($event)\"\n\t\t\t\t\t[options]=\"themes\"\n\t\t\t\t\t[placeholder]=\"'Select theme'\"\n\t\t\t\t\t[selected]=\"selectedTheme\">\n\t\t</gui-select>\n\t</div>\n\n\t<div class=\"gui-structure-schema-manager-select gui-flex gui-flex-col\">\n\n\t\t<span class=\"gui-mb-4\">\n\t\t\t{{'themeManagerModalRowColoring' | guiTranslate}}\n\t\t</span>\n\n\t\t<gui-select (optionChanged)=\"toggleRowColoring($event)\"\n\t\t\t\t\t[options]=\"coloring\"\n\t\t\t\t\t[selected]=\"selectedRowColoring\">\n\t\t</gui-select>\n\t</div>\n\n\t<gui-checkbox (changed)=\"toggleVerticalGrid($event)\"\n\t\t\t\t  [checked]=\"verticalGrid\"\n\t\t\t\t  class=\"gui-mt-14\">\n\t\t{{'themeManagerModalVerticalGrid' | guiTranslate}}\n\t</gui-checkbox>\n\n\t<gui-checkbox (changed)=\"toggleHorizontalGrid($event)\"\n\t\t\t\t  [checked]=\"horizontalGrid\"\n\t\t\t\t  class=\"gui-mt-10\">\n\t\t{{'themeManagerModalHorizontalGrid' | guiTranslate}}\n\t</gui-checkbox>\n\n</div>\n",
                    encapsulation: core.ViewEncapsulation.None,
                    changeDetection: core.ChangeDetectionStrategy.OnPush
                },] }
    ];
    StructureSchemaMangerComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: SchemaReadModelRootId },
        { type: SchemaCommandInvoker },
        { type: SchemaWarehouse }
    ]; };

    var StructureSchemaManagerIconComponent = /** @class */ (function (_super) {
        __extends(StructureSchemaManagerIconComponent, _super);
        function StructureSchemaManagerIconComponent(elRef, cdr) {
            return _super.call(this, elRef, cdr) || this;
        }
        StructureSchemaManagerIconComponent.prototype.getSelectorName = function () {
            return 'gui-structure-schema-manager-icon';
        };
        return StructureSchemaManagerIconComponent;
    }(IconComponent));
    StructureSchemaManagerIconComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-schema-manager-icon]',
                    template: "<svg height=\"24\" viewBox=\"0 0 32 24\" width=\"32\" xmlns=\"http://www.w3.org/2000/svg\">\n\t<g transform=\"translate(0 -4)\">\n\t\t<path d=\"M23.337,4H32v6H23.337Z\" data-name=\"Path 303\" id=\"Path_303\"/>\n\t\t<path d=\"M11.662,4h8.662v6H11.662Z\" data-name=\"Path 304\" id=\"Path_304\"/>\n\t\t<path d=\"M0,4H8.662v6H0Z\" data-name=\"Path 305\" id=\"Path_305\"/>\n\t\t<path d=\"M23.337,22H32v6H23.337Z\" data-name=\"Path 306\" id=\"Path_306\"/>\n\t\t<path d=\"M0,22H8.662v6H0Z\" data-name=\"Path 307\" id=\"Path_307\"/>\n\t\t<path d=\"M11.662,22h8.662v6H11.662Z\" data-name=\"Path 308\" id=\"Path_308\"/>\n\t\t<path d=\"M23.337,13H32v6H23.337Z\" data-name=\"Path 309\" id=\"Path_309\"/>\n\t\t<path d=\"M11.662,13h8.662v6H11.662Z\" data-name=\"Path 310\" id=\"Path_310\"/>\n\t\t<path d=\"M0,13H8.662v6H0Z\" data-name=\"Path 311\" id=\"Path_311\"/>\n\t</g>\n</svg>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureSchemaManagerIconComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var SchemaManagerModule = /** @class */ (function () {
        function SchemaManagerModule() {
        }
        return SchemaManagerModule;
    }());
    SchemaManagerModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabricImports,
                        TranslationFeatureModule
                    ],
                    declarations: [
                        StructureSchemaMangerComponent,
                        StructureDialogSchemaManagerComponent,
                        StructureSchemaManagerIconComponent
                    ],
                    exports: [
                        StructureSchemaManagerIconComponent
                    ],
                    entryComponents: [
                        StructureDialogSchemaManagerComponent,
                        StructureSchemaMangerComponent
                    ],
                    providers: [
                        StructureDialogSchemaManagerService
                    ]
                },] }
    ];

    var ActiveFilterMenuComponent = /** @class */ (function () {
        function ActiveFilterMenuComponent() {
        }
        return ActiveFilterMenuComponent;
    }());
    ActiveFilterMenuComponent.decorators = [
        { type: core.Component, args: [{
                    template: "\n\n\t\t<h3>Active filters</h3>\n\n\t\t<div gui-active-filter-list></div>\n\n\t\t<div>\n\n\t\t\t<button gui-button\n\t\t\t\t\t[text]=\"true\">\n\t\t\t\tCancel\n\t\t\t</button>\n\n\t\t\t<button gui-button\n\t\t\t\t\t[outline]=\"true\"\n\t\t\t\t\t[primary]=\"true\">\n\t\t\t\tClear All\n\t\t\t</button>\n\t\t</div>\n\t"
                },] }
    ];

    var ActiveFilterService = /** @class */ (function (_super) {
        __extends(ActiveFilterService, _super);
        function ActiveFilterService(injector, schemaReadModelRepository, structureThemeConverter, fabricDialogService) {
            var _this = _super.call(this) || this;
            _this.injector = injector;
            _this.schemaReadModelRepository = schemaReadModelRepository;
            _this.structureThemeConverter = structureThemeConverter;
            _this.fabricDialogService = fabricDialogService;
            return _this;
        }
        ActiveFilterService.prototype.open = function (readModelId, structureId) {
            var _this = this;
            var injector = core.Injector.create({
                parent: this.injector,
                providers: [
                    { provide: SchemaReadModelRootId, useValue: readModelId },
                    { provide: StructureId, useValue: structureId }
                ]
            });
            this.schemaReadModelRepository
                .onceTheme(readModelId)
                .pipe(this.hermesTakeUntil())
                .subscribe(function (theme) {
                _this.fabricDialogService.open(ActiveFilterMenuComponent, {
                    injector: injector,
                    theme: _this.structureThemeConverter.convertTheme(theme)
                });
            });
        };
        return ActiveFilterService;
    }(hermes.Reactive));
    ActiveFilterService.decorators = [
        { type: core.Injectable }
    ];
    ActiveFilterService.ctorParameters = function () { return [
        { type: core.Injector },
        { type: SchemaWarehouse },
        { type: StructureThemeConverter },
        { type: fabric.FabricDialogService }
    ]; };

    var ActiveFilterMenuTriggerDirective = /** @class */ (function () {
        function ActiveFilterMenuTriggerDirective(el, structureId, activeFilterService, schemaReadModelRootId) {
            this.el = el;
            this.structureId = structureId;
            this.activeFilterService = activeFilterService;
            this.schemaReadModelRootId = schemaReadModelRootId;
        }
        ActiveFilterMenuTriggerDirective.prototype.ngOnInit = function () {
            // this.renderer.listen(this.el.nativeElement, 'click', () => {
            // 	this.activeFilterService.open(this.schemaReadModelRootId, this.structureId);
            // });
        };
        return ActiveFilterMenuTriggerDirective;
    }());
    ActiveFilterMenuTriggerDirective.decorators = [
        { type: core.Directive, args: [{
                    selector: '[gui-active-filter-menu-trigger]'
                },] }
    ];
    ActiveFilterMenuTriggerDirective.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: StructureId },
        { type: ActiveFilterService },
        { type: SchemaReadModelRootId }
    ]; };

    var SourceCounterFeatureModule = /** @class */ (function (_super) {
        __extends(SourceCounterFeatureModule, _super);
        function SourceCounterFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        SourceCounterFeatureModule.forComponent = function () {
            return [];
        };
        return SourceCounterFeatureModule;
    }(hermes.FeatureModule));
    SourceCounterFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        FilterMenuFeatureModule,
                        ActiveFilterListModule,
                        fabric.FabricButtonModule
                    ],
                    declarations: [
                        ActiveFilterMenuTriggerDirective,
                        ActiveFilterMenuComponent
                    ],
                    exports: [
                        ActiveFilterMenuTriggerDirective
                    ],
                    providers: [
                        ActiveFilterService
                    ],
                    entryComponents: [
                        ActiveFilterMenuComponent
                    ]
                },] }
    ];

    var StructureInfoPanelModule = /** @class */ (function () {
        function StructureInfoPanelModule() {
        }
        return StructureInfoPanelModule;
    }());
    StructureInfoPanelModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        NumberFormatterModule,
                        fabric.FabricModule,
                        StructureColumnManagerModule,
                        SchemaManagerModule,
                        SourceCounterFeatureModule,
                        TranslationFeatureModule
                    ],
                    declarations: [
                        StructureInfoPanelComponent,
                        StructureInfoModalComponent,
                        StructureInfoIconComponent
                    ],
                    exports: [
                        StructureInfoModalComponent,
                        StructureInfoPanelComponent
                    ],
                    entryComponents: [
                        StructureInfoModalComponent
                    ],
                    providers: [
                        StructureInfoPanelConfigConverter
                    ]
                },] }
    ];

    var GenericBuilder = /** @class */ (function () {
        function GenericBuilder() {
        }
        GenericBuilder.prototype.build = function () {
            return this.buildObject();
        };
        return GenericBuilder;
    }());

    var StructurePagingDefinitionBuilder = /** @class */ (function (_super) {
        __extends(StructurePagingDefinitionBuilder, _super);
        function StructurePagingDefinitionBuilder(enabled) {
            var _this = _super.call(this) || this;
            _this.enabled = enabled;
            return _this;
        }
        StructurePagingDefinitionBuilder.prototype.withEnabled = function (enabled) {
            this.enabled = enabled;
            return this;
        };
        StructurePagingDefinitionBuilder.prototype.buildObject = function () {
            return new PagingDefinition(this.enabled);
        };
        return StructurePagingDefinitionBuilder;
    }(GenericBuilder));
    var StructurePagingDefinitionDefaultBuilder = /** @class */ (function (_super) {
        __extends(StructurePagingDefinitionDefaultBuilder, _super);
        function StructurePagingDefinitionDefaultBuilder() {
            return _super.call(this, StructurePagingDefinitionDefaultBuilder.defaultEnabled) || this;
        }
        return StructurePagingDefinitionDefaultBuilder;
    }(StructurePagingDefinitionBuilder));
    StructurePagingDefinitionDefaultBuilder.defaultEnabled = true;
    var PagingDefinition = /** @class */ (function () {
        function PagingDefinition(enabled) {
            this.enabled = enabled;
        }
        PagingDefinition.prototype.isEnabled = function () {
            return this.enabled;
        };
        return PagingDefinition;
    }());
    PagingDefinition.Builder = StructurePagingDefinitionBuilder;
    PagingDefinition.DefaultBuilder = StructurePagingDefinitionDefaultBuilder;

    var StructureDefinitionBuilder = /** @class */ (function (_super) {
        __extends(StructureDefinitionBuilder, _super);
        function StructureDefinitionBuilder(headerEnabled, bottomPaging, topPaging) {
            var _this = _super.call(this) || this;
            _this.headerEnabled = headerEnabled;
            _this.bottomPaging = bottomPaging;
            _this.topPaging = topPaging;
            _this.border = true;
            return _this;
        }
        StructureDefinitionBuilder.prototype.withHeader = function (enabled) {
            this.headerEnabled = enabled;
            return this;
        };
        StructureDefinitionBuilder.prototype.withBottomPaging = function (paging) {
            this.bottomPaging = paging;
            return this;
        };
        StructureDefinitionBuilder.prototype.withTopPaging = function (paging) {
            this.topPaging = paging;
            return this;
        };
        StructureDefinitionBuilder.prototype.withBorder = function (enabled) {
            this.border = enabled;
            return this;
        };
        StructureDefinitionBuilder.prototype.buildObject = function () {
            return new StructureDefinition(this.headerEnabled, this.bottomPaging, this.topPaging, this.border);
        };
        return StructureDefinitionBuilder;
    }(GenericBuilder));
    var StructureDefinitionDefaultBuilder = /** @class */ (function (_super) {
        __extends(StructureDefinitionDefaultBuilder, _super);
        function StructureDefinitionDefaultBuilder() {
            return _super.call(this, StructureDefinitionDefaultBuilder.defaultHeaderEnabled, StructureDefinitionDefaultBuilder.defaultBottomPaging, StructureDefinitionDefaultBuilder.defaultTopPaging) || this;
        }
        return StructureDefinitionDefaultBuilder;
    }(StructureDefinitionBuilder));
    StructureDefinitionDefaultBuilder.defaultHeaderEnabled = true;
    StructureDefinitionDefaultBuilder.defaultBottomPaging = new PagingDefinition.DefaultBuilder().build();
    StructureDefinitionDefaultBuilder.defaultTopPaging = new PagingDefinition.DefaultBuilder().build();
    var StructureDefinition = /** @class */ (function () {
        function StructureDefinition(headerEnabled, bottomPaging, topPaging, border) {
            this.headerEnabled = headerEnabled;
            this.bottomPaging = bottomPaging;
            this.topPaging = topPaging;
            this.border = border;
        }
        StructureDefinition.prototype.isHeaderEnabled = function () {
            return this.headerEnabled;
        };
        StructureDefinition.prototype.isBorderEnabled = function () {
            return this.border;
        };
        StructureDefinition.prototype.getBottomPaging = function () {
            return this.bottomPaging;
        };
        StructureDefinition.prototype.getTopPaging = function () {
            return this.topPaging;
        };
        return StructureDefinition;
    }());
    StructureDefinition.Builder = StructureDefinitionBuilder;
    StructureDefinition.DefaultBuilder = StructureDefinitionDefaultBuilder;

    var SchemaCssClassManager = /** @class */ (function (_super) {
        __extends(SchemaCssClassManager, _super);
        function SchemaCssClassManager(schemaReadModelRepository) {
            var _this = _super.call(this) || this;
            _this.schemaReadModelRepository = schemaReadModelRepository;
            _this.cssClass = null;
            _this.classModifier = new ClassModifier();
            return _this;
        }
        SchemaCssClassManager.prototype.init = function (elementRef, schemaReadModelRootId) {
            var _this = this;
            this.cssHostRef = elementRef;
            this.schemaReadModelRepository
                .onCssClasses(schemaReadModelRootId)
                .pipe(this.hermesTakeUntil())
                .subscribe(function (classes) {
                var diff = _this.updateState(classes);
                _this.renderCssClasses(diff);
            });
        };
        SchemaCssClassManager.prototype.updateState = function (css) {
            var _this = this;
            if (!this.cssClass) {
                this.cssClass = css;
                return this.cssClass;
            }
            else {
                var diff_1 = {};
                Object.keys(this.cssClass)
                    .forEach(function (key) {
                    if (css[key] !== _this.cssClass[key]) {
                        diff_1[key] = css[key];
                    }
                });
                this.cssClass = css;
                return diff_1;
            }
        };
        SchemaCssClassManager.prototype.renderCssClasses = function (diff) {
            if (diff.hasOwnProperty('verticalGrid')) {
                this.toggleCssClass(diff.verticalGrid, SchemaCssClassManager.VERTICAL_GRID_CLASS_NAME);
            }
            if (diff.hasOwnProperty('horizontalGrid')) {
                this.toggleCssClass(diff.horizontalGrid, SchemaCssClassManager.HORIZONTAL_GRID_CLASS_NAME);
            }
            if (diff.hasOwnProperty('theme')) {
                this.removeThemeCssClasses();
                this.addClass(this.resolveThemeClassName(diff.theme));
            }
            if (diff.hasOwnProperty('rowColoring')) {
                this.removeRowColoringClasses();
                this.addClass(this.resolveRowColoringClassName(diff.rowColoring));
            }
        };
        SchemaCssClassManager.prototype.toggleCssClass = function (toggle, cssClassName) {
            if (toggle) {
                this.addClass(cssClassName);
            }
            else {
                this.removeClass(cssClassName);
            }
        };
        SchemaCssClassManager.prototype.removeThemeCssClasses = function () {
            var _this = this;
            Object.keys(SchemaTheme)
                .map(function (key) { return SchemaTheme[key]; })
                .map(function (theme) { return _this.resolveThemeClassName(theme); })
                .filter(function (className) { return !!className; })
                .forEach(function (className) {
                _this.removeClass(className);
            });
        };
        SchemaCssClassManager.prototype.resolveThemeClassName = function (theme) {
            switch (theme) {
                case SchemaTheme.FABRIC:
                case SchemaTheme[SchemaTheme.FABRIC]:
                    return SchemaCssClassManager.THEME_FABRIC_CLASS_NAME;
                case SchemaTheme.MATERIAL:
                case SchemaTheme[SchemaTheme.MATERIAL]:
                    return SchemaCssClassManager.THEME_MATERIAL_CLASS_NAME;
                case SchemaTheme.LIGHT:
                case SchemaTheme[SchemaTheme.LIGHT]:
                    return SchemaCssClassManager.THEME_LIGHT_CLASS_NAME;
                case SchemaTheme.DARK:
                case SchemaTheme[SchemaTheme.DARK]:
                    return SchemaCssClassManager.THEME_DARK_CLASS_NAME;
                case SchemaTheme.GENERIC:
                case SchemaTheme[SchemaTheme.GENERIC]:
                    return SchemaCssClassManager.THEME_GENERIC_CLASS_NAME;
                default:
                    return SchemaCssClassManager.THEME_FABRIC_CLASS_NAME;
            }
        };
        SchemaCssClassManager.prototype.resolveRowColoringClassName = function (coloring) {
            switch (coloring) {
                case SchemaRowColoring.ODD:
                case SchemaRowColoring[SchemaRowColoring.ODD]:
                    return SchemaCssClassManager.ROW_COLORING_ODD;
                case SchemaRowColoring.EVEN:
                case SchemaRowColoring[SchemaRowColoring.EVEN]:
                    return SchemaCssClassManager.ROW_COLORING_EVEN;
                default:
                    return null;
            }
        };
        SchemaCssClassManager.prototype.removeRowColoringClasses = function () {
            var _this = this;
            Object.keys(SchemaRowColoring)
                .map(function (key) { return SchemaRowColoring[key]; })
                .map(function (coloring) { return _this.resolveRowColoringClassName(coloring); })
                .filter(function (className) { return !!className; })
                .forEach(function (className) {
                _this.removeClass(className);
            });
        };
        SchemaCssClassManager.prototype.addClass = function (cssClassName) {
            if (cssClassName) {
                this.classModifier.getElement(this.cssHostRef.nativeElement).add(cssClassName);
            }
        };
        SchemaCssClassManager.prototype.removeClass = function (cssClassName) {
            if (cssClassName) {
                this.classModifier.getElement(this.cssHostRef.nativeElement).remove(cssClassName);
            }
        };
        return SchemaCssClassManager;
    }(hermes.Reactive));
    SchemaCssClassManager.VERTICAL_GRID_CLASS_NAME = 'gui-vertical-grid';
    SchemaCssClassManager.HORIZONTAL_GRID_CLASS_NAME = 'gui-horizontal-grid';
    SchemaCssClassManager.THEME_FABRIC_CLASS_NAME = 'gui-fabric';
    SchemaCssClassManager.THEME_MATERIAL_CLASS_NAME = 'gui-material';
    SchemaCssClassManager.THEME_LIGHT_CLASS_NAME = 'gui-light';
    SchemaCssClassManager.THEME_DARK_CLASS_NAME = 'gui-dark';
    SchemaCssClassManager.THEME_GENERIC_CLASS_NAME = 'gui-generic';
    SchemaCssClassManager.ROW_COLORING_ODD = 'gui-rows-odd';
    SchemaCssClassManager.ROW_COLORING_EVEN = 'gui-rows-even';
    SchemaCssClassManager.decorators = [
        { type: core.Injectable }
    ];
    SchemaCssClassManager.ctorParameters = function () { return [
        { type: SchemaWarehouse }
    ]; };

    var StructureCellEditStore = /** @class */ (function (_super) {
        __extends(StructureCellEditStore, _super);
        function StructureCellEditStore() {
            return _super.call(this) || this;
        }
        return StructureCellEditStore;
    }(hermes.Archive));
    StructureCellEditStore.decorators = [
        { type: core.Injectable }
    ];
    StructureCellEditStore.ctorParameters = function () { return []; };

    var StructureEditModeArchive = /** @class */ (function (_super) {
        __extends(StructureEditModeArchive, _super);
        function StructureEditModeArchive() {
            return _super.call(this) || this;
        }
        return StructureEditModeArchive;
    }(hermes.Archive));
    StructureEditModeArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureEditModeArchive.ctorParameters = function () { return []; };

    var structureComponentToken = new core.InjectionToken('StructureComponentToken');

    var CompositionEventRepository = /** @class */ (function (_super) {
        __extends(CompositionEventRepository, _super);
        function CompositionEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        return CompositionEventRepository;
    }(hermes.EventRepository));
    CompositionEventRepository.decorators = [
        { type: core.Injectable }
    ];
    CompositionEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var SelectedRow = /** @class */ (function () {
        function SelectedRow(source, index, itemId) {
            this.source = source;
            this.index = index;
            this.itemId = itemId;
        }
        SelectedRow.prototype.getSource = function () {
            return this.source;
        };
        SelectedRow.prototype.getIndex = function () {
            return this.index;
        };
        SelectedRow.prototype.getItemId = function () {
            return this.itemId;
        };
        return SelectedRow;
    }());

    var SelectedRowChangedEvent = /** @class */ (function (_super) {
        __extends(SelectedRowChangedEvent, _super);
        function SelectedRowChangedEvent(structureId, selectedRows, allSelected, allUnselected) {
            var _this = _super.call(this, structureId, { selectedRows: selectedRows, allSelected: allSelected, allUnselected: allUnselected }, 'SelectedRowChangedEvent') || this;
            _this.selectedRows = selectedRows;
            _this.allSelected = allSelected;
            _this.allUnselected = allUnselected;
            return _this;
        }
        SelectedRowChangedEvent.prototype.getSelectedRows = function () {
            return this.selectedRows;
        };
        SelectedRowChangedEvent.prototype.isAllSelected = function () {
            return this.allSelected;
        };
        SelectedRowChangedEvent.prototype.isAllUnselected = function () {
            return this.allUnselected;
        };
        return SelectedRowChangedEvent;
    }(StructureDomainEvent));

    var FormationEventRepository = /** @class */ (function (_super) {
        __extends(FormationEventRepository, _super);
        function FormationEventRepository(domainEventBus, sourceWarehouse) {
            var _this = _super.call(this, domainEventBus) || this;
            _this.sourceWarehouse = sourceWarehouse;
            _this.map = new Map();
            _this.subject$ = new hermes.HermesSubject();
            domainEventBus
                .ofEvents([
                SelectedRowChangedEvent
            ])
                .pipe(hermes.hermesSwitchMap(function (event) {
                var selectedRows = event.getSelectedRows();
                var structureId = event.getAggregateId();
                return _this.sourceWarehouse
                    .onPreparedEntities(structureId)
                    .pipe(hermes.hermesTake(1), hermes.hermesMap(function (items) {
                    var selectedItems = [], length = items.length, itemsMap = new Map();
                    for (var i = 0; i < length; i += 1) {
                        itemsMap.set(items[i].getId().toString(), items[i]);
                    }
                    for (var j = 0; j < selectedRows.length; j += 1) {
                        var item = itemsMap.get(selectedRows[j]);
                        selectedItems.push(new SelectedRow(item.getSourceItem(), j, item.getId()));
                    }
                    return {
                        id: structureId,
                        items: selectedItems
                    };
                }));
            }))
                .subscribe(function (e) {
                _this.map.set(e.id.toString(), e.items);
                _this.subject$.next(_this.map);
            });
            return _this;
        }
        FormationEventRepository.prototype.onItemSelected = function (structureId) {
            return this.subject$
                .toObservable()
                .pipe(hermes.hermesFilter(function (map) {
                return map.has(structureId.toString());
            }), hermes.hermesMap(function (map) {
                return map.get(structureId.toString());
            }));
        };
        return FormationEventRepository;
    }(hermes.EventRepository));
    FormationEventRepository.decorators = [
        { type: core.Injectable }
    ];
    FormationEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus },
        { type: SourceWarehouse }
    ]; };

    var StructureCellEditState;
    (function (StructureCellEditState) {
        StructureCellEditState[StructureCellEditState["ENTER"] = 0] = "ENTER";
        StructureCellEditState[StructureCellEditState["SUBMIT"] = 1] = "SUBMIT";
        StructureCellEditState[StructureCellEditState["CANCEL"] = 2] = "CANCEL";
    })(StructureCellEditState || (StructureCellEditState = {}));

    var RowSelectEnabledRepository = /** @class */ (function (_super) {
        __extends(RowSelectEnabledRepository, _super);
        function RowSelectEnabledRepository() {
            return _super.call(this) || this;
        }
        return RowSelectEnabledRepository;
    }(hermes.AggregateArchive));
    RowSelectEnabledRepository.decorators = [
        { type: core.Injectable }
    ];
    RowSelectEnabledRepository.ctorParameters = function () { return []; };

    var StructureHeaderBottomEnabledArchive = /** @class */ (function (_super) {
        __extends(StructureHeaderBottomEnabledArchive, _super);
        function StructureHeaderBottomEnabledArchive() {
            return _super.call(this, false) || this;
        }
        return StructureHeaderBottomEnabledArchive;
    }(hermes.Archive));
    StructureHeaderBottomEnabledArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureHeaderBottomEnabledArchive.ctorParameters = function () { return []; };

    var SchemaEventRepository = /** @class */ (function (_super) {
        __extends(SchemaEventRepository, _super);
        function SchemaEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        return SchemaEventRepository;
    }(hermes.EventRepository));
    SchemaEventRepository.decorators = [
        { type: core.Injectable }
    ];
    SchemaEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var StructureInfoPanelConfigService = /** @class */ (function () {
        function StructureInfoPanelConfigService(structureInfoPanelConfigConverter, structureInfoPanelArchive) {
            this.structureInfoPanelConfigConverter = structureInfoPanelConfigConverter;
            this.structureInfoPanelArchive = structureInfoPanelArchive;
        }
        StructureInfoPanelConfigService.prototype.set = function (config) {
            var infoPanelConfig = this.structureInfoPanelConfigConverter.convert(config);
            this.structureInfoPanelArchive.next(infoPanelConfig);
        };
        return StructureInfoPanelConfigService;
    }());
    StructureInfoPanelConfigService.decorators = [
        { type: core.Injectable }
    ];
    StructureInfoPanelConfigService.ctorParameters = function () { return [
        { type: StructureInfoPanelConfigConverter },
        { type: StructureInfoPanelArchive }
    ]; };

    var SetSortingCommand = /** @class */ (function (_super) {
        __extends(SetSortingCommand, _super);
        function SetSortingCommand(structureId, sortingConfig) {
            var _this = _super.call(this, structureId, 'SetSortingCommand') || this;
            _this.sortingConfig = sortingConfig;
            return _this;
        }
        SetSortingCommand.prototype.getSortingConfig = function () {
            return this.sortingConfig;
        };
        return SetSortingCommand;
    }(StructureCommand));

    var ToggleSortCommand = /** @class */ (function (_super) {
        __extends(ToggleSortCommand, _super);
        function ToggleSortCommand(structureId, compositionId, fieldId) {
            var _this = _super.call(this, structureId, 'ToggleSortCommand') || this;
            _this.compositionId = compositionId;
            _this.fieldId = fieldId;
            return _this;
        }
        ToggleSortCommand.prototype.getCompositionId = function () {
            return this.compositionId;
        };
        ToggleSortCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        return ToggleSortCommand;
    }(StructureCommand));

    var SetSortOrderCommand = /** @class */ (function (_super) {
        __extends(SetSortOrderCommand, _super);
        function SetSortOrderCommand(structureId, compositionId, fieldId, sortOrder) {
            var _this = _super.call(this, structureId, 'SetSortOrderCommand') || this;
            _this.compositionId = compositionId;
            _this.fieldId = fieldId;
            _this.sortOrder = sortOrder;
            return _this;
        }
        SetSortOrderCommand.prototype.getCompositionId = function () {
            return this.compositionId;
        };
        SetSortOrderCommand.prototype.getFieldId = function () {
            return this.fieldId;
        };
        SetSortOrderCommand.prototype.getSortOrder = function () {
            return this.sortOrder;
        };
        return SetSortOrderCommand;
    }(StructureCommand));

    var SortingCommandInvoker = /** @class */ (function () {
        function SortingCommandInvoker(commandDispatcher) {
            this.commandDispatcher = commandDispatcher;
        }
        SortingCommandInvoker.prototype.setSortingConfig = function (config, structureId) {
            this.commandDispatcher.dispatch(new SetSortingCommand(structureId, config));
        };
        SortingCommandInvoker.prototype.toggleSort = function (fieldId, compositionId, structureId) {
            this.commandDispatcher.dispatch(new ToggleSortCommand(structureId, compositionId, fieldId));
        };
        SortingCommandInvoker.prototype.setSortOrder = function (fieldId, sortOrder, compositionId, structureId) {
            this.commandDispatcher.dispatch(new SetSortOrderCommand(structureId, compositionId, fieldId, sortOrder));
        };
        return SortingCommandInvoker;
    }());
    SortingCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SortingCommandInvoker.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var ColumnFieldId = /** @class */ (function () {
        function ColumnFieldId(id) {
            this.id = id;
        }
        ColumnFieldId.prototype.getId = function () {
            return this.id;
        };
        return ColumnFieldId;
    }());

    var ColumnParams = /** @class */ (function () {
        function ColumnParams(column, field) {
            this.column = column;
            this.field = field;
        }
        ColumnParams.prototype.getColumn = function () {
            return this.column;
        };
        ColumnParams.prototype.getField = function () {
            return this.field;
        };
        return ColumnParams;
    }());

    var StructureColumnInputHandler = /** @class */ (function () {
        function StructureColumnInputHandler(structureId, compositionId, commandDispatcher, domainEventBus, columnFieldFactory, columnAutoConfigurator, compositionCommandInvoker) {
            this.structureId = structureId;
            this.compositionId = compositionId;
            this.commandDispatcher = commandDispatcher;
            this.domainEventBus = domainEventBus;
            this.columnFieldFactory = columnFieldFactory;
            this.columnAutoConfigurator = columnAutoConfigurator;
            this.compositionCommandInvoker = compositionCommandInvoker;
        }
        StructureColumnInputHandler.prototype.handle = function (changes) {
            var _this = this;
            var config = [];
            if (changes.columns !== undefined && changes.columns.currentValue !== undefined) {
                config = changes.columns.currentValue;
                this.columns = config;
            }
            else {
                if (this.columns === undefined && changes.source !== undefined && changes.source !== null) {
                    config = this.columnAutoConfigurator.configure(changes.source.currentValue);
                    this.columns = config;
                }
                else {
                    return;
                }
            }
            this.compositionCommandInvoker.setGroups(config, this.compositionId);
            // prepare model
            var _a = this.getConfigs(config), columns = _a.columns, groups = _a.groups;
            var fieldConfigs = this.getFieldConfigs(columns);
            // const fieldConfigs = columns as Array<FieldConfig>;
            var initCommand = new InitFieldsCommand(this.structureId, fieldConfigs);
            this.domainEventBus
                .ofEvents([
                FieldsInitedEvent
            ])
                .pipe(hermes.hermesFilter(function (event) { return event.getAggregateId().toString() === _this.structureId.toString(); }), hermes.hermesTake(1))
                .subscribe(function (event) {
                var fields = event.getFields(), columnFieldIds = _this.convertColumnFieldIds(fields), params = _this.convertColumns(columns, fields, columnFieldIds);
                _this.compositionCommandInvoker.setColumns(params, _this.compositionId);
                // this.compositionCommandInvoker.setGroups(this.compositionId);
            });
            this.commandDispatcher.dispatch(initCommand);
        };
        StructureColumnInputHandler.prototype.getConfigs = function (configs) {
            var columnConfigs = [];
            var groupConfigs = [];
            for (var i = 0; i < configs.length; i += 1) {
                var config = configs[i];
                if (config.columns !== undefined) {
                    groupConfigs.push(config);
                    columnConfigs = columnConfigs.concat(config.columns);
                }
                else {
                    columnConfigs.push(config);
                }
            }
            return {
                columns: columnConfigs,
                groups: groupConfigs
            };
        };
        StructureColumnInputHandler.prototype.getFieldConfigs = function (columns) {
            return columns.map(function (c) {
                return {
                    field: c.field,
                    type: c.type,
                    matcher: c.matcher,
                    summaries: c.summaries,
                    sorting: c.sorting
                };
            });
        };
        StructureColumnInputHandler.prototype.convertColumnFieldIds = function (fields) {
            if (!fields) {
                return [];
            }
            return fields.map(function (field) { return new ColumnFieldId(field.getId().getId()); });
        };
        StructureColumnInputHandler.prototype.convertColumns = function (columns, fields, columnFieldIds) {
            var _this = this;
            if (!columns) {
                return [];
            }
            return columns.map(function (column, index) {
                var columnFieldId = columnFieldIds[index], field = fields[index];
                var columnField = _this.columnFieldFactory.create(columnFieldId, field.getAccessorMethod(), field.getDataType(), field.getSearchAccessorMethod());
                return new ColumnParams(column, columnField);
            });
        };
        return StructureColumnInputHandler;
    }());

    var ColumnField = /** @class */ (function () {
        function ColumnField(fieldId, accessor, dataType, searchAccessor) {
            this.fieldId = fieldId;
            this.accessor = accessor;
            this.dataType = dataType;
            this.searchAccessor = searchAccessor;
        }
        ColumnField.prototype.getId = function () {
            return this.fieldId;
        };
        ColumnField.prototype.getValue = function (entity) {
            return this.accessor(entity);
        };
        ColumnField.prototype.getAccessor = function () {
            return this.accessor;
        };
        ColumnField.prototype.getSearchAccessor = function () {
            return this.searchAccessor;
        };
        ColumnField.prototype.getDataType = function () {
            return this.dataType;
        };
        return ColumnField;
    }());

    var ColumnFieldFactory = /** @class */ (function () {
        function ColumnFieldFactory() {
        }
        ColumnFieldFactory.prototype.create = function (columnFieldId, accessor, dataType, searchAccessor) {
            return new ColumnField(columnFieldId, accessor, dataType, searchAccessor);
        };
        return ColumnFieldFactory;
    }());
    ColumnFieldFactory.decorators = [
        { type: core.Injectable }
    ];

    var RowSelectionType;
    (function (RowSelectionType) {
        RowSelectionType[RowSelectionType["ROW"] = 0] = "ROW";
        RowSelectionType[RowSelectionType["CHECKBOX"] = 1] = "CHECKBOX";
    })(RowSelectionType || (RowSelectionType = {}));
    var RowSelectionMode;
    (function (RowSelectionMode) {
        RowSelectionMode[RowSelectionMode["SINGLE"] = 0] = "SINGLE";
        RowSelectionMode[RowSelectionMode["MULTIPLE"] = 1] = "MULTIPLE";
    })(RowSelectionMode || (RowSelectionMode = {}));
    var RowSelection = /** @class */ (function () {
        function RowSelection(config) {
            if (config.enabled !== undefined) {
                this.enabled = config.enabled;
            }
            if (config.mode !== undefined) {
                this.mode = config.mode;
            }
            if (config.type !== undefined) {
                this.type = config.type;
            }
        }
        RowSelection.prototype.isModeDefined = function () {
            return this.mode !== undefined;
        };
        RowSelection.prototype.isTypeDefined = function () {
            return this.type !== undefined;
        };
        RowSelection.prototype.isEnabledDefined = function () {
            return this.enabled !== undefined;
        };
        RowSelection.prototype.isEnabled = function () {
            return this.enabled;
        };
        RowSelection.prototype.getMode = function () {
            return this.mode;
        };
        RowSelection.prototype.getType = function () {
            return this.type;
        };
        return RowSelection;
    }());
    // eslint-disable-next-line @typescript-eslint/member-ordering
    RowSelection.Builder = /** @class */ (function (_super) {
        __extends(RowSelectionBuilder, _super);
        function RowSelectionBuilder() {
            return _super.call(this) || this;
        }
        RowSelectionBuilder.prototype.buildObject = function () {
            return new RowSelection({
                enabled: this.enabled,
                type: this.type,
                mode: this.mode
            });
        };
        RowSelectionBuilder.prototype.withEnabled = function (enabled) {
            this.enabled = enabled;
            return this;
        };
        RowSelectionBuilder.prototype.withType = function (type) {
            this.type = type;
            return this;
        };
        RowSelectionBuilder.prototype.withMode = function (mode) {
            this.mode = mode;
            return this;
        };
        return RowSelectionBuilder;
    }(GenericBuilder));

    var RowSelectionTypeArchive = /** @class */ (function (_super) {
        __extends(RowSelectionTypeArchive, _super);
        function RowSelectionTypeArchive() {
            return _super.call(this, RowSelectionTypeArchive.DEFAULT_ROW_SELECTION_TYPE) || this;
        }
        return RowSelectionTypeArchive;
    }(hermes.Archive));
    RowSelectionTypeArchive.DEFAULT_ROW_SELECTION_TYPE = RowSelectionType.ROW;
    RowSelectionTypeArchive.decorators = [
        { type: core.Injectable }
    ];
    RowSelectionTypeArchive.ctorParameters = function () { return []; };

    var ToggleSelectedRowCommand = /** @class */ (function (_super) {
        __extends(ToggleSelectedRowCommand, _super);
        function ToggleSelectedRowCommand(structureId, selectedRow, type) {
            var _this = _super.call(this, structureId, 'ToggleSelectedRowCommand') || this;
            _this.selectedRow = selectedRow;
            _this.type = type;
            return _this;
        }
        ToggleSelectedRowCommand.prototype.getSelectedRow = function () {
            return this.selectedRow;
        };
        ToggleSelectedRowCommand.prototype.getType = function () {
            return this.type;
        };
        return ToggleSelectedRowCommand;
    }(StructureCommand));

    var FormationDispatcher = /** @class */ (function () {
        function FormationDispatcher(commandDispatcher) {
            this.commandDispatcher = commandDispatcher;
        }
        FormationDispatcher.prototype.toggleSelectedRow = function (structureId, selectedRow, type) {
            this.commandDispatcher.dispatch(new ToggleSelectedRowCommand(structureId, selectedRow, type));
        };
        return FormationDispatcher;
    }());
    FormationDispatcher.decorators = [
        { type: core.Injectable }
    ];
    FormationDispatcher.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var SetEnabledSelectionCommand = /** @class */ (function (_super) {
        __extends(SetEnabledSelectionCommand, _super);
        function SetEnabledSelectionCommand(structureId, enabled) {
            var _this = _super.call(this, structureId, 'SetEnabledSelectionCommand') || this;
            _this.enabled = enabled;
            return _this;
        }
        SetEnabledSelectionCommand.prototype.isEnabled = function () {
            return this.enabled;
        };
        return SetEnabledSelectionCommand;
    }(StructureCommand));

    var SetSelectionModeCommand = /** @class */ (function (_super) {
        __extends(SetSelectionModeCommand, _super);
        function SetSelectionModeCommand(structureId, mode) {
            var _this = _super.call(this, structureId, 'SetSelectionModeCommand') || this;
            _this.mode = mode;
            return _this;
        }
        SetSelectionModeCommand.prototype.getMode = function () {
            return this.mode;
        };
        return SetSelectionModeCommand;
    }(StructureCommand));

    var SelectAllRowsCommand = /** @class */ (function (_super) {
        __extends(SelectAllRowsCommand, _super);
        function SelectAllRowsCommand(structureId) {
            return _super.call(this, structureId, 'SelectAllRowsCommand') || this;
        }
        return SelectAllRowsCommand;
    }(StructureCommand));

    var UnselectAllRowsCommand = /** @class */ (function (_super) {
        __extends(UnselectAllRowsCommand, _super);
        function UnselectAllRowsCommand(structureId) {
            return _super.call(this, structureId, 'UnselectAllRowsCommand') || this;
        }
        return UnselectAllRowsCommand;
    }(StructureCommand));

    var FormationCommandInvoker = /** @class */ (function () {
        function FormationCommandInvoker(commandDispatcher, formationDispatcher) {
            this.commandDispatcher = commandDispatcher;
            this.formationDispatcher = formationDispatcher;
        }
        FormationCommandInvoker.prototype.setDefaultFormation = function (structureId) {
            // this.commandDispatcher.dispatch(new )
        };
        FormationCommandInvoker.prototype.toggleSelectedRow = function (selectedRow, type, structureId) {
            this.formationDispatcher.toggleSelectedRow(structureId, selectedRow, type);
        };
        FormationCommandInvoker.prototype.changeMode = function (mode, structureId) {
            this.commandDispatcher.dispatch(new SetSelectionModeCommand(structureId, mode));
        };
        FormationCommandInvoker.prototype.setSelection = function (enabled, structureId) {
            this.commandDispatcher.dispatch(new SetEnabledSelectionCommand(structureId, enabled));
        };
        FormationCommandInvoker.prototype.selectAll = function (structureId) {
            this.commandDispatcher.dispatch(new SelectAllRowsCommand(structureId));
        };
        FormationCommandInvoker.prototype.unselectAll = function (structureId) {
            this.commandDispatcher.dispatch(new UnselectAllRowsCommand(structureId));
        };
        return FormationCommandInvoker;
    }());
    FormationCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    FormationCommandInvoker.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher },
        { type: FormationDispatcher }
    ]; };

    var SchemaRowClassArchive = /** @class */ (function (_super) {
        __extends(SchemaRowClassArchive, _super);
        function SchemaRowClassArchive() {
            return _super.call(this) || this;
        }
        return SchemaRowClassArchive;
    }(hermes.Archive));
    SchemaRowClassArchive.decorators = [
        { type: core.Injectable }
    ];
    SchemaRowClassArchive.ctorParameters = function () { return []; };

    var SchemaRowStyleArchive = /** @class */ (function (_super) {
        __extends(SchemaRowStyleArchive, _super);
        function SchemaRowStyleArchive() {
            return _super.call(this) || this;
        }
        return SchemaRowStyleArchive;
    }(hermes.Archive));
    SchemaRowStyleArchive.decorators = [
        { type: core.Injectable }
    ];
    SchemaRowStyleArchive.ctorParameters = function () { return []; };

    var StructureInitialValuesReadyArchive = /** @class */ (function (_super) {
        __extends(StructureInitialValuesReadyArchive, _super);
        function StructureInitialValuesReadyArchive() {
            return _super.call(this, StructureInitialValuesReadyArchive.default) || this;
        }
        StructureInitialValuesReadyArchive.prototype.on = function (aggregateId) {
            return _super.prototype.on.call(this, aggregateId)
                .pipe(hermes.hermesFilter(function (v) { return v; }));
        };
        StructureInitialValuesReadyArchive.prototype.once = function (aggregateId) {
            return this.on(aggregateId)
                .pipe(hermes.hermesTake(1));
        };
        return StructureInitialValuesReadyArchive;
    }(hermes.AggregateArchive));
    StructureInitialValuesReadyArchive.default = false;
    StructureInitialValuesReadyArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureInitialValuesReadyArchive.ctorParameters = function () { return []; };

    var ColumnAutoConfigurator = /** @class */ (function () {
        function ColumnAutoConfigurator() {
        }
        return ColumnAutoConfigurator;
    }());
    ColumnAutoConfigurator.decorators = [
        { type: core.Injectable }
    ];

    /** @internal */
    var StructureGateway = /** @class */ (function (_super) {
        __extends(StructureGateway, _super);
        function StructureGateway(changeDetectorRef, elementRef, domainEventBus, commandDispatcher, columnAutoConfigurator, structureId, compositionId, schemaId, structureCommandInvoker, structurePagingCommandDispatcher, pagingEventRepository, sortingCommandDispatcher, searchCommandDispatcher, fieldCommandDispatcher, sourceCommandService, sourceEventService, schemaCommandInvoker, compositionCommandDispatcher, compositionEventRepository, formationEventService, structureEditModeArchive, structureCellEditArchive, structureInfoPanelConfigService, structureCellEditStore, columnFieldFactory, rowSelectEnabledArchive, rowSelectionTypeArchive, schemaRowClassArchive, schemaRowStyleArchive, formationCommandDispatcher, searchEventRepository, structureHeaderBottomEnabledArchive, schemaEventRepository, translationService, structureInitialValuesReadyArchive) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.domainEventBus = domainEventBus;
            _this.commandDispatcher = commandDispatcher;
            _this.columnAutoConfigurator = columnAutoConfigurator;
            _this.structureId = structureId;
            _this.compositionId = compositionId;
            _this.schemaId = schemaId;
            _this.structureCommandInvoker = structureCommandInvoker;
            _this.structurePagingCommandDispatcher = structurePagingCommandDispatcher;
            _this.pagingEventRepository = pagingEventRepository;
            _this.sortingCommandDispatcher = sortingCommandDispatcher;
            _this.searchCommandDispatcher = searchCommandDispatcher;
            _this.fieldCommandDispatcher = fieldCommandDispatcher;
            _this.sourceCommandService = sourceCommandService;
            _this.sourceEventService = sourceEventService;
            _this.schemaCommandInvoker = schemaCommandInvoker;
            _this.compositionCommandDispatcher = compositionCommandDispatcher;
            _this.compositionEventRepository = compositionEventRepository;
            _this.formationEventService = formationEventService;
            _this.structureEditModeArchive = structureEditModeArchive;
            _this.structureCellEditArchive = structureCellEditArchive;
            _this.structureInfoPanelConfigService = structureInfoPanelConfigService;
            _this.structureCellEditStore = structureCellEditStore;
            _this.columnFieldFactory = columnFieldFactory;
            _this.rowSelectEnabledArchive = rowSelectEnabledArchive;
            _this.rowSelectionTypeArchive = rowSelectionTypeArchive;
            _this.schemaRowClassArchive = schemaRowClassArchive;
            _this.schemaRowStyleArchive = schemaRowStyleArchive;
            _this.formationCommandDispatcher = formationCommandDispatcher;
            _this.searchEventRepository = searchEventRepository;
            _this.structureHeaderBottomEnabledArchive = structureHeaderBottomEnabledArchive;
            _this.schemaEventRepository = schemaEventRepository;
            _this.translationService = translationService;
            _this.structureInitialValuesReadyArchive = structureInitialValuesReadyArchive;
            // DOESNT WORK WITH GATE
            _this.source = [];
            /** *********************
             * OUTPUTS
             ***********************/
            _this.themeChanged = new core.EventEmitter();
            _this.columnsChanged = new core.EventEmitter();
            _this.containerWidthChanged = new core.EventEmitter();
            _this.sourceEdited = new core.EventEmitter();
            _this.cellEditEntered = new core.EventEmitter();
            _this.cellEditCanceled = new core.EventEmitter();
            _this.cellEditSubmitted = new core.EventEmitter();
            _this.changeAfterInit = false;
            _this.structureColumnInputHandler = new StructureColumnInputHandler(structureId, compositionId, commandDispatcher, domainEventBus, columnFieldFactory, columnAutoConfigurator, compositionCommandDispatcher);
            _this.translationService.setDefaultTranslation();
            return _this;
        }
        StructureGateway.prototype.ngOnChanges = function (changes) {
            var _this = this;
            ifChanged(changes.editMode, function () {
                _this.structureEditModeArchive.next(_this.editMode);
            });
            ifChanged(changes.cellEditing, function () {
                var editingConfig;
                if (typeof _this.cellEditing === 'boolean') {
                    editingConfig = {
                        enabled: _this.cellEditing
                    };
                }
                else {
                    editingConfig = _this.cellEditing;
                }
                _this.structureCommandInvoker.setCellEdit(editingConfig, _this.structureId);
            });
            ifChanged(changes.width, function (width) {
                _this.compositionCommandDispatcher.setWidth(width, _this.compositionId);
            });
            ifChanged(changes.theme, function () {
                _this.schemaCommandInvoker.setTheme(_this.theme, _this.schemaId, _this.structureId);
            });
            ifChanged(changes.rowHeight, function () {
                _this.structureCommandInvoker.setRowHeight(_this.rowHeight, _this.structureId);
            });
            ifChanged(changes.autoResizeWidth, function () {
                _this.compositionCommandDispatcher.setResizeWidth(_this.autoResizeWidth, _this.compositionId);
            });
            /**
             * Columns
             */
            this.structureColumnInputHandler.handle(changes);
            ifChanged(changes.maxHeight, function () {
                _this.structureCommandInvoker.setContainerHeight(_this.maxHeight, _this.structureId);
            });
            /**
             * Setting source should be last step
             */
            ifChanged(changes.source, function () {
                _this.sourceCommandService.setOrigin(_this.source, _this.structureId);
            });
        };
        StructureGateway.prototype.ngOnInit = function () {
            var _this = this;
            this.compositionEventRepository
                .onColumnsChanged(this.compositionId.toReadModelRootId())
                .pipe(this.takeUntil())
                .subscribe(function () {
                _this.columnsChanged.emit();
            });
            this.compositionEventRepository
                .onContainerWidthChanged(this.compositionId.toReadModelRootId())
                .pipe(this.takeUntil())
                .subscribe(function (containerWidth) {
                _this.containerWidthChanged.emit(containerWidth);
            });
            this.sourceEventService
                .onSourceEdited(this.structureId)
                .subscribe(function (values) {
                _this.sourceEdited.emit(values);
            });
            this.structureCellEditStore
                .on()
                .pipe(this.takeUntil())
                .subscribe(function (state) {
                switch (state) {
                    case StructureCellEditState.ENTER:
                        _this.cellEditEntered.emit();
                        break;
                    case StructureCellEditState.SUBMIT:
                        _this.cellEditSubmitted.emit();
                        break;
                    case StructureCellEditState.CANCEL:
                        _this.cellEditCanceled.emit();
                        break;
                    default:
                        break;
                }
            });
            this.subscribeAndEmit(this.schemaEventRepository.onThemeChanged(this.schemaId), this.themeChanged);
            this.componentInitialized();
        };
        StructureGateway.prototype.componentInitialized = function () {
            this.changeAfterInit = true;
        };
        return StructureGateway;
    }(SmartComponent));
    StructureGateway.decorators = [
        { type: core.Directive }
    ];
    StructureGateway.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: hermes.DomainEventBus },
        { type: hermes.CommandDispatcher },
        { type: ColumnAutoConfigurator },
        { type: StructureId },
        { type: CompositionId },
        { type: SchemaReadModelRootId },
        { type: StructureCommandInvoker },
        { type: PagingCommandInvoker },
        { type: PagingEventRepository },
        { type: SortingCommandInvoker },
        { type: SearchCommandInvoker },
        { type: FieldCommandInvoker },
        { type: SourceCommandInvoker },
        { type: SourceEventService },
        { type: SchemaCommandInvoker },
        { type: CompositionCommandInvoker },
        { type: CompositionEventRepository },
        { type: FormationEventRepository },
        { type: StructureEditModeArchive },
        { type: StructureCellEditArchive },
        { type: StructureInfoPanelConfigService },
        { type: StructureCellEditStore },
        { type: ColumnFieldFactory },
        { type: RowSelectEnabledRepository },
        { type: RowSelectionTypeArchive },
        { type: SchemaRowClassArchive },
        { type: SchemaRowStyleArchive },
        { type: FormationCommandInvoker },
        { type: SearchEventRepository },
        { type: StructureHeaderBottomEnabledArchive },
        { type: SchemaEventRepository },
        { type: TranslationFacade },
        { type: StructureInitialValuesReadyArchive }
    ]; };
    StructureGateway.propDecorators = {
        maxHeight: [{ type: core.Input }],
        width: [{ type: core.Input }],
        rowHeight: [{ type: core.Input }],
        autoResizeWidth: [{ type: core.Input }],
        source: [{ type: core.Input }],
        columns: [{ type: core.Input }],
        editMode: [{ type: core.Input }],
        cellEditing: [{ type: core.Input }],
        theme: [{ type: core.Input }],
        themeChanged: [{ type: core.Output }],
        columnsChanged: [{ type: core.Output }],
        containerWidthChanged: [{ type: core.Output }],
        sourceEdited: [{ type: core.Output }],
        cellEditEntered: [{ type: core.Output }],
        cellEditCanceled: [{ type: core.Output }],
        cellEditSubmitted: [{ type: core.Output }]
    };

    var StructureColumnMenuConfig = /** @class */ (function () {
        function StructureColumnMenuConfig(enabled, sort, filter, columnsManager) {
            if (enabled === void 0) { enabled = false; }
            if (sort === void 0) { sort = true; }
            if (filter === void 0) { filter = false; }
            if (columnsManager === void 0) { columnsManager = false; }
            this.enabled = enabled;
            this.sort = sort;
            this.filter = filter;
            this.columnsManager = columnsManager;
            this.mainMenu = 'Menu';
            this.filterMenu = 'Filter';
            this.columnsMenu = 'Columns';
        }
        StructureColumnMenuConfig.default = function () {
            return new StructureColumnMenuConfig();
        };
        StructureColumnMenuConfig.fromConfig = function (config) {
            return new StructureColumnMenuConfig(config.enabled, config.sort, config.filter, config.columnsManager);
        };
        StructureColumnMenuConfig.prototype.isEnabled = function () {
            return this.enabled &&
                (this.sort || this.filter || this.columnsManager);
        };
        StructureColumnMenuConfig.prototype.isMainEnabled = function () {
            return this.sort;
        };
        StructureColumnMenuConfig.prototype.isSortingEnabled = function () {
            return this.sort;
        };
        StructureColumnMenuConfig.prototype.isFilteringEnabled = function () {
            return this.filter;
        };
        StructureColumnMenuConfig.prototype.isColumnManagerEnabled = function () {
            return this.columnsManager;
        };
        StructureColumnMenuConfig.prototype.getMenus = function () {
            var menus = [];
            if (this.isMainEnabled()) {
                menus.push(this.getMainMenu());
            }
            if (this.isFilteringEnabled()) {
                menus.push(this.getFilterMenu());
            }
            if (this.isColumnManagerEnabled()) {
                menus.push(this.getColumnMenu());
            }
            return menus;
        };
        StructureColumnMenuConfig.prototype.getActiveMenu = function () {
            return this.getMenus()[0];
        };
        StructureColumnMenuConfig.prototype.getMainMenu = function () {
            return this.mainMenu;
        };
        StructureColumnMenuConfig.prototype.getFilterMenu = function () {
            return this.filterMenu;
        };
        StructureColumnMenuConfig.prototype.getColumnMenu = function () {
            return this.columnsMenu;
        };
        StructureColumnMenuConfig.prototype.setMainMenu = function (mainMenu) {
            this.mainMenu = mainMenu;
        };
        StructureColumnMenuConfig.prototype.setFilterMenu = function (filterMenu) {
            this.filterMenu = filterMenu;
        };
        StructureColumnMenuConfig.prototype.setColumnsMenu = function (columnsMenu) {
            this.columnsMenu = columnsMenu;
        };
        return StructureColumnMenuConfig;
    }());

    var StructureColumnMenuConfigArchive = /** @class */ (function (_super) {
        __extends(StructureColumnMenuConfigArchive, _super);
        function StructureColumnMenuConfigArchive() {
            return _super.call(this, StructureColumnMenuConfig.default()) || this;
        }
        StructureColumnMenuConfigArchive.prototype.nextConfig = function (config) {
            var menuConfig = StructureColumnMenuConfig.fromConfig(config);
            this.next(menuConfig);
        };
        return StructureColumnMenuConfigArchive;
    }(hermes.Archive));
    StructureColumnMenuConfigArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureColumnMenuConfigArchive.ctorParameters = function () { return []; };

    var StructureCellEditCloseAllService = /** @class */ (function () {
        function StructureCellEditCloseAllService() {
            this.closeAll$ = new hermes.HermesSubject();
        }
        StructureCellEditCloseAllService.prototype.closeAll = function () {
            this.closeAll$.next();
        };
        StructureCellEditCloseAllService.prototype.onCloseAll = function () {
            return this.closeAll$.toObservable();
        };
        return StructureCellEditCloseAllService;
    }());
    StructureCellEditCloseAllService.decorators = [
        { type: core.Injectable }
    ];

    var StructureHeaderTopEnabledArchive = /** @class */ (function (_super) {
        __extends(StructureHeaderTopEnabledArchive, _super);
        function StructureHeaderTopEnabledArchive() {
            return _super.call(this, true) || this;
        }
        return StructureHeaderTopEnabledArchive;
    }(hermes.Archive));
    StructureHeaderTopEnabledArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureHeaderTopEnabledArchive.ctorParameters = function () { return []; };

    var StructureRowDetailConfigArchive = /** @class */ (function (_super) {
        __extends(StructureRowDetailConfigArchive, _super);
        function StructureRowDetailConfigArchive() {
            return _super.call(this, {
                enabled: false,
                template: (function (item) { return 'Detail View'; })
            }) || this;
        }
        return StructureRowDetailConfigArchive;
    }(hermes.Archive));
    StructureRowDetailConfigArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureRowDetailConfigArchive.ctorParameters = function () { return []; };

    var structureRowDetailViewItem = new core.InjectionToken('structureRowDetailViewItem');
    var structureRowDetailViewTemplate = new core.InjectionToken('structureRowDetailViewTemplate');

    var DynamicallyCreatedComponent = /** @class */ (function () {
        function DynamicallyCreatedComponent() {
            this.subClassConstructor = this.constructor;
            if (this.hasInputs()) {
                this.throwError('it cannot have properties annotated with @Inputs().');
            }
        }
        DynamicallyCreatedComponent.prototype.hasInputs = function () {
            return false;
            // Works with Angular 12
            // return !this.isEmpty((this.constructor as any).ɵcmp.inputs);
        };
        DynamicallyCreatedComponent.prototype.isEmpty = function (obj) {
            for (var key in obj) {
                if (obj.hasOwnProperty(key)) {
                    return false;
                }
            }
            return true;
        };
        DynamicallyCreatedComponent.prototype.throwError = function (reason) {
            throw new Error("Component \"" + this.subClassConstructor.name + "\" is a DynamicallyCreatedComponent, " + reason + ".");
        };
        return DynamicallyCreatedComponent;
    }());
    DynamicallyCreatedComponent.decorators = [
        { type: core.Directive }
    ];
    DynamicallyCreatedComponent.ctorParameters = function () { return []; };

    var StructureRowDetailViewComponent = /** @class */ (function (_super) {
        __extends(StructureRowDetailViewComponent, _super);
        function StructureRowDetailViewComponent(item, template, sanitizer) {
            var _this = _super.call(this) || this;
            _this.item = item;
            _this.template = template;
            _this.sanitizer = sanitizer;
            _this.safeHTML = _this.sanitizer.bypassSecurityTrustHtml(_this.template(_this.item.getSource(), _this.item.getIndex()));
            return _this;
        }
        StructureRowDetailViewComponent.prototype.ngOnInit = function () {
            this.selectedRowValue = this.item.getSource();
        };
        return StructureRowDetailViewComponent;
    }(DynamicallyCreatedComponent));
    StructureRowDetailViewComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-row-detail]',
                    template: "<div [innerHTML]=\"safeHTML\"></div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureRowDetailViewComponent.ctorParameters = function () { return [
        { type: SelectedRow, decorators: [{ type: core.Inject, args: [structureRowDetailViewItem,] }] },
        { type: undefined, decorators: [{ type: core.Inject, args: [structureRowDetailViewTemplate,] }] },
        { type: platformBrowser.DomSanitizer }
    ]; };

    var StructureRowDetailService = /** @class */ (function (_super) {
        __extends(StructureRowDetailService, _super);
        function StructureRowDetailService(injector, structureId, structureDetailViewConfigArchive, formationEventService, drawerService) {
            var _this = _super.call(this) || this;
            _this.injector = injector;
            _this.structureId = structureId;
            _this.structureDetailViewConfigArchive = structureDetailViewConfigArchive;
            _this.formationEventService = formationEventService;
            _this.drawerService = drawerService;
            _this.enabled = false;
            return _this;
        }
        StructureRowDetailService.prototype.init = function (ref) {
            var _this = this;
            this.elementRef = ref;
            this.structureDetailViewConfigArchive
                .on()
                .pipe(this.hermesTakeUntil())
                .subscribe(function (config) {
                _this.config = config;
                if (config.enabled === true) {
                    _this.turnOn();
                }
                else if (config.enabled === false) {
                    _this.turnOff();
                }
            });
            this.formationEventService
                .onItemSelected(this.structureId)
                .pipe(this.hermesTakeUntil())
                .subscribe(function (items) {
                if (!_this.enabled) {
                    return;
                }
                _this.drawerService.close();
                if (items.length === 0) {
                    return;
                }
                var item = items[0];
                var injector = core.Injector.create({
                    parent: _this.injector,
                    providers: [
                        { provide: structureRowDetailViewItem, useValue: item },
                        { provide: structureRowDetailViewTemplate, useValue: _this.config.template }
                    ]
                });
                _this.drawerService.open({
                    appendToElement: _this.elementRef,
                    component: StructureRowDetailViewComponent,
                    injector: injector
                });
            });
        };
        StructureRowDetailService.prototype.turnOn = function () {
            this.enabled = true;
        };
        StructureRowDetailService.prototype.turnOff = function () {
            this.enabled = false;
        };
        return StructureRowDetailService;
    }(hermes.Reactive));
    StructureRowDetailService.decorators = [
        { type: core.Injectable }
    ];
    StructureRowDetailService.ctorParameters = function () { return [
        { type: core.Injector },
        { type: StructureId },
        { type: StructureRowDetailConfigArchive },
        { type: FormationEventRepository },
        { type: fabric.FabricDrawerService }
    ]; };

    var StructureTitlePanelConfigArchive = /** @class */ (function (_super) {
        __extends(StructureTitlePanelConfigArchive, _super);
        function StructureTitlePanelConfigArchive() {
            return _super.call(this, Object.assign({}, StructureTitlePanelConfigArchive.titlePanelConfig)) || this;
        }
        return StructureTitlePanelConfigArchive;
    }(hermes.Archive));
    StructureTitlePanelConfigArchive.titlePanelConfig = {
        enabled: false,
        template: 'Title Panel'
    };

    var StructureFooterPanelConfigArchive = /** @class */ (function (_super) {
        __extends(StructureFooterPanelConfigArchive, _super);
        function StructureFooterPanelConfigArchive() {
            return _super.call(this, Object.assign({}, StructureFooterPanelConfigArchive.footerPanelConfig)) || this;
        }
        return StructureFooterPanelConfigArchive;
    }(hermes.Archive));
    StructureFooterPanelConfigArchive.footerPanelConfig = {
        enabled: false,
        template: 'Footer Panel'
    };

    var SortToggledEvent = /** @class */ (function (_super) {
        __extends(SortToggledEvent, _super);
        function SortToggledEvent(aggregateId, compositionId, directions) {
            var _this = _super.call(this, aggregateId, { compositionId: compositionId, directions: directions }, 'SortToggledEvent') || this;
            _this.compositionId = compositionId;
            _this.directions = directions;
            return _this;
        }
        SortToggledEvent.prototype.getCompositionId = function () {
            return this.compositionId;
        };
        SortToggledEvent.prototype.getDirections = function () {
            return this.directions;
        };
        return SortToggledEvent;
    }(StructureDomainEvent));

    var ToggleSortCommandHandler = /** @class */ (function () {
        function ToggleSortCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        ToggleSortCommandHandler.prototype.forCommand = function () {
            return ToggleSortCommand;
        };
        ToggleSortCommandHandler.prototype.handle = function (structure, command) {
            var aggregateId = command.getAggregateId(), compositionId = command.getCompositionId(), fieldId = command.getFieldId();
            var sorters = structure.toggleSort(fieldId);
            this.publishSortEvent(aggregateId, compositionId, fieldId, sorters);
        };
        ToggleSortCommandHandler.prototype.publish = function (aggregate, command) {
        };
        ToggleSortCommandHandler.prototype.publishSortEvent = function (aggregateId, compositionId, fieldId, sorters) {
            var directions = sorters.map(function (sorter) {
                return {
                    direction: sorter.hasDirection(),
                    fieldId: sorter.getField().getId()
                };
            });
            this.domainEventPublisher.publish(new SortToggledEvent(aggregateId, compositionId, directions));
        };
        return ToggleSortCommandHandler;
    }());
    ToggleSortCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    ToggleSortCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var SortingSetEvent = /** @class */ (function (_super) {
        __extends(SortingSetEvent, _super);
        function SortingSetEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'SortingSetEvent') || this;
        }
        return SortingSetEvent;
    }(StructureDomainEvent));

    var SetSortingCommandHandler = /** @class */ (function () {
        function SetSortingCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetSortingCommandHandler.prototype.forCommand = function () {
            return SetSortingCommand;
        };
        SetSortingCommandHandler.prototype.handle = function (aggregate, command) {
            var sortingConfig = command.getSortingConfig();
            aggregate.setSortingConfig(sortingConfig);
        };
        SetSortingCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new SortingSetEvent(command.getAggregateId()));
        };
        return SetSortingCommandHandler;
    }());
    SetSortingCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetSortingCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SortOrderSetEvent = /** @class */ (function (_super) {
        __extends(SortOrderSetEvent, _super);
        function SortOrderSetEvent(aggregateId, compositionId, directions) {
            var _this = _super.call(this, aggregateId, { compositionId: compositionId, directions: directions }, 'SortOrderSetEvent') || this;
            _this.compositionId = compositionId;
            _this.directions = directions;
            return _this;
        }
        SortOrderSetEvent.prototype.getCompositionId = function () {
            return this.compositionId;
        };
        SortOrderSetEvent.prototype.getDirections = function () {
            return this.directions;
        };
        return SortOrderSetEvent;
    }(StructureDomainEvent));

    var SetSortOrderCommandHandler = /** @class */ (function () {
        function SetSortOrderCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        SetSortOrderCommandHandler.prototype.forCommand = function () {
            return SetSortOrderCommand;
        };
        SetSortOrderCommandHandler.prototype.handle = function (structure, command) {
            var structureId = command.getAggregateId(), compositionId = command.getCompositionId(), fieldId = command.getFieldId(), sortOrder = command.getSortOrder();
            var sorters = structure.setSortOrder(fieldId, sortOrder);
            this.publishSortEvent(structureId, compositionId, fieldId, sorters);
        };
        SetSortOrderCommandHandler.prototype.publish = function (aggregate, command) {
        };
        SetSortOrderCommandHandler.prototype.publishSortEvent = function (aggregateId, compositionId, fieldId, sorters) {
            var directions = sorters.map(function (sorter) {
                return {
                    direction: sorter.hasDirection(),
                    fieldId: sorter.getField().getId()
                };
            });
            this.domainEventPublisher.publish(new SortOrderSetEvent(aggregateId, compositionId, directions));
        };
        return SetSortOrderCommandHandler;
    }());
    SetSortOrderCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetSortOrderCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var SortingDomainModule = /** @class */ (function (_super) {
        __extends(SortingDomainModule, _super);
        function SortingDomainModule() {
            return _super.call(this) || this;
        }
        SortingDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(ToggleSortCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetSortingCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetSortOrderCommandHandler, structureKey)
            ];
        };
        return SortingDomainModule;
    }(hermes.DomainModule));
    SortingDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [],
                    declarations: [],
                    exports: []
                },] }
    ];
    SortingDomainModule.ctorParameters = function () { return []; };

    var SortingApiModule = /** @class */ (function (_super) {
        __extends(SortingApiModule, _super);
        function SortingApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return SortingApiModule;
    }(hermes.ApiModule));
    SortingApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        SortingDomainModule
                    ],
                    providers: [
                        SortingCommandInvoker
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var SortingFeatureModule = /** @class */ (function (_super) {
        __extends(SortingFeatureModule, _super);
        function SortingFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        SortingFeatureModule.forComponent = function () {
            return [];
        };
        return SortingFeatureModule;
    }(hermes.FeatureModule));
    SortingFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        SortingApiModule
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var FieldReadModel = /** @class */ (function () {
        function FieldReadModel(id, dataType, name) {
            this.id = id;
            this.dataType = dataType;
            this.name = name;
        }
        FieldReadModel.prototype.getFieldId = function () {
            return this.id;
        };
        FieldReadModel.prototype.getId = function () {
            return this.id.getId();
        };
        FieldReadModel.prototype.getDataType = function () {
            return this.dataType;
        };
        FieldReadModel.prototype.getName = function () {
            return this.name;
        };
        return FieldReadModel;
    }());

    var FieldUiConverter = /** @class */ (function () {
        function FieldUiConverter() {
        }
        FieldUiConverter.prototype.convert = function (fields) {
            var _this = this;
            return fields.map(function (field) {
                return _this.convertOne(field);
            });
        };
        FieldUiConverter.prototype.convertOne = function (field) {
            return new FieldReadModel(field.getId(), field.getDataType(), field.getName());
        };
        return FieldUiConverter;
    }());
    FieldUiConverter.decorators = [
        { type: core.Injectable }
    ];

    var FieldCollection = /** @class */ (function () {
        function FieldCollection(fieldFactory) {
            this.fieldFactory = fieldFactory;
            this.fields = new Map();
        }
        FieldCollection.prototype.getField = function (fieldId) {
            if (fieldId === null) {
                return this.getAllFields()[0];
            }
            return this.fields.get(fieldId.getId());
        };
        FieldCollection.prototype.getAllFieldIds = function () {
            return Array.from(this.fields.keys());
        };
        FieldCollection.prototype.getAllFields = function () {
            return Array.from(this.fields.values());
        };
        FieldCollection.prototype.getFieldsAsMap = function () {
            return this.fields;
        };
        FieldCollection.prototype.initFields = function (fieldConfigs) {
            var fields = this.fieldFactory.create(fieldConfigs);
            this.clear();
            this.addFields(fields);
        };
        FieldCollection.prototype.addFields = function (fields) {
            var e_1, _a;
            try {
                for (var fields_1 = __values(fields), fields_1_1 = fields_1.next(); !fields_1_1.done; fields_1_1 = fields_1.next()) {
                    var field = fields_1_1.value;
                    this.addField(field);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (fields_1_1 && !fields_1_1.done && (_a = fields_1.return)) _a.call(fields_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        };
        FieldCollection.prototype.addField = function (field) {
            this.fields.set(field.getId().toString(), field);
        };
        FieldCollection.prototype.clear = function () {
            this.fields.clear();
        };
        return FieldCollection;
    }());

    var Field = /** @class */ (function () {
        function Field(id, field, name) {
            this.id = id;
            this.field = field;
            this.name = name;
        }
        Field.of = function (id, dataField, name) {
            return new Field(id, dataField, name);
        };
        Field.prototype.getId = function () {
            return this.id;
        };
        Field.prototype.getKey = function () {
            return this.getId().toString();
        };
        Field.prototype.getDataType = function () {
            return this.field.getDataType();
        };
        Field.prototype.getName = function () {
            return this.name;
        };
        /**
         * @deprecated
         */
        Field.prototype.getField = function () {
            return this.field;
        };
        /**
         * Probably should not be used.
         *
         * @deprecated
         */
        Field.prototype.getAccessor = function () {
            return this.field.getAccessor();
        };
        /**
         * Probably should not be used.
         *
         * @deprecated
         */
        Field.prototype.getAccessorMethod = function () {
            return this.field.getAccessorMethod();
        };
        /**
         * Probably should not be used.
         *
         * @deprecated
         */
        Field.prototype.getSearchAccessorMethod = function () {
            return this.field.getSearchAccessorMethod();
        };
        Field.prototype.getValue = function (entity) {
            return this.field.getValue(entity);
        };
        Field.prototype.getDisplayValue = function (value) {
            return this.field.getDisplayValue(value);
        };
        /**
         * Probably should not be used.
         *
         * @deprecated
         */
        Field.prototype.isSummaries = function (type) {
            return this.field.isSummaries(type);
        };
        /**
         * Probably should not be used.
         *
         * @deprecated
         */
        Field.prototype.isSummariesEnabled = function () {
            return this.field.isSummariesEnabled();
        };
        Field.prototype.search = function (item, searchPhrase) {
            return this.field.search(item, searchPhrase);
        };
        Field.prototype.filter = function (item, filterPhrase) {
            var value = this.field.getValue(item);
            if (this.field.getDataType() === DataType.NUMBER) {
                return this.field.filter(value, filterPhrase);
            }
            else if (this.field.getDataType() === DataType.BOOLEAN) {
                return this.field.filter(value, filterPhrase);
            }
            else if (this.field.getDataType() === DataType.STRING) {
                return this.field.filter(value, filterPhrase);
            }
            else if (this.field.getDataType() === DataType.DATE) {
                return this.field.filter(value, filterPhrase);
            }
            else {
                return true;
            }
        };
        Field.prototype.sort = function (entityOne, entityTwo, direction) {
            var valueOne = direction ? this.field.getSortValue(entityOne) : this.field.getSortValue(entityTwo), valueTwo = direction ? this.field.getSortValue(entityTwo) : this.field.getSortValue(entityOne);
            if (this.field.getDataType() === DataType.NUMBER) {
                return this.field.sort(valueOne, valueTwo);
            }
            else if (this.field.getDataType() === DataType.BOOLEAN) {
                return this.field.sort(valueOne, valueTwo);
            }
            else if (this.field.getDataType() === DataType.STRING) {
                return this.field.sort(valueOne, valueTwo);
            }
            else if (this.field.getDataType() === DataType.DATE) {
                return this.field.sort(valueOne, valueTwo);
            }
            else {
                return 0;
            }
        };
        return Field;
    }());

    var BaseDataField = /** @class */ (function () {
        function BaseDataField(accessor, dataType, matchers) {
            this.accessor = accessor;
            this.dataType = dataType;
            this.matchers = matchers;
            if (typeof accessor === 'string') {
                this.accessorMethod = function (entity) { return entity.getSourceItem()[accessor]; };
            }
            else if (typeof accessor === 'function') {
                this.accessorMethod = function (entity) { return accessor(entity.getSourceItem()); };
            }
            else {
                this.accessorMethod = function (entity) { return entity; };
            }
        }
        BaseDataField.prototype.getDataType = function () {
            return this.dataType;
        };
        BaseDataField.prototype.getAccessor = function () {
            return this.accessor;
        };
        BaseDataField.prototype.getAccessorMethod = function () {
            return this.accessorMethod;
        };
        BaseDataField.prototype.getMatchers = function () {
            return this.matchers;
        };
        BaseDataField.prototype.getSearchAccessorMethod = function () {
            var _this = this;
            var matcher;
            this.matchers
                .getSearchMatcher()
                .ifPresent(function (m) {
                matcher = m;
            });
            if (matcher) {
                return function (entity) {
                    var val = _this.accessorMethod(entity);
                    return matcher(val);
                };
            }
            else {
                return function (entity) {
                    return _this.accessorMethod(entity);
                };
            }
        };
        BaseDataField.prototype.getValue = function (entity) {
            return this.accessorMethod(entity);
        };
        BaseDataField.prototype.getSortValue = function (entity) {
            var value = this.accessorMethod(entity);
            this.matchers
                .getSortMatcher()
                .ifPresent(function (matcher) {
                value = matcher(value);
            });
            return value;
        };
        BaseDataField.prototype.getSearchValue = function (entity) {
            var value = this.accessorMethod(entity);
            this.matchers
                .getSearchMatcher()
                .ifPresent(function (matcher) {
                value = matcher(value);
            });
            return value;
        };
        return BaseDataField;
    }());

    var DataField = /** @class */ (function (_super) {
        __extends(DataField, _super);
        function DataField(accessor, dataType, matchers, summariesConfig) {
            var _this = _super.call(this, accessor, dataType, matchers) || this;
            _this.summariesEnabled = true;
            _this.possibleSummaries = _this.assignPossibleSummaries();
            _this.assignSummaries(summariesConfig);
            return _this;
        }
        DataField.prototype.isSummaries = function (type) {
            if (!this.isSummariesEnabled()) {
                return false;
            }
            return !!(this.summariesTypes & type);
        };
        DataField.prototype.isSummariesEnabled = function () {
            return this.summariesEnabled;
        };
        DataField.prototype.setSummariesEnabled = function (enabled) {
            this.summariesEnabled = enabled;
        };
        DataField.prototype.assignSummaries = function (summariesConfig) {
            var _this = this;
            if (!!summariesConfig && Object.keys(summariesConfig).length !== 0) {
                if (summariesConfig.enabled) {
                    this.summariesEnabled = !!summariesConfig.enabled;
                }
                if (summariesConfig.summariesTypes) {
                    this.summariesTypes = 0;
                    summariesConfig.summariesTypes.forEach(function (t) {
                        _this.summariesTypes |= t;
                    });
                }
                else {
                    this.summariesTypes = this.assignDefaultSummaries();
                }
            }
            else {
                this.summariesTypes = this.assignDefaultSummaries();
            }
        };
        return DataField;
    }(BaseDataField));

    var SummariesType;
    (function (SummariesType) {
        SummariesType[SummariesType["COUNT"] = 1024] = "COUNT";
        SummariesType[SummariesType["DISTINCT"] = 1] = "DISTINCT";
        SummariesType[SummariesType["SUM"] = 2] = "SUM";
        SummariesType[SummariesType["AVERAGE"] = 4] = "AVERAGE";
        SummariesType[SummariesType["MIN"] = 8] = "MIN";
        SummariesType[SummariesType["MAX"] = 16] = "MAX";
        SummariesType[SummariesType["MEDIAN"] = 32] = "MEDIAN";
        SummariesType[SummariesType["TRUTHY"] = 64] = "TRUTHY";
        SummariesType[SummariesType["FALSY"] = 128] = "FALSY";
        SummariesType[SummariesType["EARLIEST"] = 256] = "EARLIEST";
        SummariesType[SummariesType["LATEST"] = 512] = "LATEST";
    })(SummariesType || (SummariesType = {}));
    // count
    // count distinct
    // percentile
    // std.dev
    // std.dev Pop
    // variance
    // variance pop

    var UnknownDataField = /** @class */ (function (_super) {
        __extends(UnknownDataField, _super);
        function UnknownDataField(accessor, matchers, summariesConfig) {
            return _super.call(this, accessor, DataType.UNKNOWN, matchers, summariesConfig) || this;
        }
        UnknownDataField.prototype.assignDefaultSummaries = function () {
            return 0;
            // return SummariesType.COUNT |
            // 	SummariesType.DISTINCT;
        };
        UnknownDataField.prototype.assignPossibleSummaries = function () {
            return SummariesType.COUNT |
                SummariesType.DISTINCT;
        };
        UnknownDataField.prototype.search = function (item, searchPhrase) {
            return false;
        };
        UnknownDataField.prototype.sort = function (one, two) {
            return 0;
        };
        UnknownDataField.prototype.filter = function (value, filterPhrase) {
            return false;
        };
        UnknownDataField.prototype.equals = function (item, value) {
            return false;
        };
        UnknownDataField.prototype.getDisplayValue = function (item) {
            return item;
        };
        return UnknownDataField;
    }(DataField));

    var NumberDataField = /** @class */ (function (_super) {
        __extends(NumberDataField, _super);
        function NumberDataField(accessor, matchers, summariesConfig) {
            return _super.call(this, accessor, DataType.NUMBER, matchers, summariesConfig) || this;
        }
        NumberDataField.prototype.getField = function () {
            return this;
        };
        NumberDataField.prototype.assignDefaultSummaries = function () {
            return 0;
            // return SummariesType.COUNT |
            // 	SummariesType.DISTINCT |
            // 	SummariesType.SUM |
            // 	SummariesType.MIN |
            // 	SummariesType.MAX |
            // 	SummariesType.AVERAGE |
            // 	SummariesType.MEDIAN;
        };
        NumberDataField.prototype.assignPossibleSummaries = function () {
            return SummariesType.COUNT |
                SummariesType.DISTINCT |
                SummariesType.SUM |
                SummariesType.MIN |
                SummariesType.MAX |
                SummariesType.AVERAGE |
                SummariesType.MEDIAN;
        };
        NumberDataField.prototype.search = function (item, searchPhrase) {
            return false;
        };
        NumberDataField.prototype.sort = function (numOne, numTwo) {
            var sureNumOne = +numOne, sureNumTwo = +numTwo;
            return sureNumOne - sureNumTwo;
        };
        NumberDataField.prototype.filter = function (value, filterPhrase) {
            return value > filterPhrase;
        };
        NumberDataField.prototype.equals = function (item, value) {
            return this.getValue(item) === value;
        };
        NumberDataField.prototype.getDisplayValue = function (item) {
            return "" + item;
        };
        return NumberDataField;
    }(DataField));

    var StringDataField = /** @class */ (function (_super) {
        __extends(StringDataField, _super);
        function StringDataField(accessor, matchers, summariesConfig) {
            return _super.call(this, accessor, DataType.STRING, matchers, summariesConfig) || this;
        }
        StringDataField.prototype.assignDefaultSummaries = function () {
            return 0;
            // return SummariesType.COUNT |
            // 	SummariesType.DISTINCT;
        };
        StringDataField.prototype.assignPossibleSummaries = function () {
            return SummariesType.COUNT |
                SummariesType.DISTINCT;
        };
        StringDataField.prototype.search = function (item, searchPhrase) {
            var value = this.getSearchValue(item);
            if (typeof value === 'string') {
                return value.toLowerCase().indexOf(searchPhrase.toLowerCase()) > -1;
            }
            else {
                return false;
            }
        };
        StringDataField.prototype.sort = function (strOne, strTwo) {
            var sureStrOne = '' + strOne, sureStrTwo = '' + strTwo;
            return sureStrOne.localeCompare(sureStrTwo);
        };
        StringDataField.prototype.filter = function (value, filterPhrase) {
            return value.toLowerCase().indexOf(filterPhrase.toLowerCase()) > -1;
        };
        StringDataField.prototype.equals = function (item, value) {
            return this.getValue(item) === value;
        };
        StringDataField.prototype.getDisplayValue = function (item) {
            return item;
        };
        return StringDataField;
    }(DataField));

    var BooleanDataField = /** @class */ (function (_super) {
        __extends(BooleanDataField, _super);
        function BooleanDataField(accessor, matchers, summariesConfig) {
            return _super.call(this, accessor, DataType.BOOLEAN, matchers, summariesConfig) || this;
        }
        BooleanDataField.prototype.assignDefaultSummaries = function () {
            return 0;
            // return SummariesType.COUNT |
            // 	SummariesType.DISTINCT |
            // 	SummariesType.TRUTHY |
            // 	SummariesType.FALSY;
        };
        BooleanDataField.prototype.assignPossibleSummaries = function () {
            return SummariesType.COUNT |
                SummariesType.DISTINCT |
                SummariesType.TRUTHY |
                SummariesType.FALSY;
        };
        BooleanDataField.prototype.search = function (item, searchPhrase) {
            return false;
        };
        BooleanDataField.prototype.sort = function (booleanOne, booleanTwo) {
            var sureBoolOne = !!booleanOne, sureBoolTwo = !!booleanTwo;
            return (sureBoolOne === sureBoolTwo) ? 0 : sureBoolTwo ? -1 : 1;
        };
        BooleanDataField.prototype.filter = function (value, filterPhrase) {
            return value === filterPhrase;
        };
        BooleanDataField.prototype.equals = function (item, value) {
            return this.getValue(item) === value;
        };
        BooleanDataField.prototype.getDisplayValue = function (item) {
            return item ? 'True' : 'False';
        };
        return BooleanDataField;
    }(DataField));

    var DateDataField = /** @class */ (function (_super) {
        __extends(DateDataField, _super);
        function DateDataField(accessor, matchers, summariesConfig) {
            return _super.call(this, accessor, DataType.DATE, matchers, summariesConfig) || this;
        }
        DateDataField.prototype.assignDefaultSummaries = function () {
            return 0;
            // return SummariesType.COUNT |
            // 	SummariesType.DISTINCT;
        };
        DateDataField.prototype.assignPossibleSummaries = function () {
            return SummariesType.COUNT |
                SummariesType.DISTINCT;
        };
        DateDataField.prototype.search = function (item, searchPhrase) {
            return false;
        };
        DateDataField.prototype.sort = function (dateOne, dateTwo) {
            return dateOne - dateTwo;
        };
        DateDataField.prototype.filter = function (value, filterPhrase) {
            return false;
        };
        DateDataField.prototype.equals = function (item, value) {
            return this.getValue(item).getTime() === value.getTime();
        };
        DateDataField.prototype.getDisplayValue = function (item) {
            return item.toDateString();
        };
        return DateDataField;
    }(DataField));

    var FieldMatchers = /** @class */ (function () {
        function FieldMatchers(matcher, sortMatcher, searchMatcher) {
            this.matcher = matcher;
            this.sortMatcher = sortMatcher;
            this.searchMatcher = searchMatcher;
        }
        FieldMatchers.prototype.getMatcher = function () {
            return hermes.Optional.of(this.matcher);
        };
        FieldMatchers.prototype.getSortMatcher = function () {
            var matcher;
            if (this.sortMatcher) {
                matcher = this.sortMatcher;
            }
            if (this.matcher) {
                matcher = this.matcher;
            }
            return hermes.Optional.of(matcher);
        };
        FieldMatchers.prototype.getSearchMatcher = function () {
            var matcher;
            if (this.searchMatcher) {
                matcher = this.searchMatcher;
            }
            if (this.matcher) {
                matcher = this.matcher;
            }
            return hermes.Optional.of(matcher);
        };
        return FieldMatchers;
    }());

    var DataFieldFactory = /** @class */ (function () {
        function DataFieldFactory() {
        }
        DataFieldFactory.prototype.create = function (fieldConfig) {
            var fieldMatchers = this.createMatchers(fieldConfig);
            var columnType = fieldConfig.type;
            if (columnType === undefined) {
                columnType = DataType.STRING;
            }
            if (columnType === DataType.UNKNOWN) {
                return new UnknownDataField(fieldConfig.field, fieldMatchers, fieldConfig.summaries);
            }
            if (columnType === DataType.NUMBER) {
                return new NumberDataField(fieldConfig.field, fieldMatchers, fieldConfig.summaries);
            }
            if (columnType === DataType.STRING) {
                return new StringDataField(fieldConfig.field, fieldMatchers);
            }
            if (columnType === DataType.BOOLEAN) {
                return new BooleanDataField(fieldConfig.field, fieldMatchers);
            }
            if (columnType === DataType.DATE) {
                return new DateDataField(fieldConfig.field, fieldMatchers);
            }
            return new UnknownDataField(fieldConfig.field, fieldMatchers, fieldConfig.summaries);
        };
        DataFieldFactory.prototype.createMatchers = function (fieldConfig) {
            var matcher = fieldConfig.matcher;
            var sortMatcher;
            if (fieldConfig.sorting) {
                sortMatcher = fieldConfig.sorting.matcher;
            }
            return new FieldMatchers(matcher, sortMatcher);
        };
        return DataFieldFactory;
    }());
    DataFieldFactory.decorators = [
        { type: core.Injectable }
    ];

    var FieldIdGenerator = /** @class */ (function () {
        function FieldIdGenerator() {
        }
        FieldIdGenerator.prototype.generateId = function () {
            var id = hermes.RandomStringGenerator.generate();
            return new FieldId(id);
        };
        return FieldIdGenerator;
    }());

    var FieldFactory = /** @class */ (function () {
        function FieldFactory(fieldIdGenerator, dataFieldFactory) {
            this.fieldIdGenerator = fieldIdGenerator;
            this.dataFieldFactory = dataFieldFactory;
        }
        FieldFactory.prototype.create = function (configs) {
            var _this = this;
            if (!configs) {
                return [];
            }
            return configs.map(function (fieldConfig, index) {
                var fieldId = _this.fieldIdGenerator.generateId(), dataField = _this.dataFieldFactory.create(fieldConfig);
                return new Field(fieldId, dataField, _this.getFieldName(fieldConfig, index));
            });
        };
        FieldFactory.prototype.getFieldName = function (fieldConfig, index) {
            if (typeof fieldConfig.field === 'string') {
                return fieldConfig.field.toLowerCase();
            }
            else {
                return 'Field #' + index;
            }
        };
        return FieldFactory;
    }());
    FieldFactory.decorators = [
        { type: core.Injectable }
    ];
    FieldFactory.ctorParameters = function () { return [
        { type: FieldIdGenerator },
        { type: DataFieldFactory }
    ]; };

    var FieldCollectionFactory = /** @class */ (function () {
        function FieldCollectionFactory(fieldFactory) {
            this.fieldFactory = fieldFactory;
        }
        FieldCollectionFactory.prototype.create = function () {
            return new FieldCollection(this.fieldFactory);
        };
        return FieldCollectionFactory;
    }());
    FieldCollectionFactory.decorators = [
        { type: core.Injectable }
    ];
    FieldCollectionFactory.ctorParameters = function () { return [
        { type: FieldFactory }
    ]; };

    var InitFieldsCommandHandler = /** @class */ (function () {
        function InitFieldsCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        InitFieldsCommandHandler.prototype.forCommand = function () {
            return InitFieldsCommand;
        };
        InitFieldsCommandHandler.prototype.handle = function (structure, command) {
            var fieldConfigs = command.getFieldConfigs();
            structure.createFields(fieldConfigs);
        };
        InitFieldsCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return InitFieldsCommandHandler;
    }());
    InitFieldsCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    InitFieldsCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var FieldsInitedEventHandler = /** @class */ (function () {
        function FieldsInitedEventHandler(fieldReadModelRepository, fieldUiConverter) {
            this.fieldReadModelRepository = fieldReadModelRepository;
            this.fieldUiConverter = fieldUiConverter;
        }
        FieldsInitedEventHandler.prototype.forEvent = function () {
            return FieldsInitedEvent;
        };
        FieldsInitedEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('FieldsInitedEvent')) {
                var fields = this.fieldUiConverter.convert(event.getFields());
                this.fieldReadModelRepository.next(event.getAggregateId(), fields);
            }
        };
        return FieldsInitedEventHandler;
    }());
    FieldsInitedEventHandler.decorators = [
        { type: core.Injectable }
    ];
    FieldsInitedEventHandler.ctorParameters = function () { return [
        { type: FieldReadModelArchive },
        { type: FieldUiConverter }
    ]; };

    var FieldDomainModule = /** @class */ (function (_super) {
        __extends(FieldDomainModule, _super);
        function FieldDomainModule() {
            return _super.call(this) || this;
        }
        FieldDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(InitFieldsCommandHandler, structureKey)
            ];
        };
        FieldDomainModule.domainEventHandlers = function () {
            return [
                hermes.HermesModule.registerDomainEventHandler(FieldsInitedEventHandler)
            ];
        };
        return FieldDomainModule;
    }(hermes.DomainModule));
    FieldDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    providers: [
                        FieldCollectionFactory,
                        FieldFactory,
                        FieldIdGenerator,
                        DataFieldFactory
                    ]
                },] }
    ];
    FieldDomainModule.ctorParameters = function () { return []; };

    var FieldApiModule = /** @class */ (function (_super) {
        __extends(FieldApiModule, _super);
        function FieldApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return FieldApiModule;
    }(hermes.ApiModule));
    FieldApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        FieldDomainModule
                    ],
                    providers: [
                        FieldCommandInvoker,
                        FieldReadModelArchive,
                        FieldUiConverter,
                        FieldWarehouse
                    ]
                },] }
    ];

    var FieldFeatureModule = /** @class */ (function (_super) {
        __extends(FieldFeatureModule, _super);
        function FieldFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        FieldFeatureModule.forComponent = function () {
            return [];
        };
        return FieldFeatureModule;
    }(hermes.FeatureModule));
    FieldFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        FieldApiModule
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var Source = /** @class */ (function () {
        function Source(loading) {
            this.loading = loading;
        }
        Source.prototype.isLoading = function () {
            return this.loading;
        };
        return Source;
    }());
    Source = __decorate([
        hermes.ReadModelObject
    ], Source);

    var SourceConverter = /** @class */ (function () {
        function SourceConverter() {
        }
        SourceConverter.prototype.convert = function (aggregate) {
            return new Source(aggregate.isLoading());
        };
        return SourceConverter;
    }());
    SourceConverter.decorators = [
        { type: core.Injectable }
    ];

    var SetSourceLoadingEvent = /** @class */ (function (_super) {
        __extends(SetSourceLoadingEvent, _super);
        function SetSourceLoadingEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'SetSourceLoadingEvent') || this;
        }
        return SetSourceLoadingEvent;
    }(StructureDomainEvent));

    var SourceSetLoadingCommand = /** @class */ (function (_super) {
        __extends(SourceSetLoadingCommand, _super);
        function SourceSetLoadingCommand(structureId, enabled) {
            var _this = _super.call(this, structureId, 'SourceSetLoadingCommand') || this;
            _this.enabled = enabled;
            return _this;
        }
        SourceSetLoadingCommand.prototype.isEnabled = function () {
            return this.enabled;
        };
        return SourceSetLoadingCommand;
    }(StructureCommand));

    var SourceSetLoadingCommandHandler = /** @class */ (function () {
        function SourceSetLoadingCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SourceSetLoadingCommandHandler.prototype.forCommand = function () {
            return SourceSetLoadingCommand;
        };
        SourceSetLoadingCommandHandler.prototype.handle = function (aggregate, command) {
            var enabled = command.isEnabled(), source = aggregate.getSource();
            source.setLoading(enabled);
        };
        SourceSetLoadingCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new SetSourceLoadingEvent(command.getAggregateId()));
        };
        return SourceSetLoadingCommandHandler;
    }());
    SourceSetLoadingCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SourceSetLoadingCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetOriginCommand = /** @class */ (function (_super) {
        __extends(SetOriginCommand, _super);
        function SetOriginCommand(structureId, items) {
            if (items === void 0) { items = []; }
            var _this = _super.call(this, structureId, 'SetOriginCommand') || this;
            _this.items = items;
            return _this;
        }
        SetOriginCommand.prototype.getItems = function () {
            return this.items;
        };
        return SetOriginCommand;
    }(StructureCommand));

    var SetOriginCommandHandler = /** @class */ (function () {
        function SetOriginCommandHandler(structureSourceDomainEventPublisher) {
            this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
        }
        SetOriginCommandHandler.prototype.forCommand = function () {
            return SetOriginCommand;
        };
        SetOriginCommandHandler.prototype.handle = function (structure, command) {
            var items = command.getItems();
            structure.setOrigin(items);
        };
        SetOriginCommandHandler.prototype.publish = function (aggregate, command) {
            var aggregateEvents = aggregate.getEvents();
            this.structureSourceDomainEventPublisher.publish(aggregateEvents);
        };
        return SetOriginCommandHandler;
    }());
    SetOriginCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetOriginCommandHandler.ctorParameters = function () { return [
        { type: SourceDomainEventPublisher }
    ]; };

    var StructureEditSourceItemCommand = /** @class */ (function (_super) {
        __extends(StructureEditSourceItemCommand, _super);
        function StructureEditSourceItemCommand(structureId, params) {
            var _this = _super.call(this, structureId, 'StructureEditSourceItemCommand') || this;
            _this.params = params;
            return _this;
        }
        StructureEditSourceItemCommand.prototype.getParams = function () {
            return this.params;
        };
        return StructureEditSourceItemCommand;
    }(StructureCommand));

    var StructureEditSourceItemCommandHandler = /** @class */ (function () {
        function StructureEditSourceItemCommandHandler(structureSourceDomainEventPublisher) {
            this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
        }
        StructureEditSourceItemCommandHandler.prototype.forCommand = function () {
            return StructureEditSourceItemCommand;
        };
        StructureEditSourceItemCommandHandler.prototype.handle = function (structure, command) {
            var params = command.getParams();
            structure.editItem(params);
        };
        StructureEditSourceItemCommandHandler.prototype.publish = function (aggregate, command) {
            var aggregateEvents = aggregate.getEvents();
            this.structureSourceDomainEventPublisher.publish(aggregateEvents);
        };
        return StructureEditSourceItemCommandHandler;
    }());
    StructureEditSourceItemCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    StructureEditSourceItemCommandHandler.ctorParameters = function () { return [
        { type: SourceDomainEventPublisher }
    ]; };

    var SourceDispatcher = /** @class */ (function () {
        function SourceDispatcher(commandDispatcher) {
            this.commandDispatcher = commandDispatcher;
        }
        SourceDispatcher.prototype.setLoading = function (structureId, enabled) {
            this.commandDispatcher.dispatch(new SourceSetLoadingCommand(structureId, enabled));
        };
        SourceDispatcher.prototype.setOrigin = function (structureId, items) {
            this.commandDispatcher.dispatch(new SetOriginCommand(structureId, items));
        };
        SourceDispatcher.prototype.editItem = function (structureId, params) {
            this.commandDispatcher.dispatch(new StructureEditSourceItemCommand(structureId, params));
        };
        return SourceDispatcher;
    }());
    SourceDispatcher.decorators = [
        { type: core.Injectable }
    ];
    SourceDispatcher.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var OriginItemEntity = /** @class */ (function (_super) {
        __extends(OriginItemEntity, _super);
        function OriginItemEntity(id, sourceItem, position, version) {
            if (version === void 0) { version = 0; }
            var _this = _super.call(this, id) || this;
            _this.sourceItem = sourceItem;
            _this.position = position;
            _this.version = version;
            return _this;
        }
        OriginItemEntity.prototype.getSourceItem = function () {
            return this.sourceItem;
        };
        OriginItemEntity.prototype.getVersion = function () {
            return this.version;
        };
        OriginItemEntity.prototype.getPosition = function () {
            return this.position;
        };
        OriginItemEntity.prototype.bumpVersion = function () {
            this.version += 1;
        };
        OriginItemEntity.prototype.setPosition = function (position) {
            this.position = position;
        };
        OriginItemEntity.prototype.clone = function () {
            var rawData = Object.assign({}, this.sourceItem);
            return new OriginItemEntity(this.getId(), rawData, this.version);
        };
        return OriginItemEntity;
    }(hermes.Entity));

    var StructureSourceItemEditedAggregateEvent = /** @class */ (function (_super) {
        __extends(StructureSourceItemEditedAggregateEvent, _super);
        function StructureSourceItemEditedAggregateEvent(aggregateId, beforeItem, afterItem) {
            var _this = _super.call(this, aggregateId, 'StructureSourceItemEditedAggregateEvent') || this;
            _this.beforeItem = beforeItem;
            _this.afterItem = afterItem;
            return _this;
        }
        StructureSourceItemEditedAggregateEvent.prototype.toDomainEvent = function () {
            return new StructureSourceItemEditedEvent(this.getAggregateId(), this.beforeItem, this.afterItem);
        };
        StructureSourceItemEditedAggregateEvent.prototype.getBeforeItem = function () {
            return this.beforeItem;
        };
        StructureSourceItemEditedAggregateEvent.prototype.getAfterItem = function () {
            return this.afterItem;
        };
        return StructureSourceItemEditedAggregateEvent;
    }(StructureAggregateEvent));

    var StructureOriginChangedAggregateEvent = /** @class */ (function (_super) {
        __extends(StructureOriginChangedAggregateEvent, _super);
        function StructureOriginChangedAggregateEvent(aggregateId, origin) {
            var _this = _super.call(this, aggregateId, 'StructureOriginChangedAggregateEvent') || this;
            _this.origin = origin;
            return _this;
        }
        StructureOriginChangedAggregateEvent.prototype.toDomainEvent = function () {
            return new OriginSetEvent(this.getAggregateId(), this.origin);
        };
        StructureOriginChangedAggregateEvent.prototype.getOrigin = function () {
            return this.origin;
        };
        return StructureOriginChangedAggregateEvent;
    }(StructureAggregateEvent));

    var OriginId = /** @class */ (function (_super) {
        __extends(OriginId, _super);
        function OriginId(id) {
            return _super.call(this, id) || this;
        }
        OriginId.prototype.toString = function () {
            return this.getId();
        };
        return OriginId;
    }(hermes.EntityId));

    var SourceManager = /** @class */ (function () {
        function SourceManager(formationManager) {
            this.loading = false;
            this.fetched = false;
            this.entities = [];
            // Entities after filtering, searching
            this.preparedEntities = [];
            this.slicedEntities = [];
            this.formationManager = formationManager;
        }
        SourceManager.prototype.isLoading = function () {
            return this.loading;
        };
        SourceManager.prototype.isFetched = function () {
            return this.fetched;
        };
        SourceManager.prototype.setLoading = function (enabled) {
            this.loading = enabled;
        };
        SourceManager.prototype.setEntities = function (ent) {
            this.entities = ent;
            this.recalculatePositions();
        };
        SourceManager.prototype.getEntities = function () {
            return this.entities;
        };
        SourceManager.prototype.setPreparedEntities = function () {
            this.preparedEntities = Array.from(this.entities);
        };
        SourceManager.prototype.getPreparedEntities = function () {
            return this.preparedEntities;
        };
        SourceManager.prototype.setSlicedEntities = function (ent) {
            this.slicedEntities = ent;
        };
        SourceManager.prototype.getSlicedEntities = function () {
            return this.slicedEntities;
        };
        SourceManager.prototype.setOrigin = function (items, structureId) {
            if (items === void 0) { items = []; }
            this.origin = this.convertItems(items);
            return this.createOriginChangedEvent(structureId);
        };
        SourceManager.prototype.setConvertedOrigin = function (items, structureId) {
            if (items === void 0) { items = []; }
            this.origin = Array.from(items);
            return this.createOriginChangedEvent(structureId);
        };
        SourceManager.prototype.getOrigin = function () {
            return this.origin;
        };
        SourceManager.prototype.getOriginSize = function () {
            return this.origin.length;
        };
        // editOriginItemByProperty(byField, value: any, field: Field, structureId: StructureId): AggregateEvent {
        //
        // }
        SourceManager.prototype.editOriginItem = function (itemId, value, field, structureId) {
            var item = this.findOriginItem(itemId), itemBeforeChange = item.clone();
            if (item) {
                item.sourceItem[field.getAccessor()] = value;
                item.bumpVersion();
            }
            return [
                new StructureSourceItemEditedAggregateEvent(structureId, itemBeforeChange, item.clone()),
                this.createOriginChangedEvent(structureId)
            ];
        };
        SourceManager.prototype.deleteAllSelected = function (structureId) {
            var _this = this;
            var events = [];
            var rows = this.formationManager.getSelectedRows();
            rows.forEach(function (r) {
                events = events.concat(_this.deleteOriginItemByItemId(new OriginId(r), structureId));
            });
            return events;
        };
        SourceManager.prototype.deleteOriginItem = function (payload, structureId) {
            var _this = this;
            if (payload instanceof OriginId) {
                return this.deleteOriginItemByItemId(payload, structureId);
            }
            else if (Array.isArray(payload)) {
                var events_1 = [];
                payload.forEach(function (item) {
                    events_1 = events_1.concat(_this.deleteOneOriginItem(item, structureId));
                });
                return events_1;
            }
            else if (Number.isInteger(payload)) {
                return this.deleteOriginItemByIndex(payload, structureId);
            }
            else {
                return [];
            }
        };
        SourceManager.prototype.addOriginItem = function (item, structureId) {
            this.origin.push(item);
            return [this.createOriginChangedEvent(structureId)];
        };
        SourceManager.prototype.selectAll = function () {
            this.formationManager.selectAll(this.getEntities().map(function (e) { return e.getId().toString(); }));
        };
        SourceManager.prototype.unselectAll = function () {
            this.formationManager.unselectAll();
        };
        SourceManager.prototype.toggleRow = function (itemId, type) {
            this.formationManager.toggleRow(itemId, type, this.getEntities().map(function (e) { return e.getId().toString(); }));
        };
        SourceManager.prototype.getFormation = function () {
            return this.formationManager;
        };
        SourceManager.prototype.convertItems = function (items) {
            return items.map(function (item, index) {
                return new OriginItemEntity(new OriginId(hermes.RandomStringGenerator.generate()), item, index);
            });
        };
        SourceManager.prototype.createOriginChangedEvent = function (structureId) {
            return new StructureOriginChangedAggregateEvent(structureId, this.origin);
        };
        SourceManager.prototype.findOriginItem = function (itemId) {
            return this.origin.find(function (item) { return item.getId().toString() === itemId; });
        };
        SourceManager.prototype.findOriginItemIndex = function (itemId) {
            return this.origin.findIndex(function (item) { return item.getId().toString() === itemId; });
        };
        SourceManager.prototype.recalculatePositions = function () {
            this.entities.forEach(function (ent, index) {
                ent.setPosition(index);
            });
        };
        SourceManager.prototype.deleteOneOriginItem = function (item, structureId) {
            if (item instanceof OriginId) {
                return this.deleteOriginItemByItemId(item, structureId);
            }
            else if (Number.isInteger(item)) {
                return this.deleteOriginItemByIndex(item, structureId);
            }
            else {
                return [];
            }
        };
        SourceManager.prototype.deleteOriginItemByItemId = function (itemId, structureId) {
            var index = this.findOriginItemIndex(itemId.toString());
            return this.deleteOriginItemByIndex(index, structureId);
        };
        SourceManager.prototype.deleteOriginItemByIndex = function (index, structureId) {
            var e_1, _a;
            if (index > -1) {
                var removedElements = this.origin.splice(index, 1);
                if (removedElements.length > 0) {
                    try {
                        for (var removedElements_1 = __values(removedElements), removedElements_1_1 = removedElements_1.next(); !removedElements_1_1.done; removedElements_1_1 = removedElements_1.next()) {
                            var element = removedElements_1_1.value;
                            this.formationManager.unselectRow(element.getId().toString());
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (removedElements_1_1 && !removedElements_1_1.done && (_a = removedElements_1.return)) _a.call(removedElements_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                    this.formationManager.calculateAllSelected(removedElements.map(function (f) { return f.getId().toString(); }));
                    this.formationManager.calculateAllUnselected();
                }
                return [
                    this.createOriginChangedEvent(structureId)
                ];
            }
            return [];
        };
        SourceManager.prototype.deleteManyOriginItemByIndex = function (indexes, structureId) {
            var _this = this;
            var events = [];
            indexes.forEach(function (index) {
                events = events.concat(_this.deleteOriginItemByIndex(index, structureId));
            });
            return events;
        };
        SourceManager.prototype.deleteManyOriginItemByItemID = function (itemIds, structureId) {
            var _this = this;
            var events = [];
            itemIds.forEach(function (itemId) {
                events = events.concat(_this.deleteOriginItemByItemId(itemId, structureId));
            });
            return events;
        };
        return SourceManager;
    }());

    var RowSelectToggleType;
    (function (RowSelectToggleType) {
        RowSelectToggleType[RowSelectToggleType["NONE"] = 0] = "NONE";
        RowSelectToggleType[RowSelectToggleType["ADD"] = 1] = "ADD";
        RowSelectToggleType[RowSelectToggleType["RANGE"] = 2] = "RANGE";
    })(RowSelectToggleType || (RowSelectToggleType = {}));

    var FormationManager = /** @class */ (function () {
        function FormationManager(selectedRows) {
            this.enabled = true;
            this.mode = RowSelectionMode.SINGLE;
            this.selectedRows = selectedRows;
        }
        FormationManager.prototype.isAllSelected = function () {
            return this.allSelected;
        };
        FormationManager.prototype.isAllUnselected = function () {
            return this.allUnselected;
        };
        FormationManager.prototype.setSelection = function (enabled) {
            this.enabled = enabled;
        };
        FormationManager.prototype.setMode = function (mode) {
            this.mode = mode;
        };
        FormationManager.prototype.getSelectedRows = function () {
            return Array.from(this.selectedRows);
        };
        FormationManager.prototype.selectAll = function (allItemIds) {
            this.selectedRows = new Set(allItemIds);
            this.allSelected = true;
            this.allUnselected = false;
        };
        FormationManager.prototype.unselectAll = function () {
            this.selectedRows.clear();
            this.allSelected = false;
            this.allUnselected = true;
        };
        FormationManager.prototype.toggleRow = function (itemId, type, allItemIds) {
            if (!this.enabled) {
                return;
            }
            if (type === RowSelectToggleType.ADD && this.mode === RowSelectionMode.SINGLE) {
                type = RowSelectToggleType.NONE;
            }
            switch (type) {
                case RowSelectToggleType.NONE:
                    if (this.selectedRows.has(itemId)) {
                        this.selectedRows.delete(itemId);
                    }
                    else {
                        this.selectedRows.clear();
                        this.selectedRows.add(itemId);
                    }
                    break;
                case RowSelectToggleType.ADD:
                    if (this.selectedRows.has(itemId)) {
                        this.selectedRows.delete(itemId);
                    }
                    else {
                        this.selectedRows.add(itemId);
                    }
                    break;
                case RowSelectToggleType.RANGE:
                    break;
                default:
                    break;
            }
            this.calculateAllSelected(allItemIds);
            this.calculateAllUnselected();
        };
        FormationManager.prototype.calculateAllSelected = function (allItemIds) {
            if (allItemIds.length !== this.selectedRows.size) {
                this.allSelected = false;
            }
            else {
                var rows = Array.from(this.selectedRows);
                var equal = true;
                rows.sort();
                allItemIds.sort();
                for (var i = 0; i < rows.length; i += 1) {
                    if (rows[i] !== allItemIds[i]) {
                        equal = false;
                        break;
                    }
                }
                this.allSelected = equal;
            }
        };
        FormationManager.prototype.calculateAllUnselected = function () {
            this.allUnselected = this.selectedRows.size === 0;
        };
        FormationManager.prototype.unselectRow = function (itemId) {
            if (this.selectedRows.has(itemId)) {
                this.selectedRows.delete(itemId);
            }
        };
        return FormationManager;
    }());

    var FormationManagerFactory = /** @class */ (function () {
        function FormationManagerFactory() {
        }
        FormationManagerFactory.prototype.create = function () {
            return new FormationManager(new Set());
        };
        return FormationManagerFactory;
    }());
    FormationManagerFactory.decorators = [
        { type: core.Injectable }
    ];

    var SourceManagerFactory = /** @class */ (function () {
        function SourceManagerFactory(formationManagerFactory) {
            this.formationManagerFactory = formationManagerFactory;
        }
        SourceManagerFactory.prototype.createDefault = function () {
            var fm = this.formationManagerFactory.create();
            return new SourceManager(fm);
        };
        SourceManagerFactory.prototype.create = function () {
            var fm = this.formationManagerFactory.create();
            return new SourceManager(fm);
        };
        return SourceManagerFactory;
    }());
    SourceManagerFactory.decorators = [
        { type: core.Injectable }
    ];
    SourceManagerFactory.ctorParameters = function () { return [
        { type: FormationManagerFactory }
    ]; };

    var SetEnabledSelectionCommandHandler = /** @class */ (function () {
        function SetEnabledSelectionCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetEnabledSelectionCommandHandler.prototype.forCommand = function () {
            return SetEnabledSelectionCommand;
        };
        SetEnabledSelectionCommandHandler.prototype.handle = function (aggregate, command) {
            aggregate.setSelection(command.isEnabled());
        };
        SetEnabledSelectionCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SetEnabledSelectionCommandHandler;
    }());
    SetEnabledSelectionCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetEnabledSelectionCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var ToggleSelectedRowCommandHandler = /** @class */ (function () {
        function ToggleSelectedRowCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        ToggleSelectedRowCommandHandler.prototype.forCommand = function () {
            return ToggleSelectedRowCommand;
        };
        ToggleSelectedRowCommandHandler.prototype.handle = function (aggregate, command) {
            var selectedRow = command.getSelectedRow(), type = command.getType();
            aggregate.toggleRow(selectedRow, type);
        };
        ToggleSelectedRowCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return ToggleSelectedRowCommandHandler;
    }());
    ToggleSelectedRowCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    ToggleSelectedRowCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var RowSelectedRepository = /** @class */ (function (_super) {
        __extends(RowSelectedRepository, _super);
        function RowSelectedRepository() {
            return _super.call(this) || this;
        }
        return RowSelectedRepository;
    }(hermes.AggregateArchive));
    RowSelectedRepository.decorators = [
        { type: core.Injectable }
    ];
    RowSelectedRepository.ctorParameters = function () { return []; };

    var RowSelectedReadModel = /** @class */ (function () {
        function RowSelectedReadModel(itemIds, allSelected, allUnselected) {
            this.itemIds = new Array();
            this.itemIds = itemIds;
            this.allSelected = allSelected;
            this.allUnselected = allUnselected;
        }
        RowSelectedReadModel.prototype.getAll = function () {
            return this.itemIds;
        };
        RowSelectedReadModel.prototype.isSelected = function (id) {
            return this.itemIds.some(function (itemId) { return itemId === id; });
        };
        RowSelectedReadModel.prototype.isAllSelected = function () {
            return this.allSelected;
        };
        RowSelectedReadModel.prototype.isAllUnselected = function () {
            return this.allUnselected;
        };
        RowSelectedReadModel.prototype.isIndeterminate = function () {
            return !(this.isAllSelected() || this.isAllUnselected());
        };
        return RowSelectedReadModel;
    }());

    var SelectedRowChangedEventHandler = /** @class */ (function () {
        function SelectedRowChangedEventHandler(rowSelectedRepository) {
            this.rowSelectedRepository = rowSelectedRepository;
        }
        SelectedRowChangedEventHandler.prototype.forEvent = function () {
            return SelectedRowChangedEvent;
        };
        SelectedRowChangedEventHandler.prototype.handle = function (rowChangedEvent) {
            if (rowChangedEvent.ofMessageType('SelectedRowChangedEvent')) {
                var rowSelectedRead = new RowSelectedReadModel(rowChangedEvent.getSelectedRows(), rowChangedEvent.isAllSelected(), rowChangedEvent.isAllUnselected());
                this.rowSelectedRepository.next(rowChangedEvent.getAggregateId(), rowSelectedRead);
            }
        };
        return SelectedRowChangedEventHandler;
    }());
    SelectedRowChangedEventHandler.decorators = [
        { type: core.Injectable }
    ];
    SelectedRowChangedEventHandler.ctorParameters = function () { return [
        { type: RowSelectedRepository }
    ]; };

    var SetSelectionModeCommandHandler = /** @class */ (function () {
        function SetSelectionModeCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetSelectionModeCommandHandler.prototype.forCommand = function () {
            return SetSelectionModeCommand;
        };
        SetSelectionModeCommandHandler.prototype.handle = function (aggregate, command) {
            aggregate.setSelectionMode(command.getMode());
        };
        SetSelectionModeCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SetSelectionModeCommandHandler;
    }());
    SetSelectionModeCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetSelectionModeCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SelectAllRowsCommandHandler = /** @class */ (function () {
        function SelectAllRowsCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        SelectAllRowsCommandHandler.prototype.forCommand = function () {
            return SelectAllRowsCommand;
        };
        SelectAllRowsCommandHandler.prototype.handle = function (aggregate, command) {
            aggregate.selectAll();
        };
        SelectAllRowsCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SelectAllRowsCommandHandler;
    }());
    SelectAllRowsCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SelectAllRowsCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var UnselectAllRowsCommandHandler = /** @class */ (function () {
        function UnselectAllRowsCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        UnselectAllRowsCommandHandler.prototype.forCommand = function () {
            return UnselectAllRowsCommand;
        };
        UnselectAllRowsCommandHandler.prototype.handle = function (aggregate, command) {
            aggregate.unselectAll();
        };
        UnselectAllRowsCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return UnselectAllRowsCommandHandler;
    }());
    UnselectAllRowsCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    UnselectAllRowsCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var SelectionModeSetEvent = /** @class */ (function (_super) {
        __extends(SelectionModeSetEvent, _super);
        function SelectionModeSetEvent(aggregateId, mode) {
            var _this = _super.call(this, aggregateId, mode, 'SelectionModeSetEvent') || this;
            _this.mode = mode;
            return _this;
        }
        SelectionModeSetEvent.prototype.getMode = function () {
            return this.mode;
        };
        return SelectionModeSetEvent;
    }(StructureDomainEvent));

    var RowSelectionModeRepository = /** @class */ (function (_super) {
        __extends(RowSelectionModeRepository, _super);
        function RowSelectionModeRepository() {
            return _super.call(this) || this;
        }
        return RowSelectionModeRepository;
    }(hermes.AggregateArchive));
    RowSelectionModeRepository.decorators = [
        { type: core.Injectable }
    ];
    RowSelectionModeRepository.ctorParameters = function () { return []; };

    var SelectionModeSetEventHandler = /** @class */ (function () {
        function SelectionModeSetEventHandler(rowSelectionModeRepository) {
            this.rowSelectionModeRepository = rowSelectionModeRepository;
        }
        SelectionModeSetEventHandler.prototype.forEvent = function () {
            return SelectionModeSetEvent;
        };
        SelectionModeSetEventHandler.prototype.handle = function (modeSetEvent) {
            if (modeSetEvent.ofMessageType('SelectionModeSetEvent')) {
                this.rowSelectionModeRepository.next(modeSetEvent.getAggregateId(), modeSetEvent.getMode());
            }
        };
        return SelectionModeSetEventHandler;
    }());
    SelectionModeSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    SelectionModeSetEventHandler.ctorParameters = function () { return [
        { type: RowSelectionModeRepository }
    ]; };

    var DeleteCommandPayloadType;
    (function (DeleteCommandPayloadType) {
        DeleteCommandPayloadType[DeleteCommandPayloadType["INDEX"] = 0] = "INDEX";
        DeleteCommandPayloadType[DeleteCommandPayloadType["ITEM_ID"] = 1] = "ITEM_ID";
        DeleteCommandPayloadType[DeleteCommandPayloadType["MANY_INDEX"] = 2] = "MANY_INDEX";
        DeleteCommandPayloadType[DeleteCommandPayloadType["MANY_ITEM_ID"] = 3] = "MANY_ITEM_ID";
    })(DeleteCommandPayloadType || (DeleteCommandPayloadType = {}));
    var DeleteOriginItemCommand = /** @class */ (function (_super) {
        __extends(DeleteOriginItemCommand, _super);
        function DeleteOriginItemCommand(structureId, payload, type) {
            var _this = _super.call(this, structureId, 'DeleteOriginItemCommand') || this;
            _this.payload = payload;
            _this.type = type;
            return _this;
        }
        DeleteOriginItemCommand.byIndex = function (structureId, index) {
            return new DeleteOriginItemCommand(structureId, index, DeleteCommandPayloadType.INDEX);
        };
        DeleteOriginItemCommand.byManyIndex = function (structureId, indexes) {
            return new DeleteOriginItemCommand(structureId, indexes, DeleteCommandPayloadType.MANY_INDEX);
        };
        DeleteOriginItemCommand.byItemId = function (structureId, itemId) {
            return new DeleteOriginItemCommand(structureId, itemId, DeleteCommandPayloadType.ITEM_ID);
        };
        DeleteOriginItemCommand.byManyItemId = function (structureId, itemIds) {
            return new DeleteOriginItemCommand(structureId, itemIds, DeleteCommandPayloadType.MANY_ITEM_ID);
        };
        DeleteOriginItemCommand.prototype.getType = function () {
            return this.type;
        };
        DeleteOriginItemCommand.prototype.getPayload = function () {
            return this.payload;
        };
        return DeleteOriginItemCommand;
    }(StructureCommand));

    var DeleteOriginItemCommandHandler = /** @class */ (function () {
        function DeleteOriginItemCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        DeleteOriginItemCommandHandler.prototype.forCommand = function () {
            return DeleteOriginItemCommand;
        };
        DeleteOriginItemCommandHandler.prototype.handle = function (aggregate, command) {
            aggregate.deleteItem(command.getPayload());
        };
        DeleteOriginItemCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return DeleteOriginItemCommandHandler;
    }());
    DeleteOriginItemCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    DeleteOriginItemCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var StructureSourceOriginArchive = /** @class */ (function (_super) {
        __extends(StructureSourceOriginArchive, _super);
        function StructureSourceOriginArchive() {
            return _super.call(this, StructureSourceOriginArchive.default) || this;
        }
        return StructureSourceOriginArchive;
    }(hermes.AggregateArchive));
    StructureSourceOriginArchive.default = [];
    StructureSourceOriginArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureSourceOriginArchive.ctorParameters = function () { return []; };

    var StructureOriginChangedEventHandler = /** @class */ (function () {
        function StructureOriginChangedEventHandler(structureSourceOriginRepository) {
            this.structureSourceOriginRepository = structureSourceOriginRepository;
        }
        StructureOriginChangedEventHandler.prototype.forEvent = function () {
            return OriginSetEvent;
        };
        StructureOriginChangedEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('OriginSetEvent')) {
                var origin = event.getOrigin();
                this.structureSourceOriginRepository.next(event.getAggregateId(), origin);
            }
        };
        return StructureOriginChangedEventHandler;
    }());
    StructureOriginChangedEventHandler.decorators = [
        { type: core.Injectable }
    ];
    StructureOriginChangedEventHandler.ctorParameters = function () { return [
        { type: StructureSourceOriginArchive }
    ]; };

    var StructurePreparedItemsArchive = /** @class */ (function (_super) {
        __extends(StructurePreparedItemsArchive, _super);
        function StructurePreparedItemsArchive() {
            return _super.call(this, StructurePreparedItemsArchive.default) || this;
        }
        /**
         * @deprecated
         */
        StructurePreparedItemsArchive.prototype.getPreparedItems = function (structureId) {
            return this.get(structureId).getValueOrNullOrThrowError();
        };
        return StructurePreparedItemsArchive;
    }(hermes.AggregateArchive));
    StructurePreparedItemsArchive.default = [];
    StructurePreparedItemsArchive.decorators = [
        { type: core.Injectable }
    ];
    StructurePreparedItemsArchive.ctorParameters = function () { return []; };

    var StructurePreparedItemsEventHandler = /** @class */ (function () {
        function StructurePreparedItemsEventHandler(structurePreparedItemsRepository) {
            this.structurePreparedItemsRepository = structurePreparedItemsRepository;
        }
        StructurePreparedItemsEventHandler.prototype.forEvent = function () {
            return StructurePreparedEntitiesSetEvent;
        };
        StructurePreparedItemsEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('StructurePreparedEntitiesSetEvent')) {
                var preparedItems = event.getPreparedItems();
                this.structurePreparedItemsRepository.next(event.getAggregateId(), preparedItems);
            }
        };
        return StructurePreparedItemsEventHandler;
    }());
    StructurePreparedItemsEventHandler.decorators = [
        { type: core.Injectable }
    ];
    StructurePreparedItemsEventHandler.ctorParameters = function () { return [
        { type: StructurePreparedItemsArchive }
    ]; };

    var SourceDomainModule = /** @class */ (function (_super) {
        __extends(SourceDomainModule, _super);
        function SourceDomainModule() {
            return _super.call(this) || this;
        }
        SourceDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SourceSetLoadingCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetOriginCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(StructureEditSourceItemCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetEnabledSelectionCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetSelectionModeCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SelectAllRowsCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(UnselectAllRowsCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(DeleteOriginItemCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(ToggleSelectedRowCommandHandler, structureKey)
            ];
        };
        SourceDomainModule.domainEventHandlers = function () {
            return [
                hermes.HermesModule.registerDomainEventHandler(StructureOriginChangedEventHandler),
                hermes.HermesModule.registerDomainEventHandler(SelectedRowChangedEventHandler),
                hermes.HermesModule.registerDomainEventHandler(SelectionModeSetEventHandler),
                hermes.HermesModule.registerDomainEventHandler(StructurePreparedItemsEventHandler)
            ];
        };
        return SourceDomainModule;
    }(hermes.DomainModule));
    SourceDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [
                        SourceDispatcher,
                        SourceManagerFactory,
                        SourceDomainEventPublisher,
                        FormationDispatcher,
                        FormationManagerFactory
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    SourceDomainModule.ctorParameters = function () { return []; };

    var FormationWarehouse = /** @class */ (function () {
        function FormationWarehouse(rowSelectedRepository, rowSelectionModeRepository, sourceWarehouse) {
            this.rowSelectedRepository = rowSelectedRepository;
            this.rowSelectionModeRepository = rowSelectionModeRepository;
            this.sourceWarehouse = sourceWarehouse;
        }
        FormationWarehouse.prototype.getSelectedRows = function (structureId) {
            var items = this.sourceWarehouse.getPreparedEntities(structureId), selectedItemIds = this.getSelectedItemIds(structureId);
            var selectedItems = [], length = items.length;
            var _loop_1 = function (i) {
                var item = items[i];
                if (selectedItemIds.some(function (itemId) { return itemId === item.getId().toString(); })) {
                    selectedItems.push(new SelectedRow(item.getSourceItem(), i, item.getId()));
                }
            };
            for (var i = 0; i < length; i += 1) {
                _loop_1(i);
            }
            return selectedItems;
        };
        FormationWarehouse.prototype.onRowSelectedReadModel = function (structureId) {
            return this.rowSelectedRepository
                .on(structureId);
        };
        FormationWarehouse.prototype.getSelectedItemIds = function (structureId) {
            return this.rowSelectedRepository.get(structureId).getValueOrNullOrThrowError().getAll();
        };
        FormationWarehouse.prototype.onSelectedRows = function (structureId) {
            return this.rowSelectedRepository
                .on(structureId)
                .pipe(hermes.hermesMap(function (rm) {
                return rm.getAll();
            }));
        };
        FormationWarehouse.prototype.onMode = function (structureId) {
            return this.rowSelectionModeRepository.on(structureId);
        };
        return FormationWarehouse;
    }());
    FormationWarehouse.decorators = [
        { type: core.Injectable }
    ];
    FormationWarehouse.ctorParameters = function () { return [
        { type: RowSelectedRepository },
        { type: RowSelectionModeRepository },
        { type: SourceWarehouse }
    ]; };

    var SourceDomainWarehouse = /** @class */ (function (_super) {
        __extends(SourceDomainWarehouse, _super);
        function SourceDomainWarehouse(structureRepository, structurePreparedItemsRepository, structureSourceOriginRepository) {
            var _this = _super.call(this) || this;
            _this.structureRepository = structureRepository;
            _this.structurePreparedItemsRepository = structurePreparedItemsRepository;
            _this.structureSourceOriginRepository = structureSourceOriginRepository;
            return _this;
        }
        /**
         * @deprecated
         */
        SourceDomainWarehouse.prototype.getEntities = function (structureId) {
            return this.structureRepository.getStructure(structureId).getEntities();
        };
        SourceDomainWarehouse.prototype.onEntities = function (structureId) {
            return this.structureRepository
                .on(structureId)
                .pipe(hermes.hermesMap(function (structure) { return structure.getEntities(); }), hermes.hermesDistinctUntilChanged(function (ents1, ents2) {
                if (ents1.length !== ents2.length) {
                    return false;
                }
                var flag = true;
                ents1.forEach(function (ent, index) {
                    if (!ent.equals(ents2[index])) {
                        flag = false;
                        return;
                    }
                });
                return flag;
            }));
        };
        SourceDomainWarehouse.prototype.onEntitiesSize = function (structureId) {
            return this.onEntities(structureId)
                .pipe(hermes.hermesMap(function (entities) {
                return entities.length;
            }));
        };
        SourceDomainWarehouse.prototype.onceEntities = function (structureId) {
            return this.onEntities(structureId)
                .pipe(hermes.hermesTake(1));
        };
        SourceDomainWarehouse.prototype.onOriginSize = function (structureId) {
            return this.structureSourceOriginRepository
                .on(structureId)
                .pipe(hermes.hermesMap(function (origin) { return origin.length; }));
        };
        SourceDomainWarehouse.prototype.onLoading = function (structureId) {
            return this.structureRepository
                .on(structureId)
                .pipe(hermes.hermesMap(function (structure) { return structure.getSource().isLoading(); }));
        };
        SourceDomainWarehouse.prototype.onPreparedEntities = function (structureId) {
            return this.structurePreparedItemsRepository.on(structureId);
        };
        /**
         * @deprecated
         */
        SourceDomainWarehouse.prototype.getPreparedEntities = function (structureId) {
            return this.structurePreparedItemsRepository.getPreparedItems(structureId);
        };
        return SourceDomainWarehouse;
    }(SourceWarehouse));
    SourceDomainWarehouse.decorators = [
        { type: core.Injectable }
    ];
    SourceDomainWarehouse.ctorParameters = function () { return [
        { type: StructureReadModelRepository },
        { type: StructurePreparedItemsArchive },
        { type: StructureSourceOriginArchive }
    ]; };

    var StructureEditSourceItemParams = /** @class */ (function () {
        function StructureEditSourceItemParams(itemId, columnFieldId, // TODO Rethink
        value) {
            this.itemId = itemId;
            this.columnFieldId = columnFieldId;
            this.value = value;
        }
        StructureEditSourceItemParams.prototype.getItemId = function () {
            return this.itemId;
        };
        StructureEditSourceItemParams.prototype.getColumnFieldId = function () {
            return this.columnFieldId;
        };
        StructureEditSourceItemParams.prototype.getValue = function () {
            return this.value;
        };
        return StructureEditSourceItemParams;
    }());

    var SourceDomainCommandInvoker = /** @class */ (function (_super) {
        __extends(SourceDomainCommandInvoker, _super);
        function SourceDomainCommandInvoker(commandDispatcher, sourceDispatcher, fieldWarehouse, sourceReadModelService) {
            var _this = _super.call(this) || this;
            _this.commandDispatcher = commandDispatcher;
            _this.sourceDispatcher = sourceDispatcher;
            _this.fieldWarehouse = fieldWarehouse;
            _this.sourceReadModelService = sourceReadModelService;
            return _this;
        }
        SourceDomainCommandInvoker.prototype.setOrigin = function (items, structureId) {
            this.sourceDispatcher.setOrigin(structureId, items);
        };
        SourceDomainCommandInvoker.prototype.setLoading = function (enabled, structureId) {
            this.sourceDispatcher.setLoading(structureId, enabled);
        };
        SourceDomainCommandInvoker.prototype.editItem = function (params, structureId) {
            this.sourceDispatcher.editItem(structureId, params);
        };
        SourceDomainCommandInvoker.prototype.editItemByIndex = function (itemIndex, fieldIndex, value, structureId) {
            var _this = this;
            var itemId$ = hermes.toRxJsObservable(this.sourceReadModelService
                .onceEntities(structureId)
                .pipe(hermes.hermesMap(function (entities) {
                return entities[itemIndex].getId();
            })));
            var fieldId$ = hermes.toRxJsObservable(this.fieldWarehouse.onFields(structureId));
            hermes.fromRxJsObservable(rxjs.zip(itemId$, fieldId$))
                .pipe(hermes.hermesTake(1))
                .subscribe(function (array) {
                var itemId = array[0], fields = array[1];
                _this.editItem(new StructureEditSourceItemParams(itemId, fields[fieldIndex], value), structureId);
            });
        };
        SourceDomainCommandInvoker.prototype.deleteRow = function (row, structureId) {
            if (row.getItemId() !== undefined) {
                this.deleteItemById(row.getItemId(), structureId);
            }
            else if (row.getIndex() !== undefined) {
                this.deleteItemByIndex(row.getIndex(), structureId);
            }
        };
        SourceDomainCommandInvoker.prototype.deleteRows = function (rows, structureId) {
            if (rows.length > 0) {
                if (rows[0].getItemId() !== undefined) {
                    this.deleteManyItemsByItemIds(rows.map(function (r) { return r.getItemId(); }), structureId);
                }
                else if (rows[0].getIndex() !== undefined) {
                    this.deleteManyItemsByIndex(rows.map(function (r) { return r.getIndex(); }), structureId);
                }
            }
        };
        SourceDomainCommandInvoker.prototype.deleteItemByIndex = function (index, structureId) {
            this.commandDispatcher.dispatch(DeleteOriginItemCommand.byIndex(structureId, index));
        };
        SourceDomainCommandInvoker.prototype.deleteItemById = function (itemId, structureId) {
            this.commandDispatcher.dispatch(DeleteOriginItemCommand.byItemId(structureId, itemId));
        };
        SourceDomainCommandInvoker.prototype.deleteManyItemsByIndex = function (indexes, structureId) {
            this.commandDispatcher.dispatch(DeleteOriginItemCommand.byManyIndex(structureId, indexes));
        };
        SourceDomainCommandInvoker.prototype.deleteManyItemsByItemIds = function (itemIds, structureId) {
            this.commandDispatcher.dispatch(DeleteOriginItemCommand.byManyItemId(structureId, itemIds));
        };
        return SourceDomainCommandInvoker;
    }(SourceCommandInvoker));
    SourceDomainCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SourceDomainCommandInvoker.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher },
        { type: SourceDispatcher },
        { type: FieldWarehouse },
        { type: SourceWarehouse }
    ]; };

    var SourceApiModule = /** @class */ (function (_super) {
        __extends(SourceApiModule, _super);
        function SourceApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return SourceApiModule;
    }(hermes.ApiModule));
    SourceApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        SourceDomainModule
                    ],
                    providers: [
                        StructureSourceOriginArchive,
                        StructurePreparedItemsArchive,
                        SourceConverter,
                        {
                            provide: SourceCommandInvoker,
                            useClass: SourceDomainCommandInvoker
                        },
                        {
                            provide: SourceWarehouse,
                            useClass: SourceDomainWarehouse
                        },
                        SourceEventService,
                        RowSelectedRepository,
                        FormationEventRepository,
                        FormationCommandInvoker,
                        FormationWarehouse,
                        RowSelectionModeRepository
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var SourceFeatureModule = /** @class */ (function (_super) {
        __extends(SourceFeatureModule, _super);
        function SourceFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        SourceFeatureModule.forComponent = function () {
            return [
                RowSelectionTypeArchive
            ];
        };
        return SourceFeatureModule;
    }(hermes.FeatureModule));
    SourceFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        SourceApiModule
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var SchemaDomainEvent = /** @class */ (function (_super) {
        __extends(SchemaDomainEvent, _super);
        function SchemaDomainEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return SchemaDomainEvent;
    }(hermes.DomainEvent));

    var SchemaThemeSetEvent = /** @class */ (function (_super) {
        __extends(SchemaThemeSetEvent, _super);
        function SchemaThemeSetEvent(schemaId, theme) {
            var _this = _super.call(this, schemaId, theme, 'SchemaThemeSetEvent') || this;
            _this.theme = theme;
            return _this;
        }
        SchemaThemeSetEvent.prototype.getTheme = function () {
            return this.theme;
        };
        return SchemaThemeSetEvent;
    }(SchemaDomainEvent));

    var SchemaAggregateEvent = /** @class */ (function (_super) {
        __extends(SchemaAggregateEvent, _super);
        function SchemaAggregateEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return SchemaAggregateEvent;
    }(hermes.AggregateEvent));

    var SchemaThemeSetAggregateEvent = /** @class */ (function (_super) {
        __extends(SchemaThemeSetAggregateEvent, _super);
        function SchemaThemeSetAggregateEvent(schemaId, theme) {
            var _this = _super.call(this, schemaId, 'SchemaThemeSetAggregateEvent') || this;
            _this.theme = theme;
            return _this;
        }
        SchemaThemeSetAggregateEvent.prototype.toDomainEvent = function () {
            return new SchemaThemeSetEvent(this.getAggregateId(), this.theme);
        };
        return SchemaThemeSetAggregateEvent;
    }(SchemaAggregateEvent));

    var RowColoringSetEvent = /** @class */ (function (_super) {
        __extends(RowColoringSetEvent, _super);
        function RowColoringSetEvent(schemaId, rowColoring) {
            var _this = _super.call(this, schemaId, rowColoring, 'RowColoringSetEvent') || this;
            _this.rowColoring = rowColoring;
            return _this;
        }
        RowColoringSetEvent.prototype.getRowColoring = function () {
            return this.rowColoring;
        };
        return RowColoringSetEvent;
    }(SchemaDomainEvent));

    var RowColoringSetAggregateEvent = /** @class */ (function (_super) {
        __extends(RowColoringSetAggregateEvent, _super);
        function RowColoringSetAggregateEvent(schemaId, rowColoring) {
            var _this = _super.call(this, schemaId, 'RowColoringSetEvent') || this;
            _this.rowColoring = rowColoring;
            return _this;
        }
        RowColoringSetAggregateEvent.prototype.toDomainEvent = function () {
            return new RowColoringSetEvent(this.getAggregateId(), this.rowColoring);
        };
        return RowColoringSetAggregateEvent;
    }(SchemaAggregateEvent));

    var SchemaVerticalGridSetEvent = /** @class */ (function (_super) {
        __extends(SchemaVerticalGridSetEvent, _super);
        function SchemaVerticalGridSetEvent(schemaId, verticalGrid) {
            var _this = _super.call(this, schemaId, verticalGrid, 'SchemaVerticalGridSetEvent') || this;
            _this.verticalGrid = verticalGrid;
            return _this;
        }
        SchemaVerticalGridSetEvent.prototype.getVerticalGrid = function () {
            return this.verticalGrid;
        };
        return SchemaVerticalGridSetEvent;
    }(SchemaDomainEvent));

    var SchemaVerticalGridSetAggregateEvent = /** @class */ (function (_super) {
        __extends(SchemaVerticalGridSetAggregateEvent, _super);
        function SchemaVerticalGridSetAggregateEvent(schemaId, verticalGrid) {
            var _this = _super.call(this, schemaId, 'SchemaHorizontalGridSetEvent') || this;
            _this.verticalGrid = verticalGrid;
            return _this;
        }
        SchemaVerticalGridSetAggregateEvent.prototype.toDomainEvent = function () {
            return new SchemaVerticalGridSetEvent(this.getAggregateId(), this.verticalGrid);
        };
        return SchemaVerticalGridSetAggregateEvent;
    }(SchemaAggregateEvent));

    var SchemaHorizontalGridSetEvent = /** @class */ (function (_super) {
        __extends(SchemaHorizontalGridSetEvent, _super);
        function SchemaHorizontalGridSetEvent(schemaId, horizontalGrid) {
            var _this = _super.call(this, schemaId, horizontalGrid, 'SchemaHorizontalGridSetEvent') || this;
            _this.horizontalGrid = horizontalGrid;
            return _this;
        }
        SchemaHorizontalGridSetEvent.prototype.getHorizontalGrid = function () {
            return this.horizontalGrid;
        };
        return SchemaHorizontalGridSetEvent;
    }(SchemaDomainEvent));

    var SchemaHorizontalGridSetAggregateEvent = /** @class */ (function (_super) {
        __extends(SchemaHorizontalGridSetAggregateEvent, _super);
        function SchemaHorizontalGridSetAggregateEvent(schemaId, horizontalGrid) {
            var _this = _super.call(this, schemaId, 'SchemaHorizontalGridSetEvent') || this;
            _this.horizontalGrid = horizontalGrid;
            return _this;
        }
        SchemaHorizontalGridSetAggregateEvent.prototype.toDomainEvent = function () {
            return new SchemaHorizontalGridSetEvent(this.getAggregateId(), this.horizontalGrid);
        };
        return SchemaHorizontalGridSetAggregateEvent;
    }(SchemaAggregateEvent));

    var SchemaCreatedEvent = /** @class */ (function (_super) {
        __extends(SchemaCreatedEvent, _super);
        function SchemaCreatedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'SchemaCreatedEvent') || this;
        }
        return SchemaCreatedEvent;
    }(SchemaDomainEvent));

    var SchemaCreatedAggregateEvent = /** @class */ (function (_super) {
        __extends(SchemaCreatedAggregateEvent, _super);
        function SchemaCreatedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'SchemaCreatedAggregateEvent') || this;
        }
        SchemaCreatedAggregateEvent.prototype.toDomainEvent = function () {
            return new SchemaCreatedEvent(this.getAggregateId());
        };
        return SchemaCreatedAggregateEvent;
    }(SchemaAggregateEvent));

    var SchemaAggregate = /** @class */ (function (_super) {
        __extends(SchemaAggregate, _super);
        function SchemaAggregate(id) {
            var _this = _super.call(this, id, 'SchemaAggregate') || this;
            _this.setTheme(SchemaAggregate.DEFAULT_THEME);
            _this.setHorizontalGrid(SchemaAggregate.DEFAULT_HORIZONTAL_GRID);
            _this.setVerticalGrid(SchemaAggregate.DEFAULT_VERTICAL_GRID);
            _this.setRowColoring(SchemaAggregate.DEFAULT_ROW_COLORING);
            return _this;
        }
        SchemaAggregate.prototype.createEvent = function () {
            return SchemaCreatedAggregateEvent;
        };
        SchemaAggregate.prototype.changeTheme = function (theme) {
            this.setTheme(theme);
            if (theme === SchemaTheme.MATERIAL) {
                this.setRowColoring(SchemaRowColoring.NONE);
                this.setVerticalGrid(false);
            }
            if (theme === SchemaTheme.LIGHT) {
                this.setRowColoring(SchemaRowColoring.NONE);
                this.setVerticalGrid(false);
            }
            if (theme === SchemaTheme.DARK) {
                this.setRowColoring(SchemaRowColoring.NONE);
                this.setVerticalGrid(false);
            }
            if (theme === SchemaTheme.GENERIC) {
                this.setRowColoring(SchemaRowColoring.ODD);
            }
        };
        SchemaAggregate.prototype.setRowColoring = function (coloring) {
            this.rowColoring = coloring;
            this.addEvent(new RowColoringSetAggregateEvent(this.getId(), this.rowColoring));
        };
        SchemaAggregate.prototype.setVerticalGrid = function (enabled) {
            this.verticalGrid = enabled;
            this.addEvent(new SchemaVerticalGridSetAggregateEvent(this.getId(), this.verticalGrid));
        };
        SchemaAggregate.prototype.setHorizontalGrid = function (enabled) {
            this.horizontalGrid = enabled;
            this.addEvent(new SchemaHorizontalGridSetAggregateEvent(this.getId(), this.horizontalGrid));
        };
        SchemaAggregate.prototype.setTheme = function (theme) {
            this.theme = theme;
            this.addEvent(new SchemaThemeSetAggregateEvent(this.getId(), this.theme));
        };
        return SchemaAggregate;
    }(hermes.AggregateRoot));
    SchemaAggregate.DEFAULT_THEME = SchemaTheme.GENERIC;
    SchemaAggregate.DEFAULT_ROW_COLORING = SchemaRowColoring.ODD;
    SchemaAggregate.DEFAULT_VERTICAL_GRID = true;
    SchemaAggregate.DEFAULT_HORIZONTAL_GRID = true;

    var SchemaAggregateFactory = /** @class */ (function (_super) {
        __extends(SchemaAggregateFactory, _super);
        function SchemaAggregateFactory() {
            return _super.call(this) || this;
        }
        SchemaAggregateFactory.prototype.create = function (aggregateId) {
            return new SchemaAggregate(aggregateId);
        };
        return SchemaAggregateFactory;
    }(hermes.AggregateFactory));
    SchemaAggregateFactory.decorators = [
        { type: core.Injectable }
    ];
    SchemaAggregateFactory.ctorParameters = function () { return []; };

    var SchemaAggregateRepository = /** @class */ (function (_super) {
        __extends(SchemaAggregateRepository, _super);
        function SchemaAggregateRepository() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return SchemaAggregateRepository;
    }(hermes.AggregateRepository));

    var InMemorySchemaStore = /** @class */ (function (_super) {
        __extends(InMemorySchemaStore, _super);
        function InMemorySchemaStore() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return InMemorySchemaStore;
    }(hermes.InMemoryStore));
    InMemorySchemaStore.decorators = [
        { type: core.Injectable }
    ];

    var InMemorySchemaAggregateStore = /** @class */ (function (_super) {
        __extends(InMemorySchemaAggregateStore, _super);
        function InMemorySchemaAggregateStore(inMemorySchemaStore, aggregateStoreRegister) {
            return _super.call(this, inMemorySchemaStore, aggregateStoreRegister) || this;
        }
        return InMemorySchemaAggregateStore;
    }(hermes.InMemoryAggregateStore));
    InMemorySchemaAggregateStore.decorators = [
        { type: core.Injectable }
    ];
    InMemorySchemaAggregateStore.ctorParameters = function () { return [
        { type: InMemorySchemaStore },
        { type: hermes.AggregateStoreRegister }
    ]; };

    var InMemorySchemaAggregateRepository = /** @class */ (function (_super) {
        __extends(InMemorySchemaAggregateRepository, _super);
        function InMemorySchemaAggregateRepository(inMemorySchemaAggregateStore) {
            var _this = _super.call(this) || this;
            _this.inMemorySchemaAggregateStore = inMemorySchemaAggregateStore;
            return _this;
        }
        InMemorySchemaAggregateRepository.prototype.findById = function (schemaId) {
            return this.inMemorySchemaAggregateStore.findById(schemaId);
        };
        InMemorySchemaAggregateRepository.prototype.save = function (schemaAggregate) {
            this.inMemorySchemaAggregateStore.save(schemaAggregate);
        };
        return InMemorySchemaAggregateRepository;
    }(SchemaAggregateRepository));
    InMemorySchemaAggregateRepository.decorators = [
        { type: core.Injectable }
    ];
    InMemorySchemaAggregateRepository.ctorParameters = function () { return [
        { type: InMemorySchemaAggregateStore }
    ]; };

    var CreateSchemaCommand = /** @class */ (function (_super) {
        __extends(CreateSchemaCommand, _super);
        function CreateSchemaCommand(schemaId) {
            return _super.call(this, schemaId, 'CreateSchemaCommand') || this;
        }
        return CreateSchemaCommand;
    }(hermes.CreateAggregateCommand));

    var CreateSchemaCommandHandler = /** @class */ (function () {
        function CreateSchemaCommandHandler() {
        }
        CreateSchemaCommandHandler.prototype.forCommand = function () {
            return CreateSchemaCommand;
        };
        return CreateSchemaCommandHandler;
    }());
    CreateSchemaCommandHandler.decorators = [
        { type: core.Injectable }
    ];

    var SchemaCommand = /** @class */ (function (_super) {
        __extends(SchemaCommand, _super);
        function SchemaCommand() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return SchemaCommand;
    }(hermes.Command));

    var SetSchemaThemeCommand = /** @class */ (function (_super) {
        __extends(SetSchemaThemeCommand, _super);
        function SetSchemaThemeCommand(schemaId, theme) {
            var _this = _super.call(this, schemaId, 'SetSchemaThemeCommand') || this;
            _this.theme = theme;
            return _this;
        }
        SetSchemaThemeCommand.prototype.getTheme = function () {
            return this.theme;
        };
        return SetSchemaThemeCommand;
    }(SchemaCommand));

    var SetSchemaThemeCommandHandler = /** @class */ (function () {
        function SetSchemaThemeCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetSchemaThemeCommandHandler.prototype.forCommand = function () {
            return SetSchemaThemeCommand;
        };
        SetSchemaThemeCommandHandler.prototype.handle = function (schemaAggregate, command) {
            var theme = command.getTheme();
            schemaAggregate.changeTheme(theme);
        };
        SetSchemaThemeCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SetSchemaThemeCommandHandler;
    }());
    SetSchemaThemeCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetSchemaThemeCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetRowColoringCommand = /** @class */ (function (_super) {
        __extends(SetRowColoringCommand, _super);
        function SetRowColoringCommand(schemaId, coloring) {
            var _this = _super.call(this, schemaId, 'SetRowColoringCommand') || this;
            _this.coloring = coloring;
            return _this;
        }
        SetRowColoringCommand.prototype.getColoring = function () {
            return this.coloring;
        };
        return SetRowColoringCommand;
    }(SchemaCommand));

    var SetRowColoringCommandHandler = /** @class */ (function () {
        function SetRowColoringCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetRowColoringCommandHandler.prototype.forCommand = function () {
            return SetRowColoringCommand;
        };
        SetRowColoringCommandHandler.prototype.handle = function (schemaAggregate, command) {
            var coloring = command.getColoring();
            schemaAggregate.setRowColoring(coloring);
        };
        SetRowColoringCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SetRowColoringCommandHandler;
    }());
    SetRowColoringCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetRowColoringCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetSchemaHorizontalGridCommand = /** @class */ (function (_super) {
        __extends(SetSchemaHorizontalGridCommand, _super);
        function SetSchemaHorizontalGridCommand(schemaId, enabled) {
            var _this = _super.call(this, schemaId, 'SetSchemaHorizontalGridCommand') || this;
            _this.enabled = enabled;
            return _this;
        }
        SetSchemaHorizontalGridCommand.prototype.isEnabled = function () {
            return this.enabled;
        };
        return SetSchemaHorizontalGridCommand;
    }(SchemaCommand));

    var SetSchemaHorizontalGridCommandHandler = /** @class */ (function () {
        function SetSchemaHorizontalGridCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetSchemaHorizontalGridCommandHandler.prototype.forCommand = function () {
            return SetSchemaHorizontalGridCommand;
        };
        SetSchemaHorizontalGridCommandHandler.prototype.handle = function (schemaAggregate, command) {
            var enabled = command.isEnabled();
            schemaAggregate.setHorizontalGrid(enabled);
        };
        SetSchemaHorizontalGridCommandHandler.prototype.publish = function (schemaAggregate, command) {
            this.domainEventPublisher.publishFromAggregate(schemaAggregate);
        };
        return SetSchemaHorizontalGridCommandHandler;
    }());
    SetSchemaHorizontalGridCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetSchemaHorizontalGridCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetSchemaVerticalGridCommand = /** @class */ (function (_super) {
        __extends(SetSchemaVerticalGridCommand, _super);
        function SetSchemaVerticalGridCommand(schemaId, enabled) {
            var _this = _super.call(this, schemaId, 'SetSchemaVerticalGridCommand') || this;
            _this.enabled = enabled;
            return _this;
        }
        SetSchemaVerticalGridCommand.prototype.isEnabled = function () {
            return this.enabled;
        };
        return SetSchemaVerticalGridCommand;
    }(SchemaCommand));

    var SetSchemaVerticalGridCommandHandler = /** @class */ (function () {
        function SetSchemaVerticalGridCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetSchemaVerticalGridCommandHandler.prototype.forCommand = function () {
            return SetSchemaVerticalGridCommand;
        };
        SetSchemaVerticalGridCommandHandler.prototype.handle = function (schemaAggregate, command) {
            var enabled = command.isEnabled();
            schemaAggregate.setVerticalGrid(enabled);
        };
        SetSchemaVerticalGridCommandHandler.prototype.publish = function (schemaAggregate, command) {
            this.domainEventPublisher.publishFromAggregate(schemaAggregate);
        };
        return SetSchemaVerticalGridCommandHandler;
    }());
    SetSchemaVerticalGridCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetSchemaVerticalGridCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SchemaCssClassesRepository = /** @class */ (function (_super) {
        __extends(SchemaCssClassesRepository, _super);
        function SchemaCssClassesRepository() {
            return _super.call(this) || this;
        }
        return SchemaCssClassesRepository;
    }(hermes.AggregateArchive));
    SchemaCssClassesRepository.decorators = [
        { type: core.Injectable }
    ];
    SchemaCssClassesRepository.ctorParameters = function () { return []; };

    var SchemaCssClass = /** @class */ (function () {
        function SchemaCssClass(verticalGrid, horizontalGrid, theme, rowColoring) {
            this.verticalGrid = verticalGrid;
            this.horizontalGrid = horizontalGrid;
            this.theme = theme;
            this.rowColoring = rowColoring;
        }
        SchemaCssClass.prototype.getRowColoring = function () {
            return this.rowColoring;
        };
        return SchemaCssClass;
    }());

    var SchemaCssClassesEventHandler = /** @class */ (function () {
        function SchemaCssClassesEventHandler(schemaCssClassesRepository) {
            this.schemaCssClassesRepository = schemaCssClassesRepository;
        }
        SchemaCssClassesEventHandler.prototype.forEvents = function () {
            return [
                SchemaThemeSetEvent,
                RowColoringSetEvent,
                SchemaHorizontalGridSetEvent,
                SchemaVerticalGridSetEvent
            ];
        };
        SchemaCssClassesEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('RowColoringSetEvent')) {
                this.rowColoring = event.getRowColoring();
            }
            if (event.ofMessageType('SchemaHorizontalGridSetEvent')) {
                this.horizontalGrid = event.getHorizontalGrid();
            }
            if (event.ofMessageType('SchemaVerticalGridSetEvent')) {
                this.verticalGrid = event.getVerticalGrid();
            }
            if (event.ofMessageType('SchemaThemeSetEvent')) {
                this.schemaTheme = event.getTheme();
            }
            this.publish(event.getAggregateId());
        };
        SchemaCssClassesEventHandler.prototype.publish = function (aggregateId) {
            if (this.rowColoring !== undefined && this.horizontalGrid !== undefined && this.verticalGrid !== undefined && this.schemaTheme !== undefined) {
                this.schemaCssClassesRepository.next(aggregateId, new SchemaCssClass(this.verticalGrid, this.horizontalGrid, this.schemaTheme, this.rowColoring));
            }
        };
        return SchemaCssClassesEventHandler;
    }());
    SchemaCssClassesEventHandler.decorators = [
        { type: core.Injectable }
    ];
    SchemaCssClassesEventHandler.ctorParameters = function () { return [
        { type: SchemaCssClassesRepository }
    ]; };

    var schemaKey = 'SchemaAggregate';

    var SchemaVerticalGridRepository = /** @class */ (function (_super) {
        __extends(SchemaVerticalGridRepository, _super);
        function SchemaVerticalGridRepository() {
            return _super.call(this) || this;
        }
        SchemaVerticalGridRepository.prototype.forEvent = function () {
            return SchemaVerticalGridSetEvent;
        };
        return SchemaVerticalGridRepository;
    }(hermes.EventDrivenRepository));
    SchemaVerticalGridRepository.decorators = [
        { type: core.Injectable }
    ];
    SchemaVerticalGridRepository.ctorParameters = function () { return []; };

    var SchemaThemeRepository = /** @class */ (function (_super) {
        __extends(SchemaThemeRepository, _super);
        function SchemaThemeRepository() {
            return _super.call(this) || this;
        }
        SchemaThemeRepository.prototype.forEvent = function () {
            return SchemaThemeSetEvent;
        };
        return SchemaThemeRepository;
    }(hermes.EventDrivenRepository));
    SchemaThemeRepository.decorators = [
        { type: core.Injectable }
    ];
    SchemaThemeRepository.ctorParameters = function () { return []; };

    var SchemaRowColoringRepository = /** @class */ (function (_super) {
        __extends(SchemaRowColoringRepository, _super);
        function SchemaRowColoringRepository() {
            return _super.call(this) || this;
        }
        SchemaRowColoringRepository.prototype.forEvent = function () {
            return RowColoringSetEvent;
        };
        return SchemaRowColoringRepository;
    }(hermes.EventDrivenRepository));
    SchemaRowColoringRepository.decorators = [
        { type: core.Injectable }
    ];
    SchemaRowColoringRepository.ctorParameters = function () { return []; };

    var SchemaHorizontalGridRepository = /** @class */ (function (_super) {
        __extends(SchemaHorizontalGridRepository, _super);
        function SchemaHorizontalGridRepository() {
            return _super.call(this) || this;
        }
        SchemaHorizontalGridRepository.prototype.forEvent = function () {
            return SchemaHorizontalGridSetEvent;
        };
        return SchemaHorizontalGridRepository;
    }(hermes.EventDrivenRepository));
    SchemaHorizontalGridRepository.decorators = [
        { type: core.Injectable }
    ];
    SchemaHorizontalGridRepository.ctorParameters = function () { return []; };

    var SchemaDomainModule = /** @class */ (function (_super) {
        __extends(SchemaDomainModule, _super);
        function SchemaDomainModule() {
            return _super.call(this) || this;
        }
        SchemaDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SetSchemaThemeCommandHandler, schemaKey),
                hermes.HermesModule.registerCommandHandler(SetRowColoringCommandHandler, schemaKey),
                hermes.HermesModule.registerCommandHandler(SetSchemaHorizontalGridCommandHandler, schemaKey),
                hermes.HermesModule.registerCommandHandler(SetSchemaVerticalGridCommandHandler, schemaKey)
            ];
        };
        SchemaDomainModule.domainEventHandlers = function () {
            return [
                hermes.HermesModule.registerDomainEventHandler(SchemaThemeRepository),
                hermes.HermesModule.registerDomainEventHandler(SchemaHorizontalGridRepository),
                hermes.HermesModule.registerDomainEventHandler(SchemaRowColoringRepository),
                hermes.HermesModule.registerDomainEventHandler(SchemaVerticalGridRepository),
                hermes.HermesModule.registerMultiDomainEventHandler(SchemaCssClassesEventHandler)
            ];
        };
        return SchemaDomainModule;
    }(hermes.DomainModule));
    SchemaDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [],
                    declarations: [],
                    exports: []
                },] }
    ];
    SchemaDomainModule.ctorParameters = function () { return []; };

    var SchemaDispatcher = /** @class */ (function () {
        function SchemaDispatcher(commandDispatcher) {
            this.commandDispatcher = commandDispatcher;
        }
        SchemaDispatcher.prototype.create = function (schemaId) {
            this.commandDispatcher.dispatch(new CreateSchemaCommand(schemaId));
        };
        SchemaDispatcher.prototype.setTheme = function (theme, schemaId) {
            this.commandDispatcher.dispatch(new SetSchemaThemeCommand(schemaId, theme));
        };
        SchemaDispatcher.prototype.setRowColoring = function (rowColoring, schemaId) {
            this.commandDispatcher.dispatch(new SetRowColoringCommand(schemaId, rowColoring));
        };
        SchemaDispatcher.prototype.setVerticalGrid = function (verticalGrid, schemaId) {
            this.commandDispatcher.dispatch(new SetSchemaVerticalGridCommand(schemaId, verticalGrid));
        };
        SchemaDispatcher.prototype.setHorizontalGrid = function (horizontalGrid, schemaId) {
            this.commandDispatcher.dispatch(new SetSchemaHorizontalGridCommand(schemaId, horizontalGrid));
        };
        return SchemaDispatcher;
    }());
    SchemaDispatcher.decorators = [
        { type: core.Injectable }
    ];
    SchemaDispatcher.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var SchemaDomainCommandInvoker = /** @class */ (function (_super) {
        __extends(SchemaDomainCommandInvoker, _super);
        function SchemaDomainCommandInvoker(schemaDispatcher, structureCommandService, fabricModalThemeService) {
            var _this = _super.call(this) || this;
            _this.schemaDispatcher = schemaDispatcher;
            _this.structureCommandService = structureCommandService;
            _this.fabricModalThemeService = fabricModalThemeService;
            return _this;
        }
        SchemaDomainCommandInvoker.prototype.create = function (schemaId) {
            this.schemaDispatcher.create(schemaId.toAggregateId());
        };
        SchemaDomainCommandInvoker.prototype.setTheme = function (theme, schemaId, structureId) {
            this.schemaDispatcher.setTheme(theme, schemaId.toAggregateId());
            this.fabricModalThemeService.changeTheme(this.toFabricTheme(theme)); // TODO github #2162
            this.structureCommandService.setRowHeightBasedOnTheme(theme, structureId);
        };
        SchemaDomainCommandInvoker.prototype.setRowColoring = function (rowColoring, schemaId) {
            var schemaRowColoring = this.toSchemaRowColoring(rowColoring);
            this.schemaDispatcher.setRowColoring(schemaRowColoring, schemaId.toAggregateId());
        };
        SchemaDomainCommandInvoker.prototype.setVerticalGrid = function (verticalGrid, schemaId) {
            this.schemaDispatcher.setVerticalGrid(verticalGrid, schemaId.toAggregateId());
        };
        SchemaDomainCommandInvoker.prototype.setHorizontalGrid = function (horizontalGrid, schemaId) {
            this.schemaDispatcher.setHorizontalGrid(horizontalGrid, schemaId.toAggregateId());
        };
        SchemaDomainCommandInvoker.prototype.toSchemaRowColoring = function (coloring) {
            switch (coloring) {
                case RowColoring.NONE:
                    return SchemaRowColoring.NONE;
                case RowColoring.ODD:
                    return SchemaRowColoring.ODD;
                case RowColoring.EVEN:
                    return SchemaRowColoring.EVEN;
                default:
                    return SchemaRowColoring.NONE;
            }
        };
        SchemaDomainCommandInvoker.prototype.toFabricTheme = function (schemaTheme) {
            switch (schemaTheme) {
                case SchemaTheme.DARK: {
                    return fabric.Theme.DARK;
                }
                case SchemaTheme.FABRIC: {
                    return fabric.Theme.FABRIC;
                }
                case SchemaTheme.GENERIC: {
                    return fabric.Theme.GENERIC;
                }
                case SchemaTheme.LIGHT: {
                    return fabric.Theme.LIGHT;
                }
                case SchemaTheme.MATERIAL: {
                    return fabric.Theme.MATERIAL;
                }
                default:
                    return fabric.Theme.FABRIC;
            }
        };
        return SchemaDomainCommandInvoker;
    }(SchemaCommandInvoker));
    SchemaDomainCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SchemaDomainCommandInvoker.ctorParameters = function () { return [
        { type: SchemaDispatcher },
        { type: StructureCommandInvoker },
        { type: fabric.FabricModalThemeService }
    ]; };

    var SchemaDomainWarehouse = /** @class */ (function (_super) {
        __extends(SchemaDomainWarehouse, _super);
        function SchemaDomainWarehouse(schemaCssClassesRepository, schemaThemeRepository, schemaHorizontalGridRepository, schemaRowColoringRepository, schemaVerticalGridRepository) {
            var _this = _super.call(this) || this;
            _this.schemaCssClassesRepository = schemaCssClassesRepository;
            _this.schemaThemeRepository = schemaThemeRepository;
            _this.schemaHorizontalGridRepository = schemaHorizontalGridRepository;
            _this.schemaRowColoringRepository = schemaRowColoringRepository;
            _this.schemaVerticalGridRepository = schemaVerticalGridRepository;
            return _this;
        }
        SchemaDomainWarehouse.prototype.onTheme = function (schemaId) {
            return this.schemaThemeRepository
                .on(schemaId.toAggregateId());
        };
        SchemaDomainWarehouse.prototype.onceTheme = function (schemaId) {
            return this.onTheme(schemaId)
                .pipe(hermes.hermesTake(1));
        };
        SchemaDomainWarehouse.prototype.onHorizontalGrid = function (schemaId) {
            return this.schemaHorizontalGridRepository
                .on(schemaId.toAggregateId());
        };
        SchemaDomainWarehouse.prototype.onVerticalGrid = function (schemaId) {
            return this.schemaVerticalGridRepository
                .on(schemaId.toAggregateId());
        };
        SchemaDomainWarehouse.prototype.onRowColoring = function (schemaId) {
            return this.schemaRowColoringRepository
                .on(schemaId.toAggregateId());
        };
        SchemaDomainWarehouse.prototype.onCssClasses = function (schemaId) {
            return this.schemaCssClassesRepository
                .on(schemaId.toAggregateId());
        };
        return SchemaDomainWarehouse;
    }(SchemaWarehouse));
    SchemaDomainWarehouse.decorators = [
        { type: core.Injectable }
    ];
    SchemaDomainWarehouse.ctorParameters = function () { return [
        { type: SchemaCssClassesRepository },
        { type: SchemaThemeRepository },
        { type: SchemaHorizontalGridRepository },
        { type: SchemaRowColoringRepository },
        { type: SchemaVerticalGridRepository }
    ]; };

    var SchemaDomainEventRepository = /** @class */ (function (_super) {
        __extends(SchemaDomainEventRepository, _super);
        function SchemaDomainEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        SchemaDomainEventRepository.prototype.onThemeChanged = function (schemaId) {
            return this.onEvent(schemaId, SchemaThemeSetEvent)
                .pipe(hermes.hermesMap(function (event) {
                return event.getTheme();
            }));
        };
        SchemaDomainEventRepository.prototype.onHorizontalGridChanged = function (schemaId) {
            return this.onEvent(schemaId, SchemaHorizontalGridSetEvent)
                .pipe(hermes.hermesMap(function (event) { return event.getHorizontalGrid(); }));
        };
        SchemaDomainEventRepository.prototype.onVerticalGridChanged = function (schemaId) {
            return this.onEvent(schemaId, SchemaVerticalGridSetEvent)
                .pipe(hermes.hermesMap(function (event) { return event.getVerticalGrid(); }));
        };
        SchemaDomainEventRepository.prototype.onRowColoring = function (schemaId) {
            return this.onEvent(schemaId, RowColoringSetEvent)
                .pipe(hermes.hermesMap(function (event) { return event.getRowColoring(); }));
        };
        return SchemaDomainEventRepository;
    }(SchemaEventRepository));
    SchemaDomainEventRepository.decorators = [
        { type: core.Injectable }
    ];
    SchemaDomainEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var SchemaApiModule = /** @class */ (function (_super) {
        __extends(SchemaApiModule, _super);
        function SchemaApiModule() {
            return _super.call(this) || this;
        }
        return SchemaApiModule;
    }(hermes.ApiModule));
    SchemaApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        hermes.HermesModule.defineAggregate(schemaKey, SchemaAggregateFactory, InMemorySchemaAggregateRepository, CreateSchemaCommandHandler, SchemaDomainModule.commandHandlers(), SchemaDomainModule.domainEventHandlers()),
                        SchemaDomainModule
                    ],
                    providers: [
                        SchemaDispatcher,
                        {
                            provide: SchemaAggregateRepository,
                            useClass: InMemorySchemaAggregateRepository
                        },
                        InMemorySchemaAggregateStore,
                        InMemorySchemaStore,
                        {
                            provide: SchemaCommandInvoker,
                            useClass: SchemaDomainCommandInvoker
                        },
                        {
                            provide: SchemaWarehouse,
                            useClass: SchemaDomainWarehouse
                        },
                        {
                            provide: SchemaEventRepository,
                            useClass: SchemaDomainEventRepository
                        },
                        SchemaCssClassesRepository
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    SchemaApiModule.ctorParameters = function () { return []; };

    var SchemaFeatureModule = /** @class */ (function (_super) {
        __extends(SchemaFeatureModule, _super);
        function SchemaFeatureModule(schemaApiModule) {
            var _this = _super.call(this) || this;
            if (schemaApiModule === null) {
                throw new Error('SchemaApiModule is required.');
            }
            return _this;
        }
        SchemaFeatureModule.forComponent = function () {
            return [
                SchemaRowClassArchive,
                SchemaRowStyleArchive
            ];
        };
        return SchemaFeatureModule;
    }(hermes.FeatureModule));
    SchemaFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        SchemaApiModule
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    SchemaFeatureModule.ctorParameters = function () { return [
        { type: SchemaApiModule, decorators: [{ type: core.Optional }] }
    ]; };

    var StyleName;
    (function (StyleName) {
        StyleName["WIDTH"] = "width";
        StyleName["HEIGHT"] = "height";
        StyleName["PADDING_TOP"] = "padding-top";
    })(StyleName || (StyleName = {}));

    var _a;
    var StyleModifier = /** @class */ (function (_super) {
        __extends(StyleModifier, _super);
        function StyleModifier(htmlElement) {
            var _this = _super.call(this, htmlElement) || this;
            _this.htmlElement = htmlElement;
            return _this;
        }
        StyleModifier.prototype.createModifier = function (htmlElement) {
            return new StyleModifier.StyleModifier(htmlElement);
        };
        return StyleModifier;
    }(Modifier));
    // eslint-disable-next-line
    StyleModifier.StyleModifier = (_a = /** @class */ (function () {
        function _a(htmlElement) {
            this.htmlElement = htmlElement;
        }
        _a.prototype.setStyleByName = function (name, value) {
            this.set(name, value);
        };
        _a.prototype.setWidth = function (value) {
            this.set(StyleName.WIDTH, this.toPx(value));
        };
        _a.prototype.setHeight = function (value) {
            this.set(StyleName.HEIGHT, this.toPx(value));
        };
        _a.prototype.setPaddingTop = function (value) {
            this.set(StyleName.PADDING_TOP, this.toPx(value));
        };
        _a.prototype.remove = function (styleName) {
            this.htmlElement[StyleModifier.StyleModifier.STYLE][styleName] = '';
        };
        _a.prototype.removeStyleByName = function (name) {
            this.htmlElement[StyleModifier.StyleModifier.STYLE][name] = '';
        };
        _a.prototype.clear = function () {
            this.htmlElement.removeAttribute(StyleModifier.StyleModifier.STYLE);
        };
        _a.prototype.set = function (name, value) {
            this.htmlElement[StyleModifier.StyleModifier.STYLE][name] = value;
        };
        _a.prototype.toPx = function (value) {
            return value > 0 ? value + "px" : "" + value;
        };
        return _a;
    }()),
        _a.STYLE = 'style',
        _a);

    var SummariesCommandInvoker = /** @class */ (function () {
        function SummariesCommandInvoker() {
        }
        return SummariesCommandInvoker;
    }());
    SummariesCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SummariesCommandInvoker.ctorParameters = function () { return []; };

    var SummariesEventRepository = /** @class */ (function (_super) {
        __extends(SummariesEventRepository, _super);
        function SummariesEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        return SummariesEventRepository;
    }(hermes.EventRepository));
    SummariesEventRepository.decorators = [
        { type: core.Injectable }
    ];
    SummariesEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var StructureSetSummariesEnabledCommand = /** @class */ (function (_super) {
        __extends(StructureSetSummariesEnabledCommand, _super);
        function StructureSetSummariesEnabledCommand(structureId, enabled) {
            var _this = _super.call(this, structureId, 'StructureSetSummariesEnabledCommand') || this;
            _this.enabled = enabled;
            return _this;
        }
        StructureSetSummariesEnabledCommand.prototype.isEnabled = function () {
            return this.enabled;
        };
        return StructureSetSummariesEnabledCommand;
    }(StructureCommand));

    var StructureSummariesEnabledSetEventName = 'StructureSummariesEnabledSetEvent';
    var StructureSummariesEnabledSetEvent = /** @class */ (function (_super) {
        __extends(StructureSummariesEnabledSetEvent, _super);
        function StructureSummariesEnabledSetEvent(aggregateId, enabled) {
            var _this = _super.call(this, aggregateId, enabled, StructureSummariesEnabledSetEventName) || this;
            _this.enabled = enabled;
            return _this;
        }
        StructureSummariesEnabledSetEvent.prototype.isEnabled = function () {
            return this.enabled;
        };
        return StructureSummariesEnabledSetEvent;
    }(StructureDomainEvent));

    var StructureSetSummariesEnabledCommandHandler = /** @class */ (function () {
        function StructureSetSummariesEnabledCommandHandler(structureSourceDomainEventPublisher, domainEventPublisher) {
            this.structureSourceDomainEventPublisher = structureSourceDomainEventPublisher;
            this.domainEventPublisher = domainEventPublisher;
        }
        StructureSetSummariesEnabledCommandHandler.prototype.forCommand = function () {
            return StructureSetSummariesEnabledCommand;
        };
        StructureSetSummariesEnabledCommandHandler.prototype.handle = function (structure, command) {
            var enabled = command.isEnabled();
            structure.setSummariesEnabled(enabled);
        };
        StructureSetSummariesEnabledCommandHandler.prototype.publish = function (aggregate, command) {
            var enabled = command.isEnabled(), aggregateEvents = aggregate.getEvents();
            this.domainEventPublisher.publish(new StructureSummariesEnabledSetEvent(command.getAggregateId(), enabled));
            this.structureSourceDomainEventPublisher.publish(aggregateEvents);
        };
        return StructureSetSummariesEnabledCommandHandler;
    }());
    StructureSetSummariesEnabledCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    StructureSetSummariesEnabledCommandHandler.ctorParameters = function () { return [
        { type: SourceDomainEventPublisher },
        { type: hermes.DomainEventPublisher }
    ]; };

    var StructureSummariesChangedAggregateEvent = /** @class */ (function (_super) {
        __extends(StructureSummariesChangedAggregateEvent, _super);
        function StructureSummariesChangedAggregateEvent(aggregateId, summarizedValues) {
            var _this = _super.call(this, aggregateId, 'StructureSummariesChangedAggregateEvent') || this;
            _this.summarizedValues = summarizedValues;
            return _this;
        }
        StructureSummariesChangedAggregateEvent.prototype.toDomainEvent = function () {
            return new StructureSummariesChangedEvent(this.getAggregateId(), this.summarizedValues);
        };
        StructureSummariesChangedAggregateEvent.prototype.getSummaries = function () {
            return this.summarizedValues;
        };
        return StructureSummariesChangedAggregateEvent;
    }(StructureAggregateEvent));

    var SummariesManager = /** @class */ (function () {
        function SummariesManager(structureId, calculators) {
            this.calculators = calculators;
            this.values = new Map();
            this.structureId = structureId;
            this.enabled = SummariesManager.DEFAULT_ENABLED;
        }
        SummariesManager.prototype.calculate = function (fields, entities) {
            if (!this.enabled) {
                return [];
            }
            var calculations = new Map();
            this.calculators.forEach(function (calc) {
                var aggregatedValues = calc.calculate(fields, entities);
                if (aggregatedValues) {
                    Array.from(aggregatedValues.keys())
                        .forEach(function (key) {
                        calculations.set(key, aggregatedValues.get(key));
                    });
                }
            });
            if (calculations.size > 0) {
                return [
                    new StructureSummariesChangedAggregateEvent(this.structureId, calculations)
                ];
            }
            else {
                return [];
            }
        };
        SummariesManager.prototype.setEnabled = function (enabled) {
            this.enabled = enabled;
        };
        SummariesManager.prototype.add = function () {
        };
        SummariesManager.prototype.remove = function () {
        };
        SummariesManager.prototype.update = function () {
        };
        return SummariesManager;
    }());
    SummariesManager.DEFAULT_ENABLED = false;

    var SummariesEnabledArchive = /** @class */ (function (_super) {
        __extends(SummariesEnabledArchive, _super);
        function SummariesEnabledArchive() {
            return _super.call(this, SummariesManager.DEFAULT_ENABLED) || this;
        }
        SummariesEnabledArchive.prototype.init = function (structureId) {
            this.next(structureId, SummariesManager.DEFAULT_ENABLED);
        };
        return SummariesEnabledArchive;
    }(hermes.AggregateArchive));
    SummariesEnabledArchive.decorators = [
        { type: core.Injectable }
    ];
    SummariesEnabledArchive.ctorParameters = function () { return []; };

    var StructureSummariesEnabledSetEventHandler = /** @class */ (function () {
        function StructureSummariesEnabledSetEventHandler(summariesEnabledArchive) {
            this.summariesEnabledArchive = summariesEnabledArchive;
        }
        StructureSummariesEnabledSetEventHandler.prototype.forEvent = function () {
            return StructureSummariesEnabledSetEvent;
        };
        StructureSummariesEnabledSetEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('StructureSummariesEnabledSetEvent')) {
                this.summariesEnabledArchive.next(event.getAggregateId(), event.isEnabled());
            }
        };
        return StructureSummariesEnabledSetEventHandler;
    }());
    StructureSummariesEnabledSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    StructureSummariesEnabledSetEventHandler.ctorParameters = function () { return [
        { type: SummariesEnabledArchive }
    ]; };

    var SUMMARIES_CALCULATORS = 'GUI - Summaries Calculators';

    function provideSummariesCalculator(clazz) {
        return {
            provide: SUMMARIES_CALCULATORS,
            useClass: clazz,
            multi: true
        };
    }

    var SummariesCalculator = /** @class */ (function () {
        function SummariesCalculator() {
        }
        SummariesCalculator.prototype.calculate = function (fields, items) {
            var _this = this;
            var filteredFields = fields.filter(function (field) { return _this.forDataType(field.getDataType()); });
            if (!filteredFields || filteredFields.length === 0 || items.length === 0) {
                return null;
            }
            var count = new Map(), distinct = new Map();
            // init
            filteredFields.forEach(function (field) {
                var key = field.getKey();
                count.set(key, 0);
                distinct.set(key, new Set());
                _this.prepare(field);
            });
            // calculate
            items.forEach(function (item) {
                filteredFields.forEach(function (field) {
                    var key = field.getKey(), value = field.getValue(item);
                    if (value !== null || value !== undefined || value !== '') {
                        if (field.isSummaries(SummariesType.COUNT)) {
                            var countForField = count.get(key);
                            count.set(key, countForField + 1);
                        }
                        if (field.isSummaries(SummariesType.DISTINCT)) {
                            var distinctSet = distinct.get(key);
                            distinctSet.add(value);
                        }
                    }
                    _this.aggregate(field, value);
                });
            });
            filteredFields.forEach(function (field) {
                _this.postCalculate(field, items);
            });
            var summaries = new Map();
            filteredFields.forEach(function (field) {
                var key = field.getKey();
                var aggregatedValues = _this.generateAggregatedValues(field);
                if (field.isSummaries(SummariesType.COUNT)) {
                    aggregatedValues.setCount(count.get(key));
                }
                if (field.isSummaries(SummariesType.DISTINCT)) {
                    aggregatedValues.setDistinct((distinct.get(key)).size);
                }
                summaries.set(key, aggregatedValues);
            });
            return summaries;
        };
        return SummariesCalculator;
    }());

    var SummariesValues = /** @class */ (function () {
        function SummariesValues() {
        }
        SummariesValues.prototype.setCount = function (value) {
            this.count = value;
        };
        SummariesValues.prototype.setDistinct = function (value) {
            this.distinct = value;
        };
        return SummariesValues;
    }());

    var BooleanSummarizedValues = /** @class */ (function (_super) {
        __extends(BooleanSummarizedValues, _super);
        function BooleanSummarizedValues(truthy, falsy) {
            var _this = _super.call(this) || this;
            _this.truthy = truthy;
            _this.falsy = falsy;
            return _this;
        }
        return BooleanSummarizedValues;
    }(SummariesValues));

    var BooleanSummariesCalculator = /** @class */ (function (_super) {
        __extends(BooleanSummariesCalculator, _super);
        function BooleanSummariesCalculator() {
            var _this = _super.call(this) || this;
            _this.truthy = new Map();
            _this.falsy = new Map();
            return _this;
        }
        BooleanSummariesCalculator.prototype.forDataType = function (dataType) {
            return dataType === DataType.BOOLEAN;
        };
        BooleanSummariesCalculator.prototype.prepare = function (field) {
            var key = field.getKey();
            if (field.isSummaries(SummariesType.TRUTHY)) {
                this.truthy.set(key, 0);
            }
            if (field.isSummaries(SummariesType.FALSY)) {
                this.falsy.set(key, 0);
            }
        };
        BooleanSummariesCalculator.prototype.postCalculate = function (field, items) {
        };
        BooleanSummariesCalculator.prototype.aggregate = function (field, value) {
            var booleanValue = value, // (value as any === 'true'),
            key = field.getKey(), truthyForField = this.truthy.get(key), falsyForField = this.falsy.get(key);
            if (booleanValue) {
                if (field.isSummaries(SummariesType.TRUTHY)) {
                    this.truthy.set(key, truthyForField + 1);
                }
            }
            else {
                if (field.isSummaries(SummariesType.FALSY)) {
                    this.falsy.set(key, falsyForField + 1);
                }
            }
        };
        BooleanSummariesCalculator.prototype.generateAggregatedValues = function (field) {
            var key = field.getKey();
            return new BooleanSummarizedValues(this.truthy.get(key), this.falsy.get(key));
        };
        return BooleanSummariesCalculator;
    }(SummariesCalculator));
    BooleanSummariesCalculator.decorators = [
        { type: core.Injectable }
    ];
    BooleanSummariesCalculator.ctorParameters = function () { return []; };

    var DateSummarizedValues = /** @class */ (function (_super) {
        __extends(DateSummarizedValues, _super);
        function DateSummarizedValues() {
            return _super.call(this) || this;
        }
        return DateSummarizedValues;
    }(SummariesValues));

    var DateSummariesCalculator = /** @class */ (function (_super) {
        __extends(DateSummariesCalculator, _super);
        function DateSummariesCalculator() {
            return _super.call(this) || this;
        }
        DateSummariesCalculator.prototype.forDataType = function (dataType) {
            return dataType === DataType.DATE;
        };
        DateSummariesCalculator.prototype.prepare = function (field) {
        };
        DateSummariesCalculator.prototype.postCalculate = function (field, items) {
        };
        DateSummariesCalculator.prototype.aggregate = function (field, value) {
        };
        DateSummariesCalculator.prototype.generateAggregatedValues = function (field) {
            return new DateSummarizedValues();
        };
        return DateSummariesCalculator;
    }(SummariesCalculator));
    DateSummariesCalculator.decorators = [
        { type: core.Injectable }
    ];
    DateSummariesCalculator.ctorParameters = function () { return []; };

    var NumberSummarizedValues = /** @class */ (function (_super) {
        __extends(NumberSummarizedValues, _super);
        function NumberSummarizedValues(sum, min, max, average, median) {
            var _this = _super.call(this) || this;
            _this.sum = _this.setValueWithPrecision(sum);
            _this.min = _this.setValueWithPrecision(min);
            _this.max = _this.setValueWithPrecision(max);
            _this.average = _this.setValueWithPrecision(average);
            _this.median = _this.setValueWithPrecision(median);
            return _this;
        }
        NumberSummarizedValues.prototype.setValueWithPrecision = function (value) {
            if (!value && value !== 0) {
                return null;
            }
            if (value === 0) {
                return 0;
            }
            return +((value).toFixed(2));
        };
        return NumberSummarizedValues;
    }(SummariesValues));

    var NumberSummariesCalculator = /** @class */ (function (_super) {
        __extends(NumberSummariesCalculator, _super);
        function NumberSummariesCalculator() {
            var _this = _super.call(this) || this;
            _this.sum = new Map();
            _this.min = new Map();
            _this.max = new Map();
            _this.average = new Map();
            _this.median = new Map();
            return _this;
        }
        NumberSummariesCalculator.prototype.forDataType = function (dataType) {
            return dataType === DataType.NUMBER;
        };
        NumberSummariesCalculator.prototype.prepare = function (field) {
            var key = field.getKey();
            this.sum.set(key, 0);
            this.min.set(key, Number.MAX_SAFE_INTEGER);
            this.max.set(key, 0);
        };
        NumberSummariesCalculator.prototype.postCalculate = function (field, items) {
            var key = field.getKey();
            if (field.isSummaries(SummariesType.AVERAGE)) {
                this.average.set(key, this.sum.get(key) / items.length);
            }
            if (field.isSummaries(SummariesType.MEDIAN)) {
                this.median.set(key, field.getValue(items[Math.floor(items.length / 2)]));
            }
        };
        NumberSummariesCalculator.prototype.aggregate = function (field, value) {
            var numberValue = +value, key = field.getKey(), sumForField = this.sum.get(key), minForField = this.min.get(key), maxForField = this.max.get(key);
            if (field.isSummaries(SummariesType.SUM) || field.isSummaries(SummariesType.AVERAGE)) {
                this.sum.set(key, sumForField + numberValue);
            }
            if (field.isSummaries(SummariesType.MIN)) {
                if (minForField > numberValue) {
                    this.min.set(key, numberValue);
                }
            }
            if (field.isSummaries(SummariesType.MAX)) {
                if (maxForField < numberValue) {
                    this.max.set(key, numberValue);
                }
            }
        };
        NumberSummariesCalculator.prototype.generateAggregatedValues = function (field) {
            var key = field.getKey(), sum = field.isSummaries(SummariesType.SUM) ? this.sum.get(key) : undefined, min = field.isSummaries(SummariesType.MIN) ? this.min.get(key) : undefined, max = field.isSummaries(SummariesType.MAX) ? this.max.get(key) : undefined, average = field.isSummaries(SummariesType.AVERAGE) ? this.average.get(key) : undefined, median = field.isSummaries(SummariesType.MEDIAN) ? this.median.get(key) : undefined;
            return new NumberSummarizedValues(sum, min, max, average, median);
        };
        return NumberSummariesCalculator;
    }(SummariesCalculator));
    NumberSummariesCalculator.decorators = [
        { type: core.Injectable }
    ];
    NumberSummariesCalculator.ctorParameters = function () { return []; };

    var StringSummarizedValues = /** @class */ (function (_super) {
        __extends(StringSummarizedValues, _super);
        function StringSummarizedValues() {
            return _super.call(this) || this;
        }
        return StringSummarizedValues;
    }(SummariesValues));

    var StringSummariesCalculator = /** @class */ (function (_super) {
        __extends(StringSummariesCalculator, _super);
        function StringSummariesCalculator() {
            return _super.call(this) || this;
        }
        StringSummariesCalculator.prototype.forDataType = function (dataType) {
            return dataType === DataType.STRING;
        };
        StringSummariesCalculator.prototype.prepare = function (field) {
        };
        StringSummariesCalculator.prototype.postCalculate = function (field, items) {
        };
        StringSummariesCalculator.prototype.aggregate = function (field, value) {
        };
        StringSummariesCalculator.prototype.generateAggregatedValues = function (field) {
            return new StringSummarizedValues();
        };
        return StringSummariesCalculator;
    }(SummariesCalculator));
    StringSummariesCalculator.decorators = [
        { type: core.Injectable }
    ];
    StringSummariesCalculator.ctorParameters = function () { return []; };

    var UnknownSummarizedValues = /** @class */ (function (_super) {
        __extends(UnknownSummarizedValues, _super);
        function UnknownSummarizedValues() {
            return _super.call(this) || this;
        }
        return UnknownSummarizedValues;
    }(SummariesValues));

    var UnknownSummariesCalculator = /** @class */ (function (_super) {
        __extends(UnknownSummariesCalculator, _super);
        function UnknownSummariesCalculator() {
            return _super.call(this) || this;
        }
        UnknownSummariesCalculator.prototype.forDataType = function (dataType) {
            return dataType === DataType.UNKNOWN;
        };
        UnknownSummariesCalculator.prototype.prepare = function (field) {
        };
        UnknownSummariesCalculator.prototype.postCalculate = function (field, items) {
        };
        UnknownSummariesCalculator.prototype.aggregate = function (field, value) {
        };
        UnknownSummariesCalculator.prototype.generateAggregatedValues = function (field) {
            return new UnknownSummarizedValues();
        };
        return UnknownSummariesCalculator;
    }(SummariesCalculator));
    UnknownSummariesCalculator.decorators = [
        { type: core.Injectable }
    ];
    UnknownSummariesCalculator.ctorParameters = function () { return []; };

    var SummariesManagerFactory = /** @class */ (function () {
        function SummariesManagerFactory(calculators) {
            this.calculators = calculators;
        }
        SummariesManagerFactory.prototype.create = function (structureId) {
            return new SummariesManager(structureId, this.calculators);
        };
        return SummariesManagerFactory;
    }());
    SummariesManagerFactory.decorators = [
        { type: core.Injectable }
    ];
    SummariesManagerFactory.ctorParameters = function () { return [
        { type: Array, decorators: [{ type: core.Inject, args: [SUMMARIES_CALCULATORS,] }] }
    ]; };

    var SummariesDomainModule = /** @class */ (function (_super) {
        __extends(SummariesDomainModule, _super);
        function SummariesDomainModule() {
            return _super.call(this) || this;
        }
        SummariesDomainModule.commandHandlers = function () {
            return hermes.HermesModule.registerCommandHandler(StructureSetSummariesEnabledCommandHandler, structureKey);
        };
        SummariesDomainModule.domainEventHandlers = function () {
            return hermes.HermesModule.registerDomainEventHandler(StructureSummariesEnabledSetEventHandler);
        };
        return SummariesDomainModule;
    }(hermes.DomainModule));
    SummariesDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [
                        provideSummariesCalculator(BooleanSummariesCalculator),
                        provideSummariesCalculator(DateSummariesCalculator),
                        provideSummariesCalculator(NumberSummariesCalculator),
                        provideSummariesCalculator(StringSummariesCalculator),
                        provideSummariesCalculator(UnknownSummariesCalculator),
                        SummariesManagerFactory
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    SummariesDomainModule.ctorParameters = function () { return []; };

    var SummariesWarehouse = /** @class */ (function () {
        function SummariesWarehouse() {
        }
        return SummariesWarehouse;
    }());
    SummariesWarehouse.decorators = [
        { type: core.Injectable }
    ];
    SummariesWarehouse.ctorParameters = function () { return []; };

    var StructureSummariesPanelConfig = /** @class */ (function () {
        function StructureSummariesPanelConfig() {
            this.top = StructureSummariesPanelConfig.defaultTop;
            this.bottom = StructureSummariesPanelConfig.defaultBottom;
        }
        StructureSummariesPanelConfig.prototype.setTop = function (top) {
            this.top = top;
        };
        StructureSummariesPanelConfig.prototype.setBottom = function (bottom) {
            this.bottom = bottom;
        };
        StructureSummariesPanelConfig.prototype.isTopEnabled = function () {
            return this.top;
        };
        StructureSummariesPanelConfig.prototype.isBottomEnabled = function () {
            return this.bottom;
        };
        return StructureSummariesPanelConfig;
    }());
    StructureSummariesPanelConfig.defaultTop = false;
    StructureSummariesPanelConfig.defaultBottom = true;

    var StructureSummariesConfigArchive = /** @class */ (function (_super) {
        __extends(StructureSummariesConfigArchive, _super);
        function StructureSummariesConfigArchive() {
            return _super.call(this, StructureSummariesConfigArchive.default) || this;
        }
        return StructureSummariesConfigArchive;
    }(hermes.AggregateArchive));
    StructureSummariesConfigArchive.default = new StructureSummariesPanelConfig();
    StructureSummariesConfigArchive.decorators = [
        { type: core.Injectable }
    ];
    StructureSummariesConfigArchive.ctorParameters = function () { return []; };

    var SummariesDomainWarehouse = /** @class */ (function (_super) {
        __extends(SummariesDomainWarehouse, _super);
        function SummariesDomainWarehouse(summariesEnabledArchive, structureSummariesArchive) {
            var _this = _super.call(this) || this;
            _this.summariesEnabledArchive = summariesEnabledArchive;
            _this.structureSummariesArchive = structureSummariesArchive;
            return _this;
        }
        SummariesDomainWarehouse.prototype.onEnabled = function (structureId) {
            return this.summariesEnabledArchive.on(structureId);
        };
        SummariesDomainWarehouse.prototype.onTopEnabled = function (structureId) {
            var _this = this;
            return this.onEnabled(structureId)
                .pipe(hermes.hermesSwitchMap(function (enabled) {
                return _this.structureSummariesArchive
                    .on(structureId)
                    .pipe(hermes.hermesMap(function (config) { return enabled && config.isTopEnabled(); }));
            }));
        };
        SummariesDomainWarehouse.prototype.onBottomEnabled = function (structureId) {
            var _this = this;
            return this.onEnabled(structureId)
                .pipe(hermes.hermesSwitchMap(function (enabled) {
                return _this.structureSummariesArchive
                    .on(structureId)
                    .pipe(hermes.hermesMap(function (config) { return enabled && config.isBottomEnabled(); }));
            }));
        };
        return SummariesDomainWarehouse;
    }(SummariesWarehouse));
    SummariesDomainWarehouse.decorators = [
        { type: core.Injectable }
    ];
    SummariesDomainWarehouse.ctorParameters = function () { return [
        { type: SummariesEnabledArchive },
        { type: StructureSummariesConfigArchive }
    ]; };

    var StructureSummariesPanelConfigConverter = /** @class */ (function () {
        function StructureSummariesPanelConfigConverter() {
        }
        StructureSummariesPanelConfigConverter.prototype.convert = function (config) {
            var panelConfig = new StructureSummariesPanelConfig();
            if (config.top !== undefined && config.top !== null) {
                panelConfig.setTop(config.top);
            }
            if (config.bottom !== undefined && config.bottom !== null) {
                panelConfig.setBottom(config.bottom);
            }
            return panelConfig;
        };
        return StructureSummariesPanelConfigConverter;
    }());
    StructureSummariesPanelConfigConverter.decorators = [
        { type: core.Injectable }
    ];

    var SummariesDomainCommandInvoker = /** @class */ (function (_super) {
        __extends(SummariesDomainCommandInvoker, _super);
        function SummariesDomainCommandInvoker(commandDispatcher, configConverter, structureSummariesConfigArchive) {
            var _this = _super.call(this) || this;
            _this.commandDispatcher = commandDispatcher;
            _this.configConverter = configConverter;
            _this.structureSummariesConfigArchive = structureSummariesConfigArchive;
            return _this;
        }
        SummariesDomainCommandInvoker.prototype.setSummariesEnabled = function (enabled, structureId) {
            this.commandDispatcher.dispatch(new StructureSetSummariesEnabledCommand(structureId, enabled));
        };
        SummariesDomainCommandInvoker.prototype.setConfig = function (config, structureId) {
            var summariesPanelConfig = this.configConverter.convert(config);
            this.setSummariesEnabled(config.enabled, structureId);
            this.structureSummariesConfigArchive.next(structureId, summariesPanelConfig);
        };
        return SummariesDomainCommandInvoker;
    }(SummariesCommandInvoker));
    SummariesDomainCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    SummariesDomainCommandInvoker.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher },
        { type: StructureSummariesPanelConfigConverter },
        { type: StructureSummariesConfigArchive }
    ]; };

    var SummariesDomainEventRepository = /** @class */ (function (_super) {
        __extends(SummariesDomainEventRepository, _super);
        function SummariesDomainEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        SummariesDomainEventRepository.prototype.onSummariesChanged = function (structureId) {
            return this.onEvent(structureId, StructureSummariesChangedEvent);
        };
        return SummariesDomainEventRepository;
    }(SummariesEventRepository));
    SummariesDomainEventRepository.decorators = [
        { type: core.Injectable }
    ];
    SummariesDomainEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var SummariesApiModule = /** @class */ (function (_super) {
        __extends(SummariesApiModule, _super);
        function SummariesApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return SummariesApiModule;
    }(hermes.ApiModule));
    SummariesApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        SummariesDomainModule
                    ],
                    providers: [
                        {
                            provide: SummariesCommandInvoker,
                            useClass: SummariesDomainCommandInvoker
                        },
                        {
                            provide: SummariesEventRepository,
                            useClass: SummariesDomainEventRepository
                        },
                        {
                            provide: SummariesWarehouse,
                            useClass: SummariesDomainWarehouse
                        },
                        SummariesEnabledArchive
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var SummariesTranslations = /** @class */ (function () {
        function SummariesTranslations(distinctTooltip, averageTooltip, minTooltip, maxTooltip, medTooltip, countTooltip) {
            this.distinctTooltip = distinctTooltip;
            this.averageTooltip = averageTooltip;
            this.minTooltip = minTooltip;
            this.maxTooltip = maxTooltip;
            this.medTooltip = medTooltip;
            this.countTooltip = countTooltip;
        }
        return SummariesTranslations;
    }());

    var StructureSummariesPanelComponent = /** @class */ (function (_super) {
        __extends(StructureSummariesPanelComponent, _super);
        function StructureSummariesPanelComponent(changeDetectorRef, elementRef, structureId, compositionId, structureSummariesEventRepository, translationService, sourceWarehouse, rowSelectionTypeArchive, compositionWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.compositionId = compositionId;
            _this.structureSummariesEventRepository = structureSummariesEventRepository;
            _this.translationService = translationService;
            _this.sourceWarehouse = sourceWarehouse;
            _this.rowSelectionTypeArchive = rowSelectionTypeArchive;
            _this.compositionWarehouse = compositionWarehouse;
            _this.sourceEmpty = false;
            _this.addClassToHost('gui-flex');
            _this.subscribe(_this.structureSummariesEventRepository.onSummariesChanged(_this.structureId.toReadModelRootId()), function (event) {
                _this.summaries = event.getSummaries();
            });
            return _this;
        }
        StructureSummariesPanelComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.rowSelectionTypeArchive.on(), function (type) {
                _this.checkboxSelection = type === RowSelectionType.CHECKBOX;
            });
            this.subscribe(this.sourceWarehouse.onEntitiesSize(this.structureId), function (size) {
                _this.sourceEmpty = size === 0;
            });
            this.subscribe(this.compositionWarehouse.onHeaderColumns(this.compositionId), function (columns) {
                _this.headerColumns = columns;
            });
            this.subscribe(this.translationService.onTranslation(), function (translation) {
                _this.summariesTranslations = new SummariesTranslations(translation.summariesDistinctValuesTooltip, translation.summariesAverageTooltip, translation.summariesMinTooltip, translation.summariesMaxTooltip, translation.summariesMedTooltip, translation.summariesCountTooltip);
            });
        };
        StructureSummariesPanelComponent.prototype.isSummariesTypePresent = function (summaries) {
            return summaries !== undefined && summaries !== null;
        };
        StructureSummariesPanelComponent.prototype.getSelectorName = function () {
            return 'gui-structure-summaries-panel';
        };
        return StructureSummariesPanelComponent;
    }(SmartComponent));
    StructureSummariesPanelComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-summaries-panel][enabled]',
                    template: "<ng-container *ngIf=\"enabled && summaries && !sourceEmpty\">\n\n\t<div *ngIf=\"checkboxSelection\"\n\t\t class=\"gui-structure-summaries-cell gui-row-checkbox gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis\">\n\t</div>\n\n\t<div *ngFor=\"let column of headerColumns\"\n\t\t [style.width.px]=\"column.width\"\n\t\t class=\"gui-structure-summaries-cell\">\n\n\t\t<ng-container *ngIf=\"summaries && !!summaries.get(column.getFieldId().getId())\">\n\n\t\t\t<div *ngIf=\"isSummariesTypePresent(summaries.get(column.getFieldId().getId()).count)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\t\t\t\t<span [gui-tooltip]=\"summariesTranslations.countTooltip\">{{'summariesCount' | guiTranslate}}</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).count }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\"isSummariesTypePresent(summaries.get(column.getFieldId().getId()).distinct)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\t\t\t\t<span [gui-tooltip]=\"summariesTranslations.distinctTooltip\">{{'summariesDist' | guiTranslate}}</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).distinct }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\" isSummariesTypePresent(summaries.get(column.getFieldId().getId()).sum)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<!--\t\t\t\t\t\t\t<span [gui-tooltip]=\"'Sum'\" -->\n\t\t\t\t\t\t\t<!--\t\t\t\t\t\t\t\t  class=\"gui-math-symbol\">&sum;</span>-->\n\t\t\t\t\t\t\t{{'summariesSum' | guiTranslate}}\n\t\t\t\t\t\t</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).sum }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\"isSummariesTypePresent(summaries.get(column.getFieldId().getId()).average)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\n\t\t\t\t<!--\t\t\t\t\t\t<div [gui-tooltip]=\"'Average'\"-->\n\t\t\t\t<!--\t\t\t\t\t\t\t class=\"gui-mean\">-->\n\t\t\t\t<!--\t\t\t\t\t\t\t<span>_</span><span>X</span>-->\n\t\t\t\t<!--\t\t\t\t\t\t</div>-->\n\t\t\t\t<span [gui-tooltip]=\"summariesTranslations.averageTooltip\">{{'summariesAvg' | guiTranslate}}</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).average }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\" isSummariesTypePresent(summaries.get(column.getFieldId().getId()).min)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\n\t\t\t\t<!--\t\t\t\t\t\t<div [gui-tooltip]=\"'Min'\">-->\n\t\t\t\t<!--\t\t\t\t\t\t\t<span class=\"gui-math-symbol\">&and;</span>-->\n\t\t\t\t<!--\t\t\t\t\t\t</div>-->\n\t\t\t\t<span [gui-tooltip]=\"summariesTranslations.minTooltip\">\n\t\t\t\t\t\t\t{{'summariesMin' | guiTranslate}}\n\t\t\t\t\t\t</span>\n\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).min }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\" isSummariesTypePresent(summaries.get(column.getFieldId().getId()).max)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\n\t\t\t\t<!--\t\t\t\t\t\t<div [gui-tooltip]=\"'Max'\">-->\n\t\t\t\t<!--\t\t\t\t\t\t\t<span class=\"gui-math-symbol\">&or;</span>-->\n\t\t\t\t<!--\t\t\t\t\t\t</div>-->\n\n\t\t\t\t<span [gui-tooltip]=\"summariesTranslations.maxTooltip\">\n\t\t\t\t\t\t\t{{'summariesMax' | guiTranslate}}\n\t\t\t\t\t\t</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).max }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\"isSummariesTypePresent(summaries.get(column.getFieldId().getId()).median)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\n\t\t\t\t<!--\t\t\t\t\t\t<div [gui-tooltip]=\"'Median'\"-->\n\t\t\t\t<!--\t\t\t\t\t\t\t class=\"gui-median\">-->\n\t\t\t\t<!--\t\t\t\t\t\t\t<span>~</span>-->\n\t\t\t\t<!--\t\t\t\t\t\t\t<span>X</span>-->\n\t\t\t\t<!--\t\t\t\t\t\t</div>-->\n\n\t\t\t\t<span [gui-tooltip]=\"summariesTranslations.medTooltip\">{{'summariesMed' | guiTranslate}}</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).median }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\"isSummariesTypePresent(summaries.get(column.getFieldId().getId()).truthy)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\t\t\t\t<span>{{'summariesTruthy' | guiTranslate}}</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).truthy }}</span>\n\t\t\t</div>\n\n\t\t\t<div *ngIf=\"isSummariesTypePresent(summaries.get(column.getFieldId().getId()).falsy)\"\n\t\t\t\t class=\"gui-structure-summaries-value\">\n\t\t\t\t<span>{{'summariesFalsy' | guiTranslate}}</span>\n\t\t\t\t<span class=\"gui-summaries-value\">{{ summaries.get(column.getFieldId().getId()).falsy }}</span>\n\t\t\t</div>\n\n\t\t</ng-container>\n\t</div>\n\n</ng-container>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureSummariesPanelComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: CompositionId },
        { type: SummariesEventRepository },
        { type: TranslationFacade },
        { type: SourceWarehouse },
        { type: RowSelectionTypeArchive },
        { type: CompositionWarehouse }
    ]; };
    StructureSummariesPanelComponent.propDecorators = {
        enabled: [{ type: core.Input }]
    };

    var SummariesFeatureModule = /** @class */ (function (_super) {
        __extends(SummariesFeatureModule, _super);
        function SummariesFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        SummariesFeatureModule.forComponent = function () {
            return [];
        };
        return SummariesFeatureModule;
    }(hermes.FeatureModule));
    SummariesFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabric.FabricModule,
                        TranslationFeatureModule,
                        SummariesApiModule
                    ],
                    declarations: [
                        StructureSummariesPanelComponent
                    ],
                    exports: [
                        StructureSummariesPanelComponent
                    ],
                    providers: [
                        StructureSummariesConfigArchive,
                        StructureSummariesPanelConfigConverter
                    ]
                },] }
    ];

    /** @internal */
    function structureIdFactoryForGrid(generator) {
        return new StructureId('gui-grid-' + generator.generateId());
    }
    /** @internal */
    function compositionIdFactoryForGrid(generator) {
        return new CompositionId('gui-grid-' + generator.generateId());
    }
    /** @internal */
    function schemaIdFactoryForGrid(generator) {
        return new SchemaReadModelRootId('gui-grid-' + generator.generateId());
    }
    /** @internal */
    var StructureComponent = /** @class */ (function (_super) {
        __extends(StructureComponent, _super);
        function StructureComponent(structureId, compositionId, pagingCommandService, pagingEventRepository, sourceCommandDispatcher, sourceEventService, sortingCommandDispatcher, searchCommandDispatcher, fieldCommandDispatcher, schemaCommandDispatcher, compositionCommandDispatcher, compositionEventRepository, formationEventService, structureCommandService, structureEditModeArchive, structureCellEditArchive, structureInfoPanelArchive, structureInfoPanelConfigService, structureCellEditStore, columnFieldFactory, structureColumnMenuConfigArchive, pagingDisplayModeArchive, rowSelectEnabledArchive, rowSelectionTypeArchive, schemaRowClassArchive, schemaRowStyleArchive, formationCommandDispatcher, searchEventRepository, structureHeaderBottomEnabledArchive, structureDetailViewConfigArchive, structureTitlePanelConfigArchive, structureFooterPanelConfigArchive, schemaEventRepository, translationService, structureInitialValuesReadyArchive, columnAutoConfigurator, elementRef, detectorRef, injector, structureDefinition, structureWarehouse, compositionWarehouse, schemaStylesManager, schemaReadModelRootId, domainEventBus, commandDispatcher, structureDetailViewService) {
            var _this = _super.call(this, detectorRef, elementRef, domainEventBus, commandDispatcher, columnAutoConfigurator, structureId, compositionId, schemaReadModelRootId, structureCommandService, pagingCommandService, pagingEventRepository, sortingCommandDispatcher, searchCommandDispatcher, fieldCommandDispatcher, sourceCommandDispatcher, sourceEventService, schemaCommandDispatcher, compositionCommandDispatcher, compositionEventRepository, formationEventService, structureEditModeArchive, structureCellEditArchive, structureInfoPanelConfigService, structureCellEditStore, columnFieldFactory, rowSelectEnabledArchive, rowSelectionTypeArchive, schemaRowClassArchive, schemaRowStyleArchive, formationCommandDispatcher, searchEventRepository, structureHeaderBottomEnabledArchive, schemaEventRepository, translationService, structureInitialValuesReadyArchive) || this;
            _this.elementRef = elementRef;
            _this.detectorRef = detectorRef;
            _this.injector = injector;
            _this.structureDefinition = structureDefinition;
            _this.structureWarehouse = structureWarehouse;
            _this.compositionWarehouse = compositionWarehouse;
            _this.schemaStylesManager = schemaStylesManager;
            _this.schemaReadModelRootId = schemaReadModelRootId;
            _this.structureDetailViewService = structureDetailViewService;
            _this.loaderEnabled = false;
            _this.circleLoaderEnabled = true;
            _this.initialLoaderAnimation = false;
            _this.styleModifier = new StyleModifier(_this.elementRef.nativeElement);
            structureCommandService.create(_this.structureId);
            compositionCommandDispatcher.create(_this.compositionId);
            schemaCommandDispatcher.create(_this.schemaId);
            return _this;
        }
        StructureComponent.prototype.ngOnChanges = function (changes) {
            _super.prototype.ngOnChanges.call(this, changes);
        };
        StructureComponent.prototype.ngOnInit = function () {
            var _this = this;
            _super.prototype.ngOnInit.call(this);
            this.subscribe(this.structureWarehouse.on(this.structureId), function (structureReadModelRoot) {
                _this.structure = structureReadModelRoot;
                _this.loaderEnabled = structureReadModelRoot.getSource().isLoading();
                _this.circleLoaderEnabled = structureReadModelRoot.isLoaderVisible();
                if (_this.loaderEnabled && !_this.initialLoaderAnimation) {
                    _this.initialLoaderAnimation = true;
                }
                _this.detectorRef.detectChanges();
            });
            this.structureDetailViewService.init(this.elementRef);
        };
        StructureComponent.prototype.ngAfterViewInit = function () {
            var _this = this;
            this.structureInitialValuesReadyArchive
                .next(this.structureId, true);
            var width = this.elementRef.nativeElement.offsetWidth;
            if (width > 0) {
                this.compositionCommandDispatcher.setContainerWidth(width, this.compositionId);
            }
            else {
                /**
                 * When gui-grid is in dynamic container which is created later then grid.
                 */
                hermes.hermesTimer(0)
                    .pipe(this.takeUntil())
                    .subscribe(function () {
                    width = _this.elementRef.nativeElement.offsetWidth;
                    if (width > 0) {
                        _this.compositionCommandDispatcher.setContainerWidth(width, _this.compositionId);
                    }
                });
            }
            this.schemaStylesManager
                .init(this.elementRef, this.schemaReadModelRootId);
            this.subscribeWithoutRender(this.compositionWarehouse.onWidth(this.compositionId), function (width) {
                _this.styleModifier.getHost().setWidth(width);
            });
        };
        StructureComponent.prototype.isBorderEnabled = function () {
            return this.structureDefinition.isBorderEnabled();
        };
        StructureComponent.prototype.getStructureId = function () {
            return this.structureId;
        };
        StructureComponent.prototype.getElementRef = function () {
            return this.elementRef;
        };
        StructureComponent.prototype.getSelectorName = function () {
            return 'gui-structure';
        };
        return StructureComponent;
    }(StructureGateway));
    StructureComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-structure',
                    template: "<div gui-structure-blueprint></div>\n\n<!---------- LOADING ---------->\n<div [ngClass]=\"{'gui-loader-visible': loaderEnabled, 'gui-loader-hidden': !loaderEnabled && initialLoaderAnimation}\"\n\t class=\"gui-loading\">\n\t<gui-spinner *ngIf=\"circleLoaderEnabled\"\n\t\t\t\t [diameter]=\"120\"\n\t\t\t\t [primary]=\"true\">\n\t</gui-spinner>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None,
                    host: {
                        '[class.gui-structure-border]': 'isBorderEnabled()',
                        '[id]': 'structureId.toString()'
                    },
                    providers: [
                        {
                            provide: StructureId,
                            useFactory: structureIdFactoryForGrid,
                            deps: [
                                StructureIdGenerator
                            ]
                        },
                        {
                            provide: CompositionId,
                            useFactory: compositionIdFactoryForGrid,
                            deps: [
                                StructureIdGenerator
                            ]
                        },
                        {
                            provide: SchemaReadModelRootId,
                            useFactory: schemaIdFactoryForGrid,
                            deps: [
                                StructureIdGenerator
                            ]
                        },
                        SchemaCssClassManager,
                        StructureCellEditCloseAllService,
                        StructureCellEditStore,
                        StructureEditModeArchive,
                        StructureInfoPanelArchive,
                        StructureInfoPanelConfigService,
                        StructureColumnMenuConfigArchive,
                        PagingFeatureModule.forComponent(),
                        SortingFeatureModule.forComponent(),
                        FieldFeatureModule.forComponent(),
                        SearchFeatureModule.forComponent(),
                        SourceFeatureModule.forComponent(),
                        SchemaFeatureModule.forComponent(),
                        SummariesFeatureModule.forComponent(),
                        TranslationFeatureModule.forComponent(),
                        RowSelectEnabledRepository,
                        StructureHeaderTopEnabledArchive,
                        StructureHeaderBottomEnabledArchive,
                        StructureRowDetailConfigArchive,
                        StructureRowDetailService,
                        StructureTitlePanelConfigArchive,
                        StructureFooterPanelConfigArchive,
                        {
                            provide: structureComponentToken,
                            useExisting: StructureComponent
                        },
                        {
                            provide: filterContainerToken,
                            useExisting: StructureComponent
                        }
                    ],
                    styles: [".gui-box-border{box-sizing:border-box}.gui-bg-transparent{background-color:transparent}.gui-border{border-width:1px}.gui-border-0{border-width:0}.gui-border-b{border-bottom-width:1px}.gui-border-t{border-top-width:1px}.gui-border-solid{border-style:solid}.gui-border-b-solid{border-bottom-style:solid}.gui-border-t-solid{border-top-style:solid}.gui-border-none{border-style:none}.gui-rounded{border-radius:4px}.gui-cursor-pointer{cursor:pointer}.gui-block{display:block}.gui-inline-block{display:inline-block}.gui-inline{display:inline}.gui-flex{display:-ms-flexbox;display:flex}.gui-hidden{display:none}.gui-display-grid{display:grid}.gui-flex-row{-ms-flex-direction:row;flex-direction:row}.gui-flex-row-reverse{-ms-flex-direction:row-reverse;flex-direction:row-reverse}.gui-flex-col{-ms-flex-direction:column;flex-direction:column}.gui-flex-col-reverse{-ms-flex-direction:column-reverse;flex-direction:column-reverse}.gui-justify-start{-ms-flex-pack:start;justify-content:flex-start}.gui-justify-end{-ms-flex-pack:end;justify-content:flex-end}.gui-justify-center{-ms-flex-pack:center;justify-content:center}.gui-justify-between{-ms-flex-pack:justify;justify-content:space-between}.gui-justify-around{-ms-flex-pack:distribute;justify-content:space-around}.gui-justify-evenly{-ms-flex-pack:space-evenly;justify-content:space-evenly}.gui-items-start{-ms-flex-align:start;align-items:flex-start}.gui-items-end{-ms-flex-align:end;align-items:flex-end}.gui-items-center{-ms-flex-align:center;align-items:center}.gui-items-between{-ms-flex-align:space-between;align-items:space-between}.gui-items-around{-ms-flex-align:space-around;align-items:space-around}.gui-items-evenly{-ms-flex-align:space-evenly;align-items:space-evenly}.gui-flex-wrap{-ms-flex-wrap:wrap;flex-wrap:wrap}.gui-flex-wrap-reverse{-ms-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse}.gui-flex-nowrap{-ms-flex-wrap:nowrap;flex-wrap:nowrap}.gui-grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.gui-grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.gui-grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.gui-grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.gui-grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.gui-grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}.gui-grid-cols-7{grid-template-columns:repeat(7,minmax(0,1fr))}.gui-grid-cols-8{grid-template-columns:repeat(8,minmax(0,1fr))}.gui-grid-cols-9{grid-template-columns:repeat(9,minmax(0,1fr))}.gui-grid-rows-1{grid-template-rows:repeat(1,minmax(0,1fr))}.gui-grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.gui-grid-rows-3{grid-template-rows:repeat(3,minmax(0,1fr))}.gui-grid-rows-4{grid-template-rows:repeat(4,minmax(0,1fr))}.gui-grid-rows-5{grid-template-rows:repeat(5,minmax(0,1fr))}.gui-grid-rows-6{grid-template-rows:repeat(6,minmax(0,1fr))}.gui-grid-rows-7{grid-template-rows:repeat(7,minmax(0,1fr))}.gui-grid-rows-8{grid-template-rows:repeat(8,minmax(0,1fr))}.gui-grid-rows-9{grid-template-rows:repeat(9,minmax(0,1fr))}.gui-grid-rows-gap-0{grid-row-gap:0}.gui-grid-rows-gap-1{grid-row-gap:1px}.gui-grid-rows-gap-2{grid-row-gap:2px}.gui-grid-rows-gap-3{grid-row-gap:3px}.gui-grid-rows-gap-4{grid-row-gap:4px}.gui-grid-rows-gap-5{grid-row-gap:6px}.gui-grid-rows-gap-6{grid-row-gap:8px}.gui-grid-rows-gap-7{grid-row-gap:10px}.gui-grid-rows-gap-8{grid-row-gap:12px}.gui-grid-rows-gap-23{grid-row-gap:42px}.gui-grid-cols-gap-0{grid-column-gap:0}.gui-grid-cols-gap-1{grid-column-gap:1px}.gui-grid-cols-gap-2{grid-column-gap:2px}.gui-grid-cols-gap-3{grid-column-gap:3px}.gui-grid-cols-gap-4{grid-column-gap:4px}.gui-grid-cols-gap-5{grid-column-gap:6px}.gui-grid-cols-gap-6{grid-column-gap:8px}.gui-grid-cols-gap-7{grid-column-gap:10px}.gui-grid-cols-gap-8{grid-column-gap:12px}.gui-grid-cols-gap-23{grid-column-gap:42px}.gui-h-full{height:100%}.gui-list-none{list-style-type:none}.gui-m-0{margin:0}.gui-mx-0{margin-left:0;margin-right:0}.gui-my-0{margin-bottom:0;margin-top:0}.gui-m-1{margin:1px}.gui-mx-1{margin-left:1px;margin-right:1px}.gui-my-1{margin-bottom:1px;margin-top:1px}.gui-m-2{margin:2px}.gui-mx-2{margin-left:2px;margin-right:2px}.gui-my-2{margin-bottom:2px;margin-top:2px}.gui-m-3{margin:3px}.gui-mx-3{margin-left:3px;margin-right:3px}.gui-my-3{margin-bottom:3px;margin-top:3px}.gui-m-4{margin:4px}.gui-mx-4{margin-left:4px;margin-right:4px}.gui-my-4{margin-bottom:4px;margin-top:4px}.gui-m-5{margin:6px}.gui-mx-5{margin-left:6px;margin-right:6px}.gui-my-5{margin-bottom:6px;margin-top:6px}.gui-m-6{margin:8px}.gui-mx-6{margin-left:8px;margin-right:8px}.gui-my-6{margin-bottom:8px;margin-top:8px}.gui-m-7{margin:10px}.gui-mx-7{margin-left:10px;margin-right:10px}.gui-my-7{margin-bottom:10px;margin-top:10px}.gui-m-8{margin:12px}.gui-mx-8{margin-left:12px;margin-right:12px}.gui-my-8{margin-bottom:12px;margin-top:12px}.gui-m-23{margin:42px}.gui-mx-23{margin-left:42px;margin-right:42px}.gui-my-23{margin-bottom:42px;margin-top:42px}.gui-mb-4{margin-bottom:4px}.gui-mb-6{margin-bottom:8px}.gui-mb-8{margin-bottom:12px}.gui-mb-10{margin-bottom:16px}.gui-mb-18{margin-bottom:32px}.gui-mr-0{margin-right:0}.gui-mr-5{margin-right:6px}.gui-mr-auto{margin-right:auto}.gui-ml-auto{margin-left:auto}.gui-mt-4{margin-top:4px}.gui-mt-6{margin-top:8px}.gui-mt-10{margin-top:16px}.gui-mt-14{margin-top:24px}.gui-overflow-hidden{overflow:hidden}.gui-overflow-y-scroll{overflow-y:scroll}.gui-overflow-x-hidden{overflow-x:hidden}.gui-overflow-auto{overflow:auto}.gui-p-0{padding:0}.gui-px-0{padding-left:0;padding-right:0}.gui-py-0{padding-bottom:0;padding-top:0}.gui-p-1{padding:1px}.gui-px-1{padding-left:1px;padding-right:1px}.gui-py-1{padding-bottom:1px;padding-top:1px}.gui-p-2{padding:2px}.gui-px-2{padding-left:2px;padding-right:2px}.gui-py-2{padding-bottom:2px;padding-top:2px}.gui-p-3{padding:3px}.gui-px-3{padding-left:3px;padding-right:3px}.gui-py-3{padding-bottom:3px;padding-top:3px}.gui-p-4{padding:4px}.gui-px-4{padding-left:4px;padding-right:4px}.gui-py-4{padding-bottom:4px;padding-top:4px}.gui-p-5{padding:6px}.gui-px-5{padding-left:6px;padding-right:6px}.gui-py-5{padding-bottom:6px;padding-top:6px}.gui-p-6{padding:8px}.gui-px-6{padding-left:8px;padding-right:8px}.gui-py-6{padding-bottom:8px;padding-top:8px}.gui-p-7{padding:10px}.gui-px-7{padding-left:10px;padding-right:10px}.gui-py-7{padding-bottom:10px;padding-top:10px}.gui-p-8{padding:12px}.gui-px-8{padding-left:12px;padding-right:12px}.gui-py-8{padding-bottom:12px;padding-top:12px}.gui-p-23{padding:42px}.gui-px-23{padding-left:42px;padding-right:42px}.gui-py-23{padding-bottom:42px;padding-top:42px}.gui-pr-10{padding-right:16px}.gui-pl-9{padding-right:10px}.gui-pb-6{padding-bottom:8px}.gui-pb-12{padding-bottom:20px}.gui-pl-21{padding-left:38px}.gui-pt-4{padding-top:4px}.gui-pt-6{padding-top:8px}.gui-pt-10{padding-top:16px}.gui-pt-12{padding-top:20px}.gui-pt-14{padding-top:24px}.gui-static{position:static}.gui-fixed{position:fixed}.gui-relative{position:relative}.gui-absolute{position:absolute}.gui-text-xxs{font-size:11px}.gui-text-xs{font-size:12px}.gui-text-sm{font-size:13px}.gui-text-base{font-size:14px}.gui-text-lg{font-size:16px}.gui-text-xl{font-size:18px}.gui-text-2xl{font-size:20px}.gui-text-3xl{font-size:22px}.gui-leading-4{line-height:16px}.gui-leading-6{line-height:24px}.gui-font-thin{font-weight:100}.gui-font-extralight{font-weight:200}.gui-font-light{font-weight:300}.gui-font-normal{font-weight:400}.gui-font-medium{font-weight:500}.gui-font-semibold{font-weight:600}.gui-font-bold{font-weight:700}.gui-font-extrabold{font-weight:800}.gui-font-black{font-weight:900}.gui-not-italic{font-style:normal}.gui-whitespace-nowrap{white-space:nowrap}.gui-overflow-ellipsis{text-overflow:ellipsis}.gui-no-underline{text-decoration:none}.gui-w-full{width:100%}.gui-w-96{width:384px}.gui-w-3\\/5{width:60%}.gui-structure *,.gui-structure *:after,.gui-structure *:before{box-sizing:border-box}.gui-structure input{font-size:13px;outline:0}.gui-bold{font-weight:bold}.gui-italic{font-style:italic}.gui-bar-view{width:100%}.gui-align-right{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;text-align:right;width:100%}.gui-align-left{text-align:left;width:100%}.gui-align-center{-ms-flex-pack:center;justify-content:center;text-align:center;width:100%}.gui-icon{cursor:pointer}.gui-icon svg{fill:#aaa;stroke:#aaa;transition:stroke .3s ease-in-out}.gui-icon svg:hover{fill:#464646!important;stroke:#464646!important}.gui-view-text{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.gui-percentage-bar{background:#deebff;border-radius:4px;box-shadow:inset 1px 1px 2px #ccc;color:#0747a6;height:22px;padding:4px;position:relative;text-align:center;width:100%}.gui-percentage-bar .gui-percentage{background:#8abcfc;border-radius:4px;height:22px;left:0;position:absolute;top:0}.gui-percentage-bar .gui-percentage-view{color:#031d44;position:relative;width:100%}.gui-clear-search-icon{cursor:pointer;height:16px;position:absolute;right:8px;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);width:16px}.gui-clear-search-icon:before,.gui-clear-search-icon:after{background-color:#aaa;border-radius:8px;content:\" \";height:16px;left:7px;position:absolute;width:2px}.gui-clear-search-icon:before{-ms-transform:rotate(45deg);transform:rotate(45deg)}.gui-clear-search-icon:after{-ms-transform:rotate(-45deg);transform:rotate(-45deg)}.gui-clear-search-icon:hover:before,.gui-clear-search-icon:hover:after{background-color:#464646}\n", ".gui-structure{border-color:#d6d6d6;font-size:14px}.gui-structure *{border-color:#d6d6d6;font-size:14px}.gui-structure input{color:#333;font-family:Arial}.gui-header{background:#f2f3f4;border-bottom:1px solid;border-color:inherit;height:36px}.gui-header .gui-header-cell.gui-header-sortable{cursor:pointer}.gui-header .gui-header-cell.gui-header-sortable:hover{background:#e6e7e8}.gui-header .gui-header-cell .gui-header-menu-icon{display:none}.gui-header .gui-header-cell:hover .gui-header-menu{cursor:pointer}.gui-header .gui-header-cell:hover .gui-header-menu .gui-header-menu-icon-wrapper .gui-header-menu-icon{display:block}.gui-header .gui-header-cell:last-of-type{border-right:0}.gui-header .gui-header-cell .gui-header-title{display:-ms-flexbox;display:flex;line-height:1.4em}.gui-header .gui-header-cell .gui-header-title .gui-sort{display:none;height:14px;margin-left:4px;width:14px}.gui-header .gui-header-cell .gui-header-title .gui-sort-asc{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAAB2CAYAAAAz4kaDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABNRSURBVHhe7V1pU1vHmkYSixEIBAIhME6cXNshjjMkNuBNeMM2U6lUJeOKwfg6W5UrqeRLPuQHJPk2n6Y8+ZaUZ7I5cYwXbEySe+/Unbmp3MQbiM3YGBtvxAVml1iEEJLmeVqniSyD8ILhKDmP3Zw+3X16eZ9+3377nCMpRoMGDSHQKceoQiAQ0H366aexra2tsXogOTk5gGT/M8884y0rK/MFS0UXDMoxKkACcIh1OBxmg8FQ0tzSsmfM43llYHDwhe6engJLZuaC7Vu3dq9Zs2b8xx9/JDlRg6jRCEULUsbHx9ecra3dqDfoV46NjT3r9Y4nMT8uNs6dEJ9wXqfXnytcverv1nTrGWjHsLg4ChAVRJCEzz//PNXj86w/c+pcxcjo8GZdjC4FWUYEPcvodDoUC7gRXEZj0v+tt9sPZKan//Tyyy8PMV/tUL1pIgn79u1L9UxM2FtaLpSPDA9tHRvzZMXGxibAPOl8Ph/LxOCcTMR5vd4kvU5n6+3rNRoTE4d27NjRVV1dPa5Up1qonojc5bnp/nH/+ubmpor+vr5tMPxWLtBAjN/vF2WgDYIMHhGo5caR4eGcgYGB5GxbtrO8vPx2VVWVRxRWKYRaqxVff/112lDX6PrGhuayIdfQFsg4EwLXQxOE4EmEIvwYqRnMQ7oOGmJxulxbz9Wdq3C5XMXHjx83KdWqEqrViC+++MLS09Oz/uKFC7uGXK5tAX/AajBADaASYs4LnwhaoCxz/DsZRBmBRI/Hk9Pf1w8PN9n5xhtvdB8+fFiVmqFKjaAmDA4Ormtvb38Fs3kTkjKFLYKAYf8FCRS4XqefFH4wruRNltHpkG4ZGRkpaWpq2tXf329Xq2aoTiOOHTtm6ejoWHf58uUKCK4EZsYmSHhw6FCHEYt4Tm9vrykpKclZUVGhujVDVUSQhJs3b66FJuyE0Eows20IUALO+QcHrqdHZYSZskHDEq1Wqwt7DFWRoRoiSMKlS5fW3bhx45W+vr4tSMpBoAxF/sNA8ahYkdHtdlvhTRnNZvOQmjRDFUSQBGjBuuvXr5dDE+gd5XKPQK9IEaJS8sHAOhi418BpMsjIdjqdprS0NNWYqXlfrLkwkwSYpB1YoLkwL2S6JODhlocgWAfrIrEAojoriNiCBbx8eHjYXllZmSwKziPmVSOoCbdu3Vrf1tbGhVmYI0qJJFBoFB7DbIH1Ekq9SdAMG8xgCjXj9ddfn1fXdt6IoCaQhCtwUWGzS5CUjQD5/Cb8UDKkECVkmiwr46FHQsZZl9QMQimXPD4+boMmJprMJteOl+fvdsi8mKZDhw6l3+7ttV9sa63AmrANAqF3RCglggKUZkkKNRShZQmey7TQ8jLOHXcoZHmEjEHnYKnDUb/HG/AWw0ylKkXmFHOuEdSEXzs77dfgokITtkB0NopDyb4DUrDhs5lHCphpUtCMh2qQDDJfnk8FFEmamJjIcg66EhOTkly752EBn1MiqAmd3Z321gsXdg04B7YE/AEbRBRxn0ABM/BeEmc1A+NSyJIgkkAwDd6RiLNcXFzctARIkCp/wG8cc49m9w/0J1vS0uf8dsicEfHZZ5+Z4anYWy5c2Ol0urZCcFkQKsWolJgaoTMau+NJLQgVbnic+ZjhghASFF4+HMzjdEA5o2fMk+0aciZa0i3OV199tRNkzMmaMSdEkITR0dFiR0NDhWtwcItOrxckyFkcSUgS8fHxQrgsSwFTuCSFaayHmsI0HqXwExISJu/KRmrDj3zlWnRNbxwZdWf39vWaMi0ZzpdeemlOFvBHSgQGp1u8eLF52D1sb25uLseiuBVpVpLAgROUD+ajiE8FRYA+j8fjg5mhGRPurQTzZZAgQQgBXONlecSnb4AIdkKQwWsDfn8Sb4fATBmt2Tmuf5sDMh4ZESRBecZcXFvrKB8aGirBIMVDnTs1IRINYqH2QgP6oBE9mP18Pm1AGuUr8qkBFJ6sUzmi+cCY0WjsYARYQD5EgWkg6+P1rA/niWPYZ3R3305alLvIVQoz9f0jNFOPhAgMXDxjJgmOekfFqHu0BLPMCpGjPZgJzjqaAz9NBi8IXieFwTwFXgjlitlsrsnLy7vY1dVFN5dvcEySyaOME8pC7cd1159//vkTME03R0ZG0pGWgnqFY8D65VEAzdI8ESQBGUxEasA4MeHL7u7pTl6ckeksfbUUZHz/SMiYdSIwOKEJmL322traiuHhkW26QEwGxiXakvOfw5RxKUhJBI9I80LgHbDzB5KSkv7d5XL1YZ3hxi8LQcxulgsPCihJXruvsLDQgV17LMhYiL6loIwoxAOJkKSE/pvsGQ74bxz3jOfcvn3buDhzsetRLeCzuqELIWFDfX39brfbXYIBWZBlCA4vCDlUIQAEmhceQ2a2F+vB9bS0tJObNm36n3379jlBghv5kwXkteFBAn0J9PT0jGHXXLt69eqD6enpx6klSKZdE23xKNsOvf63fooY/6RjLNvq6ur2wPPb8CjuTc0aEZIEDKb43Llz5ejwVhDCZ8wRtQ75k/sCCgVxLrA3MzMza9asWVMJTajH+aStul+8/fbb3uHh4Xq73X4wKyvrBOsGCT6aMLZJQtiHGcC3RTJAaumpU6f2oL4NX375pXifarYwK0SQhI8//tiEgRWfPXu2AmaA3pEFgjVwsJFAISiLI+NcmK9lZGTU5OfnH4FpqX/vvfceelNFMqAdDUVFRd+CYJJxg2TIvs1EBMuhj/TW0jAxtpEMeFUbZ1MzHpoIdE534MABPoIsPn36dAW8o20QZgY6b5A+fCRIEqA9Ezi9illbg0W2EmmO8vJyd7DUw4OEwtw1rF279mB2dvZxJF1Hk1zUgwt0BHAMiinToQ4LyNguNWO2yHgoIkgCzRGEvwEk7EbHSpCWThKkDZ4JimmYiI2Lu2q1WqtBwhGQWv/mm2+OKUVmDWVlZePUDJi8b0F4FQi4jvYJpcT04FhYTmoGJxzJmK0144GJIAl0UTHruSbQHG1DJ4UmcHJzlrHzM5GBfG7UrmTbbCdXrlx5BIOtn01NCAc1A8ITmpGbm3scbbcjOSITchwMvM2CI4anTwcZpT///POskPFAREhNgCdhh3e0i24lCKGvHnRR0WFplmQIRcj5BMpeweysXr58+VGkNz0KTQgH1wwI8vxzzz1HzaA3dRVt30WG7DsDtUHRCJFHMjBG89jY2NYzZ878GS7yxv379z/wqzr3TQQ69ZsmOGrFmoBOCU1QiggiZIcJDkAOSAJxH8pcXrhw4clly5YdMZlMDXNBggTNFJyBxhUrVnyLPhxHn0kGIfLlkX0nwsdE4Jy3aizUjLPnzv4Z2lL8oGTcFxFoVJCABu3NLc1l7lE3H28G9wnoKBF6lIFuqRyYAvry7Tk5OTVLly49hvOWR2mOpgPJQD8uoA9HuICjj9dwHmCfCfZ5yn1GyBFBj5GljYyObq1vatwd0Osf6PXOeyZCksAbeGdra8sGB50lEz7fPe8T5IAww3yIt8M+f/f4449XYaPVDFMxqhSfc1ALsXFsgrt8GBOjGknX0V9BBjVAakQkgBaaKYtzcHDb6VM/777V1bXhfsm4ZyKwGKVxTWhqPF8xMNC/HQuyzaDXU7pKibtBEhg4IAwsgEFxVFdhCk4sWbLkcHx8fKMaPkxCbcSC21hYWMgF/Bj6yh14gJOHYLc5julA0lCWZioTE7TU4ajd09Xbu+Grr77iZzjuCfdEBB9vdnV1rW9obChzuZxb0GgmGhe3sqenIdhBxa4GFJ+9/bHHHqt54oknjs63JoSD3tT4+HgT9zCcKEi6BhMMSxPcZ3As0wHTTRCFMuItdJfTtfXc2TMVrpF7fwt9RiL4VnZvb6/9QuuFXf0DA9vRoBWNTT5PkMepwDzMJhZANEASjj/55JOVILJJDZoQDpopjLVx1apVB0FGFZKuseMzmyeQhFGyHMZG35ZmSryQcKvrFl3bGV9IiEgENaG7r3vdxUsXXxl0ujaB8Ewk0x6KGSLDdEAeba0fnbuC9eC7RYsWVWVkZJxXkyaEQ2oGyKBmnOQtF3KBoJS4G5SATh+URfAGAe/06y3DQ8Ml9XUNu7p6emZ8C31aIvjyFz+fcOXylV39ff3b/D7f5FvZ7JToWITOKeBUugxNOEFNSE1NVaUmhIOawdshBQUF39hstmMYdsRNn6LyQZkocZDCHXiGa8hV2thIzeiKuGZMSURNTU3a1atX17a1te0cHHBuRp185UV8PkGwr6gi2+UDFR9VVyTxXzANR6rNFWjBSd5OwMLc8tprr42IBqIAdG2pGc8+++xhW7atWm/QX/PTSAXHNjlWn195Jh5MFLKR8sFf2ouMEWhGQ13drkivd05JxC+//PKn9vb2sr6+vu2oSLx3pKcZQp7STIx4/0KYJpEoyGBfqKI4n0A3Ly/MzT2BhfmwxWJp2rt3b1R8ujMU1Ax6U0WFRQezbFnHMNh2jM/HMXKsIEY8bRQCgSDkOym/BfGPhTNQz7/W1tbuvnz58pPIugt3EXH06FGrx+PJHxgYKICg+TSMdU4JkSHI+G3XiTkzEWswXM222b7709InxJoQTZoQDuWubXPhqsIjVmvWSZAgbqEzj2NWzND0QgpCh3WSn1wqwC58TVVVlVlJn8RdRDgcjryxsTF+Uke8ixpMnRrsBD0FHtEQj150qR2qfCL/X/IPWVItjfOxY55t0Ezx4dIGu/0bTDDeCYCZCnBjKvKlDCKB+XBysvkpqJaWljwleRJ3EFFdXZ2BBXo5XLh8nKbOVDlpCpon4S14Yw2x17Js1u+WP5tfhbTm3wMJErxRiENzwcqCwzZbVjW0gTtw3i8T459JJSBLelImEJEPk78yfOG+g4jz588vTUhIKEbFNvrDMxKB1tkJlPNiTbiJteCHgtUFR529vXN6A2+uQM2gN7WmaE1lljWzxu/z/4qxK0/6IjNBWZI0uMNZsDjFmPDLlCyBO4i4ePGiFdrwDC5Ko7oFG4iAoLp54RFdz7BkVhcVFlb6xnyO999//3ejCeEgGbDzDpDxTabVWoUJexOOCl0npcTUoCwhK05uM7RieV1dHT+aNok7iLBarU4wNoDCvCs5ea9lOqBpb2xcbEd6uuV7+7p1h9GQ4/eoCeGgmaJmYMzfWq2Z1XBOOiDpiF9PRFkyQEZuo9HYk52dfcem9g4iNm/e3Ird5D8Q7eQ5LhIqRfAYFrxwaW+YzeYTBUUrD0GT/hAkSEjNKCoo+ibNbD4O23ETyT7KhpByknFFlpzcnfAk/1FUVNQmMhXcQcSLL77YNTo6+k+w3QrT5JamKaxSLlrUnBtpaWk1xRvshwd7Bx1080SBPxCoGfSmijcXf5uenl4Ned1A8hBkJLQjVG6UJeLDCxYsuAQZn9m5c2eHyFBwBxHE9u3bW7CbrISgT+HCfiR5uF5goeGbd06QdD0xMfFvUK//3rhx46Hert4/JAkSJGOof8hht9sPpKSkfELZkBAEF+SF5UPc9OTLcb1YS0/l5eUdQdlW5AcZUnAXEdSKFStW/IDwXxD2MQi+BST0wZu6CXL+npqa+vkLL7zwcU5Ozn8i/dwfmQQJklFRUVFns9k+Li0t/Q9Yiv0Q+v9CXjdBRj/izZDf0aeffvrAsmXL/tba2npLuXQS07pFn3zySRwqyenq6tqIDcgzcE0HwORPHR0dDWB+XPGr5wx79+5dBZv8CWbScziN7EUEbXWDyWR6e//+/XVK2pzggw8+0EM+Cbm5uc/99NNPdnhImZjUF7Oysn5saGi4BRPm/eijj+66gTiDfxokhF9iiMqpShOoRNznnWtECxESJAQkxEEr9HwoNh0BEjMSoRZEGxH3i7vWCA3zA40IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJNCJUAo0IlUAjQiXQiFAJoo6IQMi3gk2FSHlqxu9SI6KRDM00qQQaESqBRoRKoBGhEmhEqATRRwS/hRCBfhF/SEN+K6GIRzGihgifwTAR0Os8IIC/vAQiAjF6/mYF8gIgg3H+pgvjMXodf12DX48d8fu61YSoIcJiMg2nmlLa9Ho9f51F/CRZbGys2DOExcnNkNmc2paSkqLaX/cKR9QQkZeX15331FN/hbDbDQaDPy4uLsbtdovfZMC5iJMMBGrBlaVP5f11yZIlPcGr1Y+oIYI/FuVyuX5JTk6qx6zvxvQfhdD5i4/it99IDkgahjp0m1JMjZ2//nr2nXfeGVQuVz1m+iJbVeHdd98dTzGlODu7bg/FGsTMT4Lw+Ysmnvi4+IG4hPhav8//l8KVq35YvHhxW35+ftR8b7nic0QP+FXPZrM5Bdpg/+X06XVer4e/DBYTHx/fvXad/dS42/1PaI7rww8/JEFcL6ICUUeERGVlpaGlpSWus7NTbzKZdDBXfqwjE2+99RZ/NT5qCNCgQcPdiIn5f8mUtwsfGiECAAAAAElFTkSuQmCC);background-position:center;background-repeat:no-repeat;background-size:contain;display:block}.gui-header .gui-header-cell .gui-header-title .gui-sort-desc{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAAB2CAYAAAAz4kaDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABPcSURBVHhe7V1pU1TXuqa7aQSaHpjBaxRkEKMCMikeoyeVm9ycqAhGcIia5GYwX/IhvyDmD+RDqu6HpJJKVeJ1wFQqZSVVVxETacQBxOiJlibxRBOFpqFpukGGHu/zrN6b0yg0RgF3m/2QlbV7DXuv9T7rHdbe2+4YFSpUhEEj5VGFYDCo+eSTT2KvXbsWq9PptG63O5idnR1YtmyZt6GhwS81iyropDwqQAKQxV68eNESo9M9d/3na7sc/Y6tI6MjLw243BWpKSnxzz//vH316tWeU6dOBUO9ogNRpRH79+83OZ3O6razZ9fPmxdX5vN4V3h8XgPrdLHaEb0u7ieQ1bGqqupERkZGG7RjRHSMAkSNRlAbvvzyy/m37tzaOzbmqff7fAU+vz85EAgkoC5eE6MxBHz+bJ/fWwSy4kdHRzugFS6pu+IRNURkZmYmxxsM63779V91Go0mHyne5/Np9Hp9jFarjeFxrD5Wj/LEMa9Hk7c47w9oxK2jR496pFMoGlFDxJIlSxbaurpeG/WMrfH7/YnUkPj4+Biv1yvqeezxeITmgBiDe3DIOzQ4eKGtrc0pGigcWilXPAYHBxMHXK5CHBohaCx8DbVAaEP4MaCBuTIMuF2FDrc7iQXRgKghAitdh//FxwSCGg3iIYg/JuD3x/CYEYc4xh8o4meNNhCcp/X7Y0O9lY+oIWIyaDXS8EkMjkUIyKA1qgLXEKKaiCcJKhEKgUqEQqASoRCoRCgEUUcE9wxPIqJSIyKRwbpoJEs1TQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQqEQqBSoRCoBKhEKhEKAQRvz3k/fff1/b39+tjY2O1Pp8vkJKS4v3ggw8CUvWc4s033ywfHBz8WKPRlOLjdF+T6g8Ggz8ajca9n3766QWpbE4B2fGLHWPdbremqKjIt3fv3tD3ok6BSSdEAoqLi+P4XauY+KabN2/Wz5s3b0VlZWWgurrasXr16sBcf/d2WVnZfI/HswnjycLH6TSZY7NhzN92dnZ2h4rmBh9//LF+/fr1Cfn5+RXXrl3b1tvb+4+kpKTMnTt3DmzYsGH422+/nXQh36cREgnzr1+//uzVq1f/homvHBsby8Ok3Ki+hJOeX7du3SlcpHPfvn1jqJ8TQpSuEY2NjborV67MW7ZsWRkW6TqMtRxjLRkZGbHExcXd0uv1nYWFhSch2+9BiE3qNo77JvTOO+8suHHjxgsgYSdW4HOBQGABJmVElcnv9y8YHR0tunXrVi7IWTA0NDT2wgsv9E7F8kxCyRrx0UcfzUtMTCy/fPnydizg2uHh4RchtxUw52nIkyC/FK/Xm2+327O1Wu3Ie++9Zztw4MCQ1F1gwoTQQdPa2lqE1b4VHavRKQ3FCfzmYZCgQ70JaRFYfsHlcu21Wq27TKmmMqpj6Ax/PZCE1KxUasE2EPDflA1klwN5mUGCXvp25nlYQCkoqwZZDceOHVsmOodhAhFHjhx5Csyuwqpfgo5kUpTjePxbwZBTi4wkBI68pqW5ZTvM1cq/IhkkwZxqLrO2WOudTudGaMAiFJshIyGLcLlRliAlASQVQcZrv/vuO2r2OCYQcf78+UI4l7+DuWycQKPT6cIJmHAM6EDTQqdroLa9o32nyWQqg52MEw3+Avj888/jU1NTyy60X9w24HRtDmBhQi78tv5xWUlyEjllKSH7zp07fz958mSR9FlgAhE2my0RqpWOTgkgI4YpIoJBnc/vf8pmt9e0tLVtB9ulfwXNIAkI6cusZ87UO/r7XvJ5fU9B5BHnTVlCK8CJJg6ak4wFb5aqBCYQAYfYhb3CVXQYABnIpgmIyLRWqwv4/Qv7enrqzrWfe+I148MPP0yIjY8tO9fe3uDos9d4xjw5kJWesogEyTRRO5zQpCvYW9ilKoEJRGRkZPwcHx9vhZPpQRpXrakRFBdAO51Wp11g67FvPHPuTAM140kkg5pgTk0tbT/X/rKjr+8fMD7cZ+lDCzbyoqUsoRVc3DbIx7p8+fJfpCqBCUTs2rXLDbY6kS6BiEF0jnx21HIQJA2rQoc8x2brqblw8UI9alc8SWYKCysB2Yqr/7xc19PTu8Hn9+XCPAkSBBGRJSUvald6evqltLS0qzU1NX2iQsIEIghsSK4lJyc34yLdUucpwXopPBM2UBuKqHK7uru3tLS27mQ09SRoBknoc/WV/Pjjj9u6u7o3B4OBPMxdzznLMphOVkAQ7bphcZrLy8uvSWXjuI+Iurq6AexIzyLE6sCFHCiakmtWcDVwENQKAhfTBQPBRT32nk0dnR3cj6xgmCcqoxBffPGFAY51+Y2ff6vr6rFt8AX8izFH8QMhnHNIG6AVovWUQLNgDxZ4BzaZl7Zs2TLBPxD3EUEUFBT8q7Ky8oDFYvm/GE1MX0j5QheTk5+Cl1QyiGP5hzRAApNOEwzm2bptWxAS74ADL6F9RXVU4bPPPjM6HI7i3377rb7r9u3NmGEB5hvLOXKuCFRC8xcpKGRC2ciyQkjLoyAkZYO5P56fn99YXV19g+e+F5MS0dDQMASz0lpaXn7IYDQ046QgA+fE1UMXwSceI1Eb4KnFwOC8RM6flwEx2oA/kIuQuOann36qj4uLK44mM0VNGBsbW9aDaPCPP/7YBEHnY2466adzQjOFGEiGKAsVytKRjwP4s6UkW74vLCw8kpube2bjxo2T/vjUpEQQdNzzMzNbSkrL95tM5mMQeB/1S7aFzEUSn6aEFuqb1w2f0dHRsZPRVDRoBhZMktvtpiY0/P7775tRVIA0pawEZHlI8sG8A1qdzpaaltqUV5B3CE76NEwSTf2kiHjy2traway0tNay8tJDSdAMnFv4DDjykLGiGQo1nRTSwPgsI7erq2tTZ2dnAzVDyT4DkV5iX1/fchBQd/PmzQ3wk/mYq5ZrUGpyH4QspITgkUUBBKq9yWbzD0uLln6VkZrR9sorr0T8GbbILAMwU675mfNb4On3m5Mtx0gG42ERLYmhRaICFwhFFHAZwdzbt2/XXbhwYQfspSJ9BjUBc5M1oRbDzkMxf9eOUwg1mgRyHXMsugBye5ol+fjTS58+hLm2vvrqq1NqgoxpiSCoGSaDyVpVueqgyWw84fX5HBCsMFORjBNXCIgTSa/Xs2HunTt3NiMMVJxmUBP6+/tXgISXoQkbMeY8PplEFX/XTsxlKrCGskCbgM/v7TWaLSdXrlzZmJWVdXo6TZDxQEQQ9BmZaWnQjKr9yRbzMVy5F6sHgcHUA+TghOYAaMvP1IwcOL8t7e3tIppijC4aPEZQE+C/Sm7cuFHPhYJhMkQV5ogkcB5MUwIyQMTkB3G21OS046Ulyw9iv9BaX1//wL8K+cBEENQMOvDVa9YeSDZbmmAPHaBh2odCJENeVejDGeXAgddcvnyZt4+LH6eZkjUBWsDoiD4hD+PljTaxeGjzI5IAoN4fq9X1Wizm5sqKikZDvKH1tddec6E8st0Ow58igiAZCIWsK0tLDxgSEk9Auk4MelwzwnM5SdoQXi7MFBx47S+//LIVn59+HKEttRHjWvbrr79uwcLYiHHQJ4zLhGPm2KUxi0Tck/MWtSPBEH+yeHlxI0zwnyaB+NNEEG+88cYgLmhdtWrV/8K8MLR1YMVP0IxwuyqbJ5kM5kg0U4vhwGuvXLmy3ePx0EzNGRnUwsHBwdLr169vhTnaBIEXYEjjDw2kMY6PnQifE4Fj3sXrMxqNTVXlVQfR1vowJBAPRQRBMrBlP0UysG0/ARUewKAEGRwwJ8AkT4jpXqCM+4zF2PTVwoFvx/HyubhRSBJw7eKrV6++jA1bDa6bj2Jx2+LeccpjZ6KZCiPCj8/9iYmJzWVlZYfoE95++2032v1pEoiHJoLgDtxsNresXbt2P1YFQ9t+ksHfmOaA5TQNtHCUebDPtW1tbTtwvtLZjKZojrBAVl68eHFrV3f3Jlyb+4RxTZgM8jy4wKQ9FHxzoM9gMDRVVT2aJsh4JCIImYw1a9aQjCYUOTFIsc94ABJkzaFm5Njt9rqzZ89uxy50Vp5nUBOGhoYECbhWjc/rXQzhxXIM04FzkebkR59+kNC8evXqA5hzy6NogoxHJoIgGRhYS3V19X6QchyrTOwzOHAMUGo1ObjKpJXGsTCaqj1z5swO3g6ZSc2gJmBIZdzDwBzRMS/GNWORi+tHAucgmSU/NmzCJ2CuB4eHh63YJ0z/3OYBMCNEECQDvuIUNQMOvAmDE5rBiUaCTBTbgTiGjYuwWjefP39eaMZM+AwSOjY2tvLSpUtbe3t7+bZFLq4rHuqQBHkMU4Ht4MypCQ4suBM0RyizvvvuuzNCAjFjRBB79uy5K2uGxWI5hlXEp1ARB0ohSCov/0o7yViIVbvZarXueNRXdXAuDVbwSmhZA0nguTEu8VCH1+RKn44I1NMxY59gOVFZWXkY/awzYY7CEdFJPQyOHDni2b17d3dKSooLZsaAsPQ/MOAEuDtMVxO6HYBEIciQTYNMCNpzR2seHR2d73K5YgsLC51ut1s/MDDwEpqJN/3C+4cDXZnRLNopuOPHj7sRou6Ab9gGohehXJDKdjzHBI0QGUf579WDYz9G50iCJlRUVAjHPNMkEDNOBEEyXtz9YndORo7b7rAbPF5vFiadGJoxxo8s9NAkJJDwREg5Mo3x7t272dj5JmdlZS0CscUoT0E5nTvb3AeSCfDUw0uWLNE5HI7/xH6hBtcX5oiV0vkFxDH+Gx+PlnXiCEQF/BqttteYlNQMEg7B9J5G2D7jJBD/HtEs4H8aG5PiXK51p8+e3jk8OPy8RqdNR/HE+zeYUqRBQIB+CLcfIfEANGQB+sSjP++IinqaFoKmhuC5UYduQU9cXNxtfE6CJqSgbErzJqTKoZAMJOnc4CbQk2AwNq+uqDiMslnRBBmzSgTBx43eQOCZixc6dvY7nf+FojTG4rLgaAimGwSEGUB7H8jgm3TckQuBkUgKnjmTXCYhiMjLx2gMZZH3CeIPY5HOA+J4K7s3xZLctKJ0xeGHuXf0ZzGjznoyiNshWE0V5RUHeAsdM+mVV50s0EiQBK3FDpZvyAltklasEBo/k1QeE/J52RZ9qAXiBl4ksJpteA7kAQTdPUaTma/Qixt4r7/++sBskkDMio+4F0ePHhUOPD013TXgdCbC7s/HhMVb5pi01CoyKHAmmiLmMvhZFj4ht5GjIpkgOZ8MrKNvQB/xUMeSYjmxsrj0MIi0kgSp2axi1jVChrQDP11SXMKHS01YX70QGm/bSi0mB4UsC5a3TngsC13O7xUy+8A/CFJYx8+RwDGgbUCr09pMScaTRUuLjvAZ81yRQMyJRshANDW2Y8eOHnNKqmtwaCjB4xmjZhgirVYKk4kEEOGrnAJmHctkrZDL5HoSSES6BpSSHXvS0zKa8wsLG7PTM1sxzgd+qDMTmFMiiK+//nrs9VdftVuSTa7evl6j1+PJhGEwSNXjCBf4ZEKUBc86pnAywhHed7LzAPAKQZs52fRDYdHSwwvnzz891yQQc04EQc2oq62zZWRluFxOVwI3bihOZF24sLiyZUHLCD8OJ2sqyPX3nksiDFnQlpaR0bQkv7AxMz19zjVBRuRZzDIaGxvN2Kz9rb29fTc2Xc9iRWeynEKShTydoB8Uk5wTH4NdJpOpZenSpQdzcnLaIr13NNt4LBohg5qxZ88ecTvE6XQmjIyMZKNY+AyZgJkigpD9DLUDpHfBITctXrz4SHZ2duu2bdv6ReVjwpxFTVOB0ZR4vbO09LDFYjmJVcoXdMefZ8iO91HAc8jaIOEOIrgfFi5c+HVeXt60L3/NBR6rRsigA2c0lZyc7BoYGIiHZmRAcEkgQ0juUbVC7o9z8l2s29CEZpBwpKCg4LGao3AogghCJiMjI8MNM2UAGcKBQ3CPbJskbSAPNpKQn5//FUzSGaWQQCiGCIJkwFZTMwYdDofR5/Nlwaw8Mhk4RwDa1QNf9D1M0WE4ZkWRQDzyapsNfPPNN8aenp51nZ2d210ul7hRiPRQY4UW0MlQE04UFhZ+xXdRleAT7sVjd9aTgS+xQStaS0pKDvEhfSAYcDD4JBU0MyLHH8rFXVMm+Zh14rYJc3rpmJheo9H4A0zRV3DQinDMk0FRpikcDG3feustG4TocjgdCSPY9Gm02gQIefxZBOUsjiWCeOOOVkyQwruoOq3dZDI3Pb1ihdis7d69+7GGqJGgSI2QId5CN5msVRVVB81Gk3gLHYIPyre95RuATCSEZVKd+PcJRnPSyZKVxY2mrMQHfiv7cUHRRBB8Cz02Nlb8+4z01LRjOo22D04csg89+JeJkI+9Xm8AbeyZmRnHly8vPegd9ba+Uf+GokkgoNTRATrwXqfzmVarddfI8N1nYYRMMEV8V0meA/3BMGhxJyYmfV9dXXUwThd3erafrM0UooYIorGxMcneb1/Vfu7Cc8FAoHLMM7bc6/OKf1+h18fdTYiP/6ffH+isqqg4FRcXd3Y2nzHPNKKKCILfsGaxWEz6+Pi1rS0ta/R6vbhR6PF67eufeebM6OhoK0Je9759+/hCWFSQQEQdETKgHfzqNj6T1t69e5df7BXglxhCC3zRRIAKFSruR0zM/wMYBpbiISU/xQAAAABJRU5ErkJggg==);background-position:center;background-repeat:no-repeat;background-size:contain;display:block}.gui-header .gui-header-cell .gui-header-menu{display:-ms-flexbox;display:flex}.gui-header .gui-header-cell .gui-header-menu .gui-header-menu-icon-wrapper{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:16px;padding:16px;position:relative;right:0;width:16px}.gui-header .gui-header-cell .gui-header-menu .gui-header-menu-icon-wrapper .gui-header-menu-icon{display:none;height:16px;width:16px}.gui-header-bottom .gui-header{border-bottom:0;border-color:inherit;border-top:1px solid}.gui-structure{background:#fff;border-color:#d6d6d6;box-sizing:border-box;color:#333;display:block;font-family:Arial;font-size:14px;position:relative}.gui-structure *{box-sizing:border-box}.gui-structure .gui-structure-header{display:block;height:100%;width:100%}.gui-structure .gui-structure-header .gui-structure-header-filters.gui-header{height:32px}.gui-structure .gui-structure-header .gui-structure-header-filters.gui-header .gui-header-cell{padding:4px}.gui-structure .gui-structure-header .gui-structure-header-filters.gui-header .gui-header-cell input{box-sizing:border-box;height:100%;padding:2px;position:relative;width:100%;border-color:#d6d6d6;border-style:solid;border-width:1px;font-size:13px}.gui-structure-container{display:block;height:100%;overflow:auto;overflow-x:hidden;position:relative;width:100%}.gui-structure-container .gui-structure-container-element{height:100%;position:absolute;width:100%}.gui-structure-container .gui-structure-container-element .gui-content{height:100%;position:relative}.gui-structure-container .gui-structure-container-element .gui-content .gui-row{border-bottom:1px solid transparent;position:absolute;width:100%}.gui-structure-container .gui-structure-container-element .gui-content .gui-row:last-child{border-bottom:0}.gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:#ecedee}.gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#d0e8fb}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell{border-right:1px solid transparent;box-sizing:border-box;line-height:1em;overflow:hidden;padding:0;white-space:nowrap}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-cell-view span{line-height:1.4em}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-button{padding:0}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-cell-boolean{-ms-flex-pack:center;justify-content:center}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-checkbox{line-height:24px;position:relative}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-checkbox input{position:relative}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-chip{line-height:1em;margin:0;padding:4px 8px}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-badge{padding:0}.gui-structure-container .gui-structure-container-element .gui-content .gui-row .gui-cell .gui-input{background:transparent;font-size:14px;padding:0;border-radius:0;border-style:none}.gui-structure-container .gui-cell{display:inline-block}.gui-structure-container .gui-cell:last-child .gui-cell-view{padding-right:20px}.gui-structure-container .gui-cell>span{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:100%;padding:0 8px;width:100%}.gui-structure-container .gui-cell .gui-cell-edit-mode{border:2px solid #2185d0;height:100%;padding:6px}.gui-structure-container .gui-cell .gui-cell-edit-mode .gui-boolean-edit{margin-left:calc(50% - 11px)}.gui-structure-container .gui-cell .gui-cell-edit-mode input:focus{box-shadow:none;outline:none}.gui-vertical-grid .gui-structure-summaries-cell{border-right:1px solid;border-right-color:inherit}.gui-vertical-grid .gui-structure-container-element .gui-content .gui-row .gui-cell,.gui-vertical-grid .gui-structure-header .gui-header .gui-header-cell{border-right:1px solid;border-right-color:inherit}.gui-vertical-grid .gui-structure-container-element .gui-content .gui-row .gui-cell:last-of-type,.gui-vertical-grid .gui-structure-header .gui-header .gui-header-cell:last-of-type{border-right:0}.gui-vertical-grid .gui-row-checkbox{border-right:1px solid!important;border-right-color:inherit!important}.gui-horizontal-grid .gui-structure-container-element .gui-content .gui-row{border-bottom:1px solid;border-bottom-color:inherit}.gui-horizontal-grid .gui-structure-container-element .gui-content .gui-row:last-of-type{border-bottom:0}.gui-rows-even .gui-row.even,.gui-rows-odd .gui-row.odd{background:#f7f8f9}.gui-structure-info-panel{-ms-flex-align:center;align-items:center;background:#f2f3f4;box-sizing:border-box;display:-ms-flexbox;display:flex;height:36px;-ms-flex-pack:justify;justify-content:space-between;padding:0 6px;width:100%;border-top-color:inherit;border-top-style:solid;border-top-width:1px}.gui-structure-info-panel p{margin:0}.gui-structure-info-panel p b{font-weight:bold}.gui-structure-info-panel div button{background:#ccc;color:#fff;cursor:pointer;font-family:Arial;font-weight:bold;height:16px;line-height:14px;padding:0;width:16px;border-color:transparent;border-radius:50%;border-style:solid;border-width:1px}.gui-structure-info-panel div button:focus{box-shadow:0 0 4px #ccc;outline:none}.gui-structure-border{border:1px solid;border-color:#d6d6d6}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut{0%{opacity:1}to{opacity:0}}@keyframes fadeOut{0%{opacity:1}to{opacity:0}}.gui-loading{-ms-flex-line-pack:center;align-content:center;-webkit-animation-duration:.2s;animation-duration:.2s;background:rgba(255,255,255,.8);border:1px solid;border-color:inherit;display:-ms-flexbox;display:flex;height:100%;-ms-flex-pack:center;justify-content:center;left:0;opacity:0;position:absolute;top:0;visibility:hidden;width:100%}.gui-loading .gui-spinner{-ms-flex-item-align:center;align-self:center}.gui-loading.gui-loader-hidden{-webkit-animation-name:fadeOut;animation-name:fadeOut;opacity:0;visibility:visible;z-index:-1}.gui-loading.gui-loader-visible{-webkit-animation-name:fadeIn;animation-name:fadeIn;opacity:1;visibility:visible;z-index:1}.gui-structure-column-manager>div:hover{background:#ecedee}.gui-structure-column-manager label{margin-bottom:0}.gui-text-highlight{background:#fff799;padding:0!important}.gui-title-panel{border-bottom-color:#d6d6d6}.gui-footer-panel{border-top-color:#d6d6d6}.gui-schema-manager-dialog .gui-schema-manager .gui-structure-schema-manager-select,.gui-schema-manager-dialog .gui-schema-manager .gui-checkbox{color:#333}.gui-schema-manager-dialog .gui-schema-manager .gui-structure-schema-manager-select:nth-last-child(1),.gui-schema-manager-dialog .gui-schema-manager .gui-checkbox:nth-last-child(1){margin-bottom:0}.gui-structure-schema-manager-icon{margin-right:16px}.gui-structure-schema-manager-icon svg{height:18px;margin-bottom:-1px;width:18px}.gui-row-checkbox{-ms-flex-align:center;align-items:center;cursor:pointer;display:-ms-flexbox!important;display:flex!important;-ms-flex-pack:center;justify-content:center;padding:0 12px!important;width:48px!important}.gui-row-checkbox .gui-checkbox{height:24px;margin:0;padding:0;width:24px}.gui-select-all .gui-checkbox .gui-checkmark{top:0}.gui-structure-cell-edit-boolean{height:100%}.gui-column-highlighted{background:#fffddd}\n", ".gui-structure-column-manager ol li:hover{background:#ecedee}.gui-structure-column-menu-icon svg{height:16px;width:16px}.gui-structure-column-menu-icon .cls-1{fill:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px}.gui-structure-column-menu-arrow-icon{display:inline-block}.gui-structure-column-menu-arrow-icon svg{height:10px;width:12px}.gui-structure-column-menu-arrow-icon .gui-structure-column-menu-sort-icon svg{height:16px}.gui-structure-column-menu-arrow-icon .cls-1{fill:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px}.gui-structure-dialog-column-manager .gui-dialog-title{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.gui-structure-dialog-column-manager ol{max-height:400px;min-width:250px}\n", ".gui-summaries-value{font-weight:bold}.gui-structure-summaries-panel{background:#f2f3f4}.gui-structure-summaries-panel.gui-structure-summaries-panel-bottom .gui-structure-summaries-cell{border-top:1px solid #d6d6d6}.gui-structure-summaries-panel.gui-structure-summaries-panel-top .gui-structure-summaries-cell{border-bottom:1px solid #d6d6d6}.gui-structure-summaries-panel .gui-structure-summaries-cell{font-size:14px;padding-left:16px;padding-right:16px}.gui-structure-summaries-panel .gui-structure-summaries-cell:last-child{padding-right:20px}.gui-structure-summaries-panel .gui-structure-summaries-value{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;line-height:1em;overflow:hidden;padding:8px 0}.gui-structure-summaries-panel .gui-structure-summaries-value div .gui-math-symbol{position:relative;top:-1px}.gui-structure-summaries-panel .gui-structure-summaries-value .gui-mean,.gui-structure-summaries-panel .gui-structure-summaries-value .gui-median{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:relative}.gui-structure-summaries-panel .gui-structure-summaries-value .gui-mean span:nth-child(1){left:1px;position:absolute;top:-15px}.gui-structure-summaries-panel .gui-structure-summaries-value .gui-median span:nth-child(1){left:1px;position:absolute;top:-8px}\n", ".gui-structure-column-manager-icon svg{height:16px;width:16px}.gui-structure-column-manager-icon .cls-1,.gui-structure-column-manager-icon .cls-2{fill:none;stroke-linecap:round;stroke-linejoin:round}.gui-structure-column-manager-icon .cls-2{stroke-width:1.5px}.gui-structure-info-icon svg{height:16px;width:16px}.gui-structure-info-icon .cls-1{stroke-width:0}.gui-structure-info-icon .cls-2{fill:none;stroke-linecap:round;stroke-linejoin:round}.gui-structure-info-panel div{display:inline-block}.gui-structure-info-panel div button{display:inline-block}.gui-structure-info-panel .gui-right-section .gui-structure-column-manager-icon{margin-right:16px;position:relative}.gui-structure-info-panel .gui-right-section .gui-structure-info-icon{margin-right:4px;position:relative}.gui-structure-info-modal .gui-quote{color:#575757}.gui-structure-info-modal p{color:#333}.gui-structure-info-modal a{color:#2185d0}.gui-structure-info-modal a:hover{color:#59a9e5;text-decoration:underline}\n", "@media (max-width: 500px){.gui-paging>*{padding-left:4px}.gui-paging .gui-paging-stats{padding-left:4px}}\n", ".gui-header{display:-ms-flexbox;display:flex}.gui-header .gui-header-cell{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex}.gui-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.gui-content .gui-structure-cell-container,.gui-content .gui-row{display:-ms-flexbox;display:flex}.gui-content .gui-structure-cell-container .gui-cell,.gui-content .gui-row .gui-cell{display:inline-block}.gui-content .gui-structure-row-details{background:#80cbc4;display:block;height:200px;position:absolute;-ms-transform:translateY(0);transform:translateY(0);width:100%}\n", ".gui-inline-dialog-header-menu.gui-inline-dialog-wrapper .gui-inline-dialog-content{background:transparent;box-shadow:none}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-item-active{font-weight:bold}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-list{background:#fff}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item{color:#333}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item.gui-active{color:#2185d0}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-content{box-shadow:0 3px 7px #ccc;box-sizing:content-box;padding:0;width:225px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move{color:#333;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;padding:0}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item{-ms-flex-align:center;align-items:center;cursor:pointer;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item svg line{stroke:#aaa}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item.left{padding:12px 16px 12px 12px;width:48%}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item.right{padding:12px 10px;width:52%}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover svg line{stroke:#464646}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container{border:none;border-radius:0}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container:hover .gui-dropdown-arrow{opacity:1}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu{width:125px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item{background:#fff;color:#333;display:-ms-flexbox;display:flex;padding:8px 8px 8px 12px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item:hover .gui-sort-title svg line{stroke:#464646}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item .gui-sort-title{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;width:100%}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item .gui-sort-title svg{margin-top:3px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-item .gui-sort-title svg line{stroke:#aaa}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-menu .gui-header-item-active .gui-item .gui-sort{opacity:1}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item{color:#333;cursor:pointer;display:block;padding:8px 12px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item:hover{background:#ecedee}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-checkbox{color:#333;margin-left:12px;padding:8px 12px 8px 32px;width:169px}.gui-inline-dialog-header-menu .gui-header-menu-tab .gui-checkbox label{display:inline-block;width:inherit}\n", ".gui-cell .gui-checkbox{display:block}.gui-cell .gui-chip{margin:0;padding:2px 8px}.gui-cell .gui-input{display:block;font-size:11px;padding:2px 4px;width:100%}.gui-cell .gui-button{padding:2px 8px}.gui-cell .gui-cell-number{display:block;width:100%}.gui-cell .gui-cell-boolean{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:100%;text-align:center;width:100%}.gui-cell .gui-string-edit{width:100%}\n", ".gui-fabric{border-color:#d6d6d6;font-family:Arial;font-size:14px}.gui-fabric .gui-header-cell,.gui-fabric .gui-structure-header-columns{height:42px}.gui-fabric .gui-structure-top-panel,.gui-fabric .gui-structure-info-panel,.gui-fabric .gui-paging{height:42px}\n", ".gui-material{border-color:rgba(0,0,0,.122);font-family:Arial;font-size:14px}.gui-material *{border-color:rgba(0,0,0,.122);font-size:14px}.gui-material.gui-structure{border:0;border-radius:0;box-shadow:0 2px 2px rgba(0,0,0,.141),0 3px 1px -2px rgba(0,0,0,.122),0 1px 5px rgba(0,0,0,.2)}.gui-material.gui-structure,.gui-material .gui-header{font-family:Arial}.gui-material .gui-header-cell,.gui-material .gui-structure-header-columns{height:56px}.gui-material .gui-header .gui-header-cell.gui-header-sortable:hover{background:transparent}.gui-material .gui-header-cell{padding-left:16px;padding-right:16px}.gui-material .gui-structure-container-element .gui-structure-cell>span{padding-left:16px;padding-right:16px}.gui-material .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:rgba(0,0,0,.04)}.gui-material .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#e6f7ff}.gui-material .gui-structure-header .gui-header{background:transparent;color:#464646;font-weight:bold}.gui-material .gui-structure-header .gui-header .gui-header-cell{border-color:inherit}.gui-material .gui-cell .gui-button{padding:0}.gui-material .gui-cell .gui-badge{padding:0}.gui-material .gui-paging-alternative-navigator .gui-button{background:transparent;color:#333;margin:0 4px;padding:0}.gui-material .gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-material .gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#ccc;opacity:.4}.gui-material .gui-structure-summaries-panel{background:#fff}.gui-material gui-structure-top-panel,.gui-material .gui-structure-info-panel,.gui-material .gui-paging{height:52px;padding-left:16px;padding-right:16px}.gui-material .gui-structure-info-panel{background:#fff;border-radius:0}.gui-material gui-structure-top-panel{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;padding-right:0}.gui-material gui-structure-top-panel .gui-search-bar form input{border:0;outline:0}.gui-material .gui-search-bar form input{border:0;outline:none}\n", ".gui-dark{border-color:#575757;border-radius:2px;color:#f0f0f0;font-family:Arial;font-size:14px}.gui-dark *{border-color:#575757;color:#f0f0f0;font-size:14px}.gui-dark.gui-structure{border-radius:2px}.gui-dark .gui-header-cell,.gui-dark .gui-structure-header-columns{background:#333;height:46px}.gui-dark .gui-structure-border{border:none;box-shadow:5px 5px 10px 2px #1f1f1f}.gui-dark .gui-header-cell{border-bottom:1px solid;border-color:inherit;padding-left:16px;padding-right:16px}.gui-dark .gui-structure-container-element .gui-structure-cell>span{padding-left:16px;padding-right:16px}.gui-dark .gui-structure-header .gui-header{border-bottom-color:#666;color:#bdbdbd}.gui-dark .gui-structure-header .gui-header .gui-header-cell:hover{background:#525252}.gui-dark .gui-structure-header .gui-header .gui-header-cell:hover .gui-header-menu .gui-header-menu-icon-wrapper{background-color:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-list{background:#383838}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item{color:#f0f0f0}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-menu .gui-tab-menu-item.gui-active{color:#ce93d8}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-tab-content{box-shadow:0 1px 2px #525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab .gui-structure-column-manager ol li:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move{color:#f0f0f0}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-column-move .gui-header-menu-column-move-item:hover svg line{stroke:#ce93d8}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container .gui-dropdown-menu{border-color:#666}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container .gui-dropdown-menu .gui-item:hover svg line{stroke:#ce93d8}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-dropdown-container:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-item{background:#383838;color:#f0f0f0;display:-ms-flexbox;display:flex}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-tab-item-dropdown .gui-header-menu-dropdown.gui-dropdown .gui-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item{color:#f0f0f0}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-header-menu-item:hover{background:#525252}.gui-dark .gui-inline-dialog-header-menu .gui-header-menu-tab .gui-checkbox{color:#f0f0f0}.gui-dark .gui-structure-column-manager>div:hover{background:#525252}.gui-dark .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:#525252}.gui-dark .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#7cb9f652}.gui-dark.gui-rows-odd .gui-row.odd{background:#4f4f4f}.gui-dark.gui-rows-even .gui-row.even{background:#4f4f4f}.gui-dark .gui-horizontal-grid .gui-structure-container-element .gui-row .gui-cell{border-bottom-color:#666}.gui-dark .gui-paging.gui-paging-bottom{border-top-color:#666}.gui-dark .gui-paging.gui-paging-top{border-bottom-color:#666}.gui-dark ::-webkit-scrollbar{width:15px}.gui-dark ::-webkit-scrollbar-track{background:#616161}.gui-dark ::-webkit-scrollbar-thumb{background:#424242}.gui-dark ::-webkit-scrollbar-thumb:hover{background:#212121}.gui-dark .gui-structure-top-panel,.gui-dark .gui-structure-info-panel,.gui-dark .gui-paging,.gui-dark .gui-structure-container-element,.gui-dark .gui-row{background:#444}.gui-dark .gui-structure-top-panel,.gui-dark .gui-structure-info-panel,.gui-dark .gui-paging{height:42px;padding-left:16px;padding-right:16px}.gui-dark .gui-structure-summaries-cell{background:#383838;color:#f0f0f0}.gui-dark .gui-structure-summaries-panel-bottom .gui-structure-summaries-cell{border-top-color:#666}.gui-dark .gui-structure-summaries-panel-top .gui-structure-summaries-cell{border-bottom-color:#666}.gui-dark .gui-structure-info-panel{background:#383838;border-top-color:#666}.gui-dark .gui-structure-info-panel div{color:#f0f0f0}.gui-dark .gui-structure-info-panel div button{background:#616161}.gui-dark .gui-structure-info-panel p{color:#f0f0f0}.gui-dark .gui-structure-info-modal p{color:#f0f0f0}.gui-dark gui-paging-alternative-navigator .gui-button{background:transparent;color:#f0f0f0;margin:0 4px;padding:0}.gui-dark gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-dark gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#f0f0f0;opacity:.4}.gui-dark gui-paging-alternative-navigator gui-paging-alternative-pages .gui-paging-active-page{box-shadow:0 1px #f0f0f0;color:#f0f0f0}.gui-dark .gui-search-bar form{background:#444}.gui-dark .gui-search-bar input{background:#444;border:0;color:#f0f0f0;cursor:pointer}.gui-dark .gui-search-bar:hover .gui-search-icon-svg line,.gui-dark .gui-search-bar:hover .gui-search-icon-svg circle{stroke:#878787}.gui-dark .gui-icon{cursor:pointer}.gui-dark .gui-icon svg{stroke:#aaa;transition:stroke .3s ease-in-out}.gui-dark .gui-icon svg:hover{stroke:#e6e6e6!important}.gui-dark .gui-empty-source div{background:#383838}.gui-dark .gui-dialog-wrapper .gui-dialog-content .gui-schema-manager-dialog .gui-dialog-title{color:#f0f0f0}.gui-dark .gui-title-panel,.gui-dark .gui-footer-panel{background:#383838}\n", ".gui-light{border-color:#f0f0f0;font-family:Arial;font-size:14px}.gui-light *{border-color:#f0f0f0;font-size:14px}.gui-light.gui-structure-border{border:0}.gui-light.gui-structure,.gui-light .gui-header{background:#fff;color:#333;font-family:Arial}.gui-light .gui-header-cell,.gui-light .gui-structure-header-columns{height:56px}.gui-light.gui-structure-border{border-color:#f0f0f0 transparent}.gui-light .gui-header-cell,.gui-light .gui-structure-container-element .gui-structure-cell>span{padding-left:16px;padding-right:16px}.gui-light .gui-structure-header .gui-header{color:#333;font-weight:bold}.gui-light .gui-structure-header .gui-header .gui-header-cell:hover{background:#f3f9ff}.gui-light .gui-structure-header .gui-header .gui-header-cell:hover .gui-header-menu .gui-header-menu-icon-wrapper{background-color:#f3f9ff}.gui-light .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:#f3f9ff}.gui-light .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#7cb9f652}.gui-light.gui-rows-odd .gui-row.odd{background:#f7f7f7}.gui-light.gui-rows-even .gui-row.even{background:#f7f7f7}.gui-light gui-paging-alternative-navigator .gui-button{background:transparent;color:#333;margin:0 4px;padding:0}.gui-light gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-light gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#333;opacity:.4}.gui-light .gui-structure-top-panel,.gui-light .gui-structure-info-panel,.gui-light .gui-paging{height:56px;padding-left:16px;padding-right:16px}.gui-light .gui-structure-top-panel,.gui-light .gui-structure-info-panel,.gui-light .gui-paging,.gui-light .gui-structure-summaries-panel{background:#fff}.gui-light .gui-search-bar form input{border:0;outline:none}\n", ".gui-structure.gui-generic{border-color:rgba(34,36,38,.102);font-family:Arial;font-size:14px}.gui-structure.gui-generic *{border-color:rgba(34,36,38,.102);font-size:14px}.gui-structure.gui-generic .gui-header-cell,.gui-structure.gui-generic .gui-structure-header-columns{height:46px}.gui-structure.gui-generic .gui-header .gui-header-cell.gui-header-sortable:hover{background:rgba(0,0,0,.04);transition:.15s all}.gui-structure.gui-generic .gui-header-cell,.gui-structure.gui-generic .gui-structure-container-element .gui-structure-cell>span{padding-left:12px;padding-right:12px}.gui-structure.gui-generic .gui-structure-container-element .gui-structure-cell:last-child>span{padding-right:20px}.gui-structure.gui-generic .gui-structure-header.gui-header-bottom .gui-header{border-color:inherit;border-style:solid;border-width:2px 0 0}.gui-structure.gui-generic .gui-structure-container .gui-structure-container-element .gui-content .gui-row:hover{background:rgba(0,0,0,.04)}.gui-structure.gui-generic .gui-structure-container .gui-structure-container-element .gui-content .gui-row.selected{background:#e6f7ff}.gui-structure.gui-generic .gui-structure-header .gui-header{background:#f9fafb;border-width:0 0 2px;color:#464646;font-weight:bold}.gui-structure.gui-generic .gui-rows-odd .gui-row.odd{background:#f9fafb}.gui-structure.gui-generic .gui-rows-even .gui-row.even{background:#f9fafb}.gui-structure.gui-generic .gui-cell .gui-button{padding:0}.gui-structure.gui-generic .gui-cell .gui-badge{padding:0}.gui-structure.gui-generic .gui-paging-alternative-navigator .gui-button{background:transparent;color:#333;margin:0 4px;padding:0}.gui-structure.gui-generic .gui-paging-alternative-navigator .gui-button:hover{background:transparent}.gui-structure.gui-generic .gui-paging-alternative-navigator .gui-button:disabled{background:transparent;color:#ccc;opacity:.4}.gui-structure.gui-generic .gui-structure-summaries-panel{background:#f9fafb}.gui-structure.gui-generic .gui-structure-top-panel,.gui-structure.gui-generic .gui-structure-info-panel,.gui-structure.gui-generic .gui-paging{height:46px;padding-left:12px;padding-right:12px}.gui-structure.gui-generic .gui-structure-info-panel{background:#f9fafb;border-radius:0}.gui-structure.gui-generic .gui-structure-top-panel{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;padding-right:0}.gui-structure.gui-generic .gui-structure-top-panel .gui-search-bar form input{border:0;outline:0}.gui-structure.gui-generic .gui-rows-odd gui-row.odd,.gui-structure.gui-generic .gui-rows-even .gui-row.even{background:#f9fafb}.gui-structure.gui-generic .gui-row:hover{background:#f9fafb;transition:.15s all}\n"]
                },] }
    ];
    StructureComponent.ctorParameters = function () { return [
        { type: StructureId },
        { type: CompositionId },
        { type: PagingCommandInvoker },
        { type: PagingEventRepository },
        { type: SourceCommandInvoker },
        { type: SourceEventService },
        { type: SortingCommandInvoker },
        { type: SearchCommandInvoker },
        { type: FieldCommandInvoker },
        { type: SchemaCommandInvoker },
        { type: CompositionCommandInvoker },
        { type: CompositionEventRepository },
        { type: FormationEventRepository },
        { type: StructureCommandInvoker },
        { type: StructureEditModeArchive },
        { type: StructureCellEditArchive },
        { type: StructureInfoPanelArchive },
        { type: StructureInfoPanelConfigService },
        { type: StructureCellEditStore },
        { type: ColumnFieldFactory },
        { type: StructureColumnMenuConfigArchive },
        { type: PagingDisplayModeArchive },
        { type: RowSelectEnabledRepository },
        { type: RowSelectionTypeArchive },
        { type: SchemaRowClassArchive },
        { type: SchemaRowStyleArchive },
        { type: FormationCommandInvoker },
        { type: SearchEventRepository },
        { type: StructureHeaderBottomEnabledArchive },
        { type: StructureRowDetailConfigArchive },
        { type: StructureTitlePanelConfigArchive },
        { type: StructureFooterPanelConfigArchive },
        { type: SchemaEventRepository },
        { type: TranslationFacade },
        { type: StructureInitialValuesReadyArchive },
        { type: ColumnAutoConfigurator },
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef },
        { type: core.Injector },
        { type: StructureDefinition },
        { type: StructureWarehouse },
        { type: CompositionWarehouse },
        { type: SchemaCssClassManager },
        { type: SchemaReadModelRootId },
        { type: hermes.DomainEventBus },
        { type: hermes.CommandDispatcher },
        { type: StructureRowDetailService }
    ]; };

    exports["ɵnr"] = void 0;
    (function (SortOrder) {
        SortOrder[SortOrder["ASC"] = 0] = "ASC";
        SortOrder[SortOrder["DESC"] = 1] = "DESC";
        SortOrder[SortOrder["NONE"] = 2] = "NONE";
    })(exports["ɵnr"] || (exports["ɵnr"] = {}));

    exports["ɵns"] = void 0;
    (function (ColumnAlign) {
        ColumnAlign[ColumnAlign["RIGHT"] = 0] = "RIGHT";
        ColumnAlign[ColumnAlign["CENTER"] = 1] = "CENTER";
        ColumnAlign[ColumnAlign["LEFT"] = 2] = "LEFT";
    })(exports["ɵns"] || (exports["ɵns"] = {}));

    // Basically header template
    var CellTemplateWithContext = /** @class */ (function () {
        function CellTemplateWithContext(viewTemplate, editTemplate, 
        // public editContext: any,
        context, width, fieldId, columnDefinitionId, sortStatus, enabled, sortable, align) {
            this.viewTemplate = viewTemplate;
            this.editTemplate = editTemplate;
            this.context = context;
            this.width = width;
            this.fieldId = fieldId;
            this.columnDefinitionId = columnDefinitionId;
            this.sortStatus = sortStatus;
            this.enabled = enabled;
            this.sortable = sortable;
            this.align = align;
        }
        CellTemplateWithContext.prototype.getColumnDefinitionId = function () {
            return this.columnDefinitionId;
        };
        CellTemplateWithContext.prototype.getFieldId = function () {
            return this.fieldId;
        };
        CellTemplateWithContext.prototype.getSortStatus = function () {
            return this.sortStatus;
        };
        CellTemplateWithContext.prototype.isSortEnabled = function () {
            return this.sortable;
        };
        CellTemplateWithContext.prototype.isAscSort = function () {
            return this.sortStatus === exports["ɵnr"].ASC;
        };
        CellTemplateWithContext.prototype.isDescSort = function () {
            return this.sortStatus === exports["ɵnr"].DESC;
        };
        CellTemplateWithContext.prototype.isNoSort = function () {
            return this.sortStatus === exports["ɵnr"].NONE;
        };
        CellTemplateWithContext.prototype.isEnabled = function () {
            return this.enabled;
        };
        CellTemplateWithContext.prototype.isAlignLeft = function () {
            return this.align === exports["ɵns"].LEFT;
        };
        CellTemplateWithContext.prototype.isAlignCenter = function () {
            return this.align === exports["ɵns"].CENTER;
        };
        CellTemplateWithContext.prototype.isAlignRight = function () {
            return this.align === exports["ɵns"].RIGHT;
        };
        return CellTemplateWithContext;
    }());

    var StructureColumnConfigComponent = /** @class */ (function (_super) {
        __extends(StructureColumnConfigComponent, _super);
        function StructureColumnConfigComponent(changeDetectorRef, elementRef, structureId, structureCommandService, compositionReadModelService, filterWarehouse, translationFacade, structureColumnMenuConfigArchive, compositionId, compositionCommandInvoker, injector, column) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.structureCommandService = structureCommandService;
            _this.compositionReadModelService = compositionReadModelService;
            _this.filterWarehouse = filterWarehouse;
            _this.translationFacade = translationFacade;
            _this.structureColumnMenuConfigArchive = structureColumnMenuConfigArchive;
            _this.compositionId = compositionId;
            _this.compositionCommandInvoker = compositionCommandInvoker;
            _this.injector = injector;
            _this.column = column;
            _this.uniqueValues = [];
            _this.structureColumnConfigService = _this.injector.get(StructureColumnConfigService);
            return _this;
        }
        StructureColumnConfigComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.filterWarehouse.onUniqueValues(this.structureId), function (uniqueValuesReadModel) {
                _this.uniqueValues = uniqueValuesReadModel.getValues(_this.column.getFieldId());
            });
            this.subscribe(this.structureColumnMenuConfigArchive
                .on()
                .pipe(hermes.hermesSwitchMap(function (config) {
                _this.config = config;
                return _this.translationFacade.onTranslation();
            })), function (translation) {
                _this.setTabTitles(translation);
                _this.dropdownTextTranslation = translation.headerMenuMainTabColumnSort;
            });
        };
        StructureColumnConfigComponent.prototype.isEnabled = function () {
            return this.config && this.config.isEnabled();
        };
        StructureColumnConfigComponent.prototype.hideColumn = function () {
            this.compositionCommandInvoker.disableColumn(this.column.getColumnDefinitionId(), this.compositionId);
            this.structureColumnConfigService.close();
        };
        StructureColumnConfigComponent.prototype.moveLeft = function () {
            this.compositionCommandInvoker.moveLeft(this.column.getColumnDefinitionId(), this.compositionId);
            this.structureColumnConfigService.close();
        };
        StructureColumnConfigComponent.prototype.moveRight = function () {
            this.compositionCommandInvoker.moveRight(this.column.getColumnDefinitionId(), this.compositionId);
            this.structureColumnConfigService.close();
        };
        StructureColumnConfigComponent.prototype.highlightColumn = function () {
            this.compositionCommandInvoker.highlightColumn(this.column.getColumnDefinitionId(), this.compositionId);
            this.structureColumnConfigService.close();
        };
        StructureColumnConfigComponent.prototype.getSelectorName = function () {
            return 'gui-column-config';
        };
        StructureColumnConfigComponent.prototype.setTabTitles = function (translation) {
            this.config.setMainMenu(translation.headerMenuMainTab);
            this.config.setFilterMenu(translation.headerMenuFilterTab);
            this.config.setColumnsMenu(translation.headerMenuColumnsTab);
        };
        return StructureColumnConfigComponent;
    }(SmartComponent));
    StructureColumnConfigComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-column-config]',
                    template: "<div *ngIf=\"isEnabled()\"\n\t class=\"gui-header-menu-tab\">\n\n\t<gui-tab [active]=\"config.getActiveMenu()\" [menu]=\"config.getMenus()\">\n\n\t\t<ng-container *ngIf=\"config.isMainEnabled()\">\n\n\t\t\t<gui-tab-item [tab]=\"config.getMainMenu()\" class=\"gui-tab-item-dropdown\">\n\n\t\t\t\t<div *ngIf=\"column.isSortEnabled()\" [column]=\"column\"\n\t\t\t\t\t [dropdownTextTranslation]=\"dropdownTextTranslation\"\n\t\t\t\t\t gui-structure-column-config-sort>\n\t\t\t\t</div>\n\n\t\t\t\t<div (columnHidden)=\"hideColumn()\"\n\t\t\t\t\t [column]=\"column\"\n\t\t\t\t\t gui-structure-column-config-column-hide>\n\t\t\t\t</div>\n\n\t\t\t\t<div (click)=\"highlightColumn()\"\n\t\t\t\t\t class=\"gui-header-menu-item\">\n\t\t\t\t\t{{'headerMenuMainTabHighlightColumn' | guiTranslate}}\n\t\t\t\t</div>\n\n\t\t\t\t<div (movedLeft)=\"moveLeft()\"\n\t\t\t\t\t (movedRight)=\"moveRight()\"\n\t\t\t\t\t [column]=\"column\"\n\t\t\t\t\t gui-structure-column-config-column-move>\n\t\t\t\t</div>\n\n\t\t\t</gui-tab-item>\n\n\t\t</ng-container>\n\n\t\t<ng-container *ngIf=\"config.isFilteringEnabled()\">\n\n\t\t\t<gui-tab-item [tab]=\"config.getFilterMenu()\">\n\n\t\t\t\t<!--\t\t\t\t\t\t<div class=\"gui-header-menu-item\">{{config.getFilterMenu()}}</div>-->\n\n\t\t\t\t<div [fieldId]=\"column.getFieldId()\"\n\t\t\t\t\t gui-unique-value-list>\n\t\t\t\t</div>\n\n\t\t\t</gui-tab-item>\n\n\t\t</ng-container>\n\n\t\t<ng-container *ngIf=\"config.isColumnManagerEnabled()\">\n\n\t\t\t<gui-tab-item [tab]=\"config.getColumnMenu()\">\n\n\t\t\t\t<div gui-structure-menu-column-manager>\n\t\t\t\t</div>\n\n\t\t\t</gui-tab-item>\n\n\t\t</ng-container>\n\n\t</gui-tab>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnConfigComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: StructureCommandInvoker },
        { type: CompositionWarehouse },
        { type: FilterWarehouse },
        { type: TranslationFacade },
        { type: StructureColumnMenuConfigArchive },
        { type: CompositionId },
        { type: CompositionCommandInvoker },
        { type: core.Injector },
        { type: CellTemplateWithContext, decorators: [{ type: core.Inject, args: ['column',] }] }
    ]; };
    StructureColumnConfigComponent.propDecorators = {
        headerSortMenu: [{ type: core.ViewChild, args: ['headerSortMenu', { static: false },] }]
    };

    var StructureColumnConfigService = /** @class */ (function (_super) {
        __extends(StructureColumnConfigService, _super);
        function StructureColumnConfigService(injector, schemaReadModelRootId, schemaWarehouse, structureThemeConverter, inlineDialogService) {
            var _this = _super.call(this) || this;
            _this.injector = injector;
            _this.schemaReadModelRootId = schemaReadModelRootId;
            _this.schemaWarehouse = schemaWarehouse;
            _this.structureThemeConverter = structureThemeConverter;
            _this.inlineDialogService = inlineDialogService;
            return _this;
        }
        StructureColumnConfigService.prototype.open = function (elementRef, column) {
            var _this = this;
            this.close();
            var injector = core.Injector.create({
                providers: [{
                        provide: 'column',
                        useValue: column
                    }],
                parent: this.injector
            });
            this.schemaWarehouse
                .onceTheme(this.schemaReadModelRootId)
                .pipe(this.hermesTakeUntil())
                .subscribe(function (theme) {
                _this.inlineDialogService.open(elementRef, StructureColumnConfigComponent, {
                    injector: injector,
                    placement: fabric.FabricPlacement.BOTTOM,
                    offset: -34,
                    theme: _this.structureThemeConverter.convertTheme(theme),
                    customClass: 'gui-inline-dialog-header-menu'
                });
            });
        };
        StructureColumnConfigService.prototype.close = function () {
            this.inlineDialogService.close();
        };
        return StructureColumnConfigService;
    }(hermes.Reactive));
    StructureColumnConfigService.decorators = [
        { type: core.Injectable }
    ];
    StructureColumnConfigService.ctorParameters = function () { return [
        { type: core.Injector },
        { type: SchemaReadModelRootId },
        { type: SchemaWarehouse },
        { type: StructureThemeConverter },
        { type: fabric.FabricInlineDialogService }
    ]; };

    var StructureHeaderColumnsComponent = /** @class */ (function (_super) {
        __extends(StructureHeaderColumnsComponent, _super);
        function StructureHeaderColumnsComponent(elementRef, injector, changeDetectorRef, compositionId, structureId, formationCommandDispatcher, sortingCommandDispatcher) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.elementRef = elementRef;
            _this.injector = injector;
            _this.changeDetectorRef = changeDetectorRef;
            _this.compositionId = compositionId;
            _this.structureId = structureId;
            _this.formationCommandDispatcher = formationCommandDispatcher;
            _this.sortingCommandDispatcher = sortingCommandDispatcher;
            _this.checkboxSelection = false;
            _this.globalSearching = false;
            return _this;
        }
        StructureHeaderColumnsComponent.prototype.toggleSort = function (column) {
            if (column.isSortEnabled()) {
                this.sortingCommandDispatcher.toggleSort(column.getFieldId(), this.compositionId, this.structureId);
            }
        };
        StructureHeaderColumnsComponent.prototype.isSortAsc = function (column) {
            return column.getSortStatus() === exports["ɵnr"].ASC;
        };
        StructureHeaderColumnsComponent.prototype.isSortDesc = function (column) {
            return column.getSortStatus() === exports["ɵnr"].DESC;
        };
        StructureHeaderColumnsComponent.prototype.isGlobalSortEnabled = function () {
            return this.globalSearching;
        };
        StructureHeaderColumnsComponent.prototype.getSelectorName = function () {
            return 'gui-structure-header-columns';
        };
        return StructureHeaderColumnsComponent;
    }(SmartComponent));
    StructureHeaderColumnsComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-header-columns][columns]',
                    template: "<div *ngIf=\"checkboxSelection\"\n\t class=\"gui-header-cell gui-row-checkbox\n\t gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis\">\n\t<div gui-select-all></div>\n</div>\n\n<div (click)=\"toggleSort(column)\"\n\t *ngFor=\"let column of columns\"\n\t [ngClass]=\"{'gui-header-sortable': column.isSortEnabled()}\"\n\t [style.width.px]=\"column.width\"\n\t class=\"gui-header-cell gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis\">\n\n\t<div class=\"gui-header-title\">\n\t\t<ng-container\n\t\t\t*ngTemplateOutlet=\"column.viewTemplate;\n\t\t\t\t\t\t\t\t   context: column.context\">\n\t\t</ng-container>\n\n\t\t<div [ngClass]=\"{'gui-sort-asc': isSortAsc(column), 'gui-sort-desc': isSortDesc(column)}\"\n\t\t\t class=\"gui-sort\">\n\t\t</div>\n\t</div>\n\n\t<div class=\"gui-header-menu\">\n\t\t<div [column]=\"column\"\n\t\t\t gui-structure-column-config-trigger>\n\t\t</div>\n\t</div>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None,
                    providers: [
                        StructureColumnConfigService
                    ]
                },] }
    ];
    StructureHeaderColumnsComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.Injector },
        { type: core.ChangeDetectorRef },
        { type: CompositionId },
        { type: StructureId },
        { type: FormationCommandInvoker },
        { type: SortingCommandInvoker }
    ]; };
    StructureHeaderColumnsComponent.propDecorators = {
        columns: [{ type: core.Input }],
        checkboxSelection: [{ type: core.Input }]
    };

    var StructureHeaderFiltersComponent = /** @class */ (function (_super) {
        __extends(StructureHeaderFiltersComponent, _super);
        function StructureHeaderFiltersComponent(structureFilterCommandService, formBuilder, cd, elementRef, structureId) {
            var _a;
            var _this = _super.call(this, elementRef) || this;
            _this.structureFilterCommandService = structureFilterCommandService;
            _this.formBuilder = formBuilder;
            _this.cd = cd;
            _this.structureId = structureId;
            _this.closed = new core.EventEmitter();
            _this.filterFieldName = 'phrase';
            _this.filterMode = false;
            _this.filterForm = _this.formBuilder.group((_a = {},
                _a[_this.filterFieldName] = [''],
                _a));
            return _this;
        }
        StructureHeaderFiltersComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.filterForm
                .valueChanges
                // .pipe(
                // debounceTime(500)
                // )
                .subscribe(function (f) {
                _this.filter(f[_this.filterFieldName]);
            });
        };
        StructureHeaderFiltersComponent.prototype.filter = function (phrase) {
            if (phrase === undefined || phrase === null) {
                phrase = '';
            }
            // this.structureFilterCommandService.addFilter(this.columns[0].getFieldId(), '1', phrase, this.structureId);
        };
        StructureHeaderFiltersComponent.prototype.clearFilters = function () {
            this.filterForm.reset();
        };
        StructureHeaderFiltersComponent.prototype.turnOnFilterMode = function () {
            this.filterMode = true;
            this.cd.detectChanges();
        };
        StructureHeaderFiltersComponent.prototype.turnOffFilterMode = function () {
            this.filterMode = false;
            this.cd.detectChanges();
        };
        StructureHeaderFiltersComponent.prototype.getSelectorName = function () {
            return '';
        };
        return StructureHeaderFiltersComponent;
    }(PureComponent));
    StructureHeaderFiltersComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-header-filters][columns]',
                    template: "\n\n\t\t<ng-container *ngIf=\"!filterMode\">\n\n\t\t\t<div *ngFor=\"let cell of columns\"\n\t\t\t\t [style.width.px]=\"cell.width\"\n\t\t\t\t class=\"gui-header-cell gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis\">\n\n\t\t\t\t<!--\t\t\t\t<gui-structure-header-filter [column]=\"cell\">-->\n\t\t\t\t<!--\t\t\t\t</gui-structure-header-filter>-->\n\n\t\t\t\t<button (click)=\"turnOnFilterMode()\">Add Filter</button>\n\n\t\t\t</div>\n\n\t\t</ng-container>\n\n\t\t<ng-container *ngIf=\"filterMode\">\n\n\t\t\t<gui-select [options]=\"['has value', 'is the same as', 'starts with', 'ends with']\" [selected]=\"'has value'\">\n\n\t\t\t</gui-select>\n\n\t\t\t<form [formGroup]=\"filterForm\">\n\t\t\t\t<input type=\"text\" [formControlName]=\"filterFieldName\" gui-input/>\n\t\t\t</form>\n\n\t\t\t<button gui-button (click)=\"clearFilters()\">Clear All</button>\n\t\t\t<button gui-button (click)=\"turnOffFilterMode()\">Close</button>\n\n\t\t</ng-container>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureHeaderFiltersComponent.ctorParameters = function () { return [
        { type: FilterCommandInvoker },
        { type: forms.FormBuilder },
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId }
    ]; };
    StructureHeaderFiltersComponent.propDecorators = {
        columns: [{ type: core.Input }],
        closed: [{ type: core.Output }]
    };

    var VerticalFormationWarehouse = /** @class */ (function () {
        function VerticalFormationWarehouse() {
        }
        return VerticalFormationWarehouse;
    }());
    VerticalFormationWarehouse.decorators = [
        { type: core.Injectable }
    ];
    VerticalFormationWarehouse.ctorParameters = function () { return []; };

    var StructureHeaderComponent = /** @class */ (function (_super) {
        __extends(StructureHeaderComponent, _super);
        function StructureHeaderComponent(changeDetectorRef, elementRef, eventBus, structureId, compositionId, filterWarehouse, structureWarehouse, rowSelectionTypeArchive, structureVerticalFormationWarehouse, compositionWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.eventBus = eventBus;
            _this.structureId = structureId;
            _this.compositionId = compositionId;
            _this.filterWarehouse = filterWarehouse;
            _this.structureWarehouse = structureWarehouse;
            _this.rowSelectionTypeArchive = rowSelectionTypeArchive;
            _this.structureVerticalFormationWarehouse = structureVerticalFormationWarehouse;
            _this.compositionWarehouse = compositionWarehouse;
            _this.headerColumns = [];
            _this.filterRowEnabled = false;
            _this.showGroups = false;
            _this.styleModifier = new StyleModifier(elementRef.nativeElement);
            return _this;
        }
        StructureHeaderComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.rowSelectionTypeArchive.on(), function (type) {
                _this.checkboxSelection = type === RowSelectionType.CHECKBOX;
            });
            this.subscribe(this.compositionWarehouse.onHeaderColumns(this.compositionId), function (columns) {
                _this.headerColumns = columns;
            });
            this.subscribeWithoutRender(this.compositionWarehouse.onContainerWidth(this.compositionId), function (width) {
                _this.styleModifier.getElement(_this.containerRef.nativeElement).setWidth(width);
            });
            this.subscribe(this.filterWarehouse.onFilteringEnabled(this.structureId), function (enabled) {
                _this.filterRowEnabled = enabled;
            });
            this.subscribe(this.compositionWarehouse.onGroups(this.compositionId), function (collection) {
                _this.showGroups = collection.isVisible();
                _this.groups = collection.getGroups();
            });
        };
        StructureHeaderComponent.prototype.ngAfterViewInit = function () {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            this.subscribeWithoutRender(this.structureVerticalFormationWarehouse.onRowHeight(this.structureId), function (rowHeight) {
                var headerHeight = +(rowHeight) + 2;
                if (_this.filtersRef) {
                    _this.styleModifier.getElement(_this.filtersRef.nativeElement).setHeight(headerHeight);
                }
            });
        };
        StructureHeaderComponent.prototype.getSelectorName = function () {
            return 'gui-structure-header';
        };
        return StructureHeaderComponent;
    }(SmartComponent));
    StructureHeaderComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-header]',
                    template: "<div *ngIf=\"showGroups\"\n\t [checkboxSelection]=\"checkboxSelection\"\n\t [groups]=\"groups\"\n\t class=\"gui-header\"\n\t gui-structure-header-groups>\n</div>\n\n<div [checkboxSelection]=\"checkboxSelection\"\n\t [columns]=\"headerColumns\"\n\t class=\"gui-header\"\n\t gui-structure-header-columns>\n</div>\n\n<div *ngIf=\"filterRowEnabled\"\n\t [columns]=\"headerColumns\"\n\t class=\"gui-header\"\n\t gui-structure-header-filters>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureHeaderComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: hermes.DomainEventBus },
        { type: StructureId },
        { type: CompositionId },
        { type: FilterWarehouse },
        { type: StructureWarehouse },
        { type: RowSelectionTypeArchive },
        { type: VerticalFormationWarehouse },
        { type: CompositionWarehouse }
    ]; };
    StructureHeaderComponent.propDecorators = {
        containerRef: [{ type: core.ViewChild, args: [StructureHeaderColumnsComponent, { read: core.ElementRef, static: true },] }],
        filtersRef: [{ type: core.ViewChild, args: [StructureHeaderFiltersComponent, { read: core.ElementRef, static: true },] }]
    };

    var ChangedValueEmitter = /** @class */ (function () {
        function ChangedValueEmitter() {
            this.subject$ = new hermes.HermesReplaySubject(1);
        }
        ChangedValueEmitter.prototype.emit = function (value) {
            this.subject$.next(value);
        };
        ChangedValueEmitter.prototype.on = function () {
            return this.subject$.toObservable();
        };
        return ChangedValueEmitter;
    }());

    var StructureHeaderFilterComponent = /** @class */ (function (_super) {
        __extends(StructureHeaderFilterComponent, _super);
        function StructureHeaderFilterComponent(changeDetectorRef, elementRef, structureFilterCommandService, structureId) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureFilterCommandService = structureFilterCommandService;
            _this.structureId = structureId;
            _this.sub = new ChangedValueEmitter();
            _this.editContext = {
                changes: _this.sub
            };
            return _this;
        }
        StructureHeaderFilterComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.sub
                .on()
                .subscribe(function (phrase) { return _this.filter(phrase); });
        };
        StructureHeaderFilterComponent.prototype.filter = function (phrase) {
            // this.structureFilterCommandService.addFilter(this.column.getFieldId(), '1', phrase, this.structureId);
        };
        StructureHeaderFilterComponent.prototype.getSelectorName = function () {
            return 'gui-structure-header-filter';
        };
        return StructureHeaderFilterComponent;
    }(SmartComponent));
    StructureHeaderFilterComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-structure-header-filter',
                    template: "\n\n\t\t<!--\t\t<ng-container-->\n\t\t<!--\t\t\t\t*ngTemplateOutlet=\"column.editTemplate; context: editContext\">-->\n\t\t<!--\t\t</ng-container>-->\n\n\t\t<button gui-button [primary]=\"true\">Add Filter</button>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureHeaderFilterComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: FilterCommandInvoker },
        { type: StructureId }
    ]; };
    StructureHeaderFilterComponent.propDecorators = {
        column: [{ type: core.Input }]
    };

    var StructureCreatedEvent = /** @class */ (function (_super) {
        __extends(StructureCreatedEvent, _super);
        function StructureCreatedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'StructureCreatedEvent') || this;
        }
        return StructureCreatedEvent;
    }(StructureDomainEvent));

    var VerticalScrollEnabledSetEvent = /** @class */ (function (_super) {
        __extends(VerticalScrollEnabledSetEvent, _super);
        function VerticalScrollEnabledSetEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'VerticalScrollEnabledSetEvent') || this;
        }
        return VerticalScrollEnabledSetEvent;
    }(StructureDomainEvent));

    var InMemoryStructureStore = /** @class */ (function (_super) {
        __extends(InMemoryStructureStore, _super);
        function InMemoryStructureStore() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return InMemoryStructureStore;
    }(hermes.InMemoryStore));
    InMemoryStructureStore.decorators = [
        { type: core.Injectable }
    ];

    var VerticalFormationReadModel = /** @class */ (function () {
        function VerticalFormationReadModel(enabled, topMargin, sourceHeight, viewportHeight, rowHeight) {
            this.enabled = enabled;
            this.topMargin = topMargin;
            this.sourceHeight = sourceHeight;
            this.viewportHeight = viewportHeight;
            this.rowHeight = rowHeight;
        }
        VerticalFormationReadModel.prototype.isEnabled = function () {
            return this.enabled;
        };
        VerticalFormationReadModel.prototype.getTopMargin = function () {
            return this.topMargin; //  * this.rowHeight;
        };
        VerticalFormationReadModel.prototype.getSourceHeight = function () {
            return this.sourceHeight;
        };
        VerticalFormationReadModel.prototype.getViewPortHeight = function () {
            return this.viewportHeight;
        };
        VerticalFormationReadModel.prototype.getRowHeight = function () {
            return this.rowHeight;
        };
        return VerticalFormationReadModel;
    }());
    VerticalFormationReadModel = __decorate([
        hermes.ReadModelObject
    ], VerticalFormationReadModel);

    var VerticalFormationConverter = /** @class */ (function () {
        function VerticalFormationConverter() {
        }
        VerticalFormationConverter.prototype.convert = function (verticalFormation) {
            var enabled = verticalFormation.isEnabled(), topMargin = verticalFormation.getTopMargin(), sourceHeight = verticalFormation.getSourceHeight(), viewportHeight = verticalFormation.getViewPortHeight(), rowHeight = verticalFormation.getRowHeight();
            return new VerticalFormationReadModel(enabled, topMargin, sourceHeight, viewportHeight, rowHeight);
        };
        return VerticalFormationConverter;
    }());
    VerticalFormationConverter.decorators = [
        { type: core.Injectable }
    ];

    var StructureReadModelRoot = /** @class */ (function (_super) {
        __extends(StructureReadModelRoot, _super);
        function StructureReadModelRoot(uid, paging, entities, source, verticalFormation) {
            var _this = _super.call(this, uid) || this;
            _this.paging = paging;
            _this.entities = entities;
            _this.source = source;
            _this.verticalFormation = verticalFormation;
            return _this;
        }
        StructureReadModelRoot.prototype.getPaging = function () {
            return this.paging;
        };
        StructureReadModelRoot.prototype.getEntities = function () {
            return this.entities;
        };
        StructureReadModelRoot.prototype.getSource = function () {
            return this.source;
        };
        StructureReadModelRoot.prototype.getVerticalFormation = function () {
            return this.verticalFormation;
        };
        // TODO Remove
        StructureReadModelRoot.prototype.getTopMargin = function () {
            return this.verticalFormation.getTopMargin();
        };
        StructureReadModelRoot.prototype.isLoaderVisible = function () {
            return this.getSource().isLoading();
        };
        StructureReadModelRoot.prototype.getSourceHeight = function () {
            return this.verticalFormation.getSourceHeight();
        };
        StructureReadModelRoot.prototype.isReadyToDisplay = function () {
            return this.entities.length > 0;
            // this.presentation.getColumns().length > 0; // TODO presentation getColumns
        };
        StructureReadModelRoot.prototype.isVerticalScrollEnabled = function () {
            return this.verticalFormation.isEnabled();
        };
        return StructureReadModelRoot;
    }(hermes.ReadModelRoot));

    var ItemEntity = /** @class */ (function () {
        function ItemEntity(source, position, id, version) {
            if (version === void 0) { version = 0; }
            this.version = 0;
            this.source = source;
            this.position = position;
            this.version = version;
            if (!id) {
                this.id = hermes.RandomStringGenerator.generate();
            }
            else {
                this.id = id;
            }
        }
        ItemEntity.prototype.getSourceItem = function () {
            return this.source;
        };
        ItemEntity.prototype.getUiId = function () {
            return 'gui' + this.id.replace(/-/g, '');
        };
        ItemEntity.prototype.getId = function () {
            return this.id;
        };
        ItemEntity.prototype.getVersion = function () {
            return this.version;
        };
        ItemEntity.prototype.getPosition = function () {
            return this.position;
        };
        ItemEntity.prototype.isSelected = function () {
            return false;
        };
        ItemEntity.prototype.isEven = function () {
            return this.position % 2 === 0;
        };
        ItemEntity.prototype.isOdd = function () {
            return this.position % 2 === 1;
        };
        ItemEntity.prototype.equals = function (entity) {
            return this.id === entity.id && this.getVersion() === entity.getVersion();
        };
        ItemEntity.prototype.equalsById = function (id) {
            return this.id === id;
        };
        return ItemEntity;
    }());

    var StructureReadModelRootConverter = /** @class */ (function () {
        function StructureReadModelRootConverter(pagingConverter, sourceConverter, verticalFormationConverter) {
            this.pagingConverter = pagingConverter;
            this.sourceConverter = sourceConverter;
            this.verticalFormationConverter = verticalFormationConverter;
        }
        StructureReadModelRootConverter.prototype.convert = function (aggregate) {
            var pagingAggregate = aggregate.getPaging(), originItemEntities = aggregate.getEntities(), sourceCoordinator = aggregate.getSource(), verticalFormation = aggregate.getVerticalFormation();
            return new StructureReadModelRoot(aggregate.getId().toReadModelRootId(), this.pagingConverter.convert(pagingAggregate), this.convertSource(originItemEntities), this.sourceConverter.convert(sourceCoordinator), this.verticalFormationConverter.convert(verticalFormation));
        };
        StructureReadModelRootConverter.prototype.convertSource = function (source) {
            return source.map(function (originItem) {
                return new ItemEntity(originItem.sourceItem, originItem.getPosition(), originItem.getId().toString(), originItem.getVersion());
            });
        };
        return StructureReadModelRootConverter;
    }());
    StructureReadModelRootConverter.decorators = [
        { type: core.Injectable }
    ];
    StructureReadModelRootConverter.ctorParameters = function () { return [
        { type: PagingConverter },
        { type: SourceConverter },
        { type: VerticalFormationConverter }
    ]; };

    var InMemoryStructureReadStore = /** @class */ (function (_super) {
        __extends(InMemoryStructureReadStore, _super);
        function InMemoryStructureReadStore(inMemoryProjectStore, structureConverter) {
            var _this = _super.call(this, inMemoryProjectStore) || this;
            _this.inMemoryProjectStore = inMemoryProjectStore;
            _this.structureConverter = structureConverter;
            return _this;
        }
        InMemoryStructureReadStore.prototype.toReadModel = function (aggregate) {
            return this.structureConverter.convert(aggregate);
        };
        return InMemoryStructureReadStore;
    }(hermes.InMemoryReadModelStore));
    InMemoryStructureReadStore.decorators = [
        { type: core.Injectable }
    ];
    InMemoryStructureReadStore.ctorParameters = function () { return [
        { type: InMemoryStructureStore },
        { type: StructureReadModelRootConverter }
    ]; };

    var RowHeightSetEvent = /** @class */ (function (_super) {
        __extends(RowHeightSetEvent, _super);
        function RowHeightSetEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'RowHeightSetEvent') || this;
        }
        return RowHeightSetEvent;
    }(StructureDomainEvent));

    var StructureHeightSetEvent = /** @class */ (function (_super) {
        __extends(StructureHeightSetEvent, _super);
        function StructureHeightSetEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'StructureHeightSetEvent') || this;
        }
        return StructureHeightSetEvent;
    }(StructureDomainEvent));

    var ScrollPositionSetEvent = /** @class */ (function (_super) {
        __extends(ScrollPositionSetEvent, _super);
        function ScrollPositionSetEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'ScrollPositionSetEvent') || this;
        }
        return ScrollPositionSetEvent;
    }(StructureDomainEvent));

    var RowHeightSetBasedOnThemeEvent = /** @class */ (function (_super) {
        __extends(RowHeightSetBasedOnThemeEvent, _super);
        function RowHeightSetBasedOnThemeEvent(structureId) {
            return _super.call(this, structureId, null, 'RowHeightSetBasedOnThemeEvent') || this;
        }
        return RowHeightSetBasedOnThemeEvent;
    }(StructureDomainEvent));

    var UniqueFilterUnselectedEvent = /** @class */ (function (_super) {
        __extends(UniqueFilterUnselectedEvent, _super);
        function UniqueFilterUnselectedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'UniqueFilterUnselectedEvent') || this;
        }
        return UniqueFilterUnselectedEvent;
    }(StructureDomainEvent));

    var AllUniqueFilterUnselectedEvent = /** @class */ (function (_super) {
        __extends(AllUniqueFilterUnselectedEvent, _super);
        function AllUniqueFilterUnselectedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'AllUniqueFilterUnselectedEvent') || this;
        }
        return AllUniqueFilterUnselectedEvent;
    }(StructureDomainEvent));

    var AllUniqueFilterSelectedEvent = /** @class */ (function (_super) {
        __extends(AllUniqueFilterSelectedEvent, _super);
        function AllUniqueFilterSelectedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'AllUniqueFilterSelectedEvent') || this;
        }
        return AllUniqueFilterSelectedEvent;
    }(StructureDomainEvent));

    var UniqueFilterSelectedEvent = /** @class */ (function (_super) {
        __extends(UniqueFilterSelectedEvent, _super);
        function UniqueFilterSelectedEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'UniqueFilterSelectedEvent') || this;
        }
        return UniqueFilterSelectedEvent;
    }(StructureDomainEvent));

    var VerticalFormationRepository = /** @class */ (function (_super) {
        __extends(VerticalFormationRepository, _super);
        function VerticalFormationRepository(domainEventBus, inMemoryStructureReadStore) {
            var _this = _super.call(this) || this;
            _this.domainEventBus = domainEventBus;
            _this.inMemoryStructureReadStore = inMemoryStructureReadStore;
            _this.verticalFormation = new Map();
            _this.verticalFormation$ = new hermes.HermesReplaySubject(1);
            _this.domainEventBus
                .ofEvents([
                StructureCreatedEvent,
                VerticalScrollEnabledSetEvent,
                OriginSetEvent,
                StructureHeightSetEvent,
                RowHeightSetEvent,
                SchemaThemeSetEvent,
                RowHeightSetBasedOnThemeEvent,
                ScrollPositionSetEvent,
                SearchPhraseSetDomainEvent,
                UniqueFilterUnselectedEvent,
                AllUniqueFilterUnselectedEvent,
                AllUniqueFilterSelectedEvent,
                UniqueFilterSelectedEvent,
                PageChangedEvent,
                PagingSetEvent,
                ActiveFiltersSetEvent
            ])
                .pipe(_this.hermesTakeUntil())
                .subscribe(function (event) {
                var aggregateId = event.getAggregateId();
                var optStructure = _this.inMemoryStructureReadStore.getById(aggregateId);
                optStructure.ifPresent(function (structureReadModelRoot) {
                    var verticalFormation = structureReadModelRoot.getVerticalFormation();
                    _this.next(aggregateId, verticalFormation);
                });
            });
            return _this;
        }
        VerticalFormationRepository.prototype.onVerticalScrollEnabled = function (structureId) {
            return this.onVerticalFormation(structureId)
                .pipe(hermes.hermesMap(function (v) { return v.isEnabled(); }), hermes.hermesDistinctUntilChanged());
        };
        VerticalFormationRepository.prototype.onRowHeight = function (structureId) {
            return this.onVerticalFormation(structureId)
                .pipe(hermes.hermesMap(function (v) { return v.getRowHeight(); }), hermes.hermesDistinctUntilChanged());
        };
        VerticalFormationRepository.prototype.onContainerHeight = function (structureId) {
            return this.onVerticalFormation(structureId)
                .pipe(hermes.hermesMap(function (v) { return v.getViewPortHeight(); }), hermes.hermesDistinctUntilChanged());
        };
        VerticalFormationRepository.prototype.onTopMargin = function (structureId) {
            return this.onVerticalFormation(structureId)
                .pipe(hermes.hermesMap(function (v) { return v.getTopMargin(); }), hermes.hermesDistinctUntilChanged());
        };
        VerticalFormationRepository.prototype.onVerticalFormation = function (structureId) {
            return this.verticalFormation$
                .toObservable()
                .pipe(hermes.hermesFilter(function (idToVerticalFormation) {
                var key = structureId.getId();
                return idToVerticalFormation.has(key);
            }), hermes.hermesMap(function (idToVerticalFormation) { return idToVerticalFormation.get(structureId.getId()); }));
        };
        VerticalFormationRepository.prototype.next = function (structureId, verticalFormation) {
            this.verticalFormation.set(structureId.toString(), verticalFormation);
            this.verticalFormation$.next(this.verticalFormation);
        };
        return VerticalFormationRepository;
    }(hermes.Reactive));
    VerticalFormationRepository.decorators = [
        { type: core.Injectable }
    ];
    VerticalFormationRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus },
        { type: InMemoryStructureReadStore }
    ]; };

    var StructureContentComponent = /** @class */ (function (_super) {
        __extends(StructureContentComponent, _super);
        function StructureContentComponent(elementRef, changeDetectorRef, formationCommandService, structureEditModeArchive, formationWarehouse, structureWarehouse, structureVerticalFormationWarehouse, verticalFormationRepository, structureId, // REfactor
        rowSelectionTypeArchive, searchWarehouse, schemaRowClassArchive, schemaRowStyleArchive) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.elementRef = elementRef;
            _this.changeDetectorRef = changeDetectorRef;
            _this.formationCommandService = formationCommandService;
            _this.structureEditModeArchive = structureEditModeArchive;
            _this.formationWarehouse = formationWarehouse;
            _this.structureWarehouse = structureWarehouse;
            _this.structureVerticalFormationWarehouse = structureVerticalFormationWarehouse;
            _this.verticalFormationRepository = verticalFormationRepository;
            _this.structureId = structureId;
            _this.rowSelectionTypeArchive = rowSelectionTypeArchive;
            _this.searchWarehouse = searchWarehouse;
            _this.schemaRowClassArchive = schemaRowClassArchive;
            _this.schemaRowStyleArchive = schemaRowStyleArchive;
            _this.editMode = false;
            _this.searchPhrase = '';
            _this.highlighting = true;
            _this.phrase = true;
            _this.rowDetailOpened = 4;
            _this.checkboxSelection = false;
            return _this;
        }
        StructureContentComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.rowSelectionTypeArchive.on(), function (type) {
                _this.checkboxSelection = type === RowSelectionType.CHECKBOX;
            });
            this.subscribe(this.structureEditModeArchive.on(), function (enabled) {
                _this.editMode = enabled;
            });
            this.subscribe(this.structureWarehouse.onEditManager(this.structureId), function (manager) {
                _this.cellEditing = manager;
            });
            this.subscribe(this.schemaRowClassArchive.on(), function (schemaRowClass) {
                _this.schemaRowClass = schemaRowClass;
            });
            this.subscribe(this.schemaRowStyleArchive.on(), function (schemaRowStyle) {
                _this.schemaRowStyle = schemaRowStyle;
            });
            this.subscribe(this.structureVerticalFormationWarehouse.onRowHeight(this.structureId), function (rowHeight) {
                _this.rowHeight = rowHeight;
            });
            this.subscribe(hermes.fromRxJsObservable(rxjs.combineLatest(hermes.toRxJsObservable(this.searchWarehouse.onPhrase(this.structureId)), hermes.toRxJsObservable(this.searchWarehouse.onHighlight(this.structureId)))), function (args) {
                var searchPhrase = args[0], highlighting = args[1];
                _this.highlighting = highlighting;
                _this.searchPhrase = searchPhrase;
                if (!_this.highlighting) {
                    _this.searchPhrase = '';
                }
            });
        };
        StructureContentComponent.prototype.trackByFn = function () {
            return 0;
        };
        StructureContentComponent.prototype.translateY = function (index) {
            var height = index * this.rowHeight;
            return "translateY(" + height + "px)";
        };
        StructureContentComponent.prototype.toggleSelectedRow = function (entity) {
            if (!this.checkboxSelection) {
                this.formationCommandService.toggleSelectedRow(entity.getId(), RowSelectToggleType.NONE, this.structureId);
            }
        };
        StructureContentComponent.prototype.getSelectorName = function () {
            return 'gui-structure-content';
        };
        return StructureContentComponent;
    }(SmartComponent));
    StructureContentComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-content]',
                    template: "<div class=\"gui-content\">\n\n\t<div (click)=\"toggleSelectedRow(entity)\" *ngFor=\"let entity of source; let index = index; trackBy: trackByFn\"\n\t\t [cellEditing]=\"cellEditing\"\n\t\t [checkboxSelection]=\"checkboxSelection\"\n\t\t [columns]=\"columns\"\n\t\t [detailsEnabled]=\"rowDetailOpened === index\"\n\t\t [editMode]=\"editMode\"\n\t\t [entity]=\"entity\"\n\t\t [id]=\"entity.getUiId()\"\n\t\t [index]=\"entity.getPosition()\"\n\t\t [ngClass]=\"{'even': entity.isEven(), 'odd': entity.isOdd()}\"\n\t\t [ngStyle]=\"{'transform': translateY(index)}\"\n\t\t [rowClass]=\"schemaRowClass\"\n\t\t [rowStyle]=\"schemaRowStyle\"\n\t\t [searchPhrase]=\"searchPhrase\"\n\t\t [style.height.px]=\"rowHeight\"\n\t\t class=\"gui-row\"\n\t\t gui-structure-row>\n\t</div>\n\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureContentComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef },
        { type: FormationCommandInvoker },
        { type: StructureEditModeArchive },
        { type: FormationWarehouse },
        { type: StructureWarehouse },
        { type: VerticalFormationWarehouse },
        { type: VerticalFormationRepository },
        { type: StructureId },
        { type: RowSelectionTypeArchive },
        { type: SearchWarehouse },
        { type: SchemaRowClassArchive },
        { type: SchemaRowStyleArchive }
    ]; };
    StructureContentComponent.propDecorators = {
        source: [{ type: core.Input }],
        columns: [{ type: core.Input }]
    };

    var StructureRowComponent = /** @class */ (function (_super) {
        __extends(StructureRowComponent, _super);
        function StructureRowComponent(changeDetectorRef, elRef, structureId, formationWarehouse, formationCommandDispatcher, cssClassModifier) {
            var _this = _super.call(this, changeDetectorRef, elRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.elRef = elRef;
            _this.structureId = structureId;
            _this.formationWarehouse = formationWarehouse;
            _this.formationCommandDispatcher = formationCommandDispatcher;
            _this.cssClassModifier = cssClassModifier;
            _this.detailsEnabled = false;
            _this.checkboxSelection = false;
            _this.selectedItem = false;
            _this.styleModifier = new StyleModifier(_this.elRef.nativeElement);
            _this.classModifier = new ClassModifier(_this.elRef.nativeElement);
            return _this;
        }
        StructureRowComponent.prototype.ngOnChanges = function (changes) {
            var _this = this;
            ifChanged(changes.entity, function () {
                _this.checkSelectedItem();
                _this.updateRowClass(changes.entity.previousValue);
                _this.updateRowStyle(changes.entity.previousValue);
            });
            ifChanged(changes.rowClass, function () {
                _this.updateRowClass();
            });
            ifChanged(changes.rowStyle, function () {
                _this.updateRowStyle();
            });
        };
        StructureRowComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribeWithoutRender(this.formationWarehouse.onRowSelectedReadModel(this.structureId), function (row) {
                _this.row = row;
                var prevValue = _this.selectedItem;
                _this.checkSelectedItem();
                if (prevValue !== _this.selectedItem) {
                    if (prevValue) {
                        _this.cssClassModifier.unselect(_this.elRef.nativeElement);
                    }
                    else {
                        _this.cssClassModifier.select(_this.elRef.nativeElement);
                    }
                    _this.changeDetectorRef.detectChanges();
                }
            });
        };
        StructureRowComponent.prototype.ngAfterViewInit = function () {
            _super.prototype.ngAfterViewInit.call(this);
            this.updateRowClass();
            this.updateRowStyle();
        };
        StructureRowComponent.prototype.trackByFn = function () {
            return 0;
        };
        StructureRowComponent.prototype.selectRow = function () {
            event.stopPropagation();
            this.formationCommandDispatcher.toggleSelectedRow(this.entity.getId(), RowSelectToggleType.ADD, this.structureId);
        };
        StructureRowComponent.prototype.checkSelectedItem = function () {
            if (this.row) {
                var prevValue = this.selectedItem;
                this.selectedItem = this.row.isSelected(this.entity.getId());
                if (prevValue !== this.selectedItem) {
                    if (prevValue) {
                        this.cssClassModifier.unselect(this.elRef.nativeElement);
                    }
                    else {
                        this.cssClassModifier.select(this.elRef.nativeElement);
                    }
                }
            }
        };
        StructureRowComponent.prototype.getSelectorName = function () {
            return 'gui-structure-row';
        };
        StructureRowComponent.prototype.calculateRowStyle = function (entity) {
            if (!this.rowStyle) {
                return '';
            }
            if (typeof this.rowStyle.style === 'string') {
                return this.rowStyle.style || '';
            }
            if (typeof this.rowStyle.styleFunction === 'function') {
                return this.rowStyle.styleFunction(entity.getSourceItem(), entity.getPosition());
            }
            return '';
        };
        StructureRowComponent.prototype.updateRowStyle = function (prevEntity) {
            if (prevEntity) {
                var rowStylesToRemove = this.calculateRowStyle(prevEntity);
                this.removeRowStyles(rowStylesToRemove);
            }
            var rowStylesToAdd = this.calculateRowStyle(this.entity);
            this.renderRowStyles(rowStylesToAdd);
        };
        StructureRowComponent.prototype.removeRowStyles = function (rowStyle) {
            if (!rowStyle) {
                return;
            }
            var styles = rowStyle.split(';');
            for (var i = 0; i < styles.length; i += 1) {
                var separatedStyles = styles[i].split(':');
                if (separatedStyles[0] && separatedStyles[1]) {
                    this.styleModifier.getHost().removeStyleByName(separatedStyles[0].trim());
                }
            }
        };
        StructureRowComponent.prototype.renderRowStyles = function (rowStyle) {
            if (!rowStyle) {
                return;
            }
            var styles = rowStyle.split(';');
            for (var i = 0; i < styles.length; i += 1) {
                var separatedStyles = styles[i].split(':');
                if (separatedStyles[0] && separatedStyles[1]) {
                    this.styleModifier.getHost().setStyleByName(separatedStyles[0].trim(), separatedStyles[1].trim());
                }
            }
        };
        StructureRowComponent.prototype.updateRowClass = function (prevEntity) {
            if (prevEntity) {
                var toRemoveClass = this.calculateRowClass(prevEntity);
                if (toRemoveClass) {
                    this.classModifier.getHost().remove(toRemoveClass);
                }
            }
            var toAddClass = this.calculateRowClass(this.entity);
            if (toAddClass) {
                this.classModifier.getHost().add(toAddClass);
            }
        };
        StructureRowComponent.prototype.calculateRowClass = function (entity) {
            if (!this.rowClass) {
                return '';
            }
            var clazz;
            if (typeof this.rowClass.class === 'string') {
                clazz = this.rowClass.class || '';
            }
            if (typeof this.rowClass.classFunction === 'function') {
                if (entity) {
                    clazz = this.rowClass.classFunction(entity.getSourceItem(), entity.getPosition()) || '';
                }
            }
            return clazz;
        };
        return StructureRowComponent;
    }(SmartComponent));
    StructureRowComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-row]',
                    template: "<!--<div class=\"gui-structure-cell-container\" >-->\n\n<div *ngIf=\"checkboxSelection\"\n\t class=\"gui-cell gui-row-checkbox\">\n\t<gui-checkbox (changed)=\"selectRow()\" [checked]=\"selectedItem\"></gui-checkbox>\n\t<!--\t<input type=\"checkbox\" [checked]=\"selectedItem\" />-->\n</div>\n\n<div *ngFor=\"let column of columns; trackBy: trackByFn; let i = index\" [cellEditorManager]=\"cellEditing\"\n\t [cell]=\"column\"\n\t [columnIndex]=\"i\"\n\t [editMode]=\"editMode\"\n\t [entity]=\"entity\"\n\t [rowIndex]=\"index\"\n\t [searchPhrase]=\"searchPhrase\"\n\t [style.width.px]=\"column.width\"\n\t class=\"gui-cell\"\n\t gui-structure-cell>\n</div>\n\n<!--</div>-->\n\n<!--<div *ngIf=\"detailsEnabled\"-->\n<!--\t [ngStyle]=\"{'transform': 'translateY(32px)'}\"-->\n<!--\t class=\"gui-structure-row-details\">-->\n\n<!--\tDETAILS PANEL-->\n\n<!--</div>-->\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureRowComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: FormationWarehouse },
        { type: FormationCommandInvoker },
        { type: CssClassModifier }
    ]; };
    StructureRowComponent.propDecorators = {
        entity: [{ type: core.Input }],
        columns: [{ type: core.Input }],
        editMode: [{ type: core.Input }],
        cellEditing: [{ type: core.Input }],
        searchPhrase: [{ type: core.Input }],
        index: [{ type: core.Input }],
        rowStyle: [{ type: core.Input }],
        rowClass: [{ type: core.Input }],
        detailsEnabled: [{ type: core.Input }],
        checkboxSelection: [{ type: core.Input }]
    };

    var EditEventType;
    (function (EditEventType) {
        EditEventType[EditEventType["SUBMIT"] = 0] = "SUBMIT";
        EditEventType[EditEventType["BLUR"] = 1] = "BLUR";
        EditEventType[EditEventType["CANCEL"] = 2] = "CANCEL";
    })(EditEventType || (EditEventType = {}));

    var ColumnId = /** @class */ (function (_super) {
        __extends(ColumnId, _super);
        function ColumnId(id) {
            return _super.call(this, id) || this;
        }
        ColumnId.prototype.toString = function () {
            return this.getId();
        };
        return ColumnId;
    }(hermes.EntityId));

    var StructureCellComponent = /** @class */ (function (_super) {
        __extends(StructureCellComponent, _super);
        function StructureCellComponent(changeDetectorRef, elementRef, structureId, compositionId, structureCellEditStore, cellEditCloseAllService, sourceCommandService, compositionWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.elementRef = elementRef;
            _this.structureId = structureId;
            _this.compositionId = compositionId;
            _this.structureCellEditStore = structureCellEditStore;
            _this.cellEditCloseAllService = cellEditCloseAllService;
            _this.sourceCommandService = sourceCommandService;
            _this.compositionWarehouse = compositionWarehouse;
            _this.inEditMode = false;
            return _this;
        }
        StructureCellComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.compositionWarehouse.onHighlightedColumn(new ColumnId(this.cell.columnDefinitionId.toString()), this.compositionId), function (value) {
                _this.isHighlighted = value;
            });
        };
        StructureCellComponent.prototype.ngAfterViewInit = function () {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            this.subscribeWithoutRender(this.cellEditCloseAllService.onCloseAll(), function () {
                _this.exitEditMode();
            });
        };
        StructureCellComponent.prototype.isCellEditingEnabled = function () {
            return this.cellEditorManager.isEnabled(this.cell.getValue(this.entity), this.entity.getSourceItem(), this.rowIndex) &&
                this.cell.isCellEditingEnabled();
        };
        StructureCellComponent.prototype.enterEditMode = function (forceCheck) {
            var _this = this;
            if (forceCheck === void 0) { forceCheck = true; }
            if (!this.isCellEditingEnabled()) {
                return;
            }
            this.cellEditCloseAllService.closeAll();
            hermes.hermesTimer(0)
                .pipe(this.takeUntil())
                .subscribe(function () {
                _this.inEditMode = true;
                _this.valueChanges$ = new ChangedValueEmitter();
                _this.status$ = new ChangedValueEmitter();
                _this.editContext = {
                    status: _this.status$,
                    valueChanges: _this.valueChanges$,
                    value: _this.cell.getValue(_this.entity).value,
                    focus: forceCheck,
                    parent: _this.elementRef
                };
                _this.observeFieldStatus();
                _this.observeValueChanges();
                _this.publishEditEnter();
                if (!forceCheck) {
                    _this.changeDetectorRef.markForCheck();
                }
                else {
                    _this.changeDetectorRef.detectChanges();
                }
            });
        };
        StructureCellComponent.prototype.exitEditMode = function () {
            this.inEditMode = false;
            this.changeDetectorRef.detectChanges();
        };
        StructureCellComponent.prototype.submitChangesAndExit = function () {
            var itemId = this.entity.getId(), updatedValue = this.actualValue, fieldId = this.cell.columnFieldId;
            this.sourceCommandService.editItem(new StructureEditSourceItemParams(itemId, fieldId, updatedValue), this.structureId);
            this.exitEditMode();
        };
        StructureCellComponent.prototype.getSelectorName = function () {
            return 'gui-structure-cell';
        };
        StructureCellComponent.prototype.observeFieldStatus = function () {
            var _this = this;
            this.status$
                .on()
                .pipe(this.takeUntil())
                .subscribe(function (status) {
                switch (status) {
                    case EditEventType.SUBMIT:
                        _this.submitChangesAndExit();
                        _this.publishEditSubmit();
                        break;
                    case EditEventType.CANCEL:
                        _this.exitEditMode();
                        _this.publishEditCancel();
                        break;
                    default:
                        break;
                }
            });
        };
        StructureCellComponent.prototype.observeValueChanges = function () {
            var _this = this;
            this.valueChanges$
                .on()
                .pipe(this.takeUntil())
                .subscribe(function (value) {
                _this.actualValue = value;
            });
        };
        StructureCellComponent.prototype.publishEditState = function (state) {
            this.structureCellEditStore.next(state);
        };
        StructureCellComponent.prototype.publishEditEnter = function () {
            this.publishEditState(StructureCellEditState.ENTER);
        };
        StructureCellComponent.prototype.publishEditCancel = function () {
            this.publishEditState(StructureCellEditState.CANCEL);
        };
        StructureCellComponent.prototype.publishEditSubmit = function () {
            this.publishEditState(StructureCellEditState.SUBMIT);
        };
        return StructureCellComponent;
    }(SmartComponent));
    StructureCellComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-cell][entity][cell]',
                    template: "<ng-container *ngIf=\"!cell.isBooleanDataType() || (cell.isBooleanDataType() && !this.isCellEditingEnabled())\">\n\n\t<span (click)=\"enterEditMode()\"\n\t\t  *ngIf=\"!inEditMode\"\n\t\t  [ngClass]=\"{'gui-cell-view': true,'gui-align-left': cell.isAlignLeft(),'gui-align-center': cell.isAlignCenter(),'gui-align-right': cell.isAlignRight(),'gui-column-highlighted': isHighlighted}\">\n\t\t<ng-container\n\t\t\t*ngTemplateOutlet=\"cell.template;\n\t\t\t\tcontext: {\n\t\t\t\telement: cell.getValue(entity, searchPhrase),\n\t\t\t\t index: entity.getPosition(),\n\t\t\t\t value: cell.getValue(entity, searchPhrase).value,\n\t\t\t\t item: entity.getSourceItem()\n\t\t\t  }\">\n\t\t</ng-container>\n\t</span>\n\n\t<span *ngIf=\"inEditMode\"\n\t\t  class=\"gui-cell-edit-mode\">\n\t\t<ng-container\n\t\t\t*ngTemplateOutlet=\"cell.editTemplate;\n\t\t\t\tcontext: editContext\">\n\t\t</ng-container>\n\t</span>\n\n\n\t<!--\t<span *ngIf=\"inEditMode\"-->\n\t<!--\t\t  class=\"gui-cell-edit-mode\">-->\n\n\t<!--\t\t<gui-structure-cell-edit [cell]=\"cell\"-->\n\t<!--\t\t\t\t\t\t\t\t [entity]=\"entity\">-->\n\t<!--\t\t</gui-structure-cell-edit>-->\n\t<!--\t</span>-->\n\n\n</ng-container>\n\n<ng-container *ngIf=\"cell.isBooleanDataType() && this.isCellEditingEnabled()\">\n\t<div [cell]=\"cell\" [entity]=\"entity\"\n\t\t gui-structure-cell-edit-boolean>\n\t</div>\n</ng-container>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureCellComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: CompositionId },
        { type: StructureCellEditStore },
        { type: StructureCellEditCloseAllService },
        { type: SourceCommandInvoker },
        { type: CompositionWarehouse }
    ]; };
    StructureCellComponent.propDecorators = {
        entity: [{ type: core.Input }],
        cell: [{ type: core.Input }],
        editMode: [{ type: core.Input }],
        cellEditorManager: [{ type: core.Input }],
        searchPhrase: [{ type: core.Input }],
        rowIndex: [{ type: core.Input }],
        columnIndex: [{ type: core.Input }]
    };

    var structureParentComponent = new core.InjectionToken('StructureParentComponent');

    var ResizeDetector = /** @class */ (function () {
        function ResizeDetector(platformId) {
            this.platformId = platformId;
        }
        ResizeDetector.prototype.on = function (element) {
            if (common.isPlatformBrowser(this.platformId)) {
                return hermes.fromRxJsObservable((new rxjs.Observable(function (observer) {
                    var resizeObserver = new ResizeObserver(function (entries) {
                        if (entries && entries.length > 0) {
                            observer.next(entries[0].contentRect);
                        }
                    });
                    resizeObserver.observe(element);
                    return function () { return resizeObserver.disconnect(); };
                }))
                    .pipe(operators.throttleTime(25)));
            }
            return hermes.hermesEmpty();
        };
        ResizeDetector.prototype.destroy = function (element) {
        };
        return ResizeDetector;
    }());
    ResizeDetector.decorators = [
        { type: core.Injectable }
    ];
    ResizeDetector.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: core.Inject, args: [core.PLATFORM_ID,] }] }
    ]; };

    var StructureContainerComponent = /** @class */ (function (_super) {
        __extends(StructureContainerComponent, _super);
        function StructureContainerComponent(changeDetectorRef, elRef, ngZone, structureId, compositionId, structureCommandService, structureWarehouse, verticalFormationWarehouse, sourceWarehouse, compositionCommandInvoker, compositionWarehouse, formationWarehouse, resizeDetector, structureInitialValuesReadyArchive, structureParent) {
            var _this = _super.call(this, changeDetectorRef, elRef) || this;
            _this.elRef = elRef;
            _this.ngZone = ngZone;
            _this.structureId = structureId;
            _this.compositionId = compositionId;
            _this.structureCommandService = structureCommandService;
            _this.structureWarehouse = structureWarehouse;
            _this.verticalFormationWarehouse = verticalFormationWarehouse;
            _this.sourceWarehouse = sourceWarehouse;
            _this.compositionCommandInvoker = compositionCommandInvoker;
            _this.compositionWarehouse = compositionWarehouse;
            _this.formationWarehouse = formationWarehouse;
            _this.resizeDetector = resizeDetector;
            _this.structureInitialValuesReadyArchive = structureInitialValuesReadyArchive;
            _this.structureParent = structureParent;
            _this.columns = [];
            _this.source = [];
            _this.autoResizeWidthEnabled = false;
            _this.scrollObservation$ = new hermes.HermesSubject();
            _this.styleModifier = new StyleModifier(_this.elRef.nativeElement);
            return _this;
        }
        StructureContainerComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribeWithoutRender(this.verticalFormationWarehouse.onContainerHeight(this.structureId), function (containerHeight) {
                _this.setContainerHeight(containerHeight);
            });
            this.subscribe(hermes.fromRxJsObservable(hermes.toRxJsObservable(this.structureInitialValuesReadyArchive.once(this.structureId))
                .pipe(operators.flatMap(function () {
                return rxjs.combineLatest(hermes.toRxJsObservable(_this.sourceWarehouse.onEntities(_this.structureId)), hermes.toRxJsObservable(_this.compositionWarehouse.onTemplateColumns(_this.compositionId)));
            }))), function (arr) {
                _this.source = arr[0];
                _this.columns = arr[1];
            });
            this.subscribeWithoutRender(this.compositionWarehouse.onResizeWidth(this.compositionId), function (enabled) {
                _this.autoResizeWidthEnabled = enabled;
            });
        };
        StructureContainerComponent.prototype.ngAfterViewInit = function () {
            var _this = this;
            _super.prototype.ngAfterViewInit.call(this);
            // turn on when structure is ready
            if (this.structureParent) {
                this.subscribeWithoutRender(this.resizeDetector
                    .on(this.structureParent.getElementRef().nativeElement)
                    .pipe(hermes.hermesFilter(function () { return _this.autoResizeWidthEnabled; }), hermes.hermesMap(function (size) { return size.width; }), hermes.hermesDistinctUntilChanged()), function (width) {
                    _this.recalculateContainer(width);
                });
            }
            this.subscribeWithoutRender(this.compositionWarehouse.onContainerWidth(this.compositionId), function (width) {
                _this.styleModifier.getElement(_this.sourceCollectionRef.nativeElement).setWidth(width);
            });
            this.subscribeWithoutRender(this.verticalFormationWarehouse.onVerticalScrollEnabled(this.structureId), function (enabled) {
                if (enabled) {
                    _this.enableScrollObservation();
                }
                else {
                    _this.disableScrollObservation();
                }
            });
            this.subscribeWithoutRender(this.structureWarehouse
                .on(this.structureId)
                .pipe(hermes.hermesFilter(function (str) {
                return str.isVerticalScrollEnabled();
            })), function (structure) {
                var topMargin = structure.getTopMargin(), sourceHeight = structure.getSourceHeight();
                _this.setSourceHeight(topMargin, sourceHeight);
            });
            this.subscribeWithoutRender(this.verticalFormationWarehouse.onScrollBarPosition(this.structureId), function (scrollPosition) {
                _this.elRef.nativeElement.scrollTop = scrollPosition;
            });
        };
        StructureContainerComponent.prototype.ngOnDestroy = function () {
            _super.prototype.ngOnDestroy.call(this);
            this.resizeDetector.destroy(this.elRef.nativeElement);
        };
        StructureContainerComponent.prototype.getSelectorName = function () {
            return 'gui-structure-container';
        };
        StructureContainerComponent.prototype.setContainerHeight = function (height) {
            this.height = height;
            this.styleModifier.getHost().setHeight(height);
        };
        StructureContainerComponent.prototype.setSourceHeight = function (topMargin, sourceHeight) {
            this.styleModifier.getElement(this.sourceCollectionRef.nativeElement).setPaddingTop(topMargin);
            this.styleModifier.getElement(this.sourceCollectionRef.nativeElement).setHeight(sourceHeight);
        };
        StructureContainerComponent.prototype.recalculateContainer = function (width) {
            if (this.autoResizeWidthEnabled) {
                this.compositionCommandInvoker.setContainerWidth(width, this.compositionId);
            }
        };
        StructureContainerComponent.prototype.enableScrollObservation = function () {
            var _this = this;
            this.ngZone
                .runOutsideAngular(function () {
                hermes.hermesFromEvent(_this.elRef.nativeElement, 'scroll')
                    .pipe(hermes.hermesTakeUntil(_this.scrollObservation$))
                    .subscribe(function (event) {
                    var scrollTop = event.target.scrollTop;
                    _this.structureCommandService.setScrollPosition(scrollTop, _this.structureId);
                });
            });
        };
        StructureContainerComponent.prototype.disableScrollObservation = function () {
            this.scrollObservation$.next();
            this.scrollObservation$.complete();
        };
        return StructureContainerComponent;
    }(SmartComponent));
    StructureContainerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-container]',
                    template: "<div #sourceCollection\n\t class=\"gui-h-full gui-w-full gui-absolute gui-structure-container-element\">\n\n\t<div [columns]=\"columns\" [source]=\"source\"\n\t\t gui-structure-content>\n\t</div>\n\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureContainerComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: core.NgZone },
        { type: StructureId },
        { type: CompositionId },
        { type: StructureCommandInvoker },
        { type: StructureWarehouse },
        { type: VerticalFormationWarehouse },
        { type: SourceWarehouse },
        { type: CompositionCommandInvoker },
        { type: CompositionWarehouse },
        { type: FormationWarehouse },
        { type: ResizeDetector },
        { type: StructureInitialValuesReadyArchive },
        { type: undefined, decorators: [{ type: core.Optional }, { type: core.Inject, args: [structureParentComponent,] }] }
    ]; };
    StructureContainerComponent.propDecorators = {
        sourceCollectionRef: [{ type: core.ViewChild, args: ['sourceCollection', { static: false },] }]
    };

    var StructureQuickFiltersComponent = /** @class */ (function () {
        function StructureQuickFiltersComponent() {
        }
        return StructureQuickFiltersComponent;
    }());
    StructureQuickFiltersComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-quick-filters]',
                    template: "\n\n\t\tQuickFilters\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];

    var prefix = 'Structure -';
    var STRUCTURE_CSS_CLASS_NAME = new core.InjectionToken(prefix + " - css className");

    var StructureBlueprintComponent = /** @class */ (function (_super) {
        __extends(StructureBlueprintComponent, _super);
        function StructureBlueprintComponent(changeDetectorRef, elementRef, structureDefinition, structureId, structureWarehouse, structureInfoPanelArchive, pagingWarehouse, summariesWarehouse, filterWarehouse, searchWarehouse, structureHeaderTopEnabledArchive, structureHeaderBottomEnabledArchive, structureTitlePanelConfigArchive, structureFooterPanelConfigArchive, className) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureDefinition = structureDefinition;
            _this.structureId = structureId;
            _this.structureWarehouse = structureWarehouse;
            _this.structureInfoPanelArchive = structureInfoPanelArchive;
            _this.pagingWarehouse = pagingWarehouse;
            _this.summariesWarehouse = summariesWarehouse;
            _this.filterWarehouse = filterWarehouse;
            _this.searchWarehouse = searchWarehouse;
            _this.structureHeaderTopEnabledArchive = structureHeaderTopEnabledArchive;
            _this.structureHeaderBottomEnabledArchive = structureHeaderBottomEnabledArchive;
            _this.structureTitlePanelConfigArchive = structureTitlePanelConfigArchive;
            _this.structureFooterPanelConfigArchive = structureFooterPanelConfigArchive;
            _this.className = className;
            _this.searchEnabled = false;
            _this.topSummariesPanelEnabled = false;
            _this.bottomSummariesPanelEnabled = false;
            _this.quickFiltersEnabled = false;
            _this.infoPanelEnabled = false;
            _this.items = [];
            _this.localStreamCloser = new StreamCloser();
            _this.headerCssClass = "gui-" + _this.className + "-header";
            _this.contentCssClass = "gui-" + _this.className + "-content";
            return _this;
        }
        StructureBlueprintComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.structureHeaderTopEnabledArchive.on(), function (topHeaderEnabled) {
                _this.topHeaderEnabled = topHeaderEnabled;
            });
            this.subscribe(this.structureHeaderBottomEnabledArchive.on(), function (bottomHeaderEnabled) {
                _this.bottomHeaderEnabled = bottomHeaderEnabled;
            });
            this.subscribe(this.structureWarehouse.on(this.structureId), function (structure) {
                _this.structure = structure;
                _this.items = structure.getEntities();
            });
            this.subscribe(this.pagingWarehouse.onPaging(this.structureId), function (paging) {
                _this.pagingReadModel = paging;
            });
            this.subscribe(this.pagingWarehouse.onPaging(this.structureId), function (paging) {
                _this.pagingReadModel = paging;
            });
            this.subscribe(this.searchWarehouse.onSearchEnabled(this.structureId), function (enabled) {
                _this.searchEnabled = enabled;
            });
            this.subscribe(this.filterWarehouse.onQuickFiltersEnabled(this.structureId), function (enabled) {
                _this.quickFiltersEnabled = enabled;
            });
            this.subscribe(this.summariesWarehouse.onBottomEnabled(this.structureId), function (enabled) {
                _this.bottomSummariesPanelEnabled = enabled;
            });
            this.subscribe(this.summariesWarehouse.onTopEnabled(this.structureId), function (enabled) {
                _this.topSummariesPanelEnabled = enabled;
            });
            this.subscribe(this.structureInfoPanelArchive.on(), function (infoPanel) {
                _this.infoPanelEnabled = infoPanel.isEnabled();
            });
            this.subscribe(this.structureTitlePanelConfigArchive.on(), function (titlePanel) {
                _this.titlePanelEnabled = titlePanel.enabled;
            });
            this.subscribe(this.structureFooterPanelConfigArchive.on(), function (footerPanel) {
                _this.footerPanelEnabled = footerPanel.enabled;
            });
        };
        StructureBlueprintComponent.prototype.ngOnDestroy = function () {
            this.localStreamCloser.unsubscribe();
            _super.prototype.ngOnDestroy.call(this);
        };
        StructureBlueprintComponent.prototype.getHeaderTopClasses = function () {
            return this.headerCssClass + ' gui-header-top';
        };
        StructureBlueprintComponent.prototype.getHeaderBottomClasses = function () {
            return this.headerCssClass + ' gui-header-bottom';
        };
        StructureBlueprintComponent.prototype.isColumnHeaderTopEnabled = function () {
            return this.structureDefinition.isHeaderEnabled() && this.topHeaderEnabled;
        };
        StructureBlueprintComponent.prototype.isColumnHeaderBottomEnabled = function () {
            return this.structureDefinition.isHeaderEnabled() && this.bottomHeaderEnabled;
        };
        StructureBlueprintComponent.prototype.isPagingTopEnabled = function () {
            return this.structureDefinition.getTopPaging().isEnabled() && this.pagingReadModel && this.pagingReadModel.isPagerTop();
        };
        StructureBlueprintComponent.prototype.isPagingBottomEnabled = function () {
            return this.structureDefinition.getBottomPaging().isEnabled() && this.pagingReadModel && this.pagingReadModel.isPagerBottom();
        };
        StructureBlueprintComponent.prototype.isSourceEmpty = function () {
            return this.structure && this.structure.getEntities().length === 0;
        };
        StructureBlueprintComponent.prototype.getSelectorName = function () {
            return 'gui-structure-blueprint';
        };
        return StructureBlueprintComponent;
    }(SmartComponent));
    StructureBlueprintComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-blueprint]',
                    template: "<!---------- TOP ---------->\n<div *ngIf=\"titlePanelEnabled\" gui-structure-title-panel></div>\n\n<div *ngIf=\"searchEnabled\" gui-structure-top-panel></div>\n\n<!--<div gui-structure-quick-filters *ngIf=\"quickFiltersEnabled\">-->\n<!--</div>-->\n\n<div *ngIf=\"isPagingTopEnabled()\" [position]=\"0\"\n\t gui-paging>\n</div>\n\n<div [enabled]=\"topSummariesPanelEnabled\" class=\"gui-structure-summaries-panel-top\"\n\t gui-structure-summaries-panel>\n</div>\n\n<div *ngIf=\"isColumnHeaderTopEnabled()\" [ngClass]=\"getHeaderTopClasses()\"\n\t gui-structure-header>\n</div>\n\n\n<!---------- MAIN ---------->\n<div [ngClass]=\"contentCssClass\" gui-structure-container>\n</div>\n\n<div [items]=\"items\" gui-empty-source>\n</div>\n\n\n<!---------- BOTTOM ---------->\n<div *ngIf=\"isColumnHeaderBottomEnabled()\" [ngClass]=\"getHeaderBottomClasses()\"\n\t gui-structure-header>\n</div>\n\n<div [enabled]=\"bottomSummariesPanelEnabled\" class=\"gui-structure-summaries-panel-bottom\"\n\t gui-structure-summaries-panel>\n</div>\n\n<div *ngIf=\"footerPanelEnabled\" gui-structure-footer-panel></div>\n\n<div *ngIf=\"isPagingBottomEnabled()\" [position]=\"1\"\n\t gui-paging>\n</div>\n\n<div *ngIf=\"infoPanelEnabled\" gui-structure-info-panel></div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureBlueprintComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureDefinition },
        { type: StructureId },
        { type: StructureWarehouse },
        { type: StructureInfoPanelArchive },
        { type: PagingWarehouse },
        { type: SummariesWarehouse },
        { type: FilterWarehouse },
        { type: SearchWarehouse },
        { type: StructureHeaderTopEnabledArchive },
        { type: StructureHeaderBottomEnabledArchive },
        { type: StructureTitlePanelConfigArchive },
        { type: StructureFooterPanelConfigArchive },
        { type: String, decorators: [{ type: core.Inject, args: [STRUCTURE_CSS_CLASS_NAME,] }] }
    ]; };

    var InMemoryStructureAggregateStore = /** @class */ (function (_super) {
        __extends(InMemoryStructureAggregateStore, _super);
        function InMemoryStructureAggregateStore(inMemoryStructureStore, aggregateStoreRegister) {
            return _super.call(this, inMemoryStructureStore, aggregateStoreRegister) || this;
        }
        return InMemoryStructureAggregateStore;
    }(hermes.InMemoryAggregateStore));
    InMemoryStructureAggregateStore.decorators = [
        { type: core.Injectable }
    ];
    InMemoryStructureAggregateStore.ctorParameters = function () { return [
        { type: InMemoryStructureStore },
        { type: hermes.AggregateStoreRegister }
    ]; };

    var InMemoryStructureAggregateRepository = /** @class */ (function (_super) {
        __extends(InMemoryStructureAggregateRepository, _super);
        function InMemoryStructureAggregateRepository(inMemoryStructureAggregateStore) {
            var _this = _super.call(this) || this;
            _this.inMemoryStructureAggregateStore = inMemoryStructureAggregateStore;
            return _this;
        }
        InMemoryStructureAggregateRepository.prototype.findById = function (aggregateId) {
            return this.inMemoryStructureAggregateStore.findById(aggregateId);
        };
        InMemoryStructureAggregateRepository.prototype.save = function (aggregate) {
            this.inMemoryStructureAggregateStore.save(aggregate);
        };
        return InMemoryStructureAggregateRepository;
    }(StructureAggregateRepository));
    InMemoryStructureAggregateRepository.decorators = [
        { type: core.Injectable }
    ];
    InMemoryStructureAggregateRepository.ctorParameters = function () { return [
        { type: InMemoryStructureAggregateStore }
    ]; };

    var SelectionEnabledSetEvent = /** @class */ (function (_super) {
        __extends(SelectionEnabledSetEvent, _super);
        function SelectionEnabledSetEvent(aggregateId, enabled) {
            var _this = _super.call(this, aggregateId, enabled, 'SelectionEnabledSetEvent') || this;
            _this.enabled = enabled;
            return _this;
        }
        SelectionEnabledSetEvent.prototype.isEnabled = function () {
            return this.enabled;
        };
        return SelectionEnabledSetEvent;
    }(StructureDomainEvent));

    var FilterAddedEvent = /** @class */ (function (_super) {
        __extends(FilterAddedEvent, _super);
        function FilterAddedEvent(aggregateId, fieldId, filterTypeId, value) {
            var _this = _super.call(this, aggregateId, { fieldId: fieldId, filterTypeId: filterTypeId, value: value }, 'FilterAddedEvent') || this;
            _this.fieldId = fieldId;
            _this.filterTypeId = filterTypeId;
            _this.value = value;
            return _this;
        }
        return FilterAddedEvent;
    }(StructureDomainEvent));

    var InMemoryStructureRepository = /** @class */ (function (_super) {
        __extends(InMemoryStructureRepository, _super);
        function InMemoryStructureRepository(domainEventBus, inMemoryStructureReadStore) {
            var _this = _super.call(this, domainEventBus) || this;
            _this.inMemoryStructureReadStore = inMemoryStructureReadStore;
            _this.structureIdToStructure = new Map();
            _this.hermesStructure$ = new hermes.HermesReplaySubject(1);
            return _this;
        }
        InMemoryStructureRepository.prototype.getStructure = function (structureId) {
            return this.structureIdToStructure.get(structureId.getId());
        };
        InMemoryStructureRepository.prototype.on = function (structureId) {
            return this.hermesStructure$
                .toObservable()
                .pipe(hermes.hermesFilter(function (structureIdToStructure) {
                var key = structureId.getId();
                return structureIdToStructure.has(key);
            }), hermes.hermesMap(function (structureIdToStructure) {
                return structureIdToStructure.get(structureId.getId());
            }));
        };
        InMemoryStructureRepository.prototype.forEvents = function () {
            return [
                StructureCreatedEvent,
                SetSourceLoadingEvent,
                PagingSetEvent,
                PrevPageEvent,
                NextPageEvent,
                PagesizeChangedEvent,
                SelectionEnabledSetEvent,
                VerticalScrollEnabledSetEvent,
                ScrollPositionSetEvent,
                SortToggledEvent,
                FilterToggledEvent,
                SearchPhraseSetDomainEvent,
                SortOrderSetEvent,
                OriginSetEvent,
                RowHeightSetEvent,
                StructureHeightSetEvent,
                RowHeightSetBasedOnThemeEvent,
                FilterAddedEvent,
                ActiveFiltersSetEvent,
                UniqueFilterSelectedEvent,
                AllUniqueFilterSelectedEvent,
                UniqueFilterUnselectedEvent,
                AllUniqueFilterUnselectedEvent
            ];
        };
        InMemoryStructureRepository.prototype.subs = function (event) {
            var _this = this;
            var aggregateId = event.getAggregateId();
            var optStructure = this.inMemoryStructureReadStore.getById(aggregateId);
            optStructure.ifPresent(function (structureReadModelRoot) {
                var key = structureReadModelRoot.getId().toString();
                _this.structureIdToStructure.set(key, structureReadModelRoot);
                _this.hermesStructure$.next(_this.structureIdToStructure);
            });
        };
        return InMemoryStructureRepository;
    }(StructureReadModelRepository));
    InMemoryStructureRepository.decorators = [
        { type: core.Injectable }
    ];
    InMemoryStructureRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus },
        { type: InMemoryStructureReadStore }
    ]; };

    var inMemoryStructureCommandProviders = [
        InMemoryStructureAggregateStore,
        {
            provide: StructureAggregateRepository,
            useClass: InMemoryStructureAggregateRepository
        }
    ];
    var inMemoryStructureReadProviders = [
        InMemoryStructureReadStore,
        {
            provide: StructureReadModelRepository,
            useClass: InMemoryStructureRepository
        }
    ];
    var inMemoryStructureProviders = [
        InMemoryStructureStore
    ];

    var VerticalRange = /** @class */ (function () {
        function VerticalRange(start, end, margin) {
            this.start = start;
            this.end = end;
            this.margin = margin;
        }
        VerticalRange.prototype.getStart = function () {
            return this.start;
        };
        VerticalRange.prototype.getEnd = function () {
            return this.end;
        };
        VerticalRange.prototype.getMargin = function () {
            return this.margin;
        };
        return VerticalRange;
    }());

    var VerticalFormationContainerHeight = /** @class */ (function () {
        function VerticalFormationContainerHeight() {
            this.containerHeight = hermes.Optional.empty();
        }
        VerticalFormationContainerHeight.prototype.isContainerHeightProperForVirtualScroll = function () {
            if (this.containerHeight.isPresent()) {
                return this.containerHeight.getValueOrNullOrThrowError() > 0;
            }
            else {
                return false;
            }
        };
        VerticalFormationContainerHeight.prototype.getVisibleContainerHeight = function () {
            return this.getHeight();
        };
        VerticalFormationContainerHeight.prototype.getHeight = function () {
            if (this.containerHeight.isPresent()) {
                return this.getContainerHeight();
            }
            return this.sourceHeight;
        };
        VerticalFormationContainerHeight.prototype.getSourceHeight = function () {
            return this.sourceHeight;
        };
        VerticalFormationContainerHeight.prototype.setContainerHeight = function (height) {
            if (height >= 0) {
                this.containerHeight = hermes.Optional.of(height);
            }
        };
        VerticalFormationContainerHeight.prototype.setSourceSize = function (height) {
            this.sourceHeight = height;
        };
        VerticalFormationContainerHeight.prototype.getContainerHeight = function () {
            if (this.containerHeight.getValueOrNullOrThrowError() > this.sourceHeight) {
                return this.sourceHeight;
            }
            else {
                return this.containerHeight.getValueOrNullOrThrowError();
            }
        };
        return VerticalFormationContainerHeight;
    }());
    VerticalFormationContainerHeight = __decorate([
        hermes.DomainObject
    ], VerticalFormationContainerHeight);

    var ScrollBarPositionSetEvent = /** @class */ (function (_super) {
        __extends(ScrollBarPositionSetEvent, _super);
        function ScrollBarPositionSetEvent(aggregateId, position) {
            var _this = _super.call(this, aggregateId, position, 'ScrollBarPositionSetEvent') || this;
            _this.position = position;
            return _this;
        }
        ScrollBarPositionSetEvent.prototype.getPosition = function () {
            return this.position;
        };
        return ScrollBarPositionSetEvent;
    }(StructureDomainEvent));

    var ScrollBarPositionSetAggregateEvent = /** @class */ (function (_super) {
        __extends(ScrollBarPositionSetAggregateEvent, _super);
        function ScrollBarPositionSetAggregateEvent(schemaId, position) {
            var _this = _super.call(this, schemaId, 'ScrollBarPositionSetAggregateEvent') || this;
            _this.position = position;
            return _this;
        }
        ScrollBarPositionSetAggregateEvent.prototype.toDomainEvent = function () {
            return new ScrollBarPositionSetEvent(this.getAggregateId(), this.position);
        };
        return ScrollBarPositionSetAggregateEvent;
    }(StructureAggregateEvent));

    var VerticalFormation_1;
    var VerticalFormation = VerticalFormation_1 = /** @class */ (function () {
        function VerticalFormation(structureId, enabled, viewportHeight, sourceSize, scrollPosition, rowHeight, hiddenItemsTop, hiddenItemsBottom) {
            if (enabled === void 0) { enabled = false; }
            if (viewportHeight === void 0) { viewportHeight = 0; }
            if (sourceSize === void 0) { sourceSize = 0; }
            if (scrollPosition === void 0) { scrollPosition = 0; }
            this.structureId = structureId;
            this.enabled = enabled;
            this.rowHeight = VerticalFormation_1.ROW_HEIGHT;
            this.hiddenItemsTop = VerticalFormation_1.HIDDEN_ITEMS_TOP;
            this.hiddenItemsBottom = VerticalFormation_1.HIDDEN_ITEMS_BOTTOM;
            this.container = new VerticalFormationContainerHeight();
            this.sourceSize = sourceSize;
            this.container.setSourceSize(this.sourceSize * this.rowHeight);
            this.container.setContainerHeight(viewportHeight);
            this.scrollPosition = scrollPosition;
            if (Number.isInteger(rowHeight)) {
                this.rowHeight = rowHeight;
            }
            if (Number.isInteger(hiddenItemsTop)) {
                this.hiddenItemsTop = hiddenItemsTop;
            }
            if (Number.isInteger(hiddenItemsBottom)) {
                this.hiddenItemsBottom = hiddenItemsBottom;
            }
            this.calculateRange();
        }
        VerticalFormation.prototype.isEnabled = function () {
            return this.enabled &&
                this.container.getHeight() > 0 &&
                this.sourceSize > 0;
        };
        VerticalFormation.prototype.getViewPortHeight = function () {
            return this.container.getVisibleContainerHeight();
        };
        VerticalFormation.prototype.getSourceHeight = function () {
            return this.container.getSourceHeight();
        };
        VerticalFormation.prototype.getRowHeight = function () {
            return this.rowHeight;
        };
        VerticalFormation.prototype.getRange = function () {
            return this.range;
        };
        VerticalFormation.prototype.getTopMargin = function () {
            return this.range.getStart() * this.rowHeight;
        };
        VerticalFormation.prototype.calculateRange = function () {
            if (this.calcFullHeight() <= this.container.getHeight()) {
                this.range = new VerticalRange(0, this.sourceSize, 0);
                return;
            }
            var itemsInViewport = Math.ceil(this.container.getHeight() / this.rowHeight), viewportPositionIndex = Math.floor(this.scrollPosition / this.rowHeight);
            var end = (viewportPositionIndex + itemsInViewport + this.hiddenItemsBottom);
            var topMargin = viewportPositionIndex;
            if (topMargin + itemsInViewport >= this.sourceSize) {
                topMargin = this.sourceSize - itemsInViewport;
            }
            var start = Math.max(viewportPositionIndex - this.hiddenItemsTop, 0);
            if (end > this.sourceSize) {
                end = this.sourceSize;
                start = end - itemsInViewport;
            }
            // end - itemsInViewport;
            this.range = new VerticalRange(start, end, topMargin);
            return {
                start: start,
                end: end,
                topMargin: topMargin
            };
        };
        VerticalFormation.prototype.setEnabled = function (enabled) {
            this.enabled = enabled;
            // TODO dispatch aggregate event
            if (this.enabled && !this.container.isContainerHeightProperForVirtualScroll()) {
                this.logger.warn('Height needs to be specified in order for virtual scroll to work.');
            }
            this.calculateRange();
        };
        VerticalFormation.prototype.setSourceSize = function (sourceSize) {
            if (sourceSize === void 0) { sourceSize = 0; }
            this.sourceSize = sourceSize;
            this.container.setSourceSize(this.sourceSize * this.rowHeight);
            this.calculateRange();
        };
        VerticalFormation.prototype.setTopHiddenItemsCount = function (count) {
            this.hiddenItemsTop = count;
            this.calculateRange();
        };
        VerticalFormation.prototype.setBottomHiddenItemsCount = function (count) {
            this.hiddenItemsBottom = count;
            this.calculateRange();
        };
        VerticalFormation.prototype.setScrollPosition = function (scrollPosition) {
            this.scrollPosition = scrollPosition;
            this.calculateRange();
        };
        VerticalFormation.prototype.scrollToIndex = function (index) {
            if (index >= this.sourceSize) {
                index = this.sourceSize;
            }
            if (index < -1) {
                index = 0;
            }
            var position = index * this.rowHeight;
            return new ScrollBarPositionSetAggregateEvent(this.structureId, position);
        };
        VerticalFormation.prototype.setViewportHeight = function (height) {
            this.container.setContainerHeight(height);
            this.calculateRange();
        };
        VerticalFormation.prototype.setRowHeight = function (rowHeight) {
            this.rowHeight = rowHeight;
            this.container.setSourceSize(this.sourceSize * this.rowHeight);
            this.calculateRange();
        };
        VerticalFormation.prototype.setLogger = function (logger) {
            this.logger = logger;
        };
        // TODO REMOVE
        VerticalFormation.prototype.calcFullHeight = function () {
            return this.sourceSize * this.rowHeight;
        };
        return VerticalFormation;
    }());
    VerticalFormation.ROW_HEIGHT = 42;
    VerticalFormation.HIDDEN_ITEMS_TOP = 5;
    VerticalFormation.HIDDEN_ITEMS_BOTTOM = 2;
    VerticalFormation = VerticalFormation_1 = __decorate([
        hermes.DomainObject
    ], VerticalFormation);

    var VerticalFormationFactory = /** @class */ (function () {
        function VerticalFormationFactory(logger) {
            this.logger = logger;
        }
        VerticalFormationFactory.prototype.create = function (structureId, enabled, viewportHeight, sourceSize, scrollPosition, rowHeight, hiddenItemsTop, hiddenItemsBottom) {
            if (enabled === void 0) { enabled = false; }
            if (viewportHeight === void 0) { viewportHeight = -1; }
            if (sourceSize === void 0) { sourceSize = 0; }
            if (scrollPosition === void 0) { scrollPosition = 0; }
            var vf = new VerticalFormation(structureId, enabled, viewportHeight, sourceSize, scrollPosition, rowHeight, hiddenItemsTop, hiddenItemsBottom);
            vf.setLogger(this.logger);
            return vf;
        };
        return VerticalFormationFactory;
    }());
    VerticalFormationFactory.decorators = [
        { type: core.Injectable }
    ];
    VerticalFormationFactory.ctorParameters = function () { return [
        { type: Logger }
    ]; };

    var StructurePreparedEntitiesSetAggregateEvent = /** @class */ (function (_super) {
        __extends(StructurePreparedEntitiesSetAggregateEvent, _super);
        function StructurePreparedEntitiesSetAggregateEvent(aggregateId, preparedItems) {
            var _this = _super.call(this, aggregateId, 'StructurePreparedEntitiesSetAggregateEvent') || this;
            _this.preparedItems = preparedItems;
            return _this;
        }
        StructurePreparedEntitiesSetAggregateEvent.prototype.toDomainEvent = function () {
            return new StructurePreparedEntitiesSetEvent(this.getAggregateId(), this.preparedItems);
        };
        StructurePreparedEntitiesSetAggregateEvent.prototype.getPreparedItems = function () {
            return this.preparedItems;
        };
        return StructurePreparedEntitiesSetAggregateEvent;
    }(StructureAggregateEvent));

    var FieldsInitedAggregateEvent = /** @class */ (function (_super) {
        __extends(FieldsInitedAggregateEvent, _super);
        function FieldsInitedAggregateEvent(structureId, fieldConfigs, // TODO merge
        fields) {
            var _this = _super.call(this, structureId, 'FieldsInitedAggregateEvent') || this;
            _this.fieldConfigs = fieldConfigs;
            _this.fields = fields;
            return _this;
        }
        FieldsInitedAggregateEvent.prototype.toDomainEvent = function () {
            return new FieldsInitedEvent(this.getAggregateId(), this.fieldConfigs, this.fields);
        };
        FieldsInitedAggregateEvent.prototype.getFieldConfigs = function () {
            return this.fieldConfigs;
        };
        FieldsInitedAggregateEvent.prototype.getFields = function () {
            return this.fields;
        };
        return FieldsInitedAggregateEvent;
    }(StructureAggregateEvent));

    var StructureCreatedAggregateEvent = /** @class */ (function (_super) {
        __extends(StructureCreatedAggregateEvent, _super);
        function StructureCreatedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'StructureCreatedAggregateEvent') || this;
        }
        StructureCreatedAggregateEvent.prototype.toDomainEvent = function () {
            return new StructureCreatedEvent(this.getAggregateId());
        };
        return StructureCreatedAggregateEvent;
    }(StructureAggregateEvent));

    /**
     * Override decorator
     *
     * class Car {
     *     drive() {}
     * }
     *
     * class FastCar {
     *     @Override
     *     drive() {}}
     * }
     */
    function Override(container, key) {
        var basePrototype = Object.getPrototypeOf(container);
        if (typeof basePrototype[key] !== 'function') {
            throw new Error('Method "' + key + '" of class "' + container.constructor.name + '" doesn\'t override any method of base class.');
        }
    }

    var FilterTypesInitedAggregateEvent = /** @class */ (function (_super) {
        __extends(FilterTypesInitedAggregateEvent, _super);
        function FilterTypesInitedAggregateEvent(structureId, filterTypes) {
            var _this = _super.call(this, structureId, 'FilterTypesInitedAggregateEvent') || this;
            _this.filterTypes = filterTypes;
            return _this;
        }
        FilterTypesInitedAggregateEvent.prototype.toDomainEvent = function () {
            return new FilterTypesInitedEvent(this.getAggregateId(), this.filterTypes);
        };
        FilterTypesInitedAggregateEvent.prototype.getFilterTypes = function () {
            return this.filterTypes;
        };
        return FilterTypesInitedAggregateEvent;
    }(StructureAggregateEvent));

    var AllFiltersRemovedAggregateEvent = /** @class */ (function (_super) {
        __extends(AllFiltersRemovedAggregateEvent, _super);
        function AllFiltersRemovedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'FilterAddedEvent') || this;
        }
        AllFiltersRemovedAggregateEvent.prototype.toDomainEvent = function () {
            return new ActiveFiltersSetEvent(this.getAggregateId(), []);
        };
        return AllFiltersRemovedAggregateEvent;
    }(StructureAggregateEvent));

    var FilterAddedAggregateEvent = /** @class */ (function (_super) {
        __extends(FilterAddedAggregateEvent, _super);
        function FilterAddedAggregateEvent(aggregateId, activeFilters) {
            var _this = _super.call(this, aggregateId, 'FilterAddedEvent') || this;
            _this.activeFilters = activeFilters;
            return _this;
        }
        FilterAddedAggregateEvent.prototype.toDomainEvent = function () {
            return new ActiveFiltersSetEvent(this.getAggregateId(), this.activeFilters);
        };
        return FilterAddedAggregateEvent;
    }(StructureAggregateEvent));

    var FilterRemovedAggregateEvent = /** @class */ (function (_super) {
        __extends(FilterRemovedAggregateEvent, _super);
        function FilterRemovedAggregateEvent(aggregateId, activeFilters) {
            var _this = _super.call(this, aggregateId, 'FilterRemovedAggregateEvent') || this;
            _this.activeFilters = activeFilters;
            return _this;
        }
        FilterRemovedAggregateEvent.prototype.toDomainEvent = function () {
            return new ActiveFiltersSetEvent(this.getAggregateId(), this.activeFilters);
        };
        return FilterRemovedAggregateEvent;
    }(StructureAggregateEvent));

    var UniqueFilterCalculatedAggregateEvent = /** @class */ (function (_super) {
        __extends(UniqueFilterCalculatedAggregateEvent, _super);
        function UniqueFilterCalculatedAggregateEvent(aggregateId, map) {
            var _this = _super.call(this, aggregateId, 'UniqueFilterCalculatedAggregateEvent') || this;
            _this.map = map;
            return _this;
        }
        UniqueFilterCalculatedAggregateEvent.prototype.toDomainEvent = function () {
            return new UniqueFilterCalculatedEvent(this.getAggregateId(), this.map);
        };
        return UniqueFilterCalculatedAggregateEvent;
    }(StructureAggregateEvent));

    var UniqueFilterSelectedAggregateEvent = /** @class */ (function (_super) {
        __extends(UniqueFilterSelectedAggregateEvent, _super);
        function UniqueFilterSelectedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'UniqueFilterSelectedAggregateEvent') || this;
        }
        UniqueFilterSelectedAggregateEvent.prototype.toDomainEvent = function () {
            return new UniqueFilterSelectedEvent(this.getAggregateId());
        };
        return UniqueFilterSelectedAggregateEvent;
    }(StructureAggregateEvent));

    var UniqueFilterUnselectedAggregateEvent = /** @class */ (function (_super) {
        __extends(UniqueFilterUnselectedAggregateEvent, _super);
        function UniqueFilterUnselectedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'UniqueFilterUnselectedAggregateEvent') || this;
        }
        UniqueFilterUnselectedAggregateEvent.prototype.toDomainEvent = function () {
            return new UniqueFilterUnselectedEvent(this.getAggregateId());
        };
        return UniqueFilterUnselectedAggregateEvent;
    }(StructureAggregateEvent));

    var AllUniqueFilterUnselectedAggregateEvent = /** @class */ (function (_super) {
        __extends(AllUniqueFilterUnselectedAggregateEvent, _super);
        function AllUniqueFilterUnselectedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'AllUniqueFilterUnselectedAggregateEvent') || this;
        }
        AllUniqueFilterUnselectedAggregateEvent.prototype.toDomainEvent = function () {
            return new AllUniqueFilterUnselectedEvent(this.getAggregateId());
        };
        return AllUniqueFilterUnselectedAggregateEvent;
    }(StructureAggregateEvent));

    var AllUniqueFilterSelectedAggregateEvent = /** @class */ (function (_super) {
        __extends(AllUniqueFilterSelectedAggregateEvent, _super);
        function AllUniqueFilterSelectedAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'AllUniqueFilterSelectedAggregateEvent') || this;
        }
        AllUniqueFilterSelectedAggregateEvent.prototype.toDomainEvent = function () {
            return new AllUniqueFilterSelectedEvent(this.getAggregateId());
        };
        return AllUniqueFilterSelectedAggregateEvent;
    }(StructureAggregateEvent));

    var SelectedRowChangedAggregateEvent = /** @class */ (function (_super) {
        __extends(SelectedRowChangedAggregateEvent, _super);
        function SelectedRowChangedAggregateEvent(structureId, selectedRows, allSelected, allUnselected) {
            var _this = _super.call(this, structureId, 'SelectedRowChangedAggregateEvent') || this;
            _this.selectedRows = selectedRows;
            _this.allSelected = allSelected;
            _this.allUnselected = allUnselected;
            return _this;
        }
        SelectedRowChangedAggregateEvent.prototype.toDomainEvent = function () {
            return new SelectedRowChangedEvent(this.getAggregateId(), this.selectedRows, this.allSelected, this.allUnselected);
        };
        return SelectedRowChangedAggregateEvent;
    }(StructureAggregateEvent));

    var SelectionEnabledSetAggregateEvent = /** @class */ (function (_super) {
        __extends(SelectionEnabledSetAggregateEvent, _super);
        function SelectionEnabledSetAggregateEvent(structureId, enabled) {
            var _this = _super.call(this, structureId, 'SelectionEnabledSetAggregateEvent') || this;
            _this.enabled = enabled;
            return _this;
        }
        SelectionEnabledSetAggregateEvent.prototype.toDomainEvent = function () {
            return new SelectionEnabledSetEvent(this.getAggregateId(), this.enabled);
        };
        return SelectionEnabledSetAggregateEvent;
    }(StructureAggregateEvent));

    var SelectionModeSetAggregateEvent = /** @class */ (function (_super) {
        __extends(SelectionModeSetAggregateEvent, _super);
        function SelectionModeSetAggregateEvent(structureId, mode) {
            var _this = _super.call(this, structureId, 'SelectionModeSetAggregateEvent') || this;
            _this.mode = mode;
            return _this;
        }
        SelectionModeSetAggregateEvent.prototype.toDomainEvent = function () {
            return new SelectionModeSetEvent(this.getAggregateId(), this.mode);
        };
        return SelectionModeSetAggregateEvent;
    }(StructureAggregateEvent));

    var StructureAggregate = /** @class */ (function (_super) {
        __extends(StructureAggregate, _super);
        function StructureAggregate(structureId, pagingAggregate, sourceManager, verticalFormation, summariesManager, sorterCollection, filterManager, uniqueFilterManager, searchManager, fieldCollection) {
            var _this = _super.call(this, structureId, structureKey) || this;
            _this.pagingManager = pagingAggregate;
            _this.sourceManager = sourceManager;
            _this.verticalFormation = verticalFormation;
            _this.summariesManager = summariesManager;
            _this.sorterCollection = sorterCollection;
            _this.filterManager = filterManager;
            _this.uniqueFilterManager = uniqueFilterManager;
            _this.searchManager = searchManager;
            _this.fieldCollection = fieldCollection;
            return _this;
        }
        StructureAggregate.prototype.createEvent = function () {
            return StructureCreatedAggregateEvent;
        };
        StructureAggregate.prototype.clearEvents = function () {
            _super.prototype.clearEvents.call(this);
            this.pagingManager.clearEvents();
        };
        StructureAggregate.prototype.init = function () {
            this.initTheme();
        };
        StructureAggregate.prototype.setVerticalFormationEnabled = function (enabled) {
            this.verticalFormation.setEnabled(enabled);
            this.calculateSource();
        };
        StructureAggregate.prototype.getVerticalFormation = function () {
            return this.verticalFormation;
        };
        StructureAggregate.prototype.setSummariesEnabled = function (enabled) {
            this.summariesManager.setEnabled(enabled);
            this.calculateSource();
            return this.getEvents();
        };
        StructureAggregate.prototype.setOrigin = function (items) {
            this.addEvent(this.sourceManager.setOrigin(items, this.getId()));
            this.calculateUniqueValues();
            this.calculateSource();
            return this.getEvents();
        };
        StructureAggregate.prototype.deleteAllSelected = function () {
        };
        StructureAggregate.prototype.deleteItem = function (payload) {
            this.addEvent(this.sourceManager.deleteOriginItem(payload, this.getId()));
            this.generateSelectedRowChangedEvent();
            this.calculateSource();
        };
        StructureAggregate.prototype.editItem = function (editParams) {
            var _this = this;
            var itemId = editParams.getItemId(), fieldId = editParams.getColumnFieldId(), field = this.fieldCollection.getField(fieldId), // as FieldId
            value = editParams.getValue();
            var editItemEvents = this.sourceManager.editOriginItem(itemId, value, field, this.getId());
            editItemEvents.forEach(function (e) { return _this.addEvent(e); });
            // TODO
            // this.calculateUniqueValues();
            this.calculateSource();
            return this.getEvents();
        };
        StructureAggregate.prototype.setHeight = function (height) {
            this.verticalFormation.setViewportHeight(height);
            this.calculateSourceBasedOnVirtualScroll();
        };
        StructureAggregate.prototype.setTheme = function (theme) {
            // #1707 Move to SchemeAggregate
            if (theme === SchemaTheme.MATERIAL) {
                this.getVerticalFormation().setRowHeight(52);
            }
            if (theme === SchemaTheme.GENERIC) {
                this.getVerticalFormation().setRowHeight(42);
            }
            if (theme === SchemaTheme.FABRIC) {
                this.getVerticalFormation().setRowHeight(36);
            }
            if (theme === SchemaTheme.LIGHT) {
                this.getVerticalFormation().setRowHeight(56);
            }
            if (theme === SchemaTheme.DARK) {
                this.getVerticalFormation().setRowHeight(38);
            }
        };
        StructureAggregate.prototype.setScrollPosition = function (position) {
            this.verticalFormation.setScrollPosition(position);
            this.calculateSourceBasedOnVirtualScroll();
        };
        StructureAggregate.prototype.scrollToIndex = function (index) {
            this.addEvent(this.verticalFormation.scrollToIndex(index));
        };
        StructureAggregate.prototype.setSelection = function (enabled) {
            this.sourceManager.getFormation().setSelection(enabled);
            this.addEvent(new SelectionEnabledSetAggregateEvent(this.getId(), enabled));
        };
        StructureAggregate.prototype.setSelectionMode = function (mode) {
            this.sourceManager.getFormation().setMode(mode);
            this.addEvent(new SelectionModeSetAggregateEvent(this.getId(), mode));
        };
        StructureAggregate.prototype.toggleRow = function (selectedRow, type) {
            this.sourceManager.toggleRow(selectedRow, type);
            this.generateSelectedRowChangedEvent();
        };
        StructureAggregate.prototype.selectAll = function () {
            this.sourceManager.selectAll();
            this.generateSelectedRowChangedEvent();
        };
        StructureAggregate.prototype.unselectAll = function () {
            this.sourceManager.unselectAll();
            this.generateSelectedRowChangedEvent();
        };
        StructureAggregate.prototype.getFormation = function () {
            return this.sourceManager.getFormation();
        };
        StructureAggregate.prototype.getPaging = function () {
            return this.pagingManager;
        };
        StructureAggregate.prototype.changePaging = function (config) {
            this.pagingManager.change(config);
            this.calculateSource();
        };
        StructureAggregate.prototype.setPaging = function (paging) {
            this.pagingManager = paging;
            this.calculateSource();
        };
        StructureAggregate.prototype.nextPage = function () {
            this.pagingManager.nextPage();
            this.calculateSource();
        };
        StructureAggregate.prototype.prevPage = function () {
            this.pagingManager.prevPage();
            this.calculateSource();
        };
        StructureAggregate.prototype.changePageSize = function (pageSize) {
            var _this = this;
            var pagingEvents = this.pagingManager.changePageSize(pageSize);
            // TODO
            pagingEvents.forEach(function (event) {
                _this.addEvent(event);
            });
            this.calculateSource();
            return this.getEvents();
        };
        StructureAggregate.prototype.getEntities = function () {
            return this.sourceManager.getSlicedEntities();
        };
        StructureAggregate.prototype.getSource = function () {
            return this.sourceManager;
        };
        StructureAggregate.prototype.createFields = function (fieldConfigs) {
            this.fieldCollection.initFields(fieldConfigs);
            var fields = this.fieldCollection.getAllFields();
            this.addEvent(new FieldsInitedAggregateEvent(this.getId(), fieldConfigs, fields));
            this.filterManager.assignFilterTypes(fields);
            this.addEvent(new FilterTypesInitedAggregateEvent(this.getId(), this.filterManager.getFilterTypes()));
            return this.getEvents();
        };
        StructureAggregate.prototype.setSortingConfig = function (config) {
            this.sorterCollection.setConfig(config);
        };
        StructureAggregate.prototype.toggleSort = function (fieldId) {
            var field = this.fieldCollection.getField(fieldId);
            this.sorterCollection.toggle(field);
            this.calculateSource();
            return this.sorterCollection.getAll();
        };
        StructureAggregate.prototype.setSortOrder = function (fieldId, sortOrder) {
            var field = this.fieldCollection.getField(fieldId);
            this.sorterCollection.setSortOrder(field, sortOrder);
            this.calculateSource();
            return this.sorterCollection.getAll();
        };
        StructureAggregate.prototype.setFilterConfig = function (config) {
            this.filterManager.getSettings().setFilterConfig(config);
        };
        StructureAggregate.prototype.setQuickFiltersConfig = function (config) {
            this.filterManager.getSettings().setQuickFiltersConfig(config);
        };
        StructureAggregate.prototype.toggleFilter = function (fieldId, externalFilterId, filterValue) {
            var field = this.fieldCollection.getField(fieldId);
            // Field not found
            // TODO throw aggregate event
            if (field === undefined) {
                return [];
            }
            // this.filterManager.addFilter(field, externalFilterId, filterValue);
            // this.filterManager.a
            this.calculateSource();
            return [];
        };
        StructureAggregate.prototype.addFilter = function (fieldId, filterTypeId, value) {
            this.filterManager.add(fieldId, filterTypeId, value);
            var fields = this.fieldCollection.getFieldsAsMap();
            var activeFilters = this.filterManager.getAllActiveFilters(fields);
            this.addEvent(new FilterAddedAggregateEvent(this.getId(), activeFilters));
            this.calculateSource();
        };
        StructureAggregate.prototype.removeAllFilters = function () {
            this.filterManager.removeAll();
            this.addEvent(new AllFiltersRemovedAggregateEvent(this.getId()));
            this.calculateSource();
        };
        StructureAggregate.prototype.removeFilter = function (filterId) {
            this.filterManager.remove(filterId);
            var fields = this.fieldCollection.getFieldsAsMap();
            var activeFilters = this.filterManager.getAllActiveFilters(fields);
            this.addEvent(new FilterRemovedAggregateEvent(this.getId(), activeFilters));
            this.calculateSource();
        };
        StructureAggregate.prototype.setSearchingConfig = function (config) {
            this.filterManager.getSettings().setSearchingConfig(config);
        };
        StructureAggregate.prototype.addSearchPhrase = function (phrase) {
            var fields = this.fieldCollection.getAllFields();
            this.searchManager.addSearchPhrase(fields, phrase);
            this.calculateSource();
            return [];
        };
        StructureAggregate.prototype.removeSearchPhrase = function () {
            this.searchManager.removeSearchFilters();
            this.calculateSource();
            return [];
        };
        StructureAggregate.prototype.selectAllUniqueFilter = function (fieldId) {
            this.uniqueFilterManager.selectAll(fieldId);
            this.addEvent(new AllUniqueFilterSelectedAggregateEvent(this.getId()));
            this.generateCalculateUniqueValuesAggregateEvent();
            this.calculateSource();
        };
        StructureAggregate.prototype.selectUniqueFilter = function (fieldId, uniqueValueId) {
            this.uniqueFilterManager.select(fieldId, uniqueValueId);
            this.addEvent(new UniqueFilterSelectedAggregateEvent(this.getId()));
            this.generateCalculateUniqueValuesAggregateEvent();
            this.calculateSource();
        };
        StructureAggregate.prototype.unselectAllUniqueFilter = function (fieldId) {
            this.uniqueFilterManager.unselectAll(fieldId);
            this.addEvent(new AllUniqueFilterUnselectedAggregateEvent(this.getId()));
            this.generateCalculateUniqueValuesAggregateEvent();
            this.calculateSource();
        };
        StructureAggregate.prototype.unselectUniqueFilter = function (fieldId, uniqueValueId) {
            this.uniqueFilterManager.unselect(fieldId, uniqueValueId);
            this.addEvent(new UniqueFilterUnselectedAggregateEvent(this.getId()));
            this.generateCalculateUniqueValuesAggregateEvent();
            this.calculateSource();
        };
        StructureAggregate.prototype.calculateSource = function () {
            var _this = this;
            if (!this.sourceManager.getOrigin() || !this.pagingManager) {
                return;
            }
            // TODO Refactor
            this.sourceManager.setEntities(this.sourceManager.getOrigin());
            // filtering
            this.sourceManager.setEntities(this.filterManager.filter(this.sourceManager.getEntities(), this.fieldCollection.getFieldsAsMap()));
            // search
            var searchedEntities = this.searchManager.search(this.sourceManager.getEntities());
            this.sourceManager.setEntities(searchedEntities);
            // unique filtering
            this.sourceManager.setEntities(this.uniqueFilterManager.filterAll(this.sourceManager.getEntities(), this.fieldCollection.getAllFields()));
            // sorting
            var ents = this.sorterCollection.sort(this.sourceManager.getEntities());
            this.sourceManager.setEntities(ents);
            // calculate filteredEntities
            this.sourceManager.setPreparedEntities();
            this.pagingManager.setSourceSize(this.sourceManager.getPreparedEntities().length);
            this.addEvent(new StructurePreparedEntitiesSetAggregateEvent(this.getId(), ents));
            // summaries
            var summariesEvents = this.summariesManager.calculate(this.fieldCollection.getAllFields(), this.sourceManager.getEntities());
            summariesEvents.forEach(function (ae) {
                _this.addEvent(ae);
            });
            // paging
            this.sourceManager.setEntities(this.pagingManager.sample(this.sourceManager.getEntities()));
            this.verticalFormation.setSourceSize(this.sourceManager.getEntities().length);
            this.calculateSourceBasedOnVirtualScroll();
        };
        StructureAggregate.prototype.calculateSourceBasedOnVirtualScroll = function () {
            if (this.verticalFormation.isEnabled()) {
                var range = this.verticalFormation.getRange();
                this.sourceManager.setSlicedEntities(this.sourceManager.getEntities().slice(range.getStart(), range.getEnd()));
            }
            else {
                this.sourceManager.setSlicedEntities(this.sourceManager.getEntities());
            }
        };
        StructureAggregate.prototype.initTheme = function () {
            // TODO
            var theme = SchemaAggregate.DEFAULT_THEME;
            this.setTheme(theme);
        };
        StructureAggregate.prototype.calculateUniqueValues = function () {
            var fields = this.fieldCollection.getAllFields(), items = this.sourceManager.getOrigin();
            this.uniqueFilterManager.calculateAll(items, fields);
            this.generateCalculateUniqueValuesAggregateEvent();
        };
        StructureAggregate.prototype.generateCalculateUniqueValuesAggregateEvent = function () {
            this.addEvent(new UniqueFilterCalculatedAggregateEvent(this.getId(), this.uniqueFilterManager.getAll(this.fieldCollection.getAllFields())));
        };
        StructureAggregate.prototype.generateSelectedRowChangedEvent = function () {
            this.addEvent(new SelectedRowChangedAggregateEvent(this.getId(), this.sourceManager.getFormation().getSelectedRows(), this.sourceManager.getFormation().isAllSelected(), this.sourceManager.getFormation().isAllUnselected()));
        };
        return StructureAggregate;
    }(hermes.AggregateRoot));
    __decorate([
        Override
    ], StructureAggregate.prototype, "clearEvents", null);

    var StructureSorter = /** @class */ (function () {
        function StructureSorter(id, field, direction) {
            if (direction === void 0) { direction = true; }
            this.rank = 1;
            this.sorterId = id;
            this.field = field;
            this.direction = direction;
        }
        StructureSorter.prototype.getId = function () {
            return this.sorterId;
        };
        StructureSorter.prototype.getRank = function () {
            return this.rank;
        };
        StructureSorter.prototype.getField = function () {
            return this.field;
        };
        StructureSorter.prototype.hasDirection = function () {
            return this.direction;
        };
        StructureSorter.prototype.changeDirection = function () {
            this.direction = !this.direction;
        };
        StructureSorter.prototype.setDirection = function (direction) {
            this.direction = direction;
        };
        StructureSorter.prototype.sort = function (entities) {
            var _this = this;
            if (entities.length === 0) {
                return entities;
            }
            return entities.sort(function (entityOne, entityTwo) {
                return _this.field.sort(entityOne, entityTwo, _this.direction);
            });
        };
        return StructureSorter;
    }());

    var SorterId = /** @class */ (function () {
        function SorterId(id) {
            this.sorterId = id;
        }
        SorterId.prototype.getId = function () {
            return this.sorterId;
        };
        return SorterId;
    }());

    var SorterCollection = /** @class */ (function () {
        function SorterCollection(enabled, multi) {
            if (enabled === void 0) { enabled = false; }
            if (multi === void 0) { multi = false; }
            this.sorters = new Map();
            this.enabled = enabled;
            this.multi = multi;
        }
        SorterCollection.prototype.setConfig = function (config) {
            if (config && config.enabled !== undefined && config.enabled !== null) {
                this.enabled = config.enabled;
            }
            if (config && config.multiSorting !== undefined && config.multiSorting !== null) {
                this.multi = config.multiSorting;
                this.sorters.clear();
            }
        };
        SorterCollection.prototype.toggle = function (field) {
            var fieldId = field.getId(), sorter = this.sorters.get(fieldId.getId());
            if (sorter) {
                if (sorter.hasDirection()) {
                    sorter.changeDirection();
                }
                else {
                    this.delete(fieldId);
                }
            }
            else {
                this.add(field);
            }
        };
        SorterCollection.prototype.setSortOrder = function (field, sortOrder) {
            var fieldId = field.getId(), sorter = this.sorters.get(fieldId.getId());
            if (sortOrder === exports["ɵnr"].NONE) {
                this.delete(fieldId);
            }
            else if (sortOrder === exports["ɵnr"].ASC || sortOrder === exports["ɵnr"].DESC) {
                this.delete(fieldId);
                var direction = sortOrder === exports["ɵnr"].ASC;
                this.add(field, direction);
            }
        };
        SorterCollection.prototype.add = function (field, direction) {
            if (direction === void 0) { direction = true; }
            this.addSorter(field.getId(), new StructureSorter(new SorterId(hermes.RandomStringGenerator.generate()), field, direction));
        };
        SorterCollection.prototype.addSorter = function (fieldId, sorter) {
            if (!this.multi) {
                this.sorters.clear();
            }
            this.sorters.set(fieldId.getId(), sorter);
        };
        SorterCollection.prototype.delete = function (fieldId) {
            this.sorters.delete(fieldId.getId());
        };
        SorterCollection.prototype.update = function () {
        };
        // TODO Remove the loop from sorter.sort
        SorterCollection.prototype.sort = function (entities) {
            var e_1, _a;
            var sorters = this.getAll();
            var sortedEntities = Array.from(entities);
            try {
                for (var sorters_1 = __values(sorters), sorters_1_1 = sorters_1.next(); !sorters_1_1.done; sorters_1_1 = sorters_1.next()) {
                    var sorter = sorters_1_1.value;
                    sortedEntities = sorter.sort(sortedEntities);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (sorters_1_1 && !sorters_1_1.done && (_a = sorters_1.return)) _a.call(sorters_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return sortedEntities;
        };
        SorterCollection.prototype.getAll = function () {
            if (!this.enabled) {
                return [];
            }
            return Array.from(this.sorters)
                .map(function (arr) { return arr[1]; })
                .sort(function (sorterOne, sorterTwo) {
                return sorterOne.getRank() - sorterTwo.getRank();
            })
                .reverse();
        };
        return SorterCollection;
    }());

    var UniqueValue = /** @class */ (function () {
        function UniqueValue(id, value, displayValue, enabled) {
            this.id = id;
            this.value = value;
            this.displayValue = displayValue;
            this.enabled = enabled;
        }
        UniqueValue.prototype.getId = function () {
            return this.id;
        };
        UniqueValue.prototype.getValue = function () {
            return this.value;
        };
        UniqueValue.prototype.getDisplayValue = function () {
            return this.displayValue;
        };
        UniqueValue.prototype.isEnabled = function () {
            return this.enabled;
        };
        UniqueValue.prototype.isDisabled = function () {
            return !this.enabled;
        };
        UniqueValue.prototype.select = function () {
            this.enabled = true;
        };
        UniqueValue.prototype.unselect = function () {
            this.enabled = false;
        };
        return UniqueValue;
    }());

    var UniqueValueId = /** @class */ (function () {
        function UniqueValueId(uniqueValueId) {
            this.id = uniqueValueId;
        }
        UniqueValueId.prototype.toString = function () {
            return this.id;
        };
        UniqueValueId.prototype.equals = function (uniqueValueId) {
            return uniqueValueId.toString() === this.id;
        };
        return UniqueValueId;
    }());

    var UniqueValueIdGenerator = /** @class */ (function () {
        function UniqueValueIdGenerator() {
        }
        UniqueValueIdGenerator.generate = function () {
            UniqueValueIdGenerator.index += 1;
            return new UniqueValueId("" + UniqueValueIdGenerator.index);
        };
        return UniqueValueIdGenerator;
    }());
    UniqueValueIdGenerator.index = 0;

    var UniqueValueCollection = /** @class */ (function () {
        function UniqueValueCollection(values, field) {
            var e_1, _a;
            this.values = [];
            try {
                for (var values_1 = __values(values), values_1_1 = values_1.next(); !values_1_1.done; values_1_1 = values_1.next()) {
                    var value = values_1_1.value;
                    this.values.push(new UniqueValue(UniqueValueIdGenerator.generate(), value, field.getDisplayValue(value), true));
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (values_1_1 && !values_1_1.done && (_a = values_1.return)) _a.call(values_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            this.calculateAllSelected();
            this.calculateAllDisabled();
        }
        UniqueValueCollection.prototype.getAll = function () {
            return this.values;
        };
        UniqueValueCollection.prototype.isAllSelected = function () {
            return this.allSelected;
        };
        UniqueValueCollection.prototype.isAllDisabled = function () {
            return this.allDisabled;
        };
        UniqueValueCollection.prototype.getNotSelected = function () {
            return this.values.filter(function (uv) { return uv.isDisabled(); });
        };
        UniqueValueCollection.prototype.selectAll = function () {
            this.values.forEach(function (uv) {
                uv.select();
            });
            this.allSelected = true;
            this.allDisabled = false;
        };
        UniqueValueCollection.prototype.select = function (uniqueValueId) {
            this.values
                .filter(function (uv) { return uv.getId().equals(uniqueValueId); })
                .forEach(function (uv) {
                uv.select();
            });
            this.calculateAllSelected();
            this.calculateAllDisabled();
        };
        UniqueValueCollection.prototype.unselectAll = function () {
            this.values.forEach(function (uv) {
                uv.unselect();
            });
            this.allSelected = false;
            this.allDisabled = true;
        };
        UniqueValueCollection.prototype.unselect = function (uniqueValueId) {
            this.values
                .filter(function (uv) { return uv.getId().equals(uniqueValueId); })
                .forEach(function (uv) {
                uv.unselect();
            });
            this.calculateAllSelected();
            this.calculateAllDisabled();
        };
        UniqueValueCollection.prototype.calculateAllSelected = function () {
            this.allSelected = !this.values.some(function (f) { return f.isDisabled(); });
        };
        UniqueValueCollection.prototype.calculateAllDisabled = function () {
            this.allDisabled = !this.values.some(function (f) { return f.isEnabled(); });
        };
        return UniqueValueCollection;
    }());

    var UniqueFilterManager = /** @class */ (function () {
        function UniqueFilterManager() {
            this.uniqueValueMap = new hermes.KeyMap();
        }
        UniqueFilterManager.prototype.calculate = function (entities, field) {
            var _this = this;
            var fieldId = field.getId();
            var optUVM = this.uniqueValueMap.get(fieldId);
            optUVM.ifEmpty(function () {
                var e_1, _a;
                var set = new Set();
                try {
                    for (var entities_1 = __values(entities), entities_1_1 = entities_1.next(); !entities_1_1.done; entities_1_1 = entities_1.next()) {
                        var entity = entities_1_1.value;
                        set.add(field.getValue(entity));
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (entities_1_1 && !entities_1_1.done && (_a = entities_1.return)) _a.call(entities_1);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
                // sort
                var sortedValues = Array.from(set.values()).sort(function (a, b) {
                    return field.getField().sort(a, b);
                });
                var uvc = new UniqueValueCollection(sortedValues, field);
                _this.uniqueValueMap.set(field.getId(), uvc);
            });
        };
        UniqueFilterManager.prototype.calculateAll = function (entities, fields) {
            var e_2, _a;
            try {
                for (var fields_1 = __values(fields), fields_1_1 = fields_1.next(); !fields_1_1.done; fields_1_1 = fields_1.next()) {
                    var field = fields_1_1.value;
                    this.calculate(entities, field);
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (fields_1_1 && !fields_1_1.done && (_a = fields_1.return)) _a.call(fields_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        };
        UniqueFilterManager.prototype.filterAll = function (entities, fields) {
            var e_3, _a;
            var values = entities;
            try {
                for (var fields_2 = __values(fields), fields_2_1 = fields_2.next(); !fields_2_1.done; fields_2_1 = fields_2.next()) {
                    var field = fields_2_1.value;
                    values = this.filter(values, field);
                }
            }
            catch (e_3_1) { e_3 = { error: e_3_1 }; }
            finally {
                try {
                    if (fields_2_1 && !fields_2_1.done && (_a = fields_2.return)) _a.call(fields_2);
                }
                finally { if (e_3) throw e_3.error; }
            }
            return values;
        };
        UniqueFilterManager.prototype.filter = function (entities, field) {
            var values = [];
            this.uniqueValueMap
                .get(field.getId())
                .ifPresent(function (uvc) {
                if (uvc.isAllSelected()) {
                    values = entities;
                }
                else if (uvc.isAllDisabled()) {
                    values = [];
                }
                else {
                    values = entities.filter(function (itemEntity) {
                        var e_4, _a;
                        try {
                            for (var _b = __values(uvc.getNotSelected()), _c = _b.next(); !_c.done; _c = _b.next()) {
                                var notSelectedValue = _c.value;
                                if (field.getField().equals(itemEntity, notSelectedValue.getValue())) {
                                    return false;
                                }
                            }
                        }
                        catch (e_4_1) { e_4 = { error: e_4_1 }; }
                        finally {
                            try {
                                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                            }
                            finally { if (e_4) throw e_4.error; }
                        }
                        return true;
                    });
                }
            });
            return values;
        };
        UniqueFilterManager.prototype.selectAll = function (fieldId) {
            this.uniqueValueMap
                .get(fieldId)
                .ifPresent(function (uvc) {
                uvc.selectAll();
            });
        };
        UniqueFilterManager.prototype.select = function (fieldId, uniqueValueId) {
            this.uniqueValueMap
                .get(fieldId)
                .ifPresent(function (uvc) {
                uvc.select(uniqueValueId);
            });
        };
        UniqueFilterManager.prototype.unselectAll = function (fieldId) {
            this.uniqueValueMap
                .get(fieldId)
                .ifPresent(function (uvc) {
                uvc.unselectAll();
            });
        };
        UniqueFilterManager.prototype.unselect = function (fieldId, uniqueValueId) {
            this.uniqueValueMap
                .get(fieldId)
                .ifPresent(function (uvc) {
                uvc.unselect(uniqueValueId);
            });
        };
        UniqueFilterManager.prototype.getAll = function (fields) {
            var e_5, _a;
            var map = new Map();
            var _loop_1 = function (field) {
                this_1.getValues(field)
                    .ifPresent(function (v) {
                    map.set(field.getId().toString(), v);
                });
            };
            var this_1 = this;
            try {
                for (var fields_3 = __values(fields), fields_3_1 = fields_3.next(); !fields_3_1.done; fields_3_1 = fields_3.next()) {
                    var field = fields_3_1.value;
                    _loop_1(field);
                }
            }
            catch (e_5_1) { e_5 = { error: e_5_1 }; }
            finally {
                try {
                    if (fields_3_1 && !fields_3_1.done && (_a = fields_3.return)) _a.call(fields_3);
                }
                finally { if (e_5) throw e_5.error; }
            }
            return map;
        };
        UniqueFilterManager.prototype.getValues = function (field) {
            return this.uniqueValueMap
                .get(field.getId())
                .map(function (uvc) {
                return uvc.getAll();
            });
        };
        return UniqueFilterManager;
    }());

    var StructureAggregateFactory = /** @class */ (function (_super) {
        __extends(StructureAggregateFactory, _super);
        function StructureAggregateFactory(pagingAggregateFactory, sourceManagerFactory, verticalFormationFactory, summariesManagerFactory, filterManagerFactory, searchManagerFactory, fieldCollectionFactory) {
            var _this = _super.call(this) || this;
            _this.pagingAggregateFactory = pagingAggregateFactory;
            _this.sourceManagerFactory = sourceManagerFactory;
            _this.verticalFormationFactory = verticalFormationFactory;
            _this.summariesManagerFactory = summariesManagerFactory;
            _this.filterManagerFactory = filterManagerFactory;
            _this.searchManagerFactory = searchManagerFactory;
            _this.fieldCollectionFactory = fieldCollectionFactory;
            return _this;
        }
        StructureAggregateFactory.prototype.create = function (structureId) {
            var paging = this.pagingAggregateFactory.createDefault(), source = this.sourceManagerFactory.createDefault(), verticalFormation = this.verticalFormationFactory.create(structureId);
            var sorterContainer = new SorterCollection(), filterContainer = this.filterManagerFactory.create(false), fieldContainer = this.fieldCollectionFactory.create(), summariesManager = this.summariesManagerFactory.create(structureId), searchManager = this.searchManagerFactory.create();
            var structureAggregate = new StructureAggregate(structureId, paging, source, verticalFormation, summariesManager, sorterContainer, filterContainer, new UniqueFilterManager(), searchManager, fieldContainer);
            this.init(structureAggregate);
            return structureAggregate;
        };
        StructureAggregateFactory.prototype.init = function (structureAggregate) {
            structureAggregate.init();
        };
        return StructureAggregateFactory;
    }(hermes.AggregateFactory));
    StructureAggregateFactory.decorators = [
        { type: core.Injectable }
    ];
    StructureAggregateFactory.ctorParameters = function () { return [
        { type: PagingManagerFactory },
        { type: SourceManagerFactory },
        { type: VerticalFormationFactory },
        { type: SummariesManagerFactory },
        { type: FilterManagerFactory },
        { type: SearchManagerFactory },
        { type: FieldCollectionFactory }
    ]; };

    var StructureCreatedEventHandler = /** @class */ (function () {
        function StructureCreatedEventHandler(summariesEnabledArchive) {
            this.summariesEnabledArchive = summariesEnabledArchive;
        }
        StructureCreatedEventHandler.prototype.forEvent = function () {
            return StructureCreatedEvent;
        };
        StructureCreatedEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('StructureCreatedEvent')) {
                var structureId = event.getAggregateId();
                this.summariesEnabledArchive.init(structureId);
            }
        };
        return StructureCreatedEventHandler;
    }());
    StructureCreatedEventHandler.decorators = [
        { type: core.Injectable }
    ];
    StructureCreatedEventHandler.ctorParameters = function () { return [
        { type: SummariesEnabledArchive }
    ]; };

    var CreateStructureCommand = /** @class */ (function (_super) {
        __extends(CreateStructureCommand, _super);
        function CreateStructureCommand(structureId) {
            return _super.call(this, structureId, 'CreateStructureCommand') || this;
        }
        return CreateStructureCommand;
    }(StructureCommand));

    var SetVerticalScrollEnabledCommand = /** @class */ (function (_super) {
        __extends(SetVerticalScrollEnabledCommand, _super);
        function SetVerticalScrollEnabledCommand(structureId, enabled) {
            var _this = _super.call(this, structureId, 'SetVerticalScrollEnabledCommand') || this;
            _this.enabled = enabled;
            return _this;
        }
        SetVerticalScrollEnabledCommand.prototype.isEnabled = function () {
            return this.enabled;
        };
        return SetVerticalScrollEnabledCommand;
    }(StructureCommand));

    var SetScrollBarPositionCommand = /** @class */ (function (_super) {
        __extends(SetScrollBarPositionCommand, _super);
        function SetScrollBarPositionCommand(structureId, position) {
            var _this = _super.call(this, structureId, 'SetScrollBarPositionCommand') || this;
            _this.position = position;
            return _this;
        }
        SetScrollBarPositionCommand.prototype.getPosition = function () {
            return this.position;
        };
        return SetScrollBarPositionCommand;
    }(StructureCommand));

    var SetScrollPositionCommand = /** @class */ (function (_super) {
        __extends(SetScrollPositionCommand, _super);
        function SetScrollPositionCommand(structureId, position) {
            var _this = _super.call(this, structureId, 'SetScrollPositionCommand') || this;
            _this.position = position;
            return _this;
        }
        SetScrollPositionCommand.prototype.getPosition = function () {
            return this.position;
        };
        return SetScrollPositionCommand;
    }(StructureCommand));

    var SetRowHeightCommand = /** @class */ (function (_super) {
        __extends(SetRowHeightCommand, _super);
        function SetRowHeightCommand(structureId, rowHeight) {
            var _this = _super.call(this, structureId, 'SetRowHeightCommand') || this;
            _this.rowHeight = rowHeight;
            return _this;
        }
        SetRowHeightCommand.prototype.getRowHeight = function () {
            return this.rowHeight;
        };
        return SetRowHeightCommand;
    }(StructureCommand));

    var StructureSetHeightCommand = /** @class */ (function (_super) {
        __extends(StructureSetHeightCommand, _super);
        function StructureSetHeightCommand(structureId, height) {
            var _this = _super.call(this, structureId, 'StructureSetHeightCommand') || this;
            _this.height = height;
            return _this;
        }
        StructureSetHeightCommand.prototype.getHeight = function () {
            return this.height;
        };
        return StructureSetHeightCommand;
    }(StructureCommand));

    var SetRowHeightBasedOnThemeCommand = /** @class */ (function (_super) {
        __extends(SetRowHeightBasedOnThemeCommand, _super);
        function SetRowHeightBasedOnThemeCommand(structureId, theme) {
            var _this = _super.call(this, structureId, 'SetRowHeightBasedOnThemeCommand') || this;
            _this.theme = theme;
            return _this;
        }
        SetRowHeightBasedOnThemeCommand.prototype.getTheme = function () {
            return this.theme;
        };
        return SetRowHeightBasedOnThemeCommand;
    }(StructureCommand));

    var StructureDomainCommandInvoker = /** @class */ (function (_super) {
        __extends(StructureDomainCommandInvoker, _super);
        function StructureDomainCommandInvoker(commandDispatcher, structureFilterCommandService, sourceDispatcher, structureCellEditArchive) {
            var _this = _super.call(this) || this;
            _this.commandDispatcher = commandDispatcher;
            _this.structureFilterCommandService = structureFilterCommandService;
            _this.sourceDispatcher = sourceDispatcher;
            _this.structureCellEditArchive = structureCellEditArchive;
            return _this;
        }
        StructureDomainCommandInvoker.prototype.create = function (structureId) {
            this.commandDispatcher.dispatch(new CreateStructureCommand(structureId));
        };
        StructureDomainCommandInvoker.prototype.enableVirtualScroll = function (structureId) {
            this.commandDispatcher.dispatch(new SetVerticalScrollEnabledCommand(structureId, true));
        };
        StructureDomainCommandInvoker.prototype.disableVirtualScroll = function (structureId) {
            this.commandDispatcher.dispatch(new SetVerticalScrollEnabledCommand(structureId, false));
        };
        StructureDomainCommandInvoker.prototype.scrollToTop = function (structureId) {
            this.commandDispatcher.dispatch(new SetScrollBarPositionCommand(structureId, 0));
        };
        StructureDomainCommandInvoker.prototype.scrollToBottom = function (structureId) {
            this.commandDispatcher.dispatch(new SetScrollBarPositionCommand(structureId, Number.MAX_SAFE_INTEGER));
        };
        StructureDomainCommandInvoker.prototype.scrollToIndex = function (index, structureId) {
            this.commandDispatcher.dispatch(new SetScrollBarPositionCommand(structureId, index));
        };
        StructureDomainCommandInvoker.prototype.setScrollPosition = function (position, structureId) {
            this.commandDispatcher.dispatch(new SetScrollPositionCommand(structureId, position));
        };
        StructureDomainCommandInvoker.prototype.setOrigin = function (items, structureId) {
            this.sourceDispatcher.setOrigin(structureId, items);
        };
        StructureDomainCommandInvoker.prototype.setFilterConfig = function (config, structureId) {
            this.structureFilterCommandService.setConfig(config, structureId);
        };
        StructureDomainCommandInvoker.prototype.setQuickFiltersConfig = function (config, structureId) {
            this.commandDispatcher.dispatch(new SetConfigQuickFilterCommand(structureId, config));
        };
        StructureDomainCommandInvoker.prototype.setRowHeight = function (rowHeight, structureId) {
            this.commandDispatcher.dispatch(new SetRowHeightCommand(structureId, +rowHeight));
        };
        StructureDomainCommandInvoker.prototype.setContainerHeight = function (height, structureId) {
            this.commandDispatcher.dispatch(new StructureSetHeightCommand(structureId, +height));
        };
        StructureDomainCommandInvoker.prototype.setRowHeightBasedOnTheme = function (theme, structureId) {
            this.commandDispatcher.dispatch(new SetRowHeightBasedOnThemeCommand(structureId, theme));
        };
        StructureDomainCommandInvoker.prototype.setCellEdit = function (cellEdit, structureId) {
            this.structureCellEditArchive.next(structureId, new CellEditorManager(cellEdit));
        };
        return StructureDomainCommandInvoker;
    }(StructureCommandInvoker));
    StructureDomainCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    StructureDomainCommandInvoker.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher },
        { type: FilterCommandInvoker },
        { type: SourceDispatcher },
        { type: StructureCellEditArchive }
    ]; };

    var commandProviders = [
        inMemoryStructureCommandProviders
    ];
    var readProviders = [
        inMemoryStructureReadProviders
    ];
    var structureCommandHandlers = [];
    var structureDomainEventHandlers = [
        hermes.HermesModule.registerDomainEventHandler(StructureCreatedEventHandler)
    ];
    var structureProviders = [
        inMemoryStructureProviders,
        commandProviders,
        readProviders,
        StructureAggregateFactory,
        StructureReadModelRootConverter,
        StructureWarehouse,
        {
            provide: StructureCommandInvoker,
            useClass: StructureDomainCommandInvoker
        },
        StructureInitialValuesReadyArchive
    ];

    var ConsoleLogger = /** @class */ (function (_super) {
        __extends(ConsoleLogger, _super);
        function ConsoleLogger() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        ConsoleLogger.prototype.warn = function (text) {
            // eslint-disable-next-line no-console
            console.warn(text);
        };
        ConsoleLogger.prototype.error = function (text) {
            // eslint-disable-next-line no-console
            console.error(text);
        };
        return ConsoleLogger;
    }(Logger));

    var LoggerModule = /** @class */ (function () {
        function LoggerModule() {
        }
        return LoggerModule;
    }());
    LoggerModule.decorators = [
        { type: core.NgModule, args: [{
                    providers: [{
                            provide: Logger,
                            useClass: ConsoleLogger
                        }]
                },] }
    ];

    var ItemEntityFactory = /** @class */ (function () {
        function ItemEntityFactory() {
        }
        ItemEntityFactory.prototype.create = function (source) {
            if (Array.isArray(source)) {
                return this.createEntities(source);
            }
            else {
                return this.createEntity(source);
            }
        };
        ItemEntityFactory.prototype.createEntities = function (source) {
            var _this = this;
            return source.map(function (source) { return _this.createEntity(source); });
        };
        ItemEntityFactory.prototype.createEntity = function (originItem) {
            if (originItem instanceof OriginItemEntity) {
                return new ItemEntity(originItem.sourceItem, originItem.getPosition(), originItem.getId().toString(), originItem.getVersion());
            }
            else {
                return new ItemEntity(originItem, 0);
            }
        };
        return ItemEntityFactory;
    }());
    ItemEntityFactory.decorators = [
        { type: core.Injectable }
    ];

    var StructureTopPanelComponent = /** @class */ (function (_super) {
        __extends(StructureTopPanelComponent, _super);
        function StructureTopPanelComponent(changeDetectorRef, elementRef) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.addClassToHost('gui-p-6');
            _this.addClassToHost('gui-border-b');
            _this.addClassToHost('gui-border-b-solid');
            return _this;
        }
        StructureTopPanelComponent.prototype.getSelectorName = function () {
            return 'gui-structure-top-panel';
        };
        return StructureTopPanelComponent;
    }(SmartComponent));
    StructureTopPanelComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-top-panel]',
                    template: "\n\n\t\t<div gui-search-bar\n\t\t\t class=\"gui-flex gui-items-center gui-h-full gui-w-3/5 gui-mr-auto\"></div>\n\n<!--\t\t<div gui-filter-menu-trigger></div>-->\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureTopPanelComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };

    var StructureTopPanelModule = /** @class */ (function () {
        function StructureTopPanelModule() {
        }
        return StructureTopPanelModule;
    }());
    StructureTopPanelModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        forms.ReactiveFormsModule,
                        FilterMenuFeatureModule,
                        SearchFeatureModule
                    ],
                    declarations: [
                        StructureTopPanelComponent
                    ],
                    exports: [
                        StructureTopPanelComponent
                    ]
                },] }
    ];

    var StructureColumnConfigTriggerComponent = /** @class */ (function (_super) {
        __extends(StructureColumnConfigTriggerComponent, _super);
        function StructureColumnConfigTriggerComponent(elementRef, changeDetectorRef, structureCommandService, structureColumnMenuConfigArchive, structureColumnConfigService) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.elementRef = elementRef;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureCommandService = structureCommandService;
            _this.structureColumnMenuConfigArchive = structureColumnMenuConfigArchive;
            _this.structureColumnConfigService = structureColumnConfigService;
            return _this;
        }
        StructureColumnConfigTriggerComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.structureColumnMenuConfigArchive.on(), function (config) {
                _this.config = config;
            });
        };
        StructureColumnConfigTriggerComponent.prototype.openConfigDialog = function () {
            this.structureColumnConfigService.open(this.headerDialogContainer, this.column);
        };
        StructureColumnConfigTriggerComponent.prototype.closeConfigDialog = function () {
            this.structureColumnConfigService.close();
        };
        StructureColumnConfigTriggerComponent.prototype.isEnabled = function () {
            return this.config && this.config.isEnabled();
        };
        StructureColumnConfigTriggerComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-config-trigger';
        };
        return StructureColumnConfigTriggerComponent;
    }(SmartComponent));
    StructureColumnConfigTriggerComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-config-trigger]',
                    template: "<div #headerDialogContainer\n\t (click)=\"openConfigDialog()\"\n\t *ngIf=\"isEnabled()\"\n\t class=\"gui-header-menu-icon-wrapper\">\n\n\t<div [ngClass]=\"'gui-header-menu-icon'\" gui-structure-column-menu-icon></div>\n\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnConfigTriggerComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef },
        { type: StructureCommandInvoker },
        { type: StructureColumnMenuConfigArchive },
        { type: StructureColumnConfigService }
    ]; };
    StructureColumnConfigTriggerComponent.propDecorators = {
        headerDialogContainer: [{ type: core.ViewChild, args: ['headerDialogContainer', { static: false },] }],
        column: [{ type: core.Input }]
    };

    var StructureColumnConfigSortComponent = /** @class */ (function (_super) {
        __extends(StructureColumnConfigSortComponent, _super);
        function StructureColumnConfigSortComponent(changeDetectorRef, elementRef, compositionId, structureId, sortingCommandDispatcher, compositionReadModelService) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.compositionId = compositionId;
            _this.structureId = structureId;
            _this.sortingCommandDispatcher = sortingCommandDispatcher;
            _this.compositionReadModelService = compositionReadModelService;
            _this.placement = fabric.Placement.Right;
            _this.status = exports["ɵnr"];
            return _this;
        }
        StructureColumnConfigSortComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.sortStatus = this.column.getSortStatus();
            this.subscribe(this.compositionReadModelService.onSortOrder(this.column.getFieldId(), this.compositionId), function (sortStatus) {
                _this.sortStatus = sortStatus;
            });
        };
        StructureColumnConfigSortComponent.prototype.isAscSort = function () {
            return this.sortStatus === exports["ɵnr"].ASC;
        };
        StructureColumnConfigSortComponent.prototype.isDescSort = function () {
            return this.sortStatus === exports["ɵnr"].DESC;
        };
        StructureColumnConfigSortComponent.prototype.isNoneSort = function () {
            return this.sortStatus === exports["ɵnr"].NONE;
        };
        StructureColumnConfigSortComponent.prototype.setSortOrder = function (sort) {
            event.stopPropagation();
            this.sortingCommandDispatcher.setSortOrder(this.column.getFieldId(), sort, this.compositionId, this.structureId);
        };
        StructureColumnConfigSortComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-config-sort';
        };
        return StructureColumnConfigSortComponent;
    }(SmartComponent));
    StructureColumnConfigSortComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-config-sort]',
                    template: "<gui-dropdown [dropdownText]=\"dropdownTextTranslation\"\n\t\t\t  [placement]=\"placement\"\n\t\t\t  [showOnHover]=\"true\"\n\t\t\t  [width]=\"225\"\n\t\t\t  class=\"gui-header-menu-dropdown\">\n\n\t<gui-dropdown-item (click)=\"setSortOrder(status.ASC)\"\n\t\t\t\t\t   [class.gui-header-item-active]=\"isAscSort()\">\n\t\t<div class=\"gui-sort-title\">\n\t\t\t{{'headerMenuMainTabColumnSortAscending' | guiTranslate}}\n\t\t\t<div [rotateDeg]=\"0\" [sort]=\"true\" gui-structure-column-menu-arrow-icon>\n\t\t\t</div>\n\t\t</div>\n\t</gui-dropdown-item>\n\n\t<gui-dropdown-item (click)=\"setSortOrder(status.DESC)\"\n\t\t\t\t\t   [class.gui-header-item-active]=\"isDescSort()\">\n\t\t<div class=\"gui-sort-title\">\n\t\t\t{{'headerMenuMainTabColumnSortDescending' | guiTranslate}}\n\t\t\t<div [rotateDeg]=\"180\" [sort]=\"true\" gui-structure-column-menu-arrow-icon>\n\t\t\t</div>\n\t\t</div>\n\t</gui-dropdown-item>\n\n\t<gui-dropdown-item (click)=\"setSortOrder(status.NONE)\"\n\t\t\t\t\t   [class.gui-header-item-active]=\"isNoneSort()\">\n\t\t{{'headerMenuMainTabColumnSortNone' | guiTranslate}}\n\t</gui-dropdown-item>\n\n</gui-dropdown>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnConfigSortComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: CompositionId },
        { type: StructureId },
        { type: SortingCommandInvoker },
        { type: CompositionWarehouse }
    ]; };
    StructureColumnConfigSortComponent.propDecorators = {
        column: [{ type: core.Input }],
        dropdownTextTranslation: [{ type: core.Input }]
    };

    var StructureColumnConfigColumnHideComponent = /** @class */ (function (_super) {
        __extends(StructureColumnConfigColumnHideComponent, _super);
        function StructureColumnConfigColumnHideComponent(elRef) {
            var _this = _super.call(this, elRef) || this;
            _this.columnHidden = new core.EventEmitter();
            return _this;
        }
        StructureColumnConfigColumnHideComponent.prototype.hideColumn = function () {
            this.columnHidden.emit();
        };
        StructureColumnConfigColumnHideComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-config-column-hide';
        };
        return StructureColumnConfigColumnHideComponent;
    }(PureComponent));
    StructureColumnConfigColumnHideComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-config-column-hide]',
                    template: "<div (click)=\"hideColumn()\"\n\t class=\"gui-header-menu-item\">\n\t{{'headerMenuMainTabHideColumn' | guiTranslate}}\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnConfigColumnHideComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    StructureColumnConfigColumnHideComponent.propDecorators = {
        column: [{ type: core.Input }],
        columnHidden: [{ type: core.Output }]
    };

    var StructureColumnConfigColumnMoveComponent = /** @class */ (function (_super) {
        __extends(StructureColumnConfigColumnMoveComponent, _super);
        function StructureColumnConfigColumnMoveComponent(elRef) {
            var _this = _super.call(this, elRef) || this;
            _this.movedLeft = new core.EventEmitter();
            _this.movedRight = new core.EventEmitter();
            return _this;
        }
        StructureColumnConfigColumnMoveComponent.prototype.moveLeft = function () {
            this.movedLeft.emit();
        };
        StructureColumnConfigColumnMoveComponent.prototype.moveRight = function () {
            this.movedRight.emit();
        };
        StructureColumnConfigColumnMoveComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-config-column-move';
        };
        return StructureColumnConfigColumnMoveComponent;
    }(PureComponent));
    StructureColumnConfigColumnMoveComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-config-column-move][column]',
                    template: "<div class=\"gui-header-menu-column-move\">\n\t<div (click)=\"moveLeft()\"\n\t\t class=\"gui-header-menu-column-move-item left\">\n\t\t<div [rotateDeg]=\"-90\" gui-structure-column-menu-arrow-icon></div>\n\t\t{{'headerMenuMainTabMoveLeft' | guiTranslate}}\n\t</div>\n\n\t<div (click)=\"moveRight()\"\n\t\t class=\"gui-header-menu-column-move-item right\">\n\t\t{{'headerMenuMainTabMoveRight' | guiTranslate}}\n\t\t<div gui-structure-column-menu-arrow-icon></div>\n\t</div>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnConfigColumnMoveComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    StructureColumnConfigColumnMoveComponent.propDecorators = {
        column: [{ type: core.Input }],
        movedLeft: [{ type: core.Output }],
        movedRight: [{ type: core.Output }]
    };

    var StructureColumnMenuIconComponent = /** @class */ (function (_super) {
        __extends(StructureColumnMenuIconComponent, _super);
        function StructureColumnMenuIconComponent(elementRef, changeDetectorRef) {
            return _super.call(this, elementRef, changeDetectorRef) || this;
        }
        StructureColumnMenuIconComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-menu-icon';
        };
        return StructureColumnMenuIconComponent;
    }(IconComponent));
    StructureColumnMenuIconComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-menu-icon]',
                    template: "\n\t\t<svg data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 10.32 7.46\">\n\t\t\t<line class=\"cls-1\" x1=\"9.57\" y1=\"3.73\" x2=\"0.75\" y2=\"3.73\"/>\n\t\t\t<line class=\"cls-1\" x1=\"9.57\" y1=\"0.75\" x2=\"0.75\" y2=\"0.75\"/>\n\t\t\t<line class=\"cls-1\" x1=\"9.57\" y1=\"6.71\" x2=\"0.75\" y2=\"6.71\"/>\n\t\t</svg>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnMenuIconComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.ChangeDetectorRef }
    ]; };

    var StructureColumnMenuArrowIconComponent = /** @class */ (function (_super) {
        __extends(StructureColumnMenuArrowIconComponent, _super);
        function StructureColumnMenuArrowIconComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.rotateDeg = 90;
            return _this;
        }
        StructureColumnMenuArrowIconComponent.prototype.getSelectorName = function () {
            return 'gui-structure-column-menu-arrow-icon';
        };
        return StructureColumnMenuArrowIconComponent;
    }(PureComponent));
    StructureColumnMenuArrowIconComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-column-menu-arrow-icon]',
                    template: "\n\t\t<div [style.transform]=\"'rotate(' + rotateDeg + 'deg)'\"\n\t\t\t [class.gui-structure-column-menu-sort-icon]=\"sort\">\n\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 10.04 11.72\">\n\t\t\t\t<line class=\"cls-1\" x1=\"5.02\" y1=\"2.15\" x2=\"5.02\" y2=\"10.97\"/>\n\t\t\t\t<line class=\"cls-1\" x1=\"5.02\" y1=\"0.75\" x2=\"9.29\" y2=\"5.02\"/>\n\t\t\t\t<line class=\"cls-1\" x1=\"5.02\" y1=\"0.75\" x2=\"0.75\" y2=\"5.02\"/>\n\t\t\t</svg>\n\t\t</div>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureColumnMenuArrowIconComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    StructureColumnMenuArrowIconComponent.propDecorators = {
        rotateDeg: [{ type: core.Input }],
        sort: [{ type: core.Input }]
    };

    var UniqueValueListComponent = /** @class */ (function (_super) {
        __extends(UniqueValueListComponent, _super);
        function UniqueValueListComponent(changeDetectorRef, elementRef, structureId, filterWarehouse, filterCommandInvoker) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.structureId = structureId;
            _this.filterWarehouse = filterWarehouse;
            _this.filterCommandInvoker = filterCommandInvoker;
            _this.uniqueValues = [];
            return _this;
        }
        UniqueValueListComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.filterWarehouse.onUniqueValues(this.structureId), function (uniqueValuesReadModel) {
                _this.uniqueValues = uniqueValuesReadModel.getValues(_this.fieldId);
                _this.selectAllChecked = uniqueValuesReadModel.isSelectAllChecked(_this.fieldId);
                _this.selectAllIndeterminate = uniqueValuesReadModel.isIndeterminate(_this.fieldId);
            });
        };
        UniqueValueListComponent.prototype.toggleAllSelect = function () {
            event.stopPropagation();
            if (this.selectAllChecked) {
                this.filterCommandInvoker.unselectAllUniqueFilter(this.fieldId, this.structureId);
            }
            else {
                this.filterCommandInvoker.selectAllUniqueFilter(this.fieldId, this.structureId);
            }
        };
        UniqueValueListComponent.prototype.toggleSelect = function (uniqueValueReadModel) {
            event.stopPropagation();
            if (uniqueValueReadModel.isEnabled()) {
                this.filterCommandInvoker.unselectUniqueFilter(this.fieldId, uniqueValueReadModel.getId(), this.structureId);
            }
            else {
                this.filterCommandInvoker.selectUniqueFilter(this.fieldId, uniqueValueReadModel.getId(), this.structureId);
            }
        };
        UniqueValueListComponent.prototype.clearFilters = function () {
            this.filterCommandInvoker.selectAllUniqueFilter(this.fieldId, this.structureId);
        };
        UniqueValueListComponent.prototype.getSelectorName = function () {
            return 'gui-unique-value-list';
        };
        return UniqueValueListComponent;
    }(SmartComponent));
    UniqueValueListComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-unique-value-list][fieldId]',
                    template: "<gui-checkbox (changed)=\"toggleAllSelect()\"\n\t\t\t  [checked]=\"selectAllChecked\"\n\t\t\t  [indeterminate]=\"selectAllIndeterminate\">\n\tSelect all\n</gui-checkbox>\n\n<div class=\"gui-unique-value-list-container gui-overflow-y-auto gui-overflow-x-hidden\">\n\t<div *ngFor=\"let value of uniqueValues\">\n\t\t<gui-checkbox (changed)=\"toggleSelect(value)\"\n\t\t\t\t\t  [checked]=\"value.isEnabled()\">\n\t\t\t{{value.getValue()}}\n\t\t</gui-checkbox>\n\t</div>\n</div>\n\n<div class=\"gui-unique-value-list-actions gui-px-4 gui-pb-4 gui-pt-2 gui-flex gui-justify-end\">\n\t<button (click)=\"clearFilters()\"\n\t\t\t[outline]=\"true\"\n\t\t\t[primary]=\"true\"\n\t\t\tclass=\"gui-clear-unique-filters gui-px-4 gui-py-2\"\n\t\t\tgui-button>\n\t\tClear\n\t</button>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None,
                    styles: [".gui-unique-value-list-container{max-height:300px}\n"]
                },] }
    ];
    UniqueValueListComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: FilterWarehouse },
        { type: FilterCommandInvoker }
    ]; };
    UniqueValueListComponent.propDecorators = {
        fieldId: [{ type: core.Input }]
    };

    var UniqueValueListModule = /** @class */ (function (_super) {
        __extends(UniqueValueListModule, _super);
        function UniqueValueListModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        UniqueValueListModule.forComponent = function () {
            return [];
        };
        return UniqueValueListModule;
    }(hermes.FeatureModule));
    UniqueValueListModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabricImports,
                        FilterApiModule
                    ],
                    declarations: [
                        UniqueValueListComponent
                    ],
                    exports: [
                        UniqueValueListComponent
                    ]
                },] }
    ];

    var declarations$2 = [
        StructureColumnConfigComponent,
        StructureColumnConfigTriggerComponent,
        StructureColumnConfigSortComponent,
        StructureColumnConfigColumnHideComponent,
        StructureColumnConfigColumnMoveComponent,
        StructureColumnMenuIconComponent,
        StructureColumnMenuArrowIconComponent
    ];
    var StructureColumnMenuModule = /** @class */ (function () {
        function StructureColumnMenuModule() {
        }
        return StructureColumnMenuModule;
    }());
    StructureColumnMenuModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        fabricImports,
                        StructureColumnManagerModule,
                        UniqueValueListModule,
                        TranslationFeatureModule
                    ],
                    declarations: declarations$2,
                    exports: declarations$2
                },] }
    ];

    var CreateStructureCommandHandler = /** @class */ (function () {
        function CreateStructureCommandHandler(structureAggregateRepository, domainEventPublisher) {
            this.structureAggregateRepository = structureAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        CreateStructureCommandHandler.prototype.forCommand = function () {
            return CreateStructureCommand;
        };
        CreateStructureCommandHandler.prototype.getAggregateRepository = function () {
            return this.structureAggregateRepository;
        };
        CreateStructureCommandHandler.prototype.publishDomainEvents = function (aggregate, command) {
            this.domainEventPublisher.publish(new StructureCreatedEvent(command.getAggregateId()));
        };
        return CreateStructureCommandHandler;
    }());
    CreateStructureCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    CreateStructureCommandHandler.ctorParameters = function () { return [
        { type: StructureAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var StructureCellEditComponent = /** @class */ (function (_super) {
        __extends(StructureCellEditComponent, _super);
        function StructureCellEditComponent(changeDetectorRef, elementRef, structureId, sourceCommandService) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.sourceCommandService = sourceCommandService;
            return _this;
        }
        StructureCellEditComponent.prototype.ngOnChanges = function (changes) {
            var _this = this;
            ifChanged(changes.entity, function () {
                _this.initEditContext();
            });
            ifChanged(changes.cell, function () {
                _this.initEditContext();
            });
        };
        StructureCellEditComponent.prototype.ngOnInit = function () {
            this.initEditContext();
        };
        StructureCellEditComponent.prototype.submitChangesAndExit = function () {
            var itemId = this.entity.getId(), updatedValue = this.actualValue, fieldId = this.cell.columnFieldId;
            this.sourceCommandService.editItem(new StructureEditSourceItemParams(itemId, fieldId, updatedValue), this.structureId);
        };
        StructureCellEditComponent.prototype.getSelectorName = function () {
            return 'gui-structure-cell-edit';
        };
        StructureCellEditComponent.prototype.initEditContext = function () {
            var _this = this;
            this.valueChanges$ = new ChangedValueEmitter();
            this.status$ = new ChangedValueEmitter();
            this.editContext = {
                status: this.status$,
                valueChanges: this.valueChanges$,
                value: this.cell.getValue(this.entity),
                focus: false,
                parent: this.cellContainerRef
            };
            this.status$
                .on()
                .pipe(this.takeUntil())
                .subscribe(function (status) {
                switch (status) {
                    case EditEventType.SUBMIT:
                        _this.submitChangesAndExit();
                        _this.publishEditSubmit();
                        break;
                    case EditEventType.CANCEL:
                        // this.exitEditMode();
                        _this.publishEditCancel();
                        break;
                    default:
                        break;
                }
            });
        };
        StructureCellEditComponent.prototype.observeValueChanges = function () {
            var _this = this;
            this.valueChanges$
                .on()
                .pipe(this.takeUntil())
                .subscribe(function (value) {
                _this.actualValue = value;
            });
        };
        StructureCellEditComponent.prototype.publishEditState = function (state) {
            // this.structureCellEditStore.next(state);
        };
        StructureCellEditComponent.prototype.publishEditEnter = function () {
            this.publishEditState(StructureCellEditState.ENTER);
        };
        StructureCellEditComponent.prototype.publishEditCancel = function () {
            this.publishEditState(StructureCellEditState.CANCEL);
        };
        StructureCellEditComponent.prototype.publishEditSubmit = function () {
            this.publishEditState(StructureCellEditState.SUBMIT);
        };
        return StructureCellEditComponent;
    }(SmartComponent));
    StructureCellEditComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-cell-edit][entity][cell]',
                    template: "\n\n\t\t<span #cellContainer>\n\t\t\t<ng-container\n\t\t\t\t*ngTemplateOutlet=\"cell.editTemplate;\n\t\t\t\t\t\t\t\t\tcontext: editContext\">\n\t\t\t</ng-container>\n\t\t</span>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureCellEditComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: SourceCommandInvoker }
    ]; };
    StructureCellEditComponent.propDecorators = {
        cellContainerRef: [{ type: core.ViewChild, args: ['cellContainer', { static: true },] }],
        entity: [{ type: core.Input }],
        cell: [{ type: core.Input }]
    };

    var StructureCellEditBooleanComponent = /** @class */ (function (_super) {
        __extends(StructureCellEditBooleanComponent, _super);
        function StructureCellEditBooleanComponent(changeDetectorRef, elementRef, structureId, sourceCommandService) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.sourceCommandService = sourceCommandService;
            return _this;
        }
        StructureCellEditBooleanComponent.prototype.ngOnChanges = function (changes) {
            var _this = this;
            ifChanged(changes.entity, function () {
                _this.initEditContext();
            });
            ifChanged(changes.cell, function () {
                _this.initEditContext();
            });
        };
        StructureCellEditBooleanComponent.prototype.ngOnInit = function () {
            this.initEditContext();
        };
        StructureCellEditBooleanComponent.prototype.getSelectorName = function () {
            return 'gui-structure-cell-edit-boolean';
        };
        StructureCellEditBooleanComponent.prototype.submitChanges = function () {
            var itemId = this.entity.getId(), updatedValue = this.actualValue, fieldId = this.cell.columnFieldId;
            this.sourceCommandService.editItem(new StructureEditSourceItemParams(itemId, fieldId, updatedValue), this.structureId);
        };
        StructureCellEditBooleanComponent.prototype.initEditContext = function () {
            var _this = this;
            this.valueChanges$ = new ChangedValueEmitter();
            this.status$ = new ChangedValueEmitter();
            this.editContext = {
                status: this.status$,
                valueChanges: this.valueChanges$,
                value: this.cell.getValue(this.entity).value,
                focus: false,
                parent: this.cellContainerRef
            };
            this.observeValueChanges();
            this.status$
                .on()
                .pipe(this.takeUntil())
                .subscribe(function (status) {
                switch (status) {
                    case EditEventType.SUBMIT:
                        _this.submitChanges();
                        break;
                    default:
                        break;
                }
            });
        };
        StructureCellEditBooleanComponent.prototype.observeValueChanges = function () {
            var _this = this;
            this.valueChanges$
                .on()
                .pipe(this.takeUntil())
                .subscribe(function (value) {
                _this.actualValue = value;
            });
        };
        return StructureCellEditBooleanComponent;
    }(SmartComponent));
    StructureCellEditBooleanComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-cell-edit-boolean][entity][cell]',
                    template: "\n\n\t\t<span #cellContainer>\n\t\t\t<ng-container\n\t\t\t\t*ngTemplateOutlet=\"cell.editTemplate;\n\t\t\t\t\t\t\t\t\tcontext: editContext\">\n\t\t\t</ng-container>\n\t\t</span>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureCellEditBooleanComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: SourceCommandInvoker }
    ]; };
    StructureCellEditBooleanComponent.propDecorators = {
        cellContainerRef: [{ type: core.ViewChild, args: ['cellContainer', { static: true },] }],
        entity: [{ type: core.Input }],
        cell: [{ type: core.Input }]
    };

    var StructureBannerPanel = /** @class */ (function (_super) {
        __extends(StructureBannerPanel, _super);
        function StructureBannerPanel(changeDetectorRef, elementRef) {
            return _super.call(this, changeDetectorRef, elementRef) || this;
        }
        StructureBannerPanel.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.onBannerPanelConfig(), function (config) {
                _this.bannerPanel = config.template;
                if (typeof _this.bannerPanel === 'function') {
                    _this.bannerPanel = _this.bannerPanel();
                }
            });
        };
        return StructureBannerPanel;
    }(SmartComponent));
    StructureBannerPanel.decorators = [
        { type: core.Directive }
    ];
    StructureBannerPanel.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };

    var StructureTitlePanelComponent = /** @class */ (function (_super) {
        __extends(StructureTitlePanelComponent, _super);
        function StructureTitlePanelComponent(structureTitlePanelConfigArchive, changeDetectorRef, elementRef) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.structureTitlePanelConfigArchive = structureTitlePanelConfigArchive;
            return _this;
        }
        StructureTitlePanelComponent.prototype.onBannerPanelConfig = function () {
            return this.structureTitlePanelConfigArchive.on();
        };
        StructureTitlePanelComponent.prototype.getSelectorName = function () {
            return 'gui-structure-title-panel';
        };
        StructureTitlePanelComponent.prototype.getPanelTitle = function () {
            return 'Title panel';
        };
        return StructureTitlePanelComponent;
    }(StructureBannerPanel));
    StructureTitlePanelComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-title-panel]',
                    template: "<div [innerHTML]=\"bannerPanel | guiSafe: 'html'\"\n\t class=\"gui-title-panel gui-p-6 gui-border-b gui-border-b-solid\">\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureTitlePanelComponent.ctorParameters = function () { return [
        { type: StructureTitlePanelConfigArchive },
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };

    var StructureFooterPanelComponent = /** @class */ (function (_super) {
        __extends(StructureFooterPanelComponent, _super);
        function StructureFooterPanelComponent(structureFooterPanelConfigArchive, changeDetectorRef, elementRef) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.structureFooterPanelConfigArchive = structureFooterPanelConfigArchive;
            return _this;
        }
        StructureFooterPanelComponent.prototype.onBannerPanelConfig = function () {
            return this.structureFooterPanelConfigArchive.on();
        };
        StructureFooterPanelComponent.prototype.getSelectorName = function () {
            return 'gui-structure-footer-panel';
        };
        StructureFooterPanelComponent.prototype.getPanelTitle = function () {
            return 'Footer panel';
        };
        return StructureFooterPanelComponent;
    }(StructureBannerPanel));
    StructureFooterPanelComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-footer-panel]',
                    template: "<div [innerHTML]=\"bannerPanel | guiSafe: 'html'\"\n\t class=\"gui-footer-panel gui-p-6 gui-border-t gui-border-t-solid\">\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StructureFooterPanelComponent.ctorParameters = function () { return [
        { type: StructureFooterPanelConfigArchive },
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };

    var SelectAllComponent = /** @class */ (function (_super) {
        __extends(SelectAllComponent, _super);
        function SelectAllComponent(changeDetectorRef, elementRef, structureId, rowSelectionModeRepository, formationCommandDispatcher, formationWarehouse) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.structureId = structureId;
            _this.rowSelectionModeRepository = rowSelectionModeRepository;
            _this.formationCommandDispatcher = formationCommandDispatcher;
            _this.formationWarehouse = formationWarehouse;
            _this.modeMulti = false;
            return _this;
        }
        SelectAllComponent.prototype.ngOnInit = function () {
            var _this = this;
            this.subscribe(this.formationWarehouse.onMode(this.structureId), function (mode) {
                _this.modeMulti = mode === RowSelectionMode.MULTIPLE;
            });
            this.subscribe(this.formationWarehouse.onRowSelectedReadModel(this.structureId), function (rowSelectedReadModel) {
                _this.selectAllChecked = rowSelectedReadModel.isAllSelected();
                _this.selectAllIndeterminate = rowSelectedReadModel.isIndeterminate();
            });
        };
        SelectAllComponent.prototype.toggleSelectAll = function () {
            if (this.selectAllIndeterminate) {
                this.formationCommandDispatcher.unselectAll(this.structureId);
            }
            else {
                if (this.selectAllChecked) {
                    this.formationCommandDispatcher.unselectAll(this.structureId);
                }
                else {
                    this.formationCommandDispatcher.selectAll(this.structureId);
                }
            }
        };
        SelectAllComponent.prototype.getSelectorName = function () {
            return 'gui-select-all';
        };
        return SelectAllComponent;
    }(SmartComponent));
    SelectAllComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-select-all]',
                    template: "<gui-checkbox (changed)=\"toggleSelectAll()\"\n\t\t\t  *ngIf=\"modeMulti\"\n\t\t\t  [checked]=\"selectAllChecked\"\n\t\t\t  [gui-tooltip]=\"'Select'\"\n\t\t\t  [indeterminate]=\"selectAllIndeterminate\">\n</gui-checkbox>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    SelectAllComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: StructureId },
        { type: RowSelectionModeRepository },
        { type: FormationCommandInvoker },
        { type: FormationWarehouse }
    ]; };

    var SetScrollPositionCommandHandler = /** @class */ (function () {
        function SetScrollPositionCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetScrollPositionCommandHandler.prototype.forCommand = function () {
            return SetScrollPositionCommand;
        };
        SetScrollPositionCommandHandler.prototype.handle = function (structure, command) {
            var position = command.getPosition();
            structure.setScrollPosition(position);
        };
        SetScrollPositionCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new ScrollPositionSetEvent(command.getAggregateId()));
        };
        return SetScrollPositionCommandHandler;
    }());
    SetScrollPositionCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetScrollPositionCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetVerticalScrollEnabledCommandHandler = /** @class */ (function () {
        function SetVerticalScrollEnabledCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetVerticalScrollEnabledCommandHandler.prototype.forCommand = function () {
            return SetVerticalScrollEnabledCommand;
        };
        SetVerticalScrollEnabledCommandHandler.prototype.handle = function (structure, command) {
            var enabled = command.isEnabled();
            structure.setVerticalFormationEnabled(enabled);
        };
        SetVerticalScrollEnabledCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new VerticalScrollEnabledSetEvent(command.getAggregateId()));
        };
        return SetVerticalScrollEnabledCommandHandler;
    }());
    SetVerticalScrollEnabledCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetVerticalScrollEnabledCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetRowHeightBasedOnThemeCommandHandler = /** @class */ (function () {
        function SetRowHeightBasedOnThemeCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetRowHeightBasedOnThemeCommandHandler.prototype.forCommand = function () {
            return SetRowHeightBasedOnThemeCommand;
        };
        SetRowHeightBasedOnThemeCommandHandler.prototype.handle = function (structure, command) {
            var theme = command.getTheme();
            structure.setTheme(theme);
        };
        SetRowHeightBasedOnThemeCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new RowHeightSetBasedOnThemeEvent(command.getAggregateId()));
        };
        return SetRowHeightBasedOnThemeCommandHandler;
    }());
    SetRowHeightBasedOnThemeCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetRowHeightBasedOnThemeCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetRowHeightCommandHandler = /** @class */ (function () {
        function SetRowHeightCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetRowHeightCommandHandler.prototype.forCommand = function () {
            return SetRowHeightCommand;
        };
        SetRowHeightCommandHandler.prototype.handle = function (structure, command) {
            var rowHeight = command.getRowHeight();
            var formation = structure.getVerticalFormation();
            formation.setRowHeight(rowHeight);
        };
        SetRowHeightCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new RowHeightSetEvent(command.getAggregateId()));
        };
        return SetRowHeightCommandHandler;
    }());
    SetRowHeightCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetRowHeightCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var StructureSetHeightCommandHandler = /** @class */ (function () {
        function StructureSetHeightCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        StructureSetHeightCommandHandler.prototype.forCommand = function () {
            return StructureSetHeightCommand;
        };
        StructureSetHeightCommandHandler.prototype.handle = function (aggregate, command) {
            var height = command.getHeight();
            aggregate.setHeight(height);
        };
        StructureSetHeightCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new StructureHeightSetEvent(command.getAggregateId()));
        };
        return StructureSetHeightCommandHandler;
    }());
    StructureSetHeightCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    StructureSetHeightCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var VerticalFormationScrollBarPositionArchive = /** @class */ (function (_super) {
        __extends(VerticalFormationScrollBarPositionArchive, _super);
        function VerticalFormationScrollBarPositionArchive() {
            return _super.call(this, VerticalFormationScrollBarPositionArchive.DEFAULT_POSITION) || this;
        }
        return VerticalFormationScrollBarPositionArchive;
    }(hermes.AggregateArchive));
    VerticalFormationScrollBarPositionArchive.DEFAULT_POSITION = 0;
    VerticalFormationScrollBarPositionArchive.decorators = [
        { type: core.Injectable }
    ];
    VerticalFormationScrollBarPositionArchive.ctorParameters = function () { return []; };

    var ScrollBarPositionSetEventHandler = /** @class */ (function () {
        function ScrollBarPositionSetEventHandler(positionRepository) {
            this.positionRepository = positionRepository;
        }
        ScrollBarPositionSetEventHandler.prototype.forEvent = function () {
            return ScrollBarPositionSetEvent;
        };
        ScrollBarPositionSetEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('ScrollBarPositionSetEvent')) {
                this.positionRepository.next(event.getAggregateId(), event.getPosition());
            }
        };
        return ScrollBarPositionSetEventHandler;
    }());
    ScrollBarPositionSetEventHandler.decorators = [
        { type: core.Injectable }
    ];
    ScrollBarPositionSetEventHandler.ctorParameters = function () { return [
        { type: VerticalFormationScrollBarPositionArchive }
    ]; };

    var SetScrollBarPositionCommandHandler = /** @class */ (function () {
        function SetScrollBarPositionCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetScrollBarPositionCommandHandler.prototype.forCommand = function () {
            return SetScrollBarPositionCommand;
        };
        SetScrollBarPositionCommandHandler.prototype.handle = function (structure, command) {
            var index = command.getPosition();
            structure.scrollToIndex(index);
        };
        SetScrollBarPositionCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publishFromAggregate(aggregate);
        };
        return SetScrollBarPositionCommandHandler;
    }());
    SetScrollBarPositionCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetScrollBarPositionCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var VerticalFormationDomainModule = /** @class */ (function (_super) {
        __extends(VerticalFormationDomainModule, _super);
        function VerticalFormationDomainModule() {
            return _super.call(this) || this;
        }
        VerticalFormationDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SetScrollPositionCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetVerticalScrollEnabledCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetRowHeightBasedOnThemeCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetRowHeightCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(StructureSetHeightCommandHandler, structureKey),
                hermes.HermesModule.registerCommandHandler(SetScrollBarPositionCommandHandler, structureKey)
            ];
        };
        VerticalFormationDomainModule.domainEventHandlers = function () {
            return [
                hermes.HermesModule.registerDomainEventHandler(ScrollBarPositionSetEventHandler)
            ];
        };
        return VerticalFormationDomainModule;
    }(hermes.DomainModule));
    VerticalFormationDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [
                        VerticalFormationFactory
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    VerticalFormationDomainModule.ctorParameters = function () { return []; };

    var VerticalFormationDomainWarehouse = /** @class */ (function (_super) {
        __extends(VerticalFormationDomainWarehouse, _super);
        function VerticalFormationDomainWarehouse(verticalFormationRepository, positionRepository) {
            var _this = _super.call(this) || this;
            _this.verticalFormationRepository = verticalFormationRepository;
            _this.positionRepository = positionRepository;
            return _this;
        }
        VerticalFormationDomainWarehouse.prototype.onVerticalScrollEnabled = function (structureId) {
            return this.verticalFormationRepository.onVerticalScrollEnabled(structureId);
        };
        VerticalFormationDomainWarehouse.prototype.onRowHeight = function (structureId) {
            return this.verticalFormationRepository.onRowHeight(structureId);
        };
        VerticalFormationDomainWarehouse.prototype.onContainerHeight = function (structureId) {
            return this.verticalFormationRepository.onContainerHeight(structureId);
        };
        VerticalFormationDomainWarehouse.prototype.onTopMargin = function (structureId) {
            return this.verticalFormationRepository.onTopMargin(structureId);
        };
        VerticalFormationDomainWarehouse.prototype.onScrollBarPosition = function (structureId) {
            return this.positionRepository.on(structureId);
        };
        return VerticalFormationDomainWarehouse;
    }(VerticalFormationWarehouse));
    VerticalFormationDomainWarehouse.decorators = [
        { type: core.Injectable }
    ];
    VerticalFormationDomainWarehouse.ctorParameters = function () { return [
        { type: VerticalFormationRepository },
        { type: VerticalFormationScrollBarPositionArchive }
    ]; };

    var VerticalFormationApiModule = /** @class */ (function (_super) {
        __extends(VerticalFormationApiModule, _super);
        function VerticalFormationApiModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return VerticalFormationApiModule;
    }(hermes.ApiModule));
    VerticalFormationApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        VerticalFormationDomainModule
                    ],
                    providers: [
                        VerticalFormationConverter,
                        VerticalFormationRepository,
                        {
                            provide: VerticalFormationWarehouse,
                            useClass: VerticalFormationDomainWarehouse
                        },
                        VerticalFormationScrollBarPositionArchive
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var VerticalFormationFeatureModule = /** @class */ (function (_super) {
        __extends(VerticalFormationFeatureModule, _super);
        function VerticalFormationFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        VerticalFormationFeatureModule.forComponent = function () {
            return [];
        };
        return VerticalFormationFeatureModule;
    }(hermes.FeatureModule));
    VerticalFormationFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        VerticalFormationApiModule
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var compositionKey = 'CompositionAggregate';

    var CompositionContainerWidthCalculator = /** @class */ (function () {
        function CompositionContainerWidthCalculator(MIN_COLUMN_WIDTH) {
            this.MIN_COLUMN_WIDTH = MIN_COLUMN_WIDTH;
        }
        CompositionContainerWidthCalculator.prototype.calculateMinWidth = function (columnWidths) {
            var _a = this.segregateColumns(columnWidths), staticColumns = _a.staticColumns, fluidColumns = _a.fluidColumns;
            // TODO reduce
            var sum = 0;
            staticColumns.forEach(function (c) {
                sum += c.getWidth();
            });
            sum += fluidColumns.length * this.MIN_COLUMN_WIDTH;
            return sum;
        };
        CompositionContainerWidthCalculator.prototype.segregateColumns = function (columns) {
            var _this = this;
            var staticColumns = columns.filter(function (columnWidth) { return columnWidth.isTypeNumber() && columnWidth.getWidth() > _this.MIN_COLUMN_WIDTH; }), fluidColumns = columns.filter(function (columnWidth) {
                return columnWidth.isTypeAuto() ||
                    columnWidth.isTypePercentage() ||
                    (columnWidth.isTypeNumber() && columnWidth.getWidth() <= _this.MIN_COLUMN_WIDTH);
            });
            return {
                staticColumns: staticColumns,
                fluidColumns: fluidColumns
            };
        };
        return CompositionContainerWidthCalculator;
    }());

    var CompositionDomainEvent = /** @class */ (function (_super) {
        __extends(CompositionDomainEvent, _super);
        function CompositionDomainEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return CompositionDomainEvent;
    }(hermes.DomainEvent));

    var CompositionWidthSetEvent = /** @class */ (function (_super) {
        __extends(CompositionWidthSetEvent, _super);
        function CompositionWidthSetEvent(compositionId) {
            return _super.call(this, compositionId, null, 'CompositionWidthSetEvent') || this;
        }
        return CompositionWidthSetEvent;
    }(CompositionDomainEvent));

    var CompositionAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionAggregateEvent, _super);
        function CompositionAggregateEvent() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return CompositionAggregateEvent;
    }(hermes.AggregateEvent));

    var CompositionWidthSetAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionWidthSetAggregateEvent, _super);
        function CompositionWidthSetAggregateEvent(aggregateId) {
            return _super.call(this, aggregateId, 'CompositionWidthSetAggregateEvent') || this;
        }
        CompositionWidthSetAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionWidthSetEvent(this.getAggregateId());
        };
        return CompositionWidthSetAggregateEvent;
    }(CompositionAggregateEvent));

    var CompositionContainerWidthSetEvent = /** @class */ (function (_super) {
        __extends(CompositionContainerWidthSetEvent, _super);
        function CompositionContainerWidthSetEvent(compositionId, payload) {
            return _super.call(this, compositionId, payload, 'CompositionContainerWidthSetEvent') || this;
        }
        return CompositionContainerWidthSetEvent;
    }(CompositionDomainEvent));

    var CompositionContainerWidthSetAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionContainerWidthSetAggregateEvent, _super);
        function CompositionContainerWidthSetAggregateEvent(compositionId, containerWidth) {
            var _this = _super.call(this, compositionId, 'CompositionContainerWidthSetAggregateEvent') || this;
            _this.containerWidth = containerWidth;
            return _this;
        }
        CompositionContainerWidthSetAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionContainerWidthSetEvent(this.getAggregateId(), this.containerWidth);
        };
        return CompositionContainerWidthSetAggregateEvent;
    }(CompositionAggregateEvent));

    var CompositionResizeWidthSetEvent = /** @class */ (function (_super) {
        __extends(CompositionResizeWidthSetEvent, _super);
        function CompositionResizeWidthSetEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'CompositionResizeWidthSetEvent') || this;
        }
        return CompositionResizeWidthSetEvent;
    }(CompositionDomainEvent));

    var CompositionResizeWidthSetAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionResizeWidthSetAggregateEvent, _super);
        function CompositionResizeWidthSetAggregateEvent(compositionId) {
            return _super.call(this, compositionId, 'CompositionResizeWidthSetAggregateEvent') || this;
        }
        CompositionResizeWidthSetAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionResizeWidthSetEvent(this.getAggregateId());
        };
        return CompositionResizeWidthSetAggregateEvent;
    }(CompositionAggregateEvent));

    var CompositionColumnSetEnabledEvent = /** @class */ (function (_super) {
        __extends(CompositionColumnSetEnabledEvent, _super);
        function CompositionColumnSetEnabledEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'CompositionColumnSetEnabledEvent') || this;
        }
        return CompositionColumnSetEnabledEvent;
    }(CompositionDomainEvent));

    var CompositionColumnSetEnabledAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionColumnSetEnabledAggregateEvent, _super);
        function CompositionColumnSetEnabledAggregateEvent(aggregateId, activeColumns) {
            var _this = _super.call(this, aggregateId, 'CompositionColumnSetEnabledAggregateEvent') || this;
            _this.activeColumns = activeColumns;
            return _this;
        }
        CompositionColumnSetEnabledAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionColumnSetEnabledEvent(this.getAggregateId());
        };
        CompositionColumnSetEnabledAggregateEvent.prototype.getActiveColumns = function () {
            return this.activeColumns;
        };
        return CompositionColumnSetEnabledAggregateEvent;
    }(CompositionAggregateEvent));

    var ColumnWidthType;
    (function (ColumnWidthType) {
        ColumnWidthType[ColumnWidthType["PERCENTAGE"] = 0] = "PERCENTAGE";
        ColumnWidthType[ColumnWidthType["NUMBER"] = 1] = "NUMBER";
        ColumnWidthType[ColumnWidthType["AUTO"] = 2] = "AUTO";
    })(ColumnWidthType || (ColumnWidthType = {}));

    var ColumnWidth = /** @class */ (function () {
        function ColumnWidth(width) {
            this.baseWidth = width;
            this.setWidthAndType(width);
        }
        ColumnWidth.prototype.getWidth = function () {
            return this.width;
        };
        ColumnWidth.prototype.getColumnType = function () {
            return this.template;
        };
        ColumnWidth.prototype.isTypePercentage = function () {
            return this.template === ColumnWidthType.PERCENTAGE;
        };
        ColumnWidth.prototype.isTypeAuto = function () {
            return this.template === ColumnWidthType.AUTO;
        };
        ColumnWidth.prototype.isTypeNumber = function () {
            return this.template === ColumnWidthType.NUMBER;
        };
        ColumnWidth.prototype.setWidth = function (width) {
            this.width = width;
        };
        ColumnWidth.prototype.setWidthAndType = function (width) {
            if (width === undefined || width === null || width === 'auto') {
                this.template = ColumnWidthType.AUTO;
                this.setWidth(null);
            }
            else if (this.isPercentage(width)) {
                this.template = ColumnWidthType.PERCENTAGE;
                this.setWidth(this.percentageToNumber('' + width));
            }
            else if (this.isStringNumber(width)) {
                this.template = ColumnWidthType.NUMBER;
                this.setWidth(+width);
            }
            else {
                this.template = ColumnWidthType.NUMBER;
                this.setWidth(+width);
            }
        };
        ColumnWidth.prototype.clone = function () {
            return new ColumnWidth(this.baseWidth);
        };
        ColumnWidth.prototype.isPercentage = function (width) {
            return typeof width === 'string' && width[width.length - 1] === '%';
        };
        /**
         * Width needs to be in format '89%'
         * @param width
         */
        ColumnWidth.prototype.percentageToNumber = function (width) {
            return +(width.slice(0, -1));
        };
        ColumnWidth.prototype.isStringNumber = function (width) {
            var widthAsNumber = +width;
            return Number.isNaN(widthAsNumber);
        };
        return ColumnWidth;
    }());

    var CompositionWidthCalculator = /** @class */ (function () {
        function CompositionWidthCalculator(source, width, MIN_COLUMN_WIDTH) {
            this.source = source;
            this.width = width;
            this.MIN_COLUMN_WIDTH = MIN_COLUMN_WIDTH;
            this.columns = this.source.map(function (c) { return c.clone(); });
        }
        CompositionWidthCalculator.prototype.calculate = function () {
            var width = this.width, columns = Array.from(this.columns);
            // adjust min value
            this.adjustMinimalWidth(columns);
            // remove number columns
            var newColumns = [];
            columns.forEach(function (column, index) {
                if (column.isTypeNumber()) {
                    width -= column.getWidth();
                }
                else {
                    newColumns.push(column);
                }
            });
            columns = newColumns;
            // split even auto columns
            if (columns.length !== 0) {
                var evenWidth_1 = width / columns.length;
                columns.forEach(function (column, index) {
                    column.setWidth(evenWidth_1);
                });
            }
            // adjust number columns
            // let numberColumns = this.columns.filter((columnWidth: ColumnWidth) => columnWidth.isTypeNumber());
            //
            // // sort by min values
            // numberColumns.sort((columnOne: ColumnWidth, columnTwo: ColumnWidth) => {
            // 	return columnOne.getWidth() - columnTwo.getWidth();
            // });
            //
            // numberColumns.forEach(() => {
            // });
            // this.adjustMinimalWidth(ColumnWidthType.NUMBER);
            //
            // this.adjustPercentageWidth();
            //
            // this.adjustAutoWidth();
            return this.columns;
        };
        CompositionWidthCalculator.prototype.adjustMinimalWidth = function (columns) {
            var _this = this;
            columns.forEach(function (column) {
                if (column.isTypeNumber()) {
                    if (column.getWidth() < _this.MIN_COLUMN_WIDTH) {
                        column.setWidthAndType(_this.MIN_COLUMN_WIDTH);
                    }
                }
            });
        };
        CompositionWidthCalculator.prototype.adjustPercentageWidth = function () {
            var e_1, _a;
            var percentageColumns = this.columns.filter(function (columnWidth) { return columnWidth.isTypePercentage(); });
            try {
                for (var _b = __values(this.columns), _c = _b.next(); !_c.done; _c = _b.next()) {
                    var column = _c.value;
                    if (column.getColumnType() === ColumnWidthType.PERCENTAGE) {
                        column.setWidth(this.width * column.getWidth() * 0.01);
                    }
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                }
                finally { if (e_1) throw e_1.error; }
            }
        };
        CompositionWidthCalculator.prototype.adjustAutoWidth = function () {
            var e_2, _a;
            var leftWidth = this.width;
            var autoColumns = [];
            for (var i = 0; i < this.columns.length; i += 1) {
                var column = this.columns[i];
                if (column.getColumnType() !== ColumnWidthType.AUTO) {
                    leftWidth -= column.getWidth();
                }
                else {
                    autoColumns.push(column);
                }
            }
            if (autoColumns.length > 0) {
                var splitWidth = leftWidth / autoColumns.length;
                try {
                    for (var autoColumns_1 = __values(autoColumns), autoColumns_1_1 = autoColumns_1.next(); !autoColumns_1_1.done; autoColumns_1_1 = autoColumns_1.next()) {
                        var column = autoColumns_1_1.value;
                        column.setWidth(splitWidth);
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (autoColumns_1_1 && !autoColumns_1_1.done && (_a = autoColumns_1.return)) _a.call(autoColumns_1);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
        };
        return CompositionWidthCalculator;
    }());

    var ColumnWidthCollection = /** @class */ (function () {
        function ColumnWidthCollection(MIN_COLUMN_WIDTH, columns, width) {
            if (columns === void 0) { columns = []; }
            if (width === void 0) { width = 100; }
            this.MIN_COLUMN_WIDTH = MIN_COLUMN_WIDTH;
            this.baseColumnWidths = columns.map(function (column) { return new ColumnWidth(column.width); });
            this.columnWidths = columns.map(function (column) { return new ColumnWidth(column.width); });
            this.setContainerWidth(width);
            this.calculate();
        }
        ColumnWidthCollection.prototype.getColumnWidths = function () {
            return this.baseColumnWidths;
        };
        ColumnWidthCollection.prototype.getColumnsWidth = function () {
            return this.width;
        };
        ColumnWidthCollection.prototype.getWidths = function () {
            return this.columnWidths.map(function (c) { return c.getWidth(); });
        };
        ColumnWidthCollection.prototype.getMinWidth = function () {
            var calculator = new CompositionContainerWidthCalculator(this.MIN_COLUMN_WIDTH);
            return calculator.calculateMinWidth(this.columnWidths);
        };
        ColumnWidthCollection.prototype.setWidth = function (width) {
            this.setContainerWidth(width);
            this.calculate();
        };
        ColumnWidthCollection.prototype.setColumns = function (columnConfigs) {
            this.baseColumnWidths = columnConfigs.map(function (column) { return new ColumnWidth(column.width); });
            this.columnWidths = columnConfigs.map(function (column) { return new ColumnWidth(column.width); });
            this.calculate();
        };
        ColumnWidthCollection.prototype.getMinColumnWidth = function () {
            return this.MIN_COLUMN_WIDTH;
        };
        ColumnWidthCollection.prototype.calculate = function () {
            if (this.baseColumnWidths && this.width) {
                var calculator = new CompositionWidthCalculator(this.baseColumnWidths, this.width, this.MIN_COLUMN_WIDTH);
                this.columnWidths = calculator.calculate();
            }
        };
        ColumnWidthCollection.prototype.setContainerWidth = function (width) {
            if (this.getMinWidth() > width) {
                this.width = this.getMinWidth();
            }
            else {
                this.width = width;
            }
            this.calculate();
        };
        return ColumnWidthCollection;
    }());

    var CompositionChangeSortStatusEvent = /** @class */ (function (_super) {
        __extends(CompositionChangeSortStatusEvent, _super);
        function CompositionChangeSortStatusEvent(aggregateId, activeColumns) {
            var _this = _super.call(this, aggregateId, activeColumns, 'CompositionChangeSortStatusEvent') || this;
            _this.activeColumns = activeColumns;
            return _this;
        }
        CompositionChangeSortStatusEvent.prototype.getCompositionId = function () {
            return this.getAggregateId();
        };
        CompositionChangeSortStatusEvent.prototype.getActiveColumns = function () {
            return this.activeColumns;
        };
        return CompositionChangeSortStatusEvent;
    }(CompositionDomainEvent));

    var CompositionChangeSortStatusAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionChangeSortStatusAggregateEvent, _super);
        function CompositionChangeSortStatusAggregateEvent(aggregateId, activeColumns) {
            var _this = _super.call(this, aggregateId, 'CompositionChangeSortStatusAggregateEvent') || this;
            _this.activeColumns = activeColumns;
            return _this;
        }
        CompositionChangeSortStatusAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionChangeSortStatusEvent(this.getAggregateId(), this.activeColumns);
        };
        return CompositionChangeSortStatusAggregateEvent;
    }(CompositionAggregateEvent));

    var ActiveColumnContainer = /** @class */ (function () {
        function ActiveColumnContainer(compositionId, columns, gridWidth, columnConfigs) {
            if (columns === void 0) { columns = []; }
            this.compositionId = compositionId;
            this.MIN_COLUMN_WIDTH = 50;
            /**
             * Columns taken from user config.
             * This should not be modified and it should be used as a reference point.
             */
            this.columnWidthCollection = new ColumnWidthCollection(this.MIN_COLUMN_WIDTH);
            this.columns = columns;
            if (gridWidth && columnConfigs) {
                this.columnWidthCollection = new ColumnWidthCollection(this.MIN_COLUMN_WIDTH, columnConfigs, gridWidth);
            }
        }
        ActiveColumnContainer.prototype.getColumnWidths = function () {
            return this.columnWidthCollection.getColumnWidths();
        };
        // REMOVE
        ActiveColumnContainer.prototype.getColumns = function () {
            return this.columns;
        };
        ActiveColumnContainer.prototype.setWidth = function (width) {
            this.columnWidthCollection.setWidth(width);
        };
        ActiveColumnContainer.prototype.addColumn = function (column, index) {
            this.columns.splice(index, 0, column);
        };
        ActiveColumnContainer.prototype.removeColumn = function (index) {
            this.columns.splice(index, 1);
        };
        ActiveColumnContainer.prototype.setColumns = function (columns, columnConfigs) {
            this.columns = columns;
            this.columnWidthCollection.setColumns(columnConfigs);
            var updatedWidths = this.columnWidthCollection.getWidths();
            this.columns.forEach(function (column, index) {
                column.setWidth(updatedWidths[index]);
            });
            // TODO
            // this.addEvent(new ColumnsSetAggregateEvent(this.getId(), columns));
        };
        ActiveColumnContainer.prototype.changeSort = function (sortParams) {
            var e_1, _a;
            this.columns.forEach(function (column) {
                column.setSortStatus(exports["ɵnr"].NONE);
            });
            var _loop_1 = function (param) {
                var fieldId = param.fieldId, direction = param.direction, sortStatus = direction ? exports["ɵnr"].ASC : exports["ɵnr"].DESC;
                var columns = this_1.columns.filter(function (column) {
                    return column.getField().getId().getId() === fieldId.getId();
                });
                if (columns.length > 0) {
                    columns.forEach(function (column) {
                        column.setSortStatus(sortStatus);
                    });
                }
            };
            var this_1 = this;
            try {
                for (var sortParams_1 = __values(sortParams), sortParams_1_1 = sortParams_1.next(); !sortParams_1_1.done; sortParams_1_1 = sortParams_1.next()) {
                    var param = sortParams_1_1.value;
                    _loop_1(param);
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (sortParams_1_1 && !sortParams_1_1.done && (_a = sortParams_1.return)) _a.call(sortParams_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
            return new CompositionChangeSortStatusAggregateEvent(this.getCompositionId(), this.columns);
        };
        ActiveColumnContainer.prototype.moveLeft = function (columnId) {
            var index = this.findColumnIndex(columnId);
            this.move(index, index - 1);
        };
        ActiveColumnContainer.prototype.moveRight = function (columnId) {
            var index = this.findColumnIndex(columnId);
            this.move(index, index + 1);
        };
        ActiveColumnContainer.prototype.getMinColumnWidth = function () {
            return this.MIN_COLUMN_WIDTH;
        };
        ActiveColumnContainer.prototype.move = function (fromIndex, toIndex) {
            if (!this.validateMoveIndex(fromIndex) || !this.validateMoveIndex(toIndex)) {
                return;
            }
            var column = this.columns[fromIndex];
            this.columns[fromIndex] = this.columns[toIndex];
            this.columns[toIndex] = column;
        };
        ActiveColumnContainer.prototype.validateMoveIndex = function (index) {
            return index >= 0;
        };
        ActiveColumnContainer.prototype.getCompositionId = function () {
            return this.compositionId;
        };
        ActiveColumnContainer.prototype.findColumnIndex = function (columnId) {
            return this.columns.findIndex(function (c) { return c.getId().equals(columnId); });
        };
        return ActiveColumnContainer;
    }());

    var CellView;
    (function (CellView) {
        CellView[CellView["TEXT"] = 0] = "TEXT";
        CellView[CellView["NUMBER"] = 1] = "NUMBER";
        CellView[CellView["CHIP"] = 2] = "CHIP";
        CellView[CellView["LINK"] = 3] = "LINK";
        CellView[CellView["IMAGE"] = 4] = "IMAGE";
        CellView[CellView["BOLD"] = 5] = "BOLD";
        CellView[CellView["ITALIC"] = 6] = "ITALIC";
        CellView[CellView["CHECKBOX"] = 7] = "CHECKBOX";
        CellView[CellView["CUSTOM"] = 8] = "CUSTOM";
        CellView[CellView["FUNCTION"] = 9] = "FUNCTION";
        CellView[CellView["DATE"] = 10] = "DATE";
        CellView[CellView["BAR"] = 11] = "BAR";
        CellView[CellView["PERCENTAGE_BAR"] = 12] = "PERCENTAGE_BAR";
        CellView[CellView["PERCENTAGE"] = 13] = "PERCENTAGE";
        CellView[CellView["NG_TEMPLATE"] = 14] = "NG_TEMPLATE";
    })(CellView || (CellView = {}));

    var ViewEntity = /** @class */ (function () {
        function ViewEntity(cellView) {
            this.templateFunction = function (cellValue, item) { return cellValue; };
            if (typeof cellView === 'function') {
                this.view = CellView.FUNCTION;
                this.templateFunction = cellView;
            }
            else {
                this.view = cellView;
            }
        }
        ViewEntity.fromDataType = function (dataType) {
            if (dataType === DataType.DATE) {
                return new ViewEntity(CellView.DATE);
            }
            else {
                return new ViewEntity(CellView.TEXT);
            }
        };
        ViewEntity.prototype.getCellView = function () {
            return this.view;
        };
        ViewEntity.prototype.getTemplateFunction = function () {
            return this.templateFunction;
        };
        return ViewEntity;
    }());

    var AbstractColumnEntity = /** @class */ (function (_super) {
        __extends(AbstractColumnEntity, _super);
        function AbstractColumnEntity(columnId, columnField, columnConfig, presentation, header, align, view, width) {
            var _this = _super.call(this, columnId) || this;
            _this.columnField = columnField;
            _this.columnConfig = columnConfig;
            _this.presentation = presentation;
            _this.view = ViewEntity.fromDataType(columnField.getDataType());
            if (header) {
                _this.header = header;
            }
            if (view) {
                _this.view = view;
            }
            if (width) {
                _this.width = width;
            }
            _this.setInitialAlign(columnField, align);
            return _this;
        }
        AbstractColumnEntity.prototype.getPresentation = function () {
            return this.presentation;
        };
        AbstractColumnEntity.prototype.getColumnConfig = function () {
            return this.columnConfig;
        };
        AbstractColumnEntity.prototype.getField = function () {
            return this.columnField;
        };
        AbstractColumnEntity.prototype.getHeader = function () {
            return this.header;
        };
        AbstractColumnEntity.prototype.getDataType = function () {
            return this.columnField.getDataType();
        };
        AbstractColumnEntity.prototype.getCellView = function () {
            return this.view.getCellView();
        };
        AbstractColumnEntity.prototype.getTemplateFunction = function () {
            return this.view.getTemplateFunction();
        };
        AbstractColumnEntity.prototype.getFormatterFunction = function () {
            return this.columnConfig.formatter;
        };
        AbstractColumnEntity.prototype.setView = function (view) {
            this.view = view;
        };
        AbstractColumnEntity.prototype.setHeader = function (header) {
            this.header = header;
        };
        AbstractColumnEntity.prototype.getView = function () {
            return this.view;
        };
        AbstractColumnEntity.prototype.getAlign = function () {
            return this.align;
        };
        AbstractColumnEntity.prototype.setWidth = function (width) {
            this.width = width;
        };
        AbstractColumnEntity.prototype.getWidth = function () {
            return this.width;
        };
        AbstractColumnEntity.prototype.isSortingEnabled = function () {
            var config = this.columnConfig;
            if (config.sorting !== undefined && config.sorting !== null) {
                if (config.sorting.enabled === undefined || config.sorting.enabled === null) {
                    return true;
                }
                return config.sorting.enabled;
            }
            return true;
        };
        AbstractColumnEntity.prototype.isCellEditingEnabled = function () {
            var config = this.columnConfig;
            if (config.cellEditing !== undefined && config.cellEditing !== null) {
                if (config.cellEditing.enabled === undefined || config.cellEditing.enabled === null) {
                    return true;
                }
                return config.cellEditing.enabled;
            }
            return true;
        };
        AbstractColumnEntity.prototype.setInitialAlign = function (columnField, align) {
            if (align !== undefined && align !== null) {
                this.align = align;
            }
            else if (columnField.getDataType() === DataType.NUMBER) {
                this.align = exports["ɵns"].RIGHT;
            }
            else {
                this.align = exports["ɵns"].LEFT;
            }
        };
        return AbstractColumnEntity;
    }(hermes.Entity));

    var ColumnEntity = /** @class */ (function (_super) {
        __extends(ColumnEntity, _super);
        function ColumnEntity(columnId, columnField, columnConfig, enabled, presentation, header, align, view, width) {
            var _this = _super.call(this, columnId, columnField, columnConfig, presentation, header, align, view, width) || this;
            _this.sortStatus = exports["ɵnr"].NONE;
            _this.enabled = true;
            _this.enabled = enabled;
            if (view === undefined) {
                _this.view = new ViewEntity(_this.presentation.getDefaultView());
            }
            if (align === undefined) {
                _this.align = _this.presentation.getDefaultAlign(_this.view);
            }
            return _this;
        }
        ColumnEntity.prototype.isEnabled = function () {
            return this.enabled;
        };
        ColumnEntity.prototype.setEnabled = function (enabled) {
            this.enabled = enabled;
        };
        ColumnEntity.prototype.getSortStatus = function () {
            return this.sortStatus;
        };
        ColumnEntity.prototype.setSortStatus = function (status) {
            this.sortStatus = status;
        };
        return ColumnEntity;
    }(AbstractColumnEntity));

    var ActiveColumnEntity = /** @class */ (function (_super) {
        __extends(ActiveColumnEntity, _super);
        function ActiveColumnEntity(columnId, columnField, header, align, view, config, presentation) {
            return _super.call(this, columnId, columnField, config, true, presentation, header, align, view, undefined) || this;
        }
        ActiveColumnEntity.fromEntity = function (entity) {
            return new ActiveColumnEntity(entity.getId(), entity.getField(), entity.getHeader(), entity.getAlign(), entity.getView(), entity.getColumnConfig(), entity.getPresentation());
        };
        return ActiveColumnEntity;
    }(ColumnEntity));

    var ActiveColumnEntityConverter = /** @class */ (function () {
        function ActiveColumnEntityConverter() {
        }
        ActiveColumnEntityConverter.prototype.convertMany = function (entities) {
            var _this = this;
            return entities.map(function (e) { return _this.convert(e); });
        };
        ActiveColumnEntityConverter.prototype.convert = function (entity) {
            return ActiveColumnEntity.fromEntity(entity);
        };
        return ActiveColumnEntityConverter;
    }());

    var CompositionColumnMovedLeftEvent = /** @class */ (function (_super) {
        __extends(CompositionColumnMovedLeftEvent, _super);
        function CompositionColumnMovedLeftEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'CompositionColumnMovedLeftEvent') || this;
        }
        return CompositionColumnMovedLeftEvent;
    }(CompositionDomainEvent));

    var CompositionColumnMovedLeftAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionColumnMovedLeftAggregateEvent, _super);
        function CompositionColumnMovedLeftAggregateEvent(aggregateId, activeColumns) {
            var _this = _super.call(this, aggregateId, 'CompositionColumnMovedLeftAggregateEvent') || this;
            _this.activeColumns = activeColumns;
            return _this;
        }
        // getActiveColumns(): Array<ActiveColumnEntity> {
        // 	return this.activeColumns;
        // }
        CompositionColumnMovedLeftAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionColumnMovedLeftEvent(this.getAggregateId());
        };
        return CompositionColumnMovedLeftAggregateEvent;
    }(CompositionAggregateEvent));

    var CompositionColumnMovedRightEvent = /** @class */ (function (_super) {
        __extends(CompositionColumnMovedRightEvent, _super);
        function CompositionColumnMovedRightEvent(aggregateId) {
            return _super.call(this, aggregateId, null, 'CompositionColumnMovedRightEvent') || this;
        }
        return CompositionColumnMovedRightEvent;
    }(CompositionDomainEvent));

    var CompositionColumnMovedRightAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionColumnMovedRightAggregateEvent, _super);
        function CompositionColumnMovedRightAggregateEvent(aggregateId, activeColumns) {
            var _this = _super.call(this, aggregateId, 'CompositionColumnMovedRightAggregateEvent') || this;
            _this.activeColumns = activeColumns;
            return _this;
        }
        // getActiveColumns(): Array<ActiveColumnEntity> {
        // 	return this.activeColumns;
        // }
        CompositionColumnMovedRightAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionColumnMovedRightEvent(this.getAggregateId());
        };
        return CompositionColumnMovedRightAggregateEvent;
    }(CompositionAggregateEvent));

    var CompositionColumnsSetEvent = /** @class */ (function (_super) {
        __extends(CompositionColumnsSetEvent, _super);
        function CompositionColumnsSetEvent(compositionId) {
            return _super.call(this, compositionId, null, 'CompositionColumnsSetEvent') || this;
        }
        return CompositionColumnsSetEvent;
    }(CompositionDomainEvent));

    var ColumnsSetAggregateEvent = /** @class */ (function (_super) {
        __extends(ColumnsSetAggregateEvent, _super);
        function ColumnsSetAggregateEvent(compositionId) {
            return _super.call(this, compositionId, 'ColumnsSetAggregateEvent') || this;
        }
        ColumnsSetAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionColumnsSetEvent(this.getAggregateId());
        };
        return ColumnsSetAggregateEvent;
    }(CompositionAggregateEvent));

    var CompositionCreatedEvent = /** @class */ (function (_super) {
        __extends(CompositionCreatedEvent, _super);
        function CompositionCreatedEvent(compositionId) {
            return _super.call(this, compositionId, null, 'CompositionCreatedEvent') || this;
        }
        return CompositionCreatedEvent;
    }(CompositionDomainEvent));

    var CompositionCreatedAggregateEvent = /** @class */ (function (_super) {
        __extends(CompositionCreatedAggregateEvent, _super);
        function CompositionCreatedAggregateEvent(compositionId) {
            return _super.call(this, compositionId, 'SchemaCreatedEvent') || this;
        }
        CompositionCreatedAggregateEvent.prototype.toDomainEvent = function () {
            return new CompositionCreatedEvent(this.getAggregateId());
        };
        return CompositionCreatedAggregateEvent;
    }(CompositionAggregateEvent));

    var Group = /** @class */ (function () {
        function Group(id, header, width) {
            this.id = id;
            this.header = header;
            this.width = width;
        }
        return Group;
    }());

    var GroupId = /** @class */ (function (_super) {
        __extends(GroupId, _super);
        function GroupId(id) {
            return _super.call(this, id) || this;
        }
        GroupId.prototype.toString = function () {
            return this.getId();
        };
        return GroupId;
    }(hermes.HermesId));

    var emptyGroup = new Group(new GroupId('-1'), '', 100);

    var CompositionAggregate = /** @class */ (function (_super) {
        __extends(CompositionAggregate, _super);
        function CompositionAggregate(id, columnFactory, groupFactory, columnsParams, width, resizeWidth) {
            if (columnsParams === void 0) { columnsParams = []; }
            var _this = _super.call(this, id, 'CompositionAggregate') || this;
            _this.allColumns = [];
            _this.resizeWidthEnabled = true;
            _this.activeColumnEntityConverter = new ActiveColumnEntityConverter();
            _this.groups = new hermes.KeyMap();
            _this.columnNameToGroupId = new Map();
            var columnConfigs = columnsParams.map(function (param) { return param.getColumn(); });
            _this.baseParams = columnsParams;
            _this.baseColumns = columnConfigs;
            _this.columnFactory = columnFactory;
            _this.groupFactory = groupFactory;
            _this.width = width;
            _this.allColumns = _this.columnFactory.create(columnsParams);
            var activeColumns = _this.activeColumnEntityConverter.convertMany(_this.getEnabledColumns());
            _this.activeColumnContainer = new ActiveColumnContainer(_this.getId(), activeColumns, width, columnConfigs);
            if (resizeWidth !== undefined && resizeWidth !== null) {
                _this.resizeWidthEnabled = resizeWidth;
            }
            return _this;
        }
        CompositionAggregate.prototype.createEvent = function () {
            return CompositionCreatedAggregateEvent;
        };
        // REMOVE
        CompositionAggregate.prototype.getColumns = function () {
            return this.allColumns;
        };
        // REMOVE
        CompositionAggregate.prototype.getActiveColumns = function () {
            return this.activeColumnContainer.getColumns();
        };
        // make private
        CompositionAggregate.prototype.getWidth = function () {
            if (this.resizeWidthEnabled) {
                return this.containerInDOMWidth;
            }
            else {
                return this.width;
            }
        };
        // REMOVE
        CompositionAggregate.prototype.isResizeEnabled = function () {
            return this.resizeWidthEnabled;
        };
        // REMOVE
        CompositionAggregate.prototype.isReady = function () {
            return !!this.getWidth() && this.getActiveColumns().length > 0;
        };
        CompositionAggregate.prototype.setGroups = function (configs) {
            var _this = this;
            var _loop_1 = function (i) {
                var config = configs[i];
                if (config.columns !== undefined) {
                    var group_1 = this_1.groupFactory.create(config);
                    this_1.groups.set(group_1.id, group_1);
                    config.columns.forEach(function (c, index) {
                        _this.columnNameToGroupId.set(c.header, group_1.id);
                    });
                }
                else {
                    this_1.columnNameToGroupId.set(config.header, emptyGroup.id);
                }
            };
            var this_1 = this;
            for (var i = 0; i < configs.length; i += 1) {
                _loop_1(i);
            }
        };
        CompositionAggregate.prototype.setColumns = function (params) {
            this.allColumns = this.columnFactory.create(params);
            var columnConfigs = params.map(function (param) { return param.getColumn(); });
            var activeColumns = this.activeColumnEntityConverter.convertMany(this.getEnabledColumns());
            this.activeColumnContainer.setColumns(activeColumns, columnConfigs);
            this.addEvent(new ColumnsSetAggregateEvent(this.getId()));
        };
        CompositionAggregate.prototype.setContainerWidth = function (containerWidth) {
            this.setContainerWidthWithEvent(containerWidth);
            this.recalculateColumns();
        };
        CompositionAggregate.prototype.setWidth = function (width) {
            this.setWidthWithEvent(width);
            this.setResizeWidthWithEvent(false);
            this.recalculateColumns();
        };
        CompositionAggregate.prototype.setResizeWidth = function (enabled) {
            this.setResizeWidthWithEvent(enabled);
        };
        CompositionAggregate.prototype.changeSort = function (sortParams) {
            this.addEvent(this.activeColumnContainer.changeSort(sortParams));
        };
        // DELEGATE
        CompositionAggregate.prototype.enableColumn = function (columnId, enabled) {
            var enabledIndex = -1;
            this.allColumns.forEach(function (column, index) {
                if (column.getId().getId() === columnId.getId()) {
                    var prevState = column.isEnabled();
                    column.setEnabled(enabled);
                    if (prevState !== enabled) {
                        enabledIndex = index;
                    }
                }
            });
            if (enabledIndex > 0) {
                if (enabled) {
                    // convert
                    var columnToAdd = this.activeColumnEntityConverter.convert(this.allColumns[enabledIndex]);
                    this.activeColumnContainer.addColumn(columnToAdd, enabledIndex);
                }
                else {
                    this.activeColumnContainer.removeColumn(enabledIndex);
                }
            }
            this.recalculateColumns();
            this.addEvent(new CompositionColumnSetEnabledAggregateEvent(this.getId(), this.getActiveColumns()));
        };
        CompositionAggregate.prototype.moveLeft = function (columnId) {
            var columnIndex = this.findColumnIndex(columnId);
            var nextLeft, nextLeftIndex = -1;
            for (var i = columnIndex - 1; i >= 0; i -= 1) {
                var leftColumn = this.allColumns[i];
                if (leftColumn.isEnabled()) {
                    nextLeft = leftColumn;
                    nextLeftIndex = i;
                    break;
                }
            }
            if (nextLeft && nextLeftIndex >= 0 && columnIndex >= 0) {
                var column = this.allColumns[columnIndex];
                this.allColumns[columnIndex] = nextLeft;
                this.allColumns[nextLeftIndex] = column;
            }
            this.activeColumnContainer.moveLeft(columnId);
            this.addEvent(new CompositionColumnMovedLeftAggregateEvent(this.getId(), this.getActiveColumns()));
        };
        CompositionAggregate.prototype.moveRight = function (columnId) {
            var columnIndex = this.findColumnIndex(columnId);
            var nextRight, nextRightIndex = -1;
            for (var i = columnIndex + 1; i < this.allColumns.length; i += 1) {
                var rightColumn = this.allColumns[i];
                if (rightColumn.isEnabled()) {
                    nextRight = rightColumn;
                    nextRightIndex = i;
                    break;
                }
            }
            if (nextRight && nextRightIndex >= 0 && columnIndex >= 0) {
                var column = this.allColumns[columnIndex];
                this.allColumns[columnIndex] = nextRight;
                this.allColumns[nextRightIndex] = column;
            }
            this.activeColumnContainer.moveRight(columnId);
            this.addEvent(new CompositionColumnMovedRightAggregateEvent(this.getId(), this.getActiveColumns()));
        };
        CompositionAggregate.prototype.recalculateColumns = function () {
            var activeColumns = this.activeColumnEntityConverter.convertMany(this.getEnabledColumns());
            this.activeColumnContainer.setColumns(activeColumns, activeColumns.map(function (c) { return c.getColumnConfig(); }));
        };
        // TODO Refactor
        CompositionAggregate.prototype.setWidthWithEvent = function (width) {
            var calculator = new CompositionContainerWidthCalculator(this.getMinColumnWidth());
            var minWidth = calculator.calculateMinWidth(this.activeColumnContainer.getColumnWidths());
            if (minWidth > width) {
                this.width = minWidth;
            }
            else {
                this.width = width;
            }
            this.activeColumnContainer.setWidth(this.getWidth());
            this.addEvent(new CompositionWidthSetAggregateEvent(this.getId()));
        };
        // TODO Refactor
        CompositionAggregate.prototype.setContainerWidthWithEvent = function (containerWidth) {
            var calculator = new CompositionContainerWidthCalculator(this.getMinColumnWidth());
            var minWidth = calculator.calculateMinWidth(this.activeColumnContainer.getColumnWidths());
            if (minWidth > containerWidth) {
                this.containerInDOMWidth = minWidth;
            }
            else {
                this.containerInDOMWidth = containerWidth;
            }
            this.activeColumnContainer.setWidth(this.getWidth());
            this.addEvent(new CompositionContainerWidthSetAggregateEvent(this.getId(), containerWidth));
        };
        CompositionAggregate.prototype.setResizeWidthWithEvent = function (enabled) {
            this.resizeWidthEnabled = enabled;
            this.activeColumnContainer.setWidth(this.getWidth());
            this.addEvent(new CompositionResizeWidthSetAggregateEvent(this.getId()));
        };
        // REMOVE -> move to allColumnsContainer
        CompositionAggregate.prototype.getEnabledColumns = function () {
            return this.allColumns.filter(function (c) { return c.isEnabled(); });
        };
        CompositionAggregate.prototype.findColumnIndex = function (columnId) {
            return this.allColumns.findIndex(function (column) { return column.getId().equals(columnId); });
        };
        CompositionAggregate.prototype.getMinColumnWidth = function () {
            return this.activeColumnContainer.getMinColumnWidth();
        };
        return CompositionAggregate;
    }(hermes.AggregateRoot));

    var ColumnPresentation = /** @class */ (function () {
        function ColumnPresentation() {
        }
        return ColumnPresentation;
    }());

    var NumberColumnPresentation = /** @class */ (function (_super) {
        __extends(NumberColumnPresentation, _super);
        function NumberColumnPresentation() {
            return _super.call(this) || this;
        }
        NumberColumnPresentation.getInstance = function () {
            if (!NumberColumnPresentation.instance) {
                NumberColumnPresentation.instance = new NumberColumnPresentation();
            }
            return NumberColumnPresentation.instance;
        };
        NumberColumnPresentation.prototype.getPossibleViews = function () {
            return [
                CellView.TEXT,
                CellView.BAR,
                CellView.PERCENTAGE_BAR,
                CellView.PERCENTAGE
            ];
        };
        NumberColumnPresentation.prototype.getDefaultView = function () {
            return CellView.NUMBER;
        };
        NumberColumnPresentation.prototype.getDefaultAlign = function (view) {
            return exports["ɵns"].RIGHT;
        };
        return NumberColumnPresentation;
    }(ColumnPresentation));
    NumberColumnPresentation.instance = null;

    var BooleanColumnPresentation = /** @class */ (function (_super) {
        __extends(BooleanColumnPresentation, _super);
        function BooleanColumnPresentation() {
            return _super.call(this) || this;
        }
        BooleanColumnPresentation.getInstance = function () {
            if (!BooleanColumnPresentation.instance) {
                BooleanColumnPresentation.instance = new BooleanColumnPresentation();
            }
            return BooleanColumnPresentation.instance;
        };
        BooleanColumnPresentation.prototype.getPossibleViews = function () {
            return [
                CellView.TEXT,
                CellView.ITALIC,
                CellView.CHIP,
                CellView.BOLD,
                CellView.CHECKBOX
            ];
        };
        BooleanColumnPresentation.prototype.getDefaultView = function () {
            return CellView.TEXT;
        };
        BooleanColumnPresentation.prototype.getDefaultAlign = function (view) {
            if (view.getCellView() === CellView.CHECKBOX) {
                return exports["ɵns"].CENTER;
            }
            else {
                return exports["ɵns"].LEFT;
            }
        };
        return BooleanColumnPresentation;
    }(ColumnPresentation));
    BooleanColumnPresentation.instance = null;

    var DateColumnPresentation = /** @class */ (function (_super) {
        __extends(DateColumnPresentation, _super);
        function DateColumnPresentation() {
            return _super.call(this) || this;
        }
        DateColumnPresentation.getInstance = function () {
            if (!DateColumnPresentation.instance) {
                DateColumnPresentation.instance = new DateColumnPresentation();
            }
            return DateColumnPresentation.instance;
        };
        DateColumnPresentation.prototype.getPossibleViews = function () {
            return [
                CellView.DATE,
                CellView.TEXT,
                CellView.ITALIC,
                CellView.BOLD,
                CellView.CHIP
            ];
        };
        DateColumnPresentation.prototype.getDefaultView = function () {
            return CellView.DATE;
        };
        DateColumnPresentation.prototype.getDefaultAlign = function () {
            return exports["ɵns"].LEFT;
        };
        return DateColumnPresentation;
    }(ColumnPresentation));
    DateColumnPresentation.instance = null;

    var StringColumnPresentation = /** @class */ (function (_super) {
        __extends(StringColumnPresentation, _super);
        function StringColumnPresentation() {
            return _super.call(this) || this;
        }
        StringColumnPresentation.getInstance = function () {
            if (!StringColumnPresentation.instance) {
                StringColumnPresentation.instance = new StringColumnPresentation();
            }
            return StringColumnPresentation.instance;
        };
        StringColumnPresentation.prototype.getPossibleViews = function () {
            return [
                CellView.TEXT,
                CellView.ITALIC,
                CellView.BOLD,
                CellView.IMAGE,
                CellView.LINK,
                CellView.CHIP
            ];
        };
        StringColumnPresentation.prototype.getDefaultView = function () {
            return CellView.TEXT;
        };
        StringColumnPresentation.prototype.getDefaultAlign = function () {
            return exports["ɵns"].LEFT;
        };
        return StringColumnPresentation;
    }(ColumnPresentation));
    StringColumnPresentation.instance = null;

    var UnknownColumnPresentation = /** @class */ (function (_super) {
        __extends(UnknownColumnPresentation, _super);
        function UnknownColumnPresentation() {
            return _super.call(this) || this;
        }
        UnknownColumnPresentation.getInstance = function () {
            if (!UnknownColumnPresentation.instance) {
                UnknownColumnPresentation.instance = new UnknownColumnPresentation();
            }
            return UnknownColumnPresentation.instance;
        };
        UnknownColumnPresentation.prototype.getPossibleViews = function () {
            return [
                CellView.TEXT
            ];
        };
        UnknownColumnPresentation.prototype.getDefaultView = function () {
            return CellView.TEXT;
        };
        UnknownColumnPresentation.prototype.getDefaultAlign = function () {
            return exports["ɵns"].LEFT;
        };
        return UnknownColumnPresentation;
    }(ColumnPresentation));
    UnknownColumnPresentation.instance = null;

    var ColumnPresentationConverter = /** @class */ (function () {
        function ColumnPresentationConverter() {
        }
        ColumnPresentationConverter.prototype.convert = function (dataType) {
            if (dataType === DataType.NUMBER) {
                return NumberColumnPresentation.getInstance();
            }
            else if (dataType === DataType.BOOLEAN) {
                return BooleanColumnPresentation.getInstance();
            }
            else if (dataType === DataType.DATE) {
                return DateColumnPresentation.getInstance();
            }
            else if (dataType === DataType.STRING) {
                return StringColumnPresentation.getInstance();
            }
            else {
                return UnknownColumnPresentation.getInstance();
            }
        };
        return ColumnPresentationConverter;
    }());
    ColumnPresentationConverter.decorators = [
        { type: core.Injectable }
    ];

    var ColumnEntityFactory = /** @class */ (function () {
        function ColumnEntityFactory(columnPresentationConverter) {
            this.columnPresentationConverter = columnPresentationConverter;
        }
        ColumnEntityFactory.prototype.create = function (source) {
            if (Array.isArray(source)) {
                return this.createColumns(source);
            }
            else {
                return this.createColumn(source);
            }
        };
        ColumnEntityFactory.prototype.createColumn = function (params) {
            var columnConfig = params.getColumn(), field = params.getField(), dataType = field.getDataType(), width = this.convertWidth(columnConfig.width) || undefined;
            var view, enabled;
            if (columnConfig.view !== undefined) {
                view = new ViewEntity(columnConfig.view);
            }
            if (columnConfig.enabled !== undefined) {
                enabled = columnConfig.enabled;
            }
            else {
                enabled = true;
            }
            var presentation = this.getPresentation(dataType);
            var columnEntity = new ColumnEntity(new ColumnId(hermes.RandomStringGenerator.generate()), field, columnConfig, enabled, presentation, undefined, columnConfig.align, view, width);
            if (columnConfig.header !== undefined) {
                columnEntity.setHeader(columnConfig.header);
            }
            return columnEntity;
        };
        ColumnEntityFactory.prototype.createColumns = function (columns) {
            var _this = this;
            var columnEntities = [];
            columns.forEach(function (column) {
                columnEntities.push(_this.createColumn(column));
            });
            return columnEntities;
        };
        ColumnEntityFactory.prototype.convertWidth = function (width) {
            return +width;
        };
        ColumnEntityFactory.prototype.getPresentation = function (dataType) {
            return this.columnPresentationConverter.convert(dataType);
        };
        return ColumnEntityFactory;
    }());
    ColumnEntityFactory.decorators = [
        { type: core.Injectable }
    ];
    ColumnEntityFactory.ctorParameters = function () { return [
        { type: ColumnPresentationConverter }
    ]; };

    var CompositionGroupFactory = /** @class */ (function () {
        function CompositionGroupFactory() {
        }
        CompositionGroupFactory.prototype.create = function (config) {
            return new Group(new GroupId(hermes.RandomStringGenerator.generate()), config.header, config.width);
        };
        return CompositionGroupFactory;
    }());

    var CompositionAggregateFactory = /** @class */ (function (_super) {
        __extends(CompositionAggregateFactory, _super);
        function CompositionAggregateFactory(columnFactory, groupFactory) {
            var _this = _super.call(this) || this;
            _this.columnFactory = columnFactory;
            _this.groupFactory = groupFactory;
            return _this;
        }
        CompositionAggregateFactory.prototype.create = function (id) {
            return new CompositionAggregate(id, this.columnFactory, this.groupFactory);
        };
        return CompositionAggregateFactory;
    }(hermes.AggregateFactory));
    CompositionAggregateFactory.decorators = [
        { type: core.Injectable }
    ];
    CompositionAggregateFactory.ctorParameters = function () { return [
        { type: ColumnEntityFactory },
        { type: CompositionGroupFactory }
    ]; };

    var CompositionAggregateRepository = /** @class */ (function (_super) {
        __extends(CompositionAggregateRepository, _super);
        function CompositionAggregateRepository() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return CompositionAggregateRepository;
    }(hermes.AggregateRepository));

    var InMemoryCompositionStore = /** @class */ (function (_super) {
        __extends(InMemoryCompositionStore, _super);
        function InMemoryCompositionStore() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return InMemoryCompositionStore;
    }(hermes.InMemoryStore));
    InMemoryCompositionStore.decorators = [
        { type: core.Injectable }
    ];

    var InMemoryCompositionAggregateStore = /** @class */ (function (_super) {
        __extends(InMemoryCompositionAggregateStore, _super);
        function InMemoryCompositionAggregateStore(inMemoryCompositionStore, aggregateStoreRegister) {
            return _super.call(this, inMemoryCompositionStore, aggregateStoreRegister) || this;
        }
        return InMemoryCompositionAggregateStore;
    }(hermes.InMemoryAggregateStore));
    InMemoryCompositionAggregateStore.decorators = [
        { type: core.Injectable }
    ];
    InMemoryCompositionAggregateStore.ctorParameters = function () { return [
        { type: InMemoryCompositionStore },
        { type: hermes.AggregateStoreRegister }
    ]; };

    var InMemoryCompositionAggregateRepository = /** @class */ (function (_super) {
        __extends(InMemoryCompositionAggregateRepository, _super);
        function InMemoryCompositionAggregateRepository(inMemoryCompositionAggregateStore) {
            var _this = _super.call(this) || this;
            _this.inMemoryCompositionAggregateStore = inMemoryCompositionAggregateStore;
            return _this;
        }
        InMemoryCompositionAggregateRepository.prototype.findById = function (aggregateId) {
            return this.inMemoryCompositionAggregateStore.findById(aggregateId);
        };
        InMemoryCompositionAggregateRepository.prototype.save = function (aggregate) {
            this.inMemoryCompositionAggregateStore.save(aggregate);
        };
        return InMemoryCompositionAggregateRepository;
    }(CompositionAggregateRepository));
    InMemoryCompositionAggregateRepository.decorators = [
        { type: core.Injectable }
    ];
    InMemoryCompositionAggregateRepository.ctorParameters = function () { return [
        { type: InMemoryCompositionAggregateStore }
    ]; };

    var CompositionCommand = /** @class */ (function (_super) {
        __extends(CompositionCommand, _super);
        function CompositionCommand() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        return CompositionCommand;
    }(hermes.Command));

    var CreateCompositionCommand = /** @class */ (function (_super) {
        __extends(CreateCompositionCommand, _super);
        function CreateCompositionCommand(compositionId) {
            var _this = _super.call(this, compositionId, 'CreateCompositionCommand') || this;
            _this.compositionId = compositionId;
            return _this;
        }
        return CreateCompositionCommand;
    }(CompositionCommand));

    var CreateCompositionCommandHandler = /** @class */ (function () {
        function CreateCompositionCommandHandler(compositionAggregateRepository, domainEventPublisher) {
            this.compositionAggregateRepository = compositionAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
        }
        CreateCompositionCommandHandler.prototype.forCommand = function () {
            return CreateCompositionCommand;
        };
        CreateCompositionCommandHandler.prototype.getAggregateRepository = function () {
            return this.compositionAggregateRepository;
        };
        CreateCompositionCommandHandler.prototype.publishDomainEvents = function (aggregate, command) {
            this.domainEventPublisher.publish(new CompositionCreatedEvent(command.getAggregateId()));
        };
        return CreateCompositionCommandHandler;
    }());
    CreateCompositionCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    CreateCompositionCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var CompositionAggregateEvents = {
        CompositionResizeWidthSetAggregateEvent: 'CompositionResizeWidthSetAggregateEvent',
        ColumnsSetAggregateEvent: 'ColumnsSetAggregateEvent',
        CompositionContainerWidthSetAggregateEvent: 'CompositionContainerWidthSetAggregateEvent',
        CompositionWidthSetAggregateEvent: 'CompositionWidthSetAggregateEvent',
        CompositionColumnSetEnabledAggregateEvent: 'CompositionColumnSetEnabledAggregateEvent',
        CompositionColumnMovedLeftAggregateEvent: 'CompositionColumnMovedLeftAggregateEvent',
        CompositionColumnMovedRightAggregateEvent: 'CompositionColumnMovedRightAggregateEvent',
        GroupsSetAggregateEvent: 'GroupsSetAggregateEvent'
    };

    var CompositionGroupsSetEvent = /** @class */ (function (_super) {
        __extends(CompositionGroupsSetEvent, _super);
        function CompositionGroupsSetEvent(compositionId) {
            return _super.call(this, compositionId, null, 'CompositionGroupsSetEvent') || this;
        }
        return CompositionGroupsSetEvent;
    }(CompositionDomainEvent));

    var CompositionEventConverter = /** @class */ (function () {
        function CompositionEventConverter() {
        }
        CompositionEventConverter.prototype.convert = function (arg) {
            if (Array.isArray(arg)) {
                return this.convertEvents(arg);
            }
            else {
                return this.convertEvent(arg);
            }
        };
        CompositionEventConverter.prototype.convertEvents = function (aggregateEvents) {
            var _this = this;
            return aggregateEvents.map(function (event) {
                return _this.convertEvent(event);
            });
        };
        CompositionEventConverter.prototype.convertEvent = function (aggregateEvent) {
            switch (aggregateEvent.getType()) {
                case CompositionAggregateEvents.CompositionResizeWidthSetAggregateEvent:
                    return new CompositionResizeWidthSetEvent(aggregateEvent.getAggregateId());
                case CompositionAggregateEvents.ColumnsSetAggregateEvent:
                    return new CompositionColumnsSetEvent(aggregateEvent.getAggregateId());
                case CompositionAggregateEvents.CompositionContainerWidthSetAggregateEvent:
                    var payload = aggregateEvent.containerWidth;
                    return new CompositionContainerWidthSetEvent(aggregateEvent.getAggregateId(), payload);
                case CompositionAggregateEvents.CompositionWidthSetAggregateEvent:
                    return new CompositionWidthSetEvent(aggregateEvent.getAggregateId());
                case CompositionAggregateEvents.CompositionColumnSetEnabledAggregateEvent:
                    return new CompositionColumnSetEnabledEvent(aggregateEvent.getAggregateId());
                case CompositionAggregateEvents.CompositionColumnMovedLeftAggregateEvent:
                    return new CompositionColumnMovedLeftEvent(aggregateEvent.getAggregateId());
                case CompositionAggregateEvents.CompositionColumnMovedRightAggregateEvent:
                    return new CompositionColumnMovedRightEvent(aggregateEvent.getAggregateId());
                case CompositionAggregateEvents.GroupsSetAggregateEvent:
                    return new CompositionGroupsSetEvent(aggregateEvent.getAggregateId());
                default:
                    return new CompositionResizeWidthSetEvent(aggregateEvent.getAggregateId());
            }
        };
        return CompositionEventConverter;
    }());
    CompositionEventConverter.decorators = [
        { type: core.Injectable }
    ];

    var SetColumnsCommand = /** @class */ (function (_super) {
        __extends(SetColumnsCommand, _super);
        function SetColumnsCommand(compositionId, columns) {
            var _this = _super.call(this, compositionId, 'SetColumnsCommand') || this;
            _this.compositionId = compositionId;
            _this.columns = columns;
            return _this;
        }
        SetColumnsCommand.prototype.getParams = function () {
            return this.columns;
        };
        return SetColumnsCommand;
    }(CompositionCommand));

    var SetColumnsCommandHandler = /** @class */ (function () {
        function SetColumnsCommandHandler(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
            this.compositionAggregateRepository = compositionAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
            this.compositionEventConverter = compositionEventConverter;
        }
        SetColumnsCommandHandler.prototype.forCommand = function () {
            return SetColumnsCommand;
        };
        SetColumnsCommandHandler.prototype.handle = function (aggregate, command) {
            var setColumnsParams = command.getParams();
            aggregate.setColumns(setColumnsParams);
        };
        SetColumnsCommandHandler.prototype.publish = function (aggregate, command) {
            this.publishEvents(aggregate, command);
        };
        SetColumnsCommandHandler.prototype.publishEvents = function (composition, command) {
            var events = composition.getEvents();
            var domainEvents = this.compositionEventConverter.convert(events);
            this.domainEventPublisher.publish(domainEvents);
        };
        return SetColumnsCommandHandler;
    }());
    SetColumnsCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetColumnsCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher },
        { type: CompositionEventConverter }
    ]; };

    var SetCompositionWidthCommand = /** @class */ (function (_super) {
        __extends(SetCompositionWidthCommand, _super);
        function SetCompositionWidthCommand(structureId, width) {
            var _this = _super.call(this, structureId, 'SetCompositionWidthCommand') || this;
            _this.structureId = structureId;
            _this.width = width;
            return _this;
        }
        SetCompositionWidthCommand.prototype.getWidth = function () {
            return this.width;
        };
        return SetCompositionWidthCommand;
    }(CompositionCommand));

    var SetCompositionWidthCommandHandler = /** @class */ (function () {
        function SetCompositionWidthCommandHandler(compositionAggregateRepository, domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetCompositionWidthCommandHandler.prototype.forCommand = function () {
            return SetCompositionWidthCommand;
        };
        SetCompositionWidthCommandHandler.prototype.handle = function (composition, command) {
            var width = command.getWidth();
            composition.setWidth(width);
        };
        SetCompositionWidthCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new CompositionWidthSetEvent(command.getAggregateId()));
        };
        return SetCompositionWidthCommandHandler;
    }());
    SetCompositionWidthCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetCompositionWidthCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetCompositionResizeWidthCommand = /** @class */ (function (_super) {
        __extends(SetCompositionResizeWidthCommand, _super);
        function SetCompositionResizeWidthCommand(structureId, enabled) {
            var _this = _super.call(this, structureId, 'SetCompositionResizeWidthCommand') || this;
            _this.structureId = structureId;
            _this.enabled = enabled;
            return _this;
        }
        SetCompositionResizeWidthCommand.prototype.getEnabled = function () {
            return this.enabled;
        };
        return SetCompositionResizeWidthCommand;
    }(CompositionCommand));

    var SetCompositionResizeWidthCommandHandler = /** @class */ (function () {
        function SetCompositionResizeWidthCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        SetCompositionResizeWidthCommandHandler.prototype.forCommand = function () {
            return SetCompositionResizeWidthCommand;
        };
        SetCompositionResizeWidthCommandHandler.prototype.handle = function (composition, command) {
            var enabled = command.getEnabled();
            composition.setResizeWidth(enabled);
        };
        SetCompositionResizeWidthCommandHandler.prototype.publish = function (aggregate, command) {
            this.domainEventPublisher.publish(new CompositionResizeWidthSetEvent(command.getAggregateId()));
        };
        return SetCompositionResizeWidthCommandHandler;
    }());
    SetCompositionResizeWidthCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetCompositionResizeWidthCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var SetCompositionContainerWidthCommand = /** @class */ (function (_super) {
        __extends(SetCompositionContainerWidthCommand, _super);
        function SetCompositionContainerWidthCommand(structureId, width) {
            var _this = _super.call(this, structureId, 'SetCompositionContainerWidthCommand') || this;
            _this.structureId = structureId;
            _this.width = width;
            return _this;
        }
        SetCompositionContainerWidthCommand.prototype.getWidth = function () {
            return this.width;
        };
        return SetCompositionContainerWidthCommand;
    }(CompositionCommand));

    var SetCompositionContainerWidthCommandHandler = /** @class */ (function () {
        function SetCompositionContainerWidthCommandHandler(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
            this.compositionAggregateRepository = compositionAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
            this.compositionEventConverter = compositionEventConverter;
        }
        SetCompositionContainerWidthCommandHandler.prototype.forCommand = function () {
            return SetCompositionContainerWidthCommand;
        };
        SetCompositionContainerWidthCommandHandler.prototype.handle = function (composition, command) {
            var width = command.getWidth();
            composition.setContainerWidth(width);
        };
        SetCompositionContainerWidthCommandHandler.prototype.publish = function (aggregate, command) {
            this.publishAggregateEvents(aggregate.getEvents());
        };
        SetCompositionContainerWidthCommandHandler.prototype.publishAggregateEvents = function (aggregateEvents) {
            var domainEvents = this.compositionEventConverter.convert(aggregateEvents);
            this.domainEventPublisher.publish(domainEvents);
        };
        return SetCompositionContainerWidthCommandHandler;
    }());
    SetCompositionContainerWidthCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetCompositionContainerWidthCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher },
        { type: CompositionEventConverter }
    ]; };

    var CompositionSetColumnEnabledCommand = /** @class */ (function (_super) {
        __extends(CompositionSetColumnEnabledCommand, _super);
        function CompositionSetColumnEnabledCommand(compositionId, columnId, enabled) {
            var _this = _super.call(this, compositionId, 'CompositionSetColumnEnabledCommand') || this;
            _this.compositionId = compositionId;
            _this.columnId = columnId;
            _this.enabled = enabled;
            return _this;
        }
        CompositionSetColumnEnabledCommand.prototype.getColumnId = function () {
            return this.columnId;
        };
        CompositionSetColumnEnabledCommand.prototype.isEnabled = function () {
            return this.enabled;
        };
        return CompositionSetColumnEnabledCommand;
    }(CompositionCommand));

    var CompositionSetColumnEnabledCommandHandler = /** @class */ (function () {
        function CompositionSetColumnEnabledCommandHandler(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
            this.compositionAggregateRepository = compositionAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
            this.compositionEventConverter = compositionEventConverter;
        }
        CompositionSetColumnEnabledCommandHandler.prototype.forCommand = function () {
            return CompositionSetColumnEnabledCommand;
        };
        CompositionSetColumnEnabledCommandHandler.prototype.handle = function (aggregate, command) {
            var columnId = command.getColumnId(), enabled = command.isEnabled();
            aggregate.enableColumn(columnId, enabled);
        };
        CompositionSetColumnEnabledCommandHandler.prototype.publish = function (aggregate, command) {
            this.publishEvents(aggregate, command);
        };
        CompositionSetColumnEnabledCommandHandler.prototype.publishEvents = function (composition, command) {
            var events = composition.getEvents();
            var domainEvents = this.compositionEventConverter.convert(events);
            if (domainEvents && domainEvents.length > 0) {
                this.domainEventPublisher.publish(domainEvents);
            }
        };
        return CompositionSetColumnEnabledCommandHandler;
    }());
    CompositionSetColumnEnabledCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    CompositionSetColumnEnabledCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher },
        { type: CompositionEventConverter }
    ]; };

    var CompositionChangeSortStatusCommand = /** @class */ (function (_super) {
        __extends(CompositionChangeSortStatusCommand, _super);
        function CompositionChangeSortStatusCommand(compositionId, sortParams) {
            var _this = _super.call(this, compositionId, 'CompositionChangeSortStatusCommand') || this;
            _this.compositionId = compositionId;
            _this.sortParams = sortParams;
            return _this;
        }
        CompositionChangeSortStatusCommand.prototype.getCompositionId = function () {
            return this.compositionId;
        };
        CompositionChangeSortStatusCommand.prototype.getSortParams = function () {
            return this.sortParams;
        };
        return CompositionChangeSortStatusCommand;
    }(CompositionCommand));

    var CompositionChangeSortStatusCommandHandler = /** @class */ (function () {
        function CompositionChangeSortStatusCommandHandler(domainEventPublisher) {
            this.domainEventPublisher = domainEventPublisher;
        }
        CompositionChangeSortStatusCommandHandler.prototype.forCommand = function () {
            return CompositionChangeSortStatusCommand;
        };
        CompositionChangeSortStatusCommandHandler.prototype.handle = function (composition, command) {
            var sortParams = command.getSortParams();
            composition.changeSort(sortParams);
        };
        CompositionChangeSortStatusCommandHandler.prototype.publish = function (composition, command) {
            var compositionId = command.getAggregateId(), columns = composition.getActiveColumns();
            this.domainEventPublisher.publish(new CompositionChangeSortStatusEvent(compositionId, columns));
        };
        return CompositionChangeSortStatusCommandHandler;
    }());
    CompositionChangeSortStatusCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    CompositionChangeSortStatusCommandHandler.ctorParameters = function () { return [
        { type: hermes.DomainEventPublisher }
    ]; };

    var CompositionMoveLeftColumnCommand = /** @class */ (function (_super) {
        __extends(CompositionMoveLeftColumnCommand, _super);
        function CompositionMoveLeftColumnCommand(compositionId, columnId) {
            var _this = _super.call(this, compositionId, 'CompositionMoveLeftColumnCommand') || this;
            _this.compositionId = compositionId;
            _this.columnId = columnId;
            return _this;
        }
        CompositionMoveLeftColumnCommand.prototype.getColumnId = function () {
            return this.columnId;
        };
        return CompositionMoveLeftColumnCommand;
    }(CompositionCommand));

    var CompositionMoveLeftColumnCommandHandler = /** @class */ (function () {
        function CompositionMoveLeftColumnCommandHandler(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
            this.compositionAggregateRepository = compositionAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
            this.compositionEventConverter = compositionEventConverter;
        }
        CompositionMoveLeftColumnCommandHandler.prototype.forCommand = function () {
            return CompositionMoveLeftColumnCommand;
        };
        CompositionMoveLeftColumnCommandHandler.prototype.handle = function (aggregate, command) {
            var columnId = command.getColumnId();
            aggregate.moveLeft(columnId);
        };
        CompositionMoveLeftColumnCommandHandler.prototype.publish = function (aggregate, command) {
            this.publishEvents(aggregate, command);
        };
        CompositionMoveLeftColumnCommandHandler.prototype.publishEvents = function (composition, command) {
            var events = composition.getEvents();
            var domainEvents = this.compositionEventConverter.convert(events);
            if (domainEvents && domainEvents.length > 0) {
                this.domainEventPublisher.publish(domainEvents);
            }
        };
        return CompositionMoveLeftColumnCommandHandler;
    }());
    CompositionMoveLeftColumnCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    CompositionMoveLeftColumnCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher },
        { type: CompositionEventConverter }
    ]; };

    var CompositionMoveRightColumnCommand = /** @class */ (function (_super) {
        __extends(CompositionMoveRightColumnCommand, _super);
        function CompositionMoveRightColumnCommand(compositionId, columnId) {
            var _this = _super.call(this, compositionId, 'CompositionMoveRightColumnCommand') || this;
            _this.columnId = columnId;
            return _this;
        }
        CompositionMoveRightColumnCommand.prototype.getColumnId = function () {
            return this.columnId;
        };
        return CompositionMoveRightColumnCommand;
    }(CompositionCommand));

    var CompositionMoveRightColumnCommandHandler = /** @class */ (function () {
        function CompositionMoveRightColumnCommandHandler(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
            this.compositionAggregateRepository = compositionAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
            this.compositionEventConverter = compositionEventConverter;
        }
        CompositionMoveRightColumnCommandHandler.prototype.forCommand = function () {
            return CompositionMoveRightColumnCommand;
        };
        CompositionMoveRightColumnCommandHandler.prototype.handle = function (aggregate, command) {
            var columnId = command.getColumnId();
            aggregate.moveRight(columnId);
        };
        CompositionMoveRightColumnCommandHandler.prototype.publish = function (aggregate, command) {
            this.publishEvents(aggregate, command);
        };
        CompositionMoveRightColumnCommandHandler.prototype.publishEvents = function (composition, command) {
            var events = composition.getEvents();
            var domainEvents = this.compositionEventConverter.convert(events);
            if (domainEvents && domainEvents.length > 0) {
                this.domainEventPublisher.publish(domainEvents);
            }
        };
        return CompositionMoveRightColumnCommandHandler;
    }());
    CompositionMoveRightColumnCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    CompositionMoveRightColumnCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher },
        { type: CompositionEventConverter }
    ]; };

    var SetGroupsCommand = /** @class */ (function (_super) {
        __extends(SetGroupsCommand, _super);
        function SetGroupsCommand(compositionId, configs) {
            var _this = _super.call(this, compositionId, 'SetGroupsCommand') || this;
            _this.compositionId = compositionId;
            _this.configs = configs;
            return _this;
        }
        SetGroupsCommand.prototype.getConfigs = function () {
            return this.configs;
        };
        return SetGroupsCommand;
    }(CompositionCommand));

    var CompositionDispatcher = /** @class */ (function () {
        function CompositionDispatcher(commandDispatcher) {
            this.commandDispatcher = commandDispatcher;
        }
        CompositionDispatcher.prototype.createComposition = function (compositionId) {
            this.commandDispatcher.dispatch(new CreateCompositionCommand(compositionId));
        };
        CompositionDispatcher.prototype.setColumns = function (compositionId, params) {
            this.commandDispatcher.dispatch(new SetColumnsCommand(compositionId, params));
        };
        CompositionDispatcher.prototype.setGroups = function (compositionId, params) {
            this.commandDispatcher.dispatch(new SetGroupsCommand(compositionId, params));
        };
        CompositionDispatcher.prototype.setWidth = function (compositionId, width) {
            this.commandDispatcher.dispatch(new SetCompositionWidthCommand(compositionId, width));
        };
        CompositionDispatcher.prototype.setContainerWidth = function (compositionId, width) {
            this.commandDispatcher.dispatch(new SetCompositionContainerWidthCommand(compositionId, width));
        };
        CompositionDispatcher.prototype.setResizeWidth = function (compositionId, enabled) {
            this.commandDispatcher.dispatch(new SetCompositionResizeWidthCommand(compositionId, enabled));
        };
        CompositionDispatcher.prototype.changeSort = function (compositionId, params) {
            this.commandDispatcher.dispatch(new CompositionChangeSortStatusCommand(compositionId, params));
        };
        CompositionDispatcher.prototype.setColumnEnabled = function (compositionId, columnId, enabled) {
            this.commandDispatcher.dispatch(new CompositionSetColumnEnabledCommand(compositionId, columnId, enabled));
        };
        CompositionDispatcher.prototype.moveLeft = function (compositionId, columnId) {
            this.commandDispatcher.dispatch(new CompositionMoveLeftColumnCommand(compositionId, columnId));
        };
        CompositionDispatcher.prototype.moveRight = function (compositionId, columnId) {
            this.commandDispatcher.dispatch(new CompositionMoveRightColumnCommand(compositionId, columnId));
        };
        return CompositionDispatcher;
    }());
    CompositionDispatcher.decorators = [
        { type: core.Injectable }
    ];
    CompositionDispatcher.ctorParameters = function () { return [
        { type: hermes.CommandDispatcher }
    ]; };

    var ChangeSortParams = /** @class */ (function () {
        function ChangeSortParams(fieldId, direction) {
            this.fieldId = fieldId;
            this.direction = direction;
        }
        return ChangeSortParams;
    }());

    var CompositionChangeSortStatusEventHandler = /** @class */ (function () {
        function CompositionChangeSortStatusEventHandler(compositionDispatcher) {
            this.compositionDispatcher = compositionDispatcher;
        }
        CompositionChangeSortStatusEventHandler.prototype.forEvents = function () {
            return [
                SortToggledEvent,
                SortOrderSetEvent
            ];
        };
        CompositionChangeSortStatusEventHandler.prototype.handle = function (event) {
            if (event.ofMessageType('SortToggledEvent')) {
                var compositionId = event.getCompositionId(), dirs = event.getDirections();
                var params = dirs.map(function (dir) {
                    var columnFieldId = new ColumnFieldId(dir.fieldId.getId());
                    return new ChangeSortParams(columnFieldId, dir.direction);
                });
                this.compositionDispatcher.changeSort(compositionId, params);
            }
            if (event.ofMessageType('SortOrderSetEvent')) {
                var compositionId = event.getCompositionId(), dirs = event.getDirections();
                var params = dirs.map(function (dir) {
                    var columnFieldId = new ColumnFieldId(dir.fieldId.getId());
                    return new ChangeSortParams(columnFieldId, dir.direction);
                });
                this.compositionDispatcher.changeSort(compositionId, params);
            }
        };
        return CompositionChangeSortStatusEventHandler;
    }());
    CompositionChangeSortStatusEventHandler.decorators = [
        { type: core.Injectable }
    ];
    CompositionChangeSortStatusEventHandler.ctorParameters = function () { return [
        { type: CompositionDispatcher }
    ]; };

    var ViewTemplatesComponent = /** @class */ (function () {
        function ViewTemplatesComponent() {
        }
        ViewTemplatesComponent.prototype.getTemplate = function (view) {
            switch (view) {
                case CellView.TEXT:
                    return this.textTemplate;
                case CellView.NUMBER:
                    return this.numberTemplate;
                case CellView.CHIP:
                    return this.chipTemplate;
                case CellView.LINK:
                    return this.linkTemplate;
                case CellView.IMAGE:
                    return this.imageTemplate;
                case CellView.CHECKBOX:
                    return this.checkboxTemplate;
                case CellView.BOLD:
                    return this.boldTemplate;
                case CellView.ITALIC:
                    return this.italicTemplate;
                case CellView.CUSTOM:
                    return this.customTemplate;
                case CellView.FUNCTION:
                    return this.functionTemplate;
                case CellView.DATE:
                    return this.dateTemplate;
                case CellView.BAR:
                    return this.barTemplate;
                case CellView.PERCENTAGE_BAR:
                    return this.percentageBarTemplate;
                case CellView.PERCENTAGE:
                    return this.percentageTemplate;
                default:
                    return this.textTemplate;
            }
        };
        return ViewTemplatesComponent;
    }());
    ViewTemplatesComponent.decorators = [
        { type: core.Component, args: [{
                    template: "\n\n\t\t<ng-template #text let-element=\"element\">\n\t\t\t<gui-view-text [value]=\"element\"></gui-view-text>\n\t\t</ng-template>\n\n\t\t<ng-template #number let-element=\"element\">\n\t\t\t<span class=\"gui-cell-number\">\n\t\t\t\t{{ element.value }}\n\t\t\t</span>\n\t\t</ng-template>\n\n\t\t<ng-template #chip let-element=\"element\">\n\t\t\t<gui-chip>\n\t\t\t\t<gui-view-text [value]=\"element\"></gui-view-text>\n\t\t\t</gui-chip>\n\t\t</ng-template>\n\n\t\t<ng-template #link let-element=\"element\">\n\t\t\t<a gui-button link=\"true\" href=\"{{ element.value }}\">\n\t\t\t\t<gui-view-text [value]=\"element\"></gui-view-text>\n\t\t\t</a>\n\t\t</ng-template>\n\n\t\t<ng-template #image let-element=\"element\">\n\t\t\t<img src=\"{{ element.value }}\"/>\n\t\t</ng-template>\n\n\t\t<ng-template #checkbox let-element=\"element\">\n\t\t\t<span class=\"gui-cell-boolean\">\n\t\t\t\t<gui-checkbox [checked]=\"!!element.value\" [disabled]=\"true\"></gui-checkbox>\n\t\t\t</span>\n\t\t</ng-template>\n\n\t\t<ng-template #bold let-element=\"element\">\n\t\t\t<gui-view-text bold [value]=\"element\"></gui-view-text>\n\t\t</ng-template>\n\n\t\t<ng-template #italic let-element=\"element\">\n\t\t\t<gui-view-text italic [value]=\"element\"></gui-view-text>\n\t\t</ng-template>\n\n\t\t<ng-template #custom let-element=\"element\">\n\t\t\t{{ element.value }}\n\t\t</ng-template>\n\n\t\t<ng-template #function let-element=\"element\">\n\t\t\t<gui-function-view [element]=\"element\"></gui-function-view>\n\t\t</ng-template>\n\n\t\t<ng-template #date let-element=\"element\">\n\t\t\t<span class=\"gui-view-text\">{{ element.value | date: 'dd/MM/yyyy' }}</span>\n\t\t</ng-template>\n\n\t\t<ng-template #bar let-element=\"element\">\n\t\t\t<gui-bar-view [value]=\"element.value\" [showPercentage]=\"false\"></gui-bar-view>\n\t\t</ng-template>\n\n\t\t<ng-template #percentageBar let-element=\"element\">\n\t\t\t<gui-bar-view [value]=\"element.value\" [showPercentage]=\"true\"></gui-bar-view>\n\t\t</ng-template>\n\n\t\t<ng-template #percentage let-element=\"element\">\n\t\t\t<gui-percentage-view [value]=\"element.value\"></gui-percentage-view>\n\t\t</ng-template>\n\n\t"
                },] }
    ];
    ViewTemplatesComponent.propDecorators = {
        textTemplate: [{ type: core.ViewChild, args: ['text', { read: core.TemplateRef, static: true },] }],
        numberTemplate: [{ type: core.ViewChild, args: ['number', { read: core.TemplateRef, static: true },] }],
        chipTemplate: [{ type: core.ViewChild, args: ['chip', { read: core.TemplateRef, static: true },] }],
        linkTemplate: [{ type: core.ViewChild, args: ['link', { read: core.TemplateRef, static: true },] }],
        imageTemplate: [{ type: core.ViewChild, args: ['image', { read: core.TemplateRef, static: true },] }],
        checkboxTemplate: [{ type: core.ViewChild, args: ['checkbox', { read: core.TemplateRef, static: true },] }],
        boldTemplate: [{ type: core.ViewChild, args: ['bold', { read: core.TemplateRef, static: true },] }],
        italicTemplate: [{ type: core.ViewChild, args: ['italic', { read: core.TemplateRef, static: true },] }],
        customTemplate: [{ type: core.ViewChild, args: ['custom', { read: core.TemplateRef, static: true },] }],
        functionTemplate: [{ type: core.ViewChild, args: ['function', { read: core.TemplateRef, static: true },] }],
        dateTemplate: [{ type: core.ViewChild, args: ['date', { read: core.TemplateRef, static: true },] }],
        barTemplate: [{ type: core.ViewChild, args: ['bar', { read: core.TemplateRef, static: true },] }],
        percentageBarTemplate: [{ type: core.ViewChild, args: ['percentageBar', { read: core.TemplateRef, static: true },] }],
        percentageTemplate: [{ type: core.ViewChild, args: ['percentage', { read: core.TemplateRef, static: true },] }]
    };

    var TemplateFactory = /** @class */ (function () {
        function TemplateFactory(templatesComponentDefinition, componentFactoryResolver) {
            this.templatesComponentDefinition = templatesComponentDefinition;
            this.componentFactoryResolver = componentFactoryResolver;
            this.templates = new Map();
            this.templatesComponent = null;
            this.createTemplatesComponent();
        }
        TemplateFactory.prototype.getTemplates = function () {
            return this.templates;
        };
        TemplateFactory.prototype.destroy = function () {
            if (this.templatesComponent) {
                this.templatesComponent.destroy();
                this.templatesComponent = null;
            }
        };
        TemplateFactory.prototype.createTemplatesComponent = function () {
            var componentFactory = this.componentFactoryResolver.resolveComponentFactory(this.templatesComponentDefinition);
            var injector = core.Injector.create({ providers: [] });
            this.templatesComponent = componentFactory.create(injector);
            this.generateMap();
        };
        TemplateFactory.prototype.generateMap = function () {
            var _this = this;
            this.generateMapKeys()
                .forEach(function (type) {
                _this.findAndSetTemplate(type);
            });
        };
        ;
        TemplateFactory.prototype.findAndSetTemplate = function (dt) {
            var template = this.templatesComponent.instance.getTemplate(dt);
            this.templates.set(dt, template);
        };
        return TemplateFactory;
    }());

    var ViewTemplateFactory = /** @class */ (function (_super) {
        __extends(ViewTemplateFactory, _super);
        function ViewTemplateFactory(componentFactoryResolver) {
            return _super.call(this, ViewTemplatesComponent, componentFactoryResolver) || this;
        }
        ViewTemplateFactory.prototype.generateMapKeys = function () {
            return Object.keys(CellView)
                .map(function (key) { return CellView[key]; });
        };
        return ViewTemplateFactory;
    }(TemplateFactory));
    ViewTemplateFactory.decorators = [
        { type: core.Injectable }
    ];
    ViewTemplateFactory.ctorParameters = function () { return [
        { type: core.ComponentFactoryResolver }
    ]; };

    var ViewTemplateRepository = /** @class */ (function () {
        function ViewTemplateRepository(columnTemplateFactory) {
            this.columnTemplateFactory = columnTemplateFactory;
        }
        ViewTemplateRepository.prototype.findTemplate = function (view) {
            var typeToTemplate = this.columnTemplateFactory.getTemplates();
            return typeToTemplate.get(view);
        };
        return ViewTemplateRepository;
    }());
    ViewTemplateRepository.decorators = [
        { type: core.Injectable }
    ];
    ViewTemplateRepository.ctorParameters = function () { return [
        { type: ViewTemplateFactory }
    ]; };

    var EditTemplatesComponent = /** @class */ (function () {
        function EditTemplatesComponent() {
        }
        EditTemplatesComponent.prototype.getTemplate = function (dataType) {
            switch (dataType) {
                case DataType.STRING:
                    return this.stringTemplate;
                case DataType.NUMBER:
                    return this.numberTemplate;
                case DataType.BOOLEAN:
                    return this.booleanTemplate;
                case DataType.DATE:
                    return this.dateTemplate;
                default:
                    return this.emptyTemplate;
            }
        };
        return EditTemplatesComponent;
    }());
    EditTemplatesComponent.decorators = [
        { type: core.Component, args: [{
                    template: "\n\n\t\t<ng-template #string let-valueChanges=\"valueChanges\" let-value=\"value\" let-status=\"status\" let-focus=\"focus\">\n\t\t\t<gui-string-edit [valueChanges]=\"valueChanges\" [value]=\"value\" [status]=\"status\" [focus]=\"focus\">\n\t\t\t</gui-string-edit>\n\t\t</ng-template>\n\n\t\t<ng-template #number let-valueChanges=\"valueChanges\" let-value=\"value\" let-status=\"status\" let-focus=\"focus\">\n\t\t\t<gui-number-edit [valueChanges]=\"valueChanges\" [value]=\"value\" [status]=\"status\" [focus]=\"focus\">\n\t\t\t</gui-number-edit>\n\t\t</ng-template>\n\n\t\t<ng-template #boolean let-valueChanges=\"valueChanges\" let-value=\"value\" let-status=\"status\" let-focus=\"focus\">\n\t\t\t<gui-boolean-edit [valueChanges]=\"valueChanges\" [value]=\"value\" [status]=\"status\" [focus]=\"focus\">\n\t\t\t</gui-boolean-edit>\n\t\t</ng-template>\n\n\t\t<ng-template #date let-valueChanges=\"valueChanges\" let-value=\"value\" let-status=\"status\" let-focus=\"focus\" let-parent=\"parent\">\n\t\t\t<gui-date-edit [valueChanges]=\"valueChanges\" [value]=\"value\" [status]=\"status\" [focus]=\"focus\" [parent]=\"parent\">\n\t\t\t</gui-date-edit>\n\t\t</ng-template>\n\n\t\t<ng-template #empty>\n\n\t\t</ng-template>\n\n\t"
                },] }
    ];
    EditTemplatesComponent.propDecorators = {
        stringTemplate: [{ type: core.ViewChild, args: ['string', { read: core.TemplateRef, static: true },] }],
        numberTemplate: [{ type: core.ViewChild, args: ['number', { read: core.TemplateRef, static: true },] }],
        booleanTemplate: [{ type: core.ViewChild, args: ['boolean', { read: core.TemplateRef, static: true },] }],
        dateTemplate: [{ type: core.ViewChild, args: ['date', { read: core.TemplateRef, static: true },] }],
        emptyTemplate: [{ type: core.ViewChild, args: ['empty', { read: core.TemplateRef, static: true },] }]
    };

    var EditTemplateFactory = /** @class */ (function (_super) {
        __extends(EditTemplateFactory, _super);
        function EditTemplateFactory(componentFactoryResolver) {
            return _super.call(this, EditTemplatesComponent, componentFactoryResolver) || this;
        }
        EditTemplateFactory.prototype.generateMapKeys = function () {
            return Object.keys(DataType)
                .map(function (key) { return DataType[key]; });
        };
        return EditTemplateFactory;
    }(TemplateFactory));
    EditTemplateFactory.decorators = [
        { type: core.Injectable }
    ];
    EditTemplateFactory.ctorParameters = function () { return [
        { type: core.ComponentFactoryResolver }
    ]; };

    var EditTemplateRepository = /** @class */ (function () {
        function EditTemplateRepository(editTemplateFactory) {
            this.editTemplateFactory = editTemplateFactory;
        }
        EditTemplateRepository.prototype.findTemplate = function (dataType) {
            var typeToTemplate = this.editTemplateFactory.getTemplates();
            return typeToTemplate.get(dataType);
        };
        return EditTemplateRepository;
    }());
    EditTemplateRepository.decorators = [
        { type: core.Injectable }
    ];
    EditTemplateRepository.ctorParameters = function () { return [
        { type: EditTemplateFactory }
    ]; };

    var CellContext = /** @class */ (function () {
        function CellContext(element) {
            this.element = element;
        }
        return CellContext;
    }());

    exports["ɵnn"] = void 0;
    (function (CellValueType) {
        CellValueType[CellValueType["TEXT"] = 0] = "TEXT";
        CellValueType[CellValueType["HTML"] = 1] = "HTML";
    })(exports["ɵnn"] || (exports["ɵnn"] = {}));
    var CellValue = /** @class */ (function () {
        function CellValue(value, type) {
            this.value = value;
            this.type = type;
        }
        CellValue.text = function (value) {
            return new CellValue(value, exports["ɵnn"].TEXT);
        };
        CellValue.HTML = function (value) {
            return new CellValue(value, exports["ɵnn"].HTML);
        };
        return CellValue;
    }());

    var CellTemplateWithAccessor = /** @class */ (function () {
        function CellTemplateWithAccessor(columnDefinitionId, name, template, editTemplate, editable, templateFun, formatterFun, accessor, searchAccessor, width, columnFieldId, align, cellEditingEnabled, type, // REFACTOR
        view) {
            this.columnDefinitionId = columnDefinitionId;
            this.name = name;
            this.template = template;
            this.editTemplate = editTemplate;
            this.editable = editable;
            this.templateFun = templateFun;
            this.formatterFun = formatterFun;
            this.accessor = accessor;
            this.searchAccessor = searchAccessor;
            this.width = width;
            this.columnFieldId = columnFieldId;
            this.align = align;
            this.cellEditingEnabled = cellEditingEnabled;
            this.type = type;
            this.view = view;
        }
        CellTemplateWithAccessor.prototype.isCellEditingEnabled = function () {
            return this.cellEditingEnabled;
        };
        CellTemplateWithAccessor.prototype.isBooleanDataType = function () {
            return this.type === DataType.BOOLEAN;
        };
        CellTemplateWithAccessor.prototype.isAlignLeft = function () {
            return this.align === exports["ɵns"].LEFT;
        };
        CellTemplateWithAccessor.prototype.isAlignCenter = function () {
            return this.align === exports["ɵns"].CENTER;
        };
        CellTemplateWithAccessor.prototype.isAlignRight = function () {
            return this.align === exports["ɵns"].RIGHT;
        };
        CellTemplateWithAccessor.prototype.getName = function () {
            return this.name;
        };
        // REFACTOR #1581
        CellTemplateWithAccessor.prototype.getValue = function (entity, searchPhrase) {
            var cellValue = this.findValue(entity, searchPhrase);
            cellValue.value = this.templateFun(cellValue.value, entity.getSourceItem());
            if (this.formatterFun) {
                cellValue.value = this.formatterFun(cellValue.value, entity.getSourceItem());
            }
            return cellValue;
        };
        CellTemplateWithAccessor.prototype.getClasses = function () {
            return 'gui-cell-highlighted';
        };
        CellTemplateWithAccessor.prototype.findValue = function (entity, searchPhrase) {
            var value = this.accessor(entity);
            if (this.type !== DataType.STRING) {
                return CellValue.text(value);
            }
            if (this.view && this.view.getCellView() === CellView.FUNCTION) {
                return CellValue.text(value);
            }
            if (searchPhrase) {
                var txt = '' + this.searchAccessor(entity);
                var lowerCasedText = txt.toLocaleLowerCase(), loweredSearchPhrase = searchPhrase.toLocaleLowerCase();
                var positions = [];
                var index = 0;
                while (index < loweredSearchPhrase.length) {
                    var found = lowerCasedText.indexOf(loweredSearchPhrase, index);
                    if (found >= 0) {
                        positions.push(found);
                        index = found + searchPhrase.length;
                        continue;
                    }
                    else {
                        index = loweredSearchPhrase.length;
                    }
                }
                var arr_1 = txt.split('');
                positions.forEach(function (pos) {
                    for (var i = 0; i < searchPhrase.length; i += 1) {
                        var ph = void 0;
                        if (i === 0) {
                            ph = "<span class=\"gui-text-highlight\">" + arr_1[pos + i];
                        }
                        else {
                            ph = arr_1[pos + i];
                        }
                        if (i === searchPhrase.length - 1) {
                            ph += '</span>';
                        }
                        arr_1[pos + i] = ph;
                    }
                });
                txt = arr_1.join('');
                return CellValue.HTML(txt);
            }
            else {
                return CellValue.text(value);
            }
        };
        return CellTemplateWithAccessor;
    }());

    var ColumnDefinition = /** @class */ (function (_super) {
        __extends(ColumnDefinition, _super);
        function ColumnDefinition(field, columnDefinitionId, // REFACTOR Id first argument
        name, enabled, type, // REFACTOR
        view, // REFACTOR
        align, // REFACTOR
        header, cellEditingEnabled, sort, sortable) {
            if (sort === void 0) { sort = exports["ɵnr"].NONE; }
            if (sortable === void 0) { sortable = true; }
            var _this = _super.call(this, columnDefinitionId) || this;
            _this.name = name;
            _this.type = type;
            _this.view = view;
            _this.align = align;
            _this.sortable = true;
            _this.field = field;
            _this.columnDefinitionId = columnDefinitionId;
            _this.enabled = enabled;
            _this.header = header;
            _this.cellEditingEnabled = cellEditingEnabled;
            _this.sortStatus = sort;
            _this.sortable = sortable;
            return _this;
        }
        ColumnDefinition.prototype.isEnabled = function () {
            return this.enabled;
        };
        ColumnDefinition.prototype.setHeader = function (header) {
            this.header = header;
        };
        ColumnDefinition.prototype.setField = function (field) {
            this.field = field;
        };
        ColumnDefinition.prototype.setTemplateFunction = function (templateFun) {
            this.templateFunction = templateFun;
        };
        ColumnDefinition.prototype.setFormatterFunction = function (formatter) {
            this.formatterFunction = formatter;
        };
        ColumnDefinition.prototype.toHeaderCellTemplateWithContext = function (index) {
            var header = this.header || '';
            var headerCellContext;
            if (typeof header === 'string') {
                headerCellContext = new CellContext(CellValue.text(header));
            }
            else if (typeof header === 'function') {
                headerCellContext = new CellContext(CellValue.text(header(index)));
            }
            var fieldId = new FieldId(this.field.getId().getId());
            return new CellTemplateWithContext(this.headerTemplate, this.editTemplate, headerCellContext, this.width, fieldId, this.columnDefinitionId, this.sortStatus, this.enabled, this.sortable, this.align);
        };
        ColumnDefinition.prototype.toContentCellTemplateWithAccessor = function () {
            var _this = this;
            var accessor = function (entity) {
                return _this.field.getAccessor()(entity);
            }, searchAccessor = function (entity) {
                return _this.field.getSearchAccessor()(entity);
            };
            return new CellTemplateWithAccessor(this.columnDefinitionId, this.name, this.cellTemplate, this.editTemplate, true, this.templateFunction, this.formatterFunction, accessor, searchAccessor, this.width, this.field.getId(), this.align, this.cellEditingEnabled, this.type, this.view);
        };
        return ColumnDefinition;
    }(hermes.ReadModelEntity));

    var ColumnDefinitionId = /** @class */ (function (_super) {
        __extends(ColumnDefinitionId, _super);
        function ColumnDefinitionId(id) {
            return _super.call(this, id) || this;
        }
        return ColumnDefinitionId;
    }(hermes.ReadModelEntityId));

    var ColumnDefinitionFactory = /** @class */ (function () {
        function ColumnDefinitionFactory(viewTemplateRepository, editTemplateRepository) {
            this.viewTemplateRepository = viewTemplateRepository;
            this.editTemplateRepository = editTemplateRepository;
        }
        ColumnDefinitionFactory.prototype.create = function (column) {
            if (column instanceof ColumnEntity) {
                return this.createFromColumnEntity(column);
            }
            else {
                return this.createFromActiveColumnEntity(column);
            }
        };
        ColumnDefinitionFactory.prototype.createColumns = function (columns) {
            var _this = this;
            return columns.map(function (column) { return _this.create(column); });
        };
        ColumnDefinitionFactory.prototype.createFromColumnEntity = function (column) {
            var columnDef = new ColumnDefinition(column.getField(), new ColumnDefinitionId(column.getId().toString()), column.getColumnConfig().name, column.isEnabled(), column.getDataType(), column.getView(), column.getAlign(), column.getHeader(), column.isCellEditingEnabled(), column.getSortStatus(), column.isSortingEnabled());
            if (column.getCellView() === CellView.NG_TEMPLATE) {
                columnDef.cellTemplate = column.getColumnConfig().templateRef;
            }
            else {
                columnDef.cellTemplate = this.findViewTemplate(column.getCellView());
            }
            if (typeof column.getHeader() === 'function') {
                columnDef.headerTemplate = this.findViewTemplate(CellView.FUNCTION);
            }
            else {
                columnDef.headerTemplate = this.findViewTemplate(CellView.TEXT);
            }
            columnDef.setTemplateFunction(column.getTemplateFunction());
            columnDef.setFormatterFunction(column.getFormatterFunction());
            columnDef.editTemplate = this.findEditTemplate(column.getDataType());
            columnDef.width = +column.getWidth();
            return columnDef;
        };
        ColumnDefinitionFactory.prototype.createFromActiveColumnEntity = function (activeColumn) {
            var columnDef = new ColumnDefinition(activeColumn.getField(), new ColumnDefinitionId(activeColumn.getId().toString()), activeColumn.getColumnConfig().name, true, // remove,
            activeColumn.getDataType(), activeColumn.getView(), activeColumn.getAlign(), activeColumn.getHeader(), activeColumn.isCellEditingEnabled(), activeColumn.getSortStatus(), activeColumn.isSortingEnabled());
            if (activeColumn.getCellView() === CellView.NG_TEMPLATE) {
                columnDef.cellTemplate = activeColumn.getColumnConfig().templateRef;
            }
            else {
                columnDef.cellTemplate = this.findViewTemplate(activeColumn.getCellView());
            }
            if (typeof activeColumn.getHeader() === 'function') {
                columnDef.headerTemplate = this.findViewTemplate(CellView.FUNCTION);
            }
            else {
                columnDef.headerTemplate = this.findViewTemplate(CellView.TEXT);
            }
            columnDef.setTemplateFunction(activeColumn.getTemplateFunction());
            columnDef.setFormatterFunction(activeColumn.getFormatterFunction());
            columnDef.editTemplate = this.findEditTemplate(activeColumn.getDataType());
            columnDef.width = +activeColumn.getWidth();
            return columnDef;
        };
        ColumnDefinitionFactory.prototype.findViewTemplate = function (view) {
            if (view === CellView.FUNCTION) {
                return this.viewTemplateRepository.findTemplate(CellView.FUNCTION);
            }
            else {
                return this.viewTemplateRepository.findTemplate(view);
            }
        };
        ColumnDefinitionFactory.prototype.findEditTemplate = function (dataType) {
            return this.editTemplateRepository.findTemplate(dataType);
        };
        return ColumnDefinitionFactory;
    }());
    ColumnDefinitionFactory.decorators = [
        { type: core.Injectable }
    ];
    ColumnDefinitionFactory.ctorParameters = function () { return [
        { type: ViewTemplateRepository },
        { type: EditTemplateRepository }
    ]; };

    var CompositionReadModeRoot = /** @class */ (function (_super) {
        __extends(CompositionReadModeRoot, _super);
        function CompositionReadModeRoot(uid, ready, allColumns, activeColumns, width, resizeWidth) {
            var _this = _super.call(this, uid) || this;
            _this.ready = ready;
            _this.allColumns = allColumns;
            _this.activeColumns = activeColumns;
            _this.width = width;
            _this.resizeWidth = resizeWidth;
            return _this;
        }
        CompositionReadModeRoot.prototype.getActiveColumns = function () {
            return this.activeColumns;
        };
        CompositionReadModeRoot.prototype.getAllColumns = function () {
            return this.allColumns;
        };
        CompositionReadModeRoot.prototype.getActiveHeaderColumns = function () {
            return this.getActiveColumns()
                .map(function (column, index) { return column.toHeaderCellTemplateWithContext(index); });
        };
        CompositionReadModeRoot.prototype.getHeaderColumns = function () {
            return this.getAllColumns()
                .map(function (column, index) { return column.toHeaderCellTemplateWithContext(index); });
        };
        CompositionReadModeRoot.prototype.getTemplateColumns = function () {
            return this.getActiveColumns()
                .map(function (column) { return column.toContentCellTemplateWithAccessor(); });
        };
        CompositionReadModeRoot.prototype.getWidth = function () {
            return this.width;
        };
        CompositionReadModeRoot.prototype.getContainerWidth = function () {
            return +this.width - 2;
        };
        CompositionReadModeRoot.prototype.isReady = function () {
            return this.ready;
        };
        CompositionReadModeRoot.prototype.isResizeWidthEnabled = function () {
            return this.resizeWidth;
        };
        CompositionReadModeRoot.prototype.equals = function (composition) {
            return this.width === composition.width &&
                this.resizeWidth === composition.resizeWidth &&
                this.equalsByColumns(composition.allColumns);
        };
        CompositionReadModeRoot.prototype.equalsByColumns = function (columns) {
            return this.allColumns.length === columns.length;
        };
        return CompositionReadModeRoot;
    }(hermes.ReadModelRoot));

    var CompositionReadModelRootConverter = /** @class */ (function () {
        function CompositionReadModelRootConverter(columnDefinitionFactory) {
            this.columnDefinitionFactory = columnDefinitionFactory;
        }
        CompositionReadModelRootConverter.prototype.convert = function (aggregate) {
            var ready = aggregate.isReady(), allColumns = aggregate.getColumns(), activeColumns = aggregate.getActiveColumns(), allColumnDefs = this.convertToColumnDef(allColumns), activeColumnDefs = this.convertActiveColumnsToColumnDef(activeColumns), width = aggregate.getWidth(), resizeWidth = aggregate.isResizeEnabled(), aggregateId = aggregate.getId();
            return new CompositionReadModeRoot(aggregateId.toReadModelRootId(), ready, allColumnDefs, activeColumnDefs, width, resizeWidth);
        };
        CompositionReadModelRootConverter.prototype.convertToColumnDef = function (columns) {
            var _this = this;
            var columnDefs = [];
            columns.forEach(function (column) {
                var columnDef = _this.columnDefinitionFactory.create(column);
                columnDefs.push(columnDef);
            });
            return columnDefs;
        };
        CompositionReadModelRootConverter.prototype.convertActiveColumnsToColumnDef = function (activeColumns) {
            var _this = this;
            var columnDefs = [];
            activeColumns.forEach(function (column) {
                var columnDef = _this.columnDefinitionFactory.create(column);
                columnDefs.push(columnDef);
            });
            return columnDefs;
        };
        return CompositionReadModelRootConverter;
    }());
    CompositionReadModelRootConverter.decorators = [
        { type: core.Injectable }
    ];
    CompositionReadModelRootConverter.ctorParameters = function () { return [
        { type: ColumnDefinitionFactory }
    ]; };

    var InMemoryCompositionReadStore = /** @class */ (function (_super) {
        __extends(InMemoryCompositionReadStore, _super);
        function InMemoryCompositionReadStore(inMemoryCompositionStore, compositionConverter) {
            var _this = _super.call(this, inMemoryCompositionStore) || this;
            _this.inMemoryCompositionStore = inMemoryCompositionStore;
            _this.compositionConverter = compositionConverter;
            return _this;
        }
        InMemoryCompositionReadStore.prototype.toReadModel = function (aggregate) {
            return this.compositionConverter.convert(aggregate);
        };
        return InMemoryCompositionReadStore;
    }(hermes.InMemoryReadModelStore));
    InMemoryCompositionReadStore.decorators = [
        { type: core.Injectable }
    ];
    InMemoryCompositionReadStore.ctorParameters = function () { return [
        { type: InMemoryCompositionStore },
        { type: CompositionReadModelRootConverter }
    ]; };

    var CompositionReadModelRootRepository = /** @class */ (function (_super) {
        __extends(CompositionReadModelRootRepository, _super);
        function CompositionReadModelRootRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        return CompositionReadModelRootRepository;
    }(hermes.ReadModelRootRepository));

    var InMemoryCompositionRepository = /** @class */ (function (_super) {
        __extends(InMemoryCompositionRepository, _super);
        function InMemoryCompositionRepository(domainEventBus, inMemoryCompositionReadStore) {
            var _this = _super.call(this, domainEventBus) || this;
            _this.inMemoryCompositionReadStore = inMemoryCompositionReadStore;
            _this.compositionIdToComposition = new Map();
            _this.composition$ = new hermes.HermesReplaySubject(1);
            return _this;
        }
        InMemoryCompositionRepository.prototype.on = function (compositionId) {
            return this.composition$
                .toObservable()
                .pipe(hermes.hermesFilter(function (compositionIdToComposition) {
                var key = compositionId.getId();
                return compositionIdToComposition.has(key);
            }), hermes.hermesMap(function (compositionIdToComposition) { return compositionIdToComposition.get(compositionId.getId()); }));
        };
        InMemoryCompositionRepository.prototype.forEvents = function () {
            return [
                CompositionCreatedEvent,
                CompositionResizeWidthSetEvent,
                CompositionColumnsSetEvent,
                CompositionContainerWidthSetEvent,
                CompositionWidthSetEvent,
                CompositionColumnSetEnabledEvent,
                CompositionColumnMovedLeftEvent,
                CompositionColumnMovedRightEvent,
                CompositionChangeSortStatusEvent
            ];
        };
        InMemoryCompositionRepository.prototype.subscribe = function (event) {
            var _this = this;
            var aggregateId = event.getAggregateId();
            var optComposition = this.inMemoryCompositionReadStore.getById(aggregateId);
            optComposition.ifPresent(function (composition) {
                var key = composition.getId().toString();
                _this.compositionIdToComposition.set(key, composition);
                _this.composition$.next(_this.compositionIdToComposition);
            });
        };
        return InMemoryCompositionRepository;
    }(CompositionReadModelRootRepository));
    InMemoryCompositionRepository.decorators = [
        { type: core.Injectable }
    ];
    InMemoryCompositionRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus },
        { type: InMemoryCompositionReadStore }
    ]; };

    var inMemoryCompositionCommandProviders = [
        InMemoryCompositionAggregateStore,
        {
            provide: CompositionAggregateRepository,
            useClass: InMemoryCompositionAggregateRepository
        }
    ];
    var inMemoryCompositionReadModelProviders = [
        InMemoryCompositionReadStore,
        {
            provide: CompositionReadModelRootRepository,
            useClass: InMemoryCompositionRepository
        }
    ];
    var inMemoryCompositionProviders = [
        InMemoryCompositionStore
    ];

    var SetGroupsCommandHandler = /** @class */ (function () {
        function SetGroupsCommandHandler(compositionAggregateRepository, domainEventPublisher, compositionEventConverter) {
            this.compositionAggregateRepository = compositionAggregateRepository;
            this.domainEventPublisher = domainEventPublisher;
            this.compositionEventConverter = compositionEventConverter;
        }
        SetGroupsCommandHandler.prototype.forCommand = function () {
            return SetGroupsCommand;
        };
        SetGroupsCommandHandler.prototype.handle = function (aggregate, command) {
            var groupConfigs = command.getConfigs();
            aggregate.setGroups(groupConfigs);
        };
        SetGroupsCommandHandler.prototype.publish = function (aggregate, command) {
            this.publishEvents(aggregate, command);
        };
        SetGroupsCommandHandler.prototype.publishEvents = function (composition, command) {
            var events = composition.getEvents();
            var domainEvents = this.compositionEventConverter.convert(events);
            this.domainEventPublisher.publish(domainEvents);
        };
        return SetGroupsCommandHandler;
    }());
    SetGroupsCommandHandler.decorators = [
        { type: core.Injectable }
    ];
    SetGroupsCommandHandler.ctorParameters = function () { return [
        { type: CompositionAggregateRepository },
        { type: hermes.DomainEventPublisher },
        { type: CompositionEventConverter }
    ]; };

    var ColumnHighlightManager = /** @class */ (function () {
        function ColumnHighlightManager() {
            this.enabled = true;
            this.highlightedColumns = new Set(); // should be set of ColumnId
        }
        ColumnHighlightManager.prototype.isHighlighted = function (columnId) {
            return this.highlightedColumns.has(columnId.toString());
        };
        ColumnHighlightManager.prototype.toggle = function (columnId) {
            if (this.highlightedColumns.has(columnId.toString())) {
                this.highlightedColumns.delete(columnId.toString());
            }
            else {
                this.highlightedColumns.add(columnId.toString());
            }
        };
        ColumnHighlightManager.prototype.remove = function (columnId) {
            this.highlightedColumns.delete(columnId.toString());
        };
        return ColumnHighlightManager;
    }());

    var ColumnHighlightArchive = /** @class */ (function (_super) {
        __extends(ColumnHighlightArchive, _super);
        function ColumnHighlightArchive() {
            return _super.call(this, new ColumnHighlightManager()) || this;
        }
        ColumnHighlightArchive.prototype.toggle = function (key, value) {
            var _this = this;
            this.get(key)
                .ifPresent(function (manager) {
                manager.toggle(value);
                _this.next(key, manager);
            });
        };
        ColumnHighlightArchive.prototype.equals = function (a, b) {
            return false;
        };
        ColumnHighlightArchive.prototype.createDefaultValue = function (defaultValue) {
            return new ColumnHighlightManager();
        };
        return ColumnHighlightArchive;
    }(hermes.AggregateArchive));
    ColumnHighlightArchive.decorators = [
        { type: core.Injectable }
    ];
    ColumnHighlightArchive.ctorParameters = function () { return []; };
    __decorate([
        Override
    ], ColumnHighlightArchive.prototype, "equals", null);
    __decorate([
        Override
    ], ColumnHighlightArchive.prototype, "createDefaultValue", null);

    var CompositionDomainModule = /** @class */ (function (_super) {
        __extends(CompositionDomainModule, _super);
        function CompositionDomainModule() {
            return _super.call(this) || this;
        }
        CompositionDomainModule.commandHandlers = function () {
            return [
                hermes.HermesModule.registerCommandHandler(SetColumnsCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(SetCompositionWidthCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(SetCompositionResizeWidthCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(SetCompositionContainerWidthCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(CompositionSetColumnEnabledCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(CompositionChangeSortStatusCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(CompositionMoveLeftColumnCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(CompositionMoveRightColumnCommandHandler, compositionKey),
                hermes.HermesModule.registerCommandHandler(SetGroupsCommandHandler, compositionKey)
            ];
        };
        CompositionDomainModule.domainEventHandlers = function () {
            return [
                hermes.HermesModule.registerMultiDomainEventHandler(CompositionChangeSortStatusEventHandler)
            ];
        };
        return CompositionDomainModule;
    }(hermes.DomainModule));
    CompositionDomainModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    providers: [
                        inMemoryCompositionCommandProviders,
                        CompositionDispatcher,
                        ColumnEntityFactory,
                        ColumnPresentationConverter,
                        CompositionEventConverter,
                        ColumnFieldFactory,
                        CompositionGroupFactory,
                        ColumnHighlightArchive
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];
    CompositionDomainModule.ctorParameters = function () { return []; };

    var GroupCollection = /** @class */ (function () {
        function GroupCollection(groups, showGroups) {
            this.groups = groups;
            this.showGroups = showGroups;
        }
        GroupCollection.prototype.getGroups = function () {
            return this.groups;
        };
        GroupCollection.prototype.isVisible = function () {
            return this.showGroups;
        };
        return GroupCollection;
    }());

    var CompositionGroupArchive = /** @class */ (function (_super) {
        __extends(CompositionGroupArchive, _super);
        function CompositionGroupArchive() {
            return _super.call(this, CompositionGroupArchive.default) || this;
        }
        return CompositionGroupArchive;
    }(hermes.AggregateArchive));
    CompositionGroupArchive.default = new GroupCollection([], false);
    CompositionGroupArchive.decorators = [
        { type: core.Injectable }
    ];
    CompositionGroupArchive.ctorParameters = function () { return []; };

    var CompositionDomainCommandInvoker = /** @class */ (function (_super) {
        __extends(CompositionDomainCommandInvoker, _super);
        function CompositionDomainCommandInvoker(compositionDispatcher, compositionGroupRepository, columnHighlightArchive) {
            var _this = _super.call(this) || this;
            _this.compositionDispatcher = compositionDispatcher;
            _this.compositionGroupRepository = compositionGroupRepository;
            _this.columnHighlightArchive = columnHighlightArchive;
            return _this;
        }
        CompositionDomainCommandInvoker.prototype.create = function (compositionId) {
            this.compositionDispatcher.createComposition(compositionId);
        };
        CompositionDomainCommandInvoker.prototype.setColumns = function (params, compositionId) {
            this.compositionDispatcher.setColumns(compositionId, params);
        };
        CompositionDomainCommandInvoker.prototype.setGroups = function (configs, compositionId) {
            // this.compositionGroupRepository.next(compositionId, CompositionGroupRepository.default);
            this.compositionDispatcher.setGroups(compositionId, configs);
        };
        CompositionDomainCommandInvoker.prototype.setWidth = function (width, compositionId) {
            this.compositionDispatcher.setWidth(compositionId, width);
        };
        CompositionDomainCommandInvoker.prototype.setContainerWidth = function (width, compositionId) {
            this.compositionDispatcher.setContainerWidth(compositionId, width);
        };
        CompositionDomainCommandInvoker.prototype.setResizeWidth = function (enabled, compositionId) {
            this.compositionDispatcher.setResizeWidth(compositionId, enabled);
        };
        CompositionDomainCommandInvoker.prototype.enableColumn = function (columnDefinitionId, compositionId) {
            this.compositionDispatcher.setColumnEnabled(compositionId, this.toColumnId(columnDefinitionId), true);
        };
        CompositionDomainCommandInvoker.prototype.disableColumn = function (columnDefinitionId, compositionId) {
            this.compositionDispatcher.setColumnEnabled(compositionId, this.toColumnId(columnDefinitionId), false);
        };
        CompositionDomainCommandInvoker.prototype.moveLeft = function (columnDefinitionId, compositionId) {
            this.compositionDispatcher.moveLeft(compositionId, this.toColumnId(columnDefinitionId));
        };
        CompositionDomainCommandInvoker.prototype.moveRight = function (columnDefinitionId, compositionId) {
            this.compositionDispatcher.moveRight(compositionId, this.toColumnId(columnDefinitionId));
        };
        CompositionDomainCommandInvoker.prototype.highlightColumn = function (columnDefinitionId, compositionId) {
            this.columnHighlightArchive.toggle(compositionId, new ColumnId(columnDefinitionId.getId()));
        };
        CompositionDomainCommandInvoker.prototype.toColumnId = function (defId) {
            return new ColumnId(defId.getId());
        };
        return CompositionDomainCommandInvoker;
    }(CompositionCommandInvoker));
    CompositionDomainCommandInvoker.decorators = [
        { type: core.Injectable }
    ];
    CompositionDomainCommandInvoker.ctorParameters = function () { return [
        { type: CompositionDispatcher },
        { type: CompositionGroupArchive },
        { type: ColumnHighlightArchive }
    ]; };

    var CompositionDomainEventRepository = /** @class */ (function (_super) {
        __extends(CompositionDomainEventRepository, _super);
        function CompositionDomainEventRepository(domainEventBus) {
            return _super.call(this, domainEventBus) || this;
        }
        CompositionDomainEventRepository.prototype.onColumnsChanged = function (compositionId) {
            return this.onEvent(compositionId, CompositionColumnsSetEvent);
        };
        CompositionDomainEventRepository.prototype.onContainerWidthChanged = function (compositionId) {
            return this.onEvent(compositionId, CompositionContainerWidthSetEvent)
                .pipe(hermes.hermesMap(function (event) {
                return event.getPayload();
            }), hermes.hermesFilter(function (width) { return !!width; }));
        };
        return CompositionDomainEventRepository;
    }(CompositionEventRepository));
    CompositionDomainEventRepository.decorators = [
        { type: core.Injectable }
    ];
    CompositionDomainEventRepository.ctorParameters = function () { return [
        { type: hermes.DomainEventBus }
    ]; };

    var CompositionDomainWarehouse = /** @class */ (function (_super) {
        __extends(CompositionDomainWarehouse, _super);
        function CompositionDomainWarehouse(compositionRepository, compositionGroupArchive, columnHighlightArchive) {
            var _this = _super.call(this) || this;
            _this.compositionRepository = compositionRepository;
            _this.compositionGroupArchive = compositionGroupArchive;
            _this.columnHighlightArchive = columnHighlightArchive;
            return _this;
        }
        CompositionDomainWarehouse.prototype.onWidth = function (compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.getWidth(); }));
        };
        CompositionDomainWarehouse.prototype.onContainerWidth = function (compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.getContainerWidth(); }));
        };
        CompositionDomainWarehouse.prototype.onWidthForEachColumn = function (compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.getAllColumns().map(function (c) { return c.width; }); }));
        };
        CompositionDomainWarehouse.prototype.onHeaderColumns = function (compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.getActiveHeaderColumns(); }));
        };
        CompositionDomainWarehouse.prototype.onAllColumns = function (compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.getHeaderColumns(); }));
        };
        CompositionDomainWarehouse.prototype.onSortOrder = function (fieldId, compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.getActiveHeaderColumns(); }), hermes.hermesMap(function (columns) {
                return columns.filter(function (c) { return c.getFieldId().equals(fieldId); });
            }), hermes.hermesFilter(function (columns) {
                return columns.length > 0;
            }), hermes.hermesMap(function (columns) { return columns[0].getSortStatus(); }));
        };
        CompositionDomainWarehouse.prototype.onTemplateColumns = function (compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.getTemplateColumns(); }));
        };
        CompositionDomainWarehouse.prototype.onResizeWidth = function (compositionId) {
            return this.compositionRepository
                .on(compositionId)
                .pipe(hermes.hermesMap(function (composition) { return composition.isResizeWidthEnabled(); }));
        };
        CompositionDomainWarehouse.prototype.onGroups = function (compositionId) {
            return this.compositionGroupArchive.on(compositionId);
        };
        CompositionDomainWarehouse.prototype.onHighlightedColumn = function (columnId, compositionId) {
            return this.columnHighlightArchive
                .on(compositionId)
                .pipe(hermes.hermesMap(function (manager) { return manager.isHighlighted(columnId); }));
        };
        return CompositionDomainWarehouse;
    }(CompositionWarehouse));
    CompositionDomainWarehouse.decorators = [
        { type: core.Injectable }
    ];
    CompositionDomainWarehouse.ctorParameters = function () { return [
        { type: CompositionReadModelRootRepository },
        { type: CompositionGroupArchive },
        { type: ColumnHighlightArchive }
    ]; };

    var DomainColumnAutoConfigurator = /** @class */ (function (_super) {
        __extends(DomainColumnAutoConfigurator, _super);
        function DomainColumnAutoConfigurator() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        DomainColumnAutoConfigurator.prototype.configure = function (source) {
            var _this = this;
            if (source !== undefined && source !== null && Array.isArray(source) && source.length === 0) {
                return [];
            }
            var rawItem = source[0];
            return Object.keys(rawItem)
                .map(function (key, index) {
                return _this.toColumnConfig(key, rawItem);
            });
        };
        DomainColumnAutoConfigurator.prototype.toColumnConfig = function (key, rawItem) {
            return {
                field: this.getField(key),
                header: this.getHeader(key),
                type: this.getType(key, rawItem)
            };
        };
        DomainColumnAutoConfigurator.prototype.getField = function (key) {
            return key;
        };
        DomainColumnAutoConfigurator.prototype.getHeader = function (key) {
            return key[0].toUpperCase() + key.slice(1);
        };
        DomainColumnAutoConfigurator.prototype.getType = function (key, rawItem) {
            if (typeof rawItem[key] === 'string') {
                return DataType.STRING;
            }
            else if (typeof rawItem[key] === 'number') {
                return DataType.NUMBER;
            }
            else if (rawItem[key] instanceof Date) {
                return DataType.DATE;
            }
            else if (typeof rawItem[key] === 'boolean') {
                return DataType.BOOLEAN;
            }
            else {
                return DataType.UNKNOWN;
            }
        };
        return DomainColumnAutoConfigurator;
    }(ColumnAutoConfigurator));
    DomainColumnAutoConfigurator.decorators = [
        { type: core.Injectable }
    ];

    var CompositionApiModule = /** @class */ (function () {
        function CompositionApiModule() {
        }
        return CompositionApiModule;
    }());
    CompositionApiModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        hermes.HermesModule.defineAggregate(compositionKey, CompositionAggregateFactory, InMemoryCompositionAggregateRepository, CreateCompositionCommandHandler, [
                            CompositionDomainModule.commandHandlers()
                        ], [
                            CompositionDomainModule.domainEventHandlers()
                        ]),
                        CompositionDomainModule
                    ],
                    providers: [
                        inMemoryCompositionReadModelProviders,
                        ColumnDefinitionFactory,
                        ViewTemplateRepository,
                        ViewTemplateFactory,
                        EditTemplateFactory,
                        EditTemplateRepository,
                        inMemoryCompositionProviders,
                        CompositionReadModelRootConverter,
                        CompositionGroupArchive,
                        {
                            provide: CompositionCommandInvoker,
                            useClass: CompositionDomainCommandInvoker
                        },
                        {
                            provide: CompositionWarehouse,
                            useClass: CompositionDomainWarehouse
                        },
                        {
                            provide: CompositionEventRepository,
                            useClass: CompositionDomainEventRepository
                        },
                        {
                            provide: ColumnAutoConfigurator,
                            useClass: DomainColumnAutoConfigurator
                        }
                    ],
                    declarations: [],
                    exports: []
                },] }
    ];

    var SafePipe = /** @class */ (function () {
        function SafePipe(sanitizer) {
            this.sanitizer = sanitizer;
        }
        SafePipe.prototype.transform = function (value, type) {
            switch (type) {
                case 'html':
                    return this.sanitizer.bypassSecurityTrustHtml(value);
                case 'style':
                    return this.sanitizer.bypassSecurityTrustStyle(value);
                case 'script':
                    return this.sanitizer.bypassSecurityTrustScript(value);
                case 'url':
                    return this.sanitizer.bypassSecurityTrustUrl(value);
                case 'resourceUrl':
                    return this.sanitizer.bypassSecurityTrustResourceUrl(value);
                default:
                    throw new Error("Invalid safe type specified: " + type);
            }
        };
        return SafePipe;
    }());
    SafePipe.decorators = [
        { type: core.Pipe, args: [{
                    name: 'guiSafe'
                },] }
    ];
    SafePipe.ctorParameters = function () { return [
        { type: platformBrowser.DomSanitizer }
    ]; };

    var SanitizeModule = /** @class */ (function () {
        function SanitizeModule() {
        }
        return SanitizeModule;
    }());
    SanitizeModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule
                    ],
                    declarations: [
                        SafePipe
                    ],
                    exports: [
                        SafePipe
                    ]
                },] }
    ];

    var EditCommunicationComponent = /** @class */ (function (_super) {
        __extends(EditCommunicationComponent, _super);
        function EditCommunicationComponent(changeDetectorRef, elementRef) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.ENTER_KEY_CODE = 13;
            _this.ESC_KEY_CODE = 27;
            return _this;
        }
        EditCommunicationComponent.prototype.submit = function () {
            this.emitStatus(EditEventType.SUBMIT);
        };
        EditCommunicationComponent.prototype.cancel = function () {
            this.emitStatus(EditEventType.CANCEL);
        };
        EditCommunicationComponent.prototype.emitStatus = function (status) {
            if (this.status) {
                this.status.emit(status);
            }
        };
        return EditCommunicationComponent;
    }(SmartComponent));
    EditCommunicationComponent.decorators = [
        { type: core.Directive }
    ];
    EditCommunicationComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };
    EditCommunicationComponent.propDecorators = {
        value: [{ type: core.Input }],
        valueChanges: [{ type: core.Input }],
        status: [{ type: core.Input }],
        focus: [{ type: core.Input }],
        parent: [{ type: core.Input }]
    };

    var InputEditTemplateComponent = /** @class */ (function (_super) {
        __extends(InputEditTemplateComponent, _super);
        function InputEditTemplateComponent(changeDetectorRef, elementRef, formBuilder) {
            var _a;
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.formBuilder = formBuilder;
            _this.filterFieldName = 'phrase';
            _this.filterForm = _this.formBuilder.group((_a = {},
                _a[_this.filterFieldName] = [''],
                _a));
            return _this;
        }
        InputEditTemplateComponent.prototype.ngOnChanges = function (changes) {
            if (changes.value !== undefined) {
                this.filterForm.get(this.filterFieldName).setValue(this.value);
            }
        };
        InputEditTemplateComponent.prototype.ngOnInit = function () {
            this.observeChanges();
        };
        InputEditTemplateComponent.prototype.ngAfterViewInit = function () {
            var _this = this;
            var inputElement = this.inputRef.nativeElement;
            this.focusField(inputElement);
            this.emitValueChange(inputElement.value);
            hermes.hermesFromEvent(inputElement, 'blur')
                .pipe(this.takeUntil())
                .subscribe(function () {
                _this.unsubscribe();
                _this.submit();
            });
            var keyup$ = hermes.hermesFromEvent(inputElement, 'keyup');
            keyup$
                .pipe(hermes.hermesFilter(function (e) { return e.keyCode === _this.ENTER_KEY_CODE; }), this.takeUntil())
                .subscribe(function () {
                _this.unsubscribe();
                _this.submit();
            });
            keyup$
                .pipe(hermes.hermesFilter(function (e) { return e.keyCode === _this.ESC_KEY_CODE; }), this.takeUntil())
                .subscribe(function () {
                _this.unsubscribe();
                _this.cancel();
            });
        };
        InputEditTemplateComponent.prototype.focusField = function (inputElement) {
            if (this.focus) {
                inputElement.focus();
            }
        };
        InputEditTemplateComponent.prototype.observeChanges = function () {
            var _this = this;
            hermes.fromRxJsObservable(this.filterForm
                .controls[this.filterFieldName]
                .valueChanges)
                .pipe(this.takeUntil())
                .subscribe(function (value) {
                _this.emitValueChange(value);
            });
        };
        InputEditTemplateComponent.prototype.emitValueChange = function (value) {
            if (this.valueChanges) {
                this.valueChanges.emit(value);
            }
        };
        return InputEditTemplateComponent;
    }(EditCommunicationComponent));
    InputEditTemplateComponent.decorators = [
        { type: core.Directive }
    ];
    InputEditTemplateComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: forms.FormBuilder }
    ]; };
    InputEditTemplateComponent.propDecorators = {
        inputRef: [{ type: core.ViewChild, args: ['input', { static: true },] }]
    };

    var StringEditTemplateComponent = /** @class */ (function (_super) {
        __extends(StringEditTemplateComponent, _super);
        function StringEditTemplateComponent(changeDetectorRef, elementRef, fb) {
            return _super.call(this, changeDetectorRef, elementRef, fb) || this;
        }
        StringEditTemplateComponent.prototype.focusField = function (inputElement) {
            if (this.focus) {
                inputElement.focus();
                inputElement.setSelectionRange(0, inputElement.value.length);
            }
        };
        StringEditTemplateComponent.prototype.getSelectorName = function () {
            return 'gui-string-edit';
        };
        return StringEditTemplateComponent;
    }(InputEditTemplateComponent));
    StringEditTemplateComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-string-edit',
                    template: "\n\n\t\t<form [formGroup]=\"filterForm\">\n\t\t\t<input #input [formControlName]=\"filterFieldName\" type=\"type\" class=\"gui-input\"/>\n\t\t</form>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    StringEditTemplateComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: forms.FormBuilder }
    ]; };
    __decorate([
        Override
    ], StringEditTemplateComponent.prototype, "focusField", null);

    var NumberEditTemplateComponent = /** @class */ (function (_super) {
        __extends(NumberEditTemplateComponent, _super);
        function NumberEditTemplateComponent(changeDetectorRef, elementRef, fb) {
            return _super.call(this, changeDetectorRef, elementRef, fb) || this;
        }
        NumberEditTemplateComponent.prototype.getSelectorName = function () {
            return 'gui-number-edit';
        };
        return NumberEditTemplateComponent;
    }(InputEditTemplateComponent));
    NumberEditTemplateComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-number-edit',
                    template: "\n\n\t\t<form [formGroup]=\"filterForm\">\n\t\t\t<input #input [formControlName]=\"filterFieldName\" type=\"number\" class=\"gui-input\"/>\n\t\t</form>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    NumberEditTemplateComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef },
        { type: forms.FormBuilder }
    ]; };

    var BooleanEditTemplateComponent = /** @class */ (function (_super) {
        __extends(BooleanEditTemplateComponent, _super);
        function BooleanEditTemplateComponent(changeDetectorRef, elementRef) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.filterFieldName = 'booleanEdit';
            return _this;
        }
        BooleanEditTemplateComponent.prototype.toggle = function (changed) {
            this.valueChanges.emit(changed);
            this.submit();
        };
        BooleanEditTemplateComponent.prototype.getSelectorName = function () {
            return 'gui-boolean-edit';
        };
        return BooleanEditTemplateComponent;
    }(EditCommunicationComponent));
    BooleanEditTemplateComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-boolean-edit',
                    template: "\n\n\t\t<span class=\"gui-cell-boolean\">\n\t\t\t<gui-checkbox #checkbox\n\t\t\t\t\t\t  [checked]=\"value\"\n\t\t\t\t\t\t  [name]=\"filterFieldName\"\n\t\t\t\t\t\t  (changed)=\"toggle($event)\">\n\t\t\t</gui-checkbox>\n\t\t</span>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    BooleanEditTemplateComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };
    BooleanEditTemplateComponent.propDecorators = {
        checkboxRef: [{ type: core.ViewChild, args: ['checkbox', { read: core.ElementRef, static: true },] }]
    };

    var DateEditTemplateComponent = /** @class */ (function (_super) {
        __extends(DateEditTemplateComponent, _super);
        function DateEditTemplateComponent(changeDetectorRef, elementRef) {
            var _this = _super.call(this, changeDetectorRef, elementRef) || this;
            _this.changeDetectorRef = changeDetectorRef;
            _this.filterFieldName = 'dateEdit';
            _this.opened = false;
            _this.localStreamCloser = new StreamCloser();
            return _this;
        }
        DateEditTemplateComponent.prototype.ngAfterViewInit = function () {
            var _this = this;
            var inputElement = this.datePickerRef.nativeElement.querySelector('.gui-date-picker-input');
            var keyup$ = hermes.hermesFromEvent(inputElement, 'keyup');
            keyup$
                .pipe(hermes.hermesFilter(function (e) { return e.keyCode === _this.ENTER_KEY_CODE; }), this.localStreamCloser.takeUntil())
                .subscribe(function () {
                _this.localStreamCloser.unsubscribe();
                _this.submit();
            });
            keyup$
                .pipe(hermes.hermesFilter(function (e) { return e.keyCode === _this.ESC_KEY_CODE; }), this.localStreamCloser.takeUntil())
                .subscribe(function () {
                _this.localStreamCloser.unsubscribe();
                _this.cancel();
            });
        };
        DateEditTemplateComponent.prototype.ngOnDestroy = function () {
            this.localStreamCloser.unsubscribe();
            _super.prototype.ngOnDestroy.call(this);
        };
        DateEditTemplateComponent.prototype.toggle = function (changed) {
            this.valueChanges.emit(changed);
        };
        DateEditTemplateComponent.prototype.dialogOpened = function (opened) {
            this.opened = opened;
            if (!opened) {
                this.localStreamCloser.unsubscribe();
                this.submit();
            }
        };
        DateEditTemplateComponent.prototype.getSelectorName = function () {
            return 'gui-date-edit';
        };
        return DateEditTemplateComponent;
    }(EditCommunicationComponent));
    DateEditTemplateComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-date-edit',
                    template: "\n\n\t\t<gui-date-picker #datepicker\n\t\t\t\t\t\t [selectDate]=\"value\"\n\t\t\t\t\t\t [name]=\"filterFieldName\"\n\t\t\t\t\t\t [openDialog]=\"true\"\n\t\t\t\t\t\t [onlyDialog]=\"false\"\n\t\t\t\t\t\t [parentElement]=\"parent\"\n\t\t\t\t\t\t (dialogOpened)=\"dialogOpened($event)\"\n\t\t\t\t\t\t (dateSelected)=\"toggle($event)\">\n\t\t</gui-date-picker>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    DateEditTemplateComponent.ctorParameters = function () { return [
        { type: core.ChangeDetectorRef },
        { type: core.ElementRef }
    ]; };
    DateEditTemplateComponent.propDecorators = {
        datePickerRef: [{ type: core.ViewChild, args: ['datepicker', { read: core.ElementRef, static: true },] }]
    };

    var ColumnQueryComponent = /** @class */ (function () {
        function ColumnQueryComponent() {
        }
        return ColumnQueryComponent;
    }());
    ColumnQueryComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-column[header]',
                    template: ''
                },] }
    ];
    ColumnQueryComponent.propDecorators = {
        cellTemplate: [{ type: core.ContentChild, args: [core.TemplateRef, { static: false },] }],
        header: [{ type: core.Input }]
    };

    var FunctionViewComponent = /** @class */ (function (_super) {
        __extends(FunctionViewComponent, _super);
        function FunctionViewComponent(sanitizer, elRef) {
            var _this = _super.call(this, elRef) || this;
            _this.sanitizer = sanitizer;
            _this.elRef = elRef;
            _this.addClassToHost('gui-h-full');
            _this.addClassToHost('gui-w-full');
            return _this;
        }
        FunctionViewComponent.prototype.ngOnChanges = function () {
            this.safeHTML = this.sanitizer.bypassSecurityTrustHtml(this.element.value);
        };
        FunctionViewComponent.prototype.getSelectorName = function () {
            return 'gui-function-view';
        };
        return FunctionViewComponent;
    }(PureComponent));
    FunctionViewComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-function-view',
                    template: "\n\n\t\t<div class=\"gui-h-full gui-flex gui-items-center\"\n\t\t\t [innerHTML]=\"safeHTML\">\n\t\t</div>\n\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    FunctionViewComponent.ctorParameters = function () { return [
        { type: platformBrowser.DomSanitizer },
        { type: core.ElementRef }
    ]; };
    FunctionViewComponent.propDecorators = {
        element: [{ type: core.Input }]
    };

    var BarViewComponent = /** @class */ (function (_super) {
        __extends(BarViewComponent, _super);
        function BarViewComponent(elementRef) {
            var _this = _super.call(this, elementRef) || this;
            _this.showPercentage = false;
            return _this;
        }
        BarViewComponent.prototype.ngOnChanges = function (changes) {
            var _this = this;
            ifChanged(changes.value, function () {
                _this.width = _this.value > 100 ? 100 : _this.value;
            });
        };
        BarViewComponent.prototype.getSelectorName = function () {
            return 'gui-bar-view';
        };
        return BarViewComponent;
    }(PureComponent));
    BarViewComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-bar-view[value]',
                    template: "\n\t\t<div class=\"gui-percentage-bar\">\n\t\t\t<div class=\"gui-percentage\" [style.width.%]=\"width\">\n\t\t\t</div>\n\t\t\t<gui-percentage-view *ngIf=\"showPercentage\"\n\t\t\t\t\t\t\t\t [value]=\"value\">\n\t\t\t</gui-percentage-view>\n\t\t</div>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    BarViewComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    BarViewComponent.propDecorators = {
        value: [{ type: core.Input }],
        showPercentage: [{ type: core.Input }]
    };

    var PercentageViewComponent = /** @class */ (function (_super) {
        __extends(PercentageViewComponent, _super);
        function PercentageViewComponent(elementRef) {
            return _super.call(this, elementRef) || this;
        }
        PercentageViewComponent.prototype.getSelectorName = function () {
            return 'gui-percentage-view';
        };
        return PercentageViewComponent;
    }(PureComponent));
    PercentageViewComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-percentage-view[value]',
                    template: "\n\t\t{{ value }} %\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    PercentageViewComponent.ctorParameters = function () { return [
        { type: core.ElementRef }
    ]; };
    PercentageViewComponent.propDecorators = {
        value: [{ type: core.Input }]
    };

    var TextViewComponent = /** @class */ (function (_super) {
        __extends(TextViewComponent, _super);
        function TextViewComponent(isBold, isItalic, elementRef, renderer) {
            var _this = _super.call(this, elementRef) || this;
            _this.elementRef = elementRef;
            _this.renderer = renderer;
            _this.isHtml = false;
            if (isBold !== null) {
                _this.addClassToHost('gui-bold');
            }
            if (isItalic !== null) {
                _this.addClassToHost('gui-italic');
            }
            return _this;
        }
        TextViewComponent.prototype.ngOnChanges = function () {
            this.isHtml = this.value.type === exports["ɵnn"].HTML;
        };
        TextViewComponent.prototype.getSelectorName = function () {
            return 'gui-text-view';
        };
        return TextViewComponent;
    }(PureComponent));
    TextViewComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'gui-view-text[value]',
                    template: "\n\n\t\t<ng-container *ngIf=\"isHtml; else text\">\n\t\t\t<span [innerHTML]=\"value.value | guiSafe: 'html'\"></span>\n\t\t</ng-container>\n\n\t\t<ng-template #text>\n\t\t\t<span>\n\t\t\t\t{{value.value}}\n\t\t\t</span>\n\t\t</ng-template>\n\t",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None
                },] }
    ];
    TextViewComponent.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: core.Attribute, args: ['bold',] }] },
        { type: undefined, decorators: [{ type: core.Attribute, args: ['italic',] }] },
        { type: core.ElementRef },
        { type: core.Renderer2 }
    ]; };
    TextViewComponent.propDecorators = {
        value: [{ type: core.Input }]
    };

    var components = [
        ViewTemplatesComponent,
        EditTemplatesComponent,
        StringEditTemplateComponent,
        NumberEditTemplateComponent,
        BooleanEditTemplateComponent,
        DateEditTemplateComponent,
        ColumnQueryComponent,
        FunctionViewComponent,
        BarViewComponent,
        PercentageViewComponent,
        TextViewComponent
    ];
    var exportDeclarations$2 = [
        ViewTemplatesComponent,
        EditTemplatesComponent,
        ColumnQueryComponent,
        fabric.FabricChipModule,
        fabric.FabricCheckboxModule,
        fabric.FabricButtonModule,
        fabric.FabricInputModule,
        FunctionViewComponent,
        BarViewComponent,
        PercentageViewComponent
    ];
    var CompositionFeatureModule = /** @class */ (function (_super) {
        __extends(CompositionFeatureModule, _super);
        function CompositionFeatureModule() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        CompositionFeatureModule.forComponent = function () {
            return [];
        };
        return CompositionFeatureModule;
    }(hermes.FeatureModule));
    CompositionFeatureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        common.CommonModule,
                        CompositionApiModule,
                        forms.ReactiveFormsModule,
                        SanitizeModule,
                        fabric.FabricChipModule,
                        fabric.FabricCheckboxModule,
                        fabric.FabricButtonModule,
                        fabric.FabricInputModule,
                        fabric.FabricDatePickerModule
                    ],
                    declarations: [
                        components
                    ],
                    exports: [
                        exportDeclarations$2
                    ],
                    entryComponents: [
                        ViewTemplatesComponent,
                        EditTemplatesComponent,
                        fabric.FabricChipComponent,
                        fabric.FabricCheckboxComponent,
                        fabric.FabricButtonComponent,
                        fabric.FabricInputComponent
                    ]
                },] }
    ];

    var StructureHeaderGroupsComponent = /** @class */ (function (_super) {
        __extends(StructureHeaderGroupsComponent, _super);
        function StructureHeaderGroupsComponent(elementRef, injector, changeDetectorRef, compositionId, structureId, formationCommandDispatcher, sortingCommandDispatcher) {
            var _this = _super.call(this, elementRef) || this;
            _this.elementRef = elementRef;
            _this.injector = injector;
            _this.changeDetectorRef = changeDetectorRef;
            _this.compositionId = compositionId;
            _this.structureId = structureId;
            _this.formationCommandDispatcher = formationCommandDispatcher;
            _this.sortingCommandDispatcher = sortingCommandDispatcher;
            _this.checkboxSelection = false;
            _this.globalSearching = false;
            return _this;
        }
        StructureHeaderGroupsComponent.prototype.toggleSort = function (column) {
            if (column.isSortEnabled()) {
                this.sortingCommandDispatcher.toggleSort(column.getFieldId(), this.compositionId, this.structureId);
            }
        };
        StructureHeaderGroupsComponent.prototype.isSortAsc = function (column) {
            return column.getSortStatus() === exports["ɵnr"].ASC;
        };
        StructureHeaderGroupsComponent.prototype.isSortDesc = function (column) {
            return column.getSortStatus() === exports["ɵnr"].DESC;
        };
        StructureHeaderGroupsComponent.prototype.isGlobalSortEnabled = function () {
            return this.globalSearching;
        };
        StructureHeaderGroupsComponent.prototype.getSelectorName = function () {
            return 'gui-structure-header-groups';
        };
        return StructureHeaderGroupsComponent;
    }(PureComponent));
    StructureHeaderGroupsComponent.decorators = [
        { type: core.Component, args: [{
                    selector: 'div[gui-structure-header-groups][groups][checkboxSelection]',
                    template: "<div *ngIf=\"checkboxSelection\"\n\t class=\"gui-header-cell gui-row-checkbox gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis\">\n\t<div gui-select-all></div>\n</div>\n\n<div *ngFor=\"let group of groups\"\n\t [style.width.px]=\"group.width\"\n\t class=\"gui-header-cell gui-flex gui-justify-between\n\t gui-overflow-hidden gui-relative gui-py-0 gui-px-6 gui-box-border\n\t gui-leading-4 gui-whitespace-nowrap gui-overflow-ellipsis\">\n\n\t<div class=\"gui-header-title\">\n\t\t{{group.header}}\n\t</div>\n</div>\n",
                    changeDetection: core.ChangeDetectionStrategy.OnPush,
                    encapsulation: core.ViewEncapsulation.None,
                    providers: [
                        StructureColumnConfigService
                    ]
                },] }
    ];
    StructureHeaderGroupsComponent.ctorParameters = function () { return [
        { type: core.ElementRef },
        { type: core.Injector },
        { type: core.ChangeDetectorRef },
        { type: CompositionId },
        { type: StructureId },
        { type: FormationCommandInvoker },
        { type: SortingCommandInvoker }
    ]; };
    StructureHeaderGroupsComponent.propDecorators = {
        groups: [{ type: core.Input }],
        showGroups: [{ type: core.Input }],
        checkboxSelection: [{ type: core.Input }]
    };

    var StructureSearchingGate = /** @class */ (function (_super) {
        __extends(StructureSearchingGate, _super);
        function StructureSearchingGate(structureId, searchEventRepository, searchCommandInvoker) {
            return _super.call(this, structureId, searchEventRepository, searchCommandInvoker) || this;
        }
        return StructureSearchingGate;
    }(SearchingGate));
    StructureSearchingGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[searching]'
                },] }
    ];
    StructureSearchingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SearchEventRepository },
        { type: SearchCommandInvoker }
    ]; };

    var StructureColumnHeaderGate = /** @class */ (function (_super) {
        __extends(StructureColumnHeaderGate, _super);
        function StructureColumnHeaderGate(structureHeaderTopEnabledArchive, structureHeaderBottomEnabledArchive) {
            var _this = _super.call(this) || this;
            _this.structureHeaderTopEnabledArchive = structureHeaderTopEnabledArchive;
            _this.structureHeaderBottomEnabledArchive = structureHeaderBottomEnabledArchive;
            return _this;
        }
        StructureColumnHeaderGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('columnHeaderTop', changes)) {
                this.structureHeaderTopEnabledArchive.next(this.columnHeaderTop);
            }
            if (this.isDefined('columnHeaderBottom', changes)) {
                this.structureHeaderBottomEnabledArchive.next(this.columnHeaderBottom);
            }
        };
        return StructureColumnHeaderGate;
    }(Gate));
    StructureColumnHeaderGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[columnHeaderTop][columnHeaderBottom], gui-structure[columnHeaderTop], gui-structure[columnHeaderBottom]'
                },] }
    ];
    StructureColumnHeaderGate.ctorParameters = function () { return [
        { type: StructureHeaderTopEnabledArchive },
        { type: StructureHeaderBottomEnabledArchive }
    ]; };
    StructureColumnHeaderGate.propDecorators = {
        columnHeaderTop: [{ type: core.Input }],
        columnHeaderBottom: [{ type: core.Input }]
    };

    var StructurePagingGate = /** @class */ (function (_super) {
        __extends(StructurePagingGate, _super);
        function StructurePagingGate(structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository, pagingDisplayModeArchive) {
            var _this = _super.call(this, structureId, compositionId, structurePagingCommandDispatcher, pagingEventRepository) || this;
            _this.pagingDisplayModeArchive = pagingDisplayModeArchive;
            return _this;
        }
        StructurePagingGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('paging', changes)) {
                var pagingConfig = void 0;
                if (typeof this.paging === 'boolean') {
                    pagingConfig = {
                        enabled: this.paging
                    };
                }
                else {
                    pagingConfig = this.paging;
                    if (this.paging.displayMode !== undefined) {
                        this.pagingDisplayModeArchive.next(this.paging.displayMode);
                    }
                }
                this.pagingCommandInvoker.setPaging(pagingConfig, this.structureId);
            }
        };
        return StructurePagingGate;
    }(PagingGate));
    StructurePagingGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[paging]'
                },] }
    ];
    StructurePagingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: CompositionId },
        { type: PagingCommandInvoker },
        { type: PagingEventRepository },
        { type: PagingDisplayModeArchive }
    ]; };
    __decorate([
        Override
    ], StructurePagingGate.prototype, "ngOnChanges", null);

    var SelectionGate = /** @class */ (function (_super) {
        __extends(SelectionGate, _super);
        function SelectionGate(structureId, formationEventService, formationCommandDispatcher, rowSelectionTypeArchive) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.formationEventService = formationEventService;
            _this.formationCommandDispatcher = formationCommandDispatcher;
            _this.rowSelectionTypeArchive = rowSelectionTypeArchive;
            _this.itemsSelected = new core.EventEmitter();
            _this.selectedRows = new core.EventEmitter();
            return _this;
        }
        SelectionGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('rowSelection', changes)) {
                if (this.rowSelection.isEnabledDefined()) {
                    this.formationCommandDispatcher.setSelection(this.rowSelection.isEnabled(), this.structureId);
                }
                if (this.rowSelection.isTypeDefined()) {
                    this.rowSelectionTypeArchive.next(this.rowSelection.getType());
                }
                if (this.rowSelection.isModeDefined()) {
                    this.formationCommandDispatcher.changeMode(this.rowSelection.getMode(), this.structureId);
                }
            }
        };
        SelectionGate.prototype.ngOnInit = function () {
            var _this = this;
            this.formationEventService
                .onItemSelected(this.structureId)
                .pipe(this.hermesTakeUntil())
                .subscribe(function (items) {
                _this.itemsSelected.emit(items.map(function (i) { return i.getSource(); }));
                _this.selectedRows.emit(items);
            });
        };
        SelectionGate.prototype.ngOnDestroy = function () {
            _super.prototype.ngOnDestroy.call(this);
        };
        return SelectionGate;
    }(Gate));
    SelectionGate.decorators = [
        { type: core.Directive }
    ];
    SelectionGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: FormationEventRepository },
        { type: FormationCommandInvoker },
        { type: RowSelectionTypeArchive }
    ]; };
    SelectionGate.propDecorators = {
        rowSelection: [{ type: core.Input }],
        itemsSelected: [{ type: core.Output }],
        selectedRows: [{ type: core.Output }]
    };

    var StructureSelectionGate = /** @class */ (function (_super) {
        __extends(StructureSelectionGate, _super);
        function StructureSelectionGate(structureId, formationEventService, formationCommandDispatcher, rowSelectionTypeArchive) {
            return _super.call(this, structureId, formationEventService, formationCommandDispatcher, rowSelectionTypeArchive) || this;
        }
        return StructureSelectionGate;
    }(SelectionGate));
    StructureSelectionGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[rowSelection], gui-structure[selectionGate]'
                },] }
    ];
    StructureSelectionGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: FormationEventRepository },
        { type: FormationCommandInvoker },
        { type: RowSelectionTypeArchive }
    ]; };
    StructureSelectionGate.propDecorators = {
        selectionGate: [{ type: core.Input }]
    };

    var StructureL10nGate = /** @class */ (function (_super) {
        __extends(StructureL10nGate, _super);
        function StructureL10nGate(translationService) {
            var _this = _super.call(this) || this;
            _this.translationService = translationService;
            return _this;
        }
        StructureL10nGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('localization', changes)) {
                if (this.localization.translationResolver) {
                    this.translationService.setResolver(this.localization.translationResolver);
                }
                if (this.localization.translation) {
                    this.translationService.changeTranslation(this.localization.translation);
                }
            }
        };
        return StructureL10nGate;
    }(Gate));
    StructureL10nGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[localization]'
                },] }
    ];
    StructureL10nGate.ctorParameters = function () { return [
        { type: TranslationFacade }
    ]; };
    StructureL10nGate.propDecorators = {
        localization: [{ type: core.Input }]
    };

    var StructurePanelGate = /** @class */ (function (_super) {
        __extends(StructurePanelGate, _super);
        function StructurePanelGate(structureTitlePanelConfigArchive, structureFooterPanelConfigArchive) {
            var _this = _super.call(this) || this;
            _this.structureTitlePanelConfigArchive = structureTitlePanelConfigArchive;
            _this.structureFooterPanelConfigArchive = structureFooterPanelConfigArchive;
            return _this;
        }
        StructurePanelGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('titlePanel', changes)) {
                this.structureTitlePanelConfigArchive.next(this.titlePanel);
            }
            if (this.isDefined('footerPanel', changes)) {
                this.structureFooterPanelConfigArchive.next(this.footerPanel);
            }
        };
        return StructurePanelGate;
    }(Gate));
    StructurePanelGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[titlePanel][footerPanel]'
                },] }
    ];
    StructurePanelGate.ctorParameters = function () { return [
        { type: StructureTitlePanelConfigArchive },
        { type: StructureFooterPanelConfigArchive }
    ]; };
    StructurePanelGate.propDecorators = {
        titlePanel: [{ type: core.Input }],
        footerPanel: [{ type: core.Input }]
    };

    var StructureRowDetailGate = /** @class */ (function (_super) {
        __extends(StructureRowDetailGate, _super);
        function StructureRowDetailGate(structureDetailViewConfigArchive) {
            var _this = _super.call(this) || this;
            _this.structureDetailViewConfigArchive = structureDetailViewConfigArchive;
            return _this;
        }
        StructureRowDetailGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('rowDetail', changes)) {
                this.structureDetailViewConfigArchive.next(this.rowDetail);
            }
        };
        return StructureRowDetailGate;
    }(Gate));
    StructureRowDetailGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[rowDetail]'
                },] }
    ];
    StructureRowDetailGate.ctorParameters = function () { return [
        { type: StructureRowDetailConfigArchive }
    ]; };
    StructureRowDetailGate.propDecorators = {
        rowDetail: [{ type: core.Input }]
    };

    var StructureColumnMenuGate = /** @class */ (function (_super) {
        __extends(StructureColumnMenuGate, _super);
        function StructureColumnMenuGate(structureColumnMenuConfigArchive) {
            var _this = _super.call(this) || this;
            _this.structureColumnMenuConfigArchive = structureColumnMenuConfigArchive;
            return _this;
        }
        StructureColumnMenuGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('columnMenu', changes)) {
                this.structureColumnMenuConfigArchive.nextConfig(this.columnMenu);
            }
        };
        return StructureColumnMenuGate;
    }(Gate));
    StructureColumnMenuGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[columnMenu]'
                },] }
    ];
    StructureColumnMenuGate.ctorParameters = function () { return [
        { type: StructureColumnMenuConfigArchive }
    ]; };
    StructureColumnMenuGate.propDecorators = {
        columnMenu: [{ type: core.Input }]
    };

    var StructureSummariesGate = /** @class */ (function (_super) {
        __extends(StructureSummariesGate, _super);
        function StructureSummariesGate(structureId, summariesCommandInvoker) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.summariesCommandInvoker = summariesCommandInvoker;
            return _this;
        }
        StructureSummariesGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('summaries', changes)) {
                this.summariesCommandInvoker.setConfig(this.summaries, this.structureId);
            }
        };
        return StructureSummariesGate;
    }(Gate));
    StructureSummariesGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[summaries]'
                },] }
    ];
    StructureSummariesGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SummariesCommandInvoker }
    ]; };
    StructureSummariesGate.propDecorators = {
        summaries: [{ type: core.Input }]
    };

    var StructureInfoPanelGate = /** @class */ (function (_super) {
        __extends(StructureInfoPanelGate, _super);
        function StructureInfoPanelGate(structureInfoPanelConfigService) {
            var _this = _super.call(this) || this;
            _this.structureInfoPanelConfigService = structureInfoPanelConfigService;
            return _this;
        }
        StructureInfoPanelGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('infoPanel', changes)) {
                if (typeof this.infoPanel === 'boolean') {
                    this.infoPanel = {
                        enabled: this.infoPanel
                    };
                }
                this.structureInfoPanelConfigService.set(this.infoPanel);
            }
        };
        return StructureInfoPanelGate;
    }(Gate));
    StructureInfoPanelGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[infoPanel]'
                },] }
    ];
    StructureInfoPanelGate.ctorParameters = function () { return [
        { type: StructureInfoPanelConfigService }
    ]; };
    StructureInfoPanelGate.propDecorators = {
        infoPanel: [{ type: core.Input }]
    };

    var StructureRowClassGate = /** @class */ (function (_super) {
        __extends(StructureRowClassGate, _super);
        function StructureRowClassGate(schemaRowClassArchive) {
            var _this = _super.call(this) || this;
            _this.schemaRowClassArchive = schemaRowClassArchive;
            return _this;
        }
        StructureRowClassGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('rowClass', changes)) {
                this.schemaRowClassArchive.next(this.rowClass);
            }
        };
        return StructureRowClassGate;
    }(Gate));
    StructureRowClassGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[rowClass]'
                },] }
    ];
    StructureRowClassGate.ctorParameters = function () { return [
        { type: SchemaRowClassArchive }
    ]; };
    StructureRowClassGate.propDecorators = {
        rowClass: [{ type: core.Input }]
    };

    var StructureRowColoringGate = /** @class */ (function (_super) {
        __extends(StructureRowColoringGate, _super);
        function StructureRowColoringGate(schemaId, schemaCommandInvoker, schemaEventRepository) {
            var _this = _super.call(this) || this;
            _this.schemaId = schemaId;
            _this.schemaCommandInvoker = schemaCommandInvoker;
            _this.schemaEventRepository = schemaEventRepository;
            _this.rowColoringChanged = new core.EventEmitter();
            return _this;
        }
        StructureRowColoringGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('rowColoring', changes)) {
                this.schemaCommandInvoker.setRowColoring(this.rowColoring, this.schemaId);
            }
        };
        StructureRowColoringGate.prototype.ngOnInit = function () {
            this.subscribeAndEmit(this.schemaEventRepository.onRowColoring(this.schemaId), this.rowColoringChanged);
        };
        StructureRowColoringGate.prototype.ngOnDestroy = function () {
            _super.prototype.ngOnDestroy.call(this);
        };
        return StructureRowColoringGate;
    }(Gate));
    StructureRowColoringGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[rowColoring]'
                },] }
    ];
    StructureRowColoringGate.ctorParameters = function () { return [
        { type: SchemaReadModelRootId },
        { type: SchemaCommandInvoker },
        { type: SchemaEventRepository }
    ]; };
    StructureRowColoringGate.propDecorators = {
        rowColoring: [{ type: core.Input }],
        rowColoringChanged: [{ type: core.Output }]
    };

    var StructureRowStyleGate = /** @class */ (function (_super) {
        __extends(StructureRowStyleGate, _super);
        function StructureRowStyleGate(schemaRowStyleArchive) {
            var _this = _super.call(this) || this;
            _this.schemaRowStyleArchive = schemaRowStyleArchive;
            return _this;
        }
        StructureRowStyleGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('rowStyle', changes)) {
                this.schemaRowStyleArchive.next(this.rowStyle);
            }
        };
        return StructureRowStyleGate;
    }(Gate));
    StructureRowStyleGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[rowStyle]'
                },] }
    ];
    StructureRowStyleGate.ctorParameters = function () { return [
        { type: SchemaRowStyleArchive }
    ]; };
    StructureRowStyleGate.propDecorators = {
        rowStyle: [{ type: core.Input }]
    };

    var ThemeGridGate = /** @class */ (function (_super) {
        __extends(ThemeGridGate, _super);
        function ThemeGridGate(schemaId, schemaCommandInvoker, schemaEventRepository) {
            var _this = _super.call(this) || this;
            _this.schemaId = schemaId;
            _this.schemaCommandInvoker = schemaCommandInvoker;
            _this.schemaEventRepository = schemaEventRepository;
            _this.horizontalGridChanged = new core.EventEmitter();
            _this.verticalGridChanged = new core.EventEmitter();
            return _this;
        }
        ThemeGridGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('verticalGrid', changes)) {
                this.schemaCommandInvoker.setVerticalGrid(this.verticalGrid, this.schemaId);
            }
            if (this.isDefined('horizontalGrid', changes)) {
                this.schemaCommandInvoker.setHorizontalGrid(this.horizontalGrid, this.schemaId);
            }
        };
        ThemeGridGate.prototype.ngOnInit = function () {
            this.subscribeAndEmit(this.schemaEventRepository.onHorizontalGridChanged(this.schemaId), this.horizontalGridChanged);
            this.subscribeAndEmit(this.schemaEventRepository.onVerticalGridChanged(this.schemaId), this.verticalGridChanged);
        };
        return ThemeGridGate;
    }(Gate));
    ThemeGridGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[verticalGrid][horizontalGrid]'
                },] }
    ];
    ThemeGridGate.ctorParameters = function () { return [
        { type: SchemaReadModelRootId },
        { type: SchemaCommandInvoker },
        { type: SchemaEventRepository }
    ]; };
    ThemeGridGate.propDecorators = {
        verticalGrid: [{ type: core.Input }],
        horizontalGrid: [{ type: core.Input }],
        horizontalGridChanged: [{ type: core.Output }],
        verticalGridChanged: [{ type: core.Output }]
    };

    var SourceLoadingGate = /** @class */ (function (_super) {
        __extends(SourceLoadingGate, _super);
        function SourceLoadingGate(structureId, sourceCommandInvoker) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.sourceCommandInvoker = sourceCommandInvoker;
            return _this;
        }
        SourceLoadingGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('loading', changes)) {
                this.sourceCommandInvoker.setLoading(this.loading, this.structureId);
            }
        };
        SourceLoadingGate.prototype.ngOnInit = function () {
        };
        return SourceLoadingGate;
    }(Gate));
    SourceLoadingGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[loading]'
                },] }
    ];
    SourceLoadingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SourceCommandInvoker }
    ]; };
    SourceLoadingGate.propDecorators = {
        loading: [{ type: core.Input }]
    };

    var VerticalFormationGate = /** @class */ (function (_super) {
        __extends(VerticalFormationGate, _super);
        function VerticalFormationGate(structureId, structureCommandInvoker) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.structureCommandInvoker = structureCommandInvoker;
            return _this;
        }
        VerticalFormationGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('virtualScroll', changes)) {
                if (this.virtualScroll) {
                    this.structureCommandInvoker.enableVirtualScroll(this.structureId);
                }
                else {
                    this.structureCommandInvoker.disableVirtualScroll(this.structureId);
                }
            }
        };
        return VerticalFormationGate;
    }(Gate));
    VerticalFormationGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[virtualScroll]'
                },] }
    ];
    VerticalFormationGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: StructureCommandInvoker }
    ]; };
    VerticalFormationGate.propDecorators = {
        virtualScroll: [{ type: core.Input }]
    };

    var StructureSortingGate = /** @class */ (function (_super) {
        __extends(StructureSortingGate, _super);
        function StructureSortingGate(structureId, sortingCommandInvoker) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.sortingCommandInvoker = sortingCommandInvoker;
            return _this;
        }
        StructureSortingGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('sorting', changes)) {
                var sorting = void 0;
                if (typeof this.sorting === 'boolean') {
                    sorting = {
                        enabled: this.sorting
                    };
                }
                else {
                    sorting = this.sorting;
                }
                this.sortingCommandInvoker.setSortingConfig(sorting, this.structureId);
            }
        };
        return StructureSortingGate;
    }(Gate));
    StructureSortingGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[sorting]'
                },] }
    ];
    StructureSortingGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: SortingCommandInvoker }
    ]; };
    StructureSortingGate.propDecorators = {
        sorting: [{ type: core.Input }]
    };

    var StructureFilterGate = /** @class */ (function (_super) {
        __extends(StructureFilterGate, _super);
        function StructureFilterGate(structureId, structureCommandInvoker) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.structureCommandInvoker = structureCommandInvoker;
            return _this;
        }
        StructureFilterGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('filtering', changes)) {
                var filtering = void 0;
                if (typeof this.filtering === 'boolean') {
                    filtering = {
                        enabled: this.filtering
                    };
                }
                else {
                    filtering = this.filtering;
                }
                this.structureCommandInvoker.setFilterConfig(filtering, this.structureId);
            }
        };
        return StructureFilterGate;
    }(Gate));
    StructureFilterGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[filtering]'
                },] }
    ];
    StructureFilterGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: StructureCommandInvoker }
    ]; };
    StructureFilterGate.propDecorators = {
        filtering: [{ type: core.Input }]
    };

    var StructureQuickFiltersGate = /** @class */ (function (_super) {
        __extends(StructureQuickFiltersGate, _super);
        function StructureQuickFiltersGate(structureId, structureCommandInvoker) {
            var _this = _super.call(this) || this;
            _this.structureId = structureId;
            _this.structureCommandInvoker = structureCommandInvoker;
            return _this;
        }
        StructureQuickFiltersGate.prototype.ngOnChanges = function (changes) {
            if (this.isDefined('quickFilters', changes)) {
                var quickFilters = void 0;
                if (typeof this.quickFilters === 'boolean') {
                    quickFilters = {
                        enabled: this.quickFilters
                    };
                }
                else {
                    quickFilters = this.quickFilters;
                }
                this.structureCommandInvoker.setQuickFiltersConfig(quickFilters, this.structureId);
            }
        };
        return StructureQuickFiltersGate;
    }(Gate));
    StructureQuickFiltersGate.decorators = [
        { type: core.Directive, args: [{
                    selector: 'gui-structure[quickFilters]'
                },] }
    ];
    StructureQuickFiltersGate.ctorParameters = function () { return [
        { type: StructureId },
        { type: StructureCommandInvoker }
    ]; };
    StructureQuickFiltersGate.propDecorators = {
        quickFilters: [{ type: core.Input }]
    };

    var structureGates = [
        StructureColumnHeaderGate,
        StructurePagingGate,
        StructureSearchingGate,
        // StructureSourceGate,
        StructureSelectionGate,
        StructureL10nGate,
        StructurePanelGate,
        StructureRowDetailGate,
        StructureColumnMenuGate,
        StructureSummariesGate,
        StructureInfoPanelGate,
        StructureRowClassGate,
        StructureRowStyleGate,
        StructureRowColoringGate,
        ThemeGridGate,
        StructureSortingGate,
        SourceLoadingGate,
        StructureFilterGate,
        StructureQuickFiltersGate,
        VerticalFormationGate
    ];

    var CssClassModule = /** @class */ (function () {
        function CssClassModule() {
        }
        return CssClassModule;
    }());
    CssClassModule.decorators = [
        { type: core.NgModule, args: [{
                    providers: [
                        CssClassModifier
                    ]
                },] }
    ];

    var StructureSharedModule = /** @class */ (function () {
        function StructureSharedModule() {
        }
        return StructureSharedModule;
    }());
    StructureSharedModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        CssClassModule
                    ]
                },] }
    ];

    var ResizeDetectorModule = /** @class */ (function () {
        function ResizeDetectorModule() {
        }
        return ResizeDetectorModule;
    }());
    ResizeDetectorModule.decorators = [
        { type: core.NgModule, args: [{
                    providers: [
                        ResizeDetector
                    ]
                },] }
    ];

    function createStructureDefinition() {
        return new StructureDefinition.DefaultBuilder().build();
    }
    var imports$1 = [
        common.CommonModule,
        forms.ReactiveFormsModule,
        TranslationFeatureModule,
        hermes.HermesModule,
        hermes.HermesModule.defineAggregate(structureKey, StructureAggregateFactory, InMemoryStructureAggregateRepository, CreateStructureCommandHandler, [
            PagingDomainModule.commandHandlers(),
            SortingDomainModule.commandHandlers(),
            FieldDomainModule.commandHandlers(),
            SearchDomainModule.commandHandlers(),
            FilterDomainModule.commandHandlers(),
            SourceDomainModule.commandHandlers(),
            SummariesDomainModule.commandHandlers(),
            VerticalFormationDomainModule.commandHandlers(),
            structureCommandHandlers
        ], [
            structureDomainEventHandlers,
            SearchDomainModule.domainEventHandlers(),
            FilterDomainModule.domainEventHandlers(),
            SourceDomainModule.domainEventHandlers(),
            SummariesDomainModule.domainEventHandlers(),
            FieldDomainModule.domainEventHandlers(),
            VerticalFormationDomainModule.domainEventHandlers()
        ]),
        // .withConfig({
        // 	loggers: false
        // }),
        fabricImports,
        ResizeDetectorModule,
        PagingFeatureModule,
        SortingFeatureModule,
        FieldFeatureModule,
        SearchFeatureModule,
        FilterMenuFeatureModule,
        SourceFeatureModule,
        SummariesFeatureModule,
        VerticalFormationFeatureModule,
        SchemaFeatureModule,
        StructureSharedModule,
        StructureInfoPanelModule,
        StructureTopPanelModule,
        StructureColumnMenuModule,
        StructureColumnManagerModule,
        SchemaManagerModule,
        EmptySourceFeatureModule,
        CompositionFeatureModule,
        LoggerModule,
        SanitizeModule
    ];
    var declarations$1 = [
        StructureComponent,
        StructureHeaderComponent,
        StructureHeaderColumnsComponent,
        StructureHeaderGroupsComponent,
        StructureHeaderFiltersComponent,
        StructureHeaderFilterComponent,
        SelectAllComponent,
        StructureContentComponent,
        StructureRowComponent,
        StructureCellComponent,
        StructureCellEditComponent,
        StructureCellEditBooleanComponent,
        StructureContainerComponent,
        StructureQuickFiltersComponent,
        StructureBlueprintComponent,
        StructureRowDetailViewComponent,
        StructureTitlePanelComponent,
        StructureFooterPanelComponent,
        structureGates
    ];
    var entryComponents$1 = [
        StructureColumnConfigComponent,
        StructureRowDetailViewComponent
    ];
    var exportDeclarations$1 = [
        fabric.FabricModule,
        StructureComponent,
        StructureHeaderComponent,
        StructureContentComponent,
        StructureRowComponent,
        StructureContainerComponent,
        fabricImports,
        PagingFeatureModule,
        structureGates
    ];
    var StructureModule = /** @class */ (function () {
        function StructureModule(platformId) {
            this.platformId = platformId;
            if (common.isPlatformBrowser(this.platformId)) {
                window[StructureModule.HERMES_API].loggers = false;
            }
        }
        StructureModule.withConfig = function (structureConfig) {
            if (structureConfig === void 0) { structureConfig = {
                cssClassName: '',
                hermesModuleConfig: { loggers: false }
            }; }
            return {
                ngModule: StructureModule,
                providers: [
                    {
                        provide: STRUCTURE_CSS_CLASS_NAME,
                        useValue: structureConfig.cssClassName
                    },
                    { provide: hermes.COMMAND_LOGGER_ENABLED, useValue: structureConfig.hermesModuleConfig.loggers },
                    { provide: hermes.EVENT_LOGGER_ENABLED, useValue: structureConfig.hermesModuleConfig.loggers },
                    {
                        provide: STRUCTURE_CSS_CLASS_NAME,
                        useValue: 'structure'
                    },
                    {
                        provide: StructureDefinition,
                        useFactory: createStructureDefinition
                    },
                    ItemEntityFactory,
                    StructureThemeConverter,
                    StructureIdGenerator,
                    StructureCellEditArchive,
                    structureProviders
                ]
            };
        };
        return StructureModule;
    }());
    StructureModule.HERMES_API = 'hermesApi';
    StructureModule.exportDeclarations = Array.from(exportDeclarations$1);
    StructureModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: [
                        imports$1
                    ],
                    declarations: declarations$1,
                    exports: exportDeclarations$1,
                    entryComponents: entryComponents$1
                },] }
    ];
    StructureModule.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: core.Inject, args: [core.PLATFORM_ID,] }] }
    ]; };

    var imports = [
        common.CommonModule,
        ListViewFeatureModule,
        StructureModule.withConfig({
            cssClassName: 'list',
            hermesModuleConfig: {
                loggers: true
            }
        })
    ];
    var declarations = [
        GuiListComponent,
        GuiListItemComponent,
        GuiListCardComponent
    ];
    var providers = [];
    var exportDeclarations = [
        GuiListComponent,
        GuiListItemComponent,
        GuiListCardComponent
    ];
    var entryComponents = [];
    var GuiListModule = /** @class */ (function () {
        function GuiListModule() {
        }
        GuiListModule.forRoot = function () {
            return {
                ngModule: GuiListModule,
                providers: providers
            };
        };
        GuiListModule.forChild = function () {
            return {
                ngModule: GuiListModule,
                providers: []
            };
        };
        return GuiListModule;
    }());
    GuiListModule.decorators = [
        { type: core.NgModule, args: [{
                    imports: imports,
                    declarations: declarations,
                    exports: exportDeclarations,
                    entryComponents: entryComponents
                },] }
    ];

    /**
     * Generated bundle index. Do not edit.
     */

    exports.GuiListCardComponent = GuiListCardComponent;
    exports.GuiListComponent = GuiListComponent;
    exports.GuiListDefaultTranslation = GuiListDefaultTranslation;
    exports.GuiListItemComponent = GuiListItemComponent;
    exports.GuiListModule = GuiListModule;
    exports.StructureComponent = StructureComponent;
    exports["ɵa"] = structureIdFactoryForGrid;
    exports["ɵb"] = compositionIdFactoryForGrid;
    exports["ɵba"] = PagingDispatcher;
    exports["ɵbb"] = PagingManagerFactory;
    exports["ɵbc"] = Logger;
    exports["ɵbd"] = SetPagingCommandHandler;
    exports["ɵbe"] = StructureAggregateRepository;
    exports["ɵbf"] = structureKey;
    exports["ɵbg"] = NextPageCommandHandler;
    exports["ɵbh"] = PrevPageCommandHandler;
    exports["ɵbi"] = ChangePagesizeCommandHandler;
    exports["ɵbj"] = PagingCommandInvoker;
    exports["ɵbk"] = PagingDomainCommandInvoker;
    exports["ɵbl"] = PagingWarehouse;
    exports["ɵbm"] = PagingDomainWarehouse;
    exports["ɵbn"] = PagingRepository;
    exports["ɵbo"] = StructureReadModelRepository;
    exports["ɵbp"] = PagingEventRepository;
    exports["ɵbq"] = PagingDomainEventRepository;
    exports["ɵbr"] = PagingConverter;
    exports["ɵbs"] = TranslationFeatureModule;
    exports["ɵbt"] = TranslationApiModule;
    exports["ɵbu"] = TranslationPipe;
    exports["ɵbv"] = TranslationFacade;
    exports["ɵbw"] = TranslationDomainFacade;
    exports["ɵbx"] = PagingComponent;
    exports["ɵby"] = SmartComponent;
    exports["ɵbz"] = GuiComponent;
    exports["ɵc"] = schemaIdFactoryForGrid;
    exports["ɵca"] = CssClassModifier;
    exports["ɵcb"] = StructureId;
    exports["ɵcc"] = SourceWarehouse;
    exports["ɵcd"] = PagingDisplayModeArchive;
    exports["ɵce"] = PagingNavigatorComponent;
    exports["ɵcf"] = PureComponent;
    exports["ɵcg"] = PagingSelectComponent;
    exports["ɵch"] = PagingStatsComponent;
    exports["ɵci"] = AlternativePagingNavigatorComponent;
    exports["ɵcj"] = AlternativePagingPagesComponent;
    exports["ɵck"] = SearchFeatureModule;
    exports["ɵcl"] = SearchApiModule;
    exports["ɵcm"] = SearchDomainModule;
    exports["ɵcn"] = SearchManagerFactory;
    exports["ɵco"] = SearchDispatcher;
    exports["ɵcp"] = SearchHighlightArchive;
    exports["ɵcq"] = SearchPlaceholderArchive;
    exports["ɵcr"] = SetConfigSearchingCommandHandler;
    exports["ɵcs"] = StructureSetSearchPhraseCommandHandler;
    exports["ɵct"] = SourceDomainEventPublisher;
    exports["ɵcu"] = SearchPhraseSetEventHandler;
    exports["ɵcv"] = SearchPhraseArchive;
    exports["ɵcw"] = ConfigSearchingSetEventHandler;
    exports["ɵcx"] = SearchingEnabledArchive;
    exports["ɵcy"] = SearchCommandInvoker;
    exports["ɵcz"] = SearchDomainCommandInvoker;
    exports["ɵd"] = ListViewFeatureModule;
    exports["ɵda"] = SearchWarehouse;
    exports["ɵdb"] = SearchDomainWarehouse;
    exports["ɵdc"] = SearchEventRepository;
    exports["ɵdd"] = SearchDomainEventRepository;
    exports["ɵde"] = SearchIconComponent;
    exports["ɵdf"] = IconComponent;
    exports["ɵdg"] = StaticComponent;
    exports["ɵdh"] = SearchComponent;
    exports["ɵdi"] = StructureWarehouse;
    exports["ɵdj"] = StructureCellEditArchive;
    exports["ɵdk"] = CellEditorManager;
    exports["ɵdm"] = EmptySourceFeatureModule;
    exports["ɵdn"] = EmptySourceComponent;
    exports["ɵdo"] = SortingSelectorFeatureModule;
    exports["ɵdp"] = SortingSelectorComponent;
    exports["ɵdq"] = FilterMenuFeatureModule;
    exports["ɵdr"] = FilterApiModule;
    exports["ɵds"] = FilterDomainModule;
    exports["ɵdt"] = FilterManagerFactory;
    exports["ɵdu"] = SetConfigFilterCommandHandler;
    exports["ɵdv"] = SetConfigQuickFilterCommandHandler;
    exports["ɵdw"] = ToggleFilterCommandHandler;
    exports["ɵdx"] = AddFilterCommandHandler;
    exports["ɵdy"] = RemoveAllFiltersCommandHandler;
    exports["ɵdz"] = RemoveFilterCommandHandler;
    exports["ɵe"] = listViewKey;
    exports["ɵea"] = SelectUniqueFilterCommandHandler;
    exports["ɵeb"] = SelectAllUniqueFilterCommandHandler;
    exports["ɵec"] = UnselectUniqueFilterCommandHandler;
    exports["ɵed"] = UnselectAllUniqueFilterCommandHandler;
    exports["ɵee"] = ConfigQuickFilterSetEventHandler;
    exports["ɵef"] = QuickFilterEnabledArchive;
    exports["ɵeg"] = ConfigFilterSetEventHandler;
    exports["ɵeh"] = FilterEnabledArchive;
    exports["ɵei"] = FilterTypeConfigFilterSetEventHandler;
    exports["ɵej"] = FilterTypeArchive;
    exports["ɵek"] = FilterTypeMap;
    exports["ɵel"] = FilterTypeReadModel;
    exports["ɵem"] = FilterTypeId;
    exports["ɵen"] = ActiveFiltersSetEventHandler;
    exports["ɵeo"] = ActiveFilterArchive;
    exports["ɵep"] = UniqueFilterCalculatedEventHandler;
    exports["ɵeq"] = UniqueValuesArchive;
    exports["ɵer"] = UniqueValuesReadModel;
    exports["ɵes"] = UniqueValueReadModel;
    exports["ɵet"] = UniqueValueId;
    exports["ɵeu"] = FilterTypeFieldsInitedEventHandler;
    exports["ɵev"] = FilterCommandInvoker;
    exports["ɵew"] = DomainFilterCommandInvoker;
    exports["ɵex"] = FilterWarehouse;
    exports["ɵey"] = DomainFilterWarehouse;
    exports["ɵez"] = FilterIntegration;
    exports["ɵf"] = ListViewApiModule;
    exports["ɵfa"] = CompositionWarehouse;
    exports["ɵfb"] = ActiveFilterListModule;
    exports["ɵfc"] = fabricImports;
    exports["ɵfd"] = ActiveFilterListComponent;
    exports["ɵfe"] = ActiveSearchComponent;
    exports["ɵff"] = FilterIconComponent;
    exports["ɵfg"] = FilterMenuComponent;
    exports["ɵfh"] = CompositionId;
    exports["ɵfi"] = FieldWarehouse;
    exports["ɵfj"] = FieldReadModelArchive;
    exports["ɵfk"] = FilterMenuTriggerComponent;
    exports["ɵfl"] = filterContainerToken;
    exports["ɵfn"] = ColumnSelectorComponent;
    exports["ɵfo"] = FilterTypeSelectorComponent;
    exports["ɵfp"] = FilterValueComponent;
    exports["ɵfq"] = FieldSelectorComponent;
    exports["ɵfr"] = FilterMenuActiveFiltersComponent;
    exports["ɵfs"] = listViewIdFactoryForList;
    exports["ɵft"] = structureIdFactoryForList;
    exports["ɵfu"] = compositionIdFactoryForList;
    exports["ɵfv"] = schemaIdFactoryForList;
    exports["ɵfw"] = ListViewComponent;
    exports["ɵfx"] = LayoutComponent;
    exports["ɵfy"] = StructureIdGenerator;
    exports["ɵfz"] = SchemaReadModelRootId;
    exports["ɵg"] = ListViewAggregateFactory;
    exports["ɵga"] = ListViewReadModelRootId;
    exports["ɵgb"] = listViewProviders;
    exports["ɵgc"] = ListViewTemplateArchive;
    exports["ɵgd"] = ListViewCardTemplateArchive;
    exports["ɵge"] = StructureCommandInvoker;
    exports["ɵgf"] = ListViewItemComponent;
    exports["ɵgg"] = ListViewLayoutComponent;
    exports["ɵgh"] = ListViewSourceComponent;
    exports["ɵgi"] = ListViewContainerCardComponent;
    exports["ɵgj"] = ListViewCardItemComponent;
    exports["ɵgk"] = ListViewContainerModeSelectComponent;
    exports["ɵgl"] = listViewGatewayDeclarations;
    exports["ɵgm"] = ListViewPagingGate;
    exports["ɵgn"] = PagingGate;
    exports["ɵgo"] = Gate;
    exports["ɵgp"] = ListViewModeGate;
    exports["ɵgq"] = ListViewTemplateGate;
    exports["ɵgr"] = ListViewFieldGate;
    exports["ɵgs"] = FieldCommandInvoker;
    exports["ɵgt"] = ListViewSearchingGate;
    exports["ɵgu"] = SearchingGate;
    exports["ɵgv"] = ListViewL10nGate;
    exports["ɵgw"] = ListViewSourceGate;
    exports["ɵgx"] = SourceGate;
    exports["ɵgy"] = SourceCommandInvoker;
    exports["ɵgz"] = SourceEventService;
    exports["ɵh"] = InMemoryListViewAggregateRepository;
    exports["ɵha"] = createStructureDefinition;
    exports["ɵhb"] = StructureModule;
    exports["ɵhc"] = StructureAggregateFactory;
    exports["ɵhd"] = SourceManagerFactory;
    exports["ɵhe"] = FormationManagerFactory;
    exports["ɵhf"] = VerticalFormationFactory;
    exports["ɵhg"] = SummariesManagerFactory;
    exports["ɵhh"] = SUMMARIES_CALCULATORS;
    exports["ɵhi"] = SummariesCalculator;
    exports["ɵhj"] = FieldCollectionFactory;
    exports["ɵhk"] = FieldFactory;
    exports["ɵhl"] = FieldIdGenerator;
    exports["ɵhm"] = DataFieldFactory;
    exports["ɵhn"] = InMemoryStructureAggregateRepository;
    exports["ɵho"] = InMemoryStructureAggregateStore;
    exports["ɵhp"] = InMemoryStructureStore;
    exports["ɵhq"] = CreateStructureCommandHandler;
    exports["ɵhr"] = SortingDomainModule;
    exports["ɵhs"] = ToggleSortCommandHandler;
    exports["ɵht"] = SetSortingCommandHandler;
    exports["ɵhu"] = SetSortOrderCommandHandler;
    exports["ɵhv"] = FieldDomainModule;
    exports["ɵhw"] = InitFieldsCommandHandler;
    exports["ɵhx"] = FieldsInitedEventHandler;
    exports["ɵhy"] = FieldUiConverter;
    exports["ɵhz"] = SourceDomainModule;
    exports["ɵi"] = ListViewAggregateRepository;
    exports["ɵia"] = SourceDispatcher;
    exports["ɵib"] = FormationDispatcher;
    exports["ɵic"] = SourceSetLoadingCommandHandler;
    exports["ɵid"] = SetOriginCommandHandler;
    exports["ɵie"] = StructureEditSourceItemCommandHandler;
    exports["ɵif"] = SetEnabledSelectionCommandHandler;
    exports["ɵig"] = SetSelectionModeCommandHandler;
    exports["ɵih"] = SelectAllRowsCommandHandler;
    exports["ɵii"] = UnselectAllRowsCommandHandler;
    exports["ɵij"] = DeleteOriginItemCommandHandler;
    exports["ɵik"] = ToggleSelectedRowCommandHandler;
    exports["ɵil"] = StructureOriginChangedEventHandler;
    exports["ɵim"] = StructureSourceOriginArchive;
    exports["ɵin"] = SelectedRowChangedEventHandler;
    exports["ɵio"] = RowSelectedRepository;
    exports["ɵip"] = SelectionModeSetEventHandler;
    exports["ɵiq"] = RowSelectionModeRepository;
    exports["ɵir"] = StructurePreparedItemsEventHandler;
    exports["ɵis"] = StructurePreparedItemsArchive;
    exports["ɵit"] = SummariesDomainModule;
    exports["ɵiu"] = provideSummariesCalculator;
    exports["ɵiv"] = BooleanSummariesCalculator;
    exports["ɵiw"] = DateSummariesCalculator;
    exports["ɵix"] = NumberSummariesCalculator;
    exports["ɵiy"] = StringSummariesCalculator;
    exports["ɵiz"] = UnknownSummariesCalculator;
    exports["ɵj"] = InMemoryListViewAggregateStore;
    exports["ɵja"] = StructureSetSummariesEnabledCommandHandler;
    exports["ɵjb"] = StructureSummariesEnabledSetEventHandler;
    exports["ɵjc"] = SummariesEnabledArchive;
    exports["ɵjd"] = VerticalFormationDomainModule;
    exports["ɵje"] = SetScrollPositionCommandHandler;
    exports["ɵjf"] = SetVerticalScrollEnabledCommandHandler;
    exports["ɵjg"] = SetRowHeightBasedOnThemeCommandHandler;
    exports["ɵjh"] = SetRowHeightCommandHandler;
    exports["ɵji"] = StructureSetHeightCommandHandler;
    exports["ɵjj"] = SetScrollBarPositionCommandHandler;
    exports["ɵjk"] = ScrollBarPositionSetEventHandler;
    exports["ɵjl"] = VerticalFormationScrollBarPositionArchive;
    exports["ɵjm"] = structureCommandHandlers;
    exports["ɵjn"] = structureDomainEventHandlers;
    exports["ɵjo"] = structureProviders;
    exports["ɵjp"] = StructureCreatedEventHandler;
    exports["ɵjq"] = ResizeDetectorModule;
    exports["ɵjr"] = ResizeDetector;
    exports["ɵjs"] = SortingFeatureModule;
    exports["ɵjt"] = SortingApiModule;
    exports["ɵju"] = SortingCommandInvoker;
    exports["ɵjv"] = FieldFeatureModule;
    exports["ɵjw"] = FieldApiModule;
    exports["ɵjx"] = SourceFeatureModule;
    exports["ɵjy"] = SourceApiModule;
    exports["ɵjz"] = SourceConverter;
    exports["ɵk"] = InMemoryListViewStore;
    exports["ɵka"] = SourceDomainCommandInvoker;
    exports["ɵkb"] = SourceDomainWarehouse;
    exports["ɵkc"] = FormationEventRepository;
    exports["ɵkd"] = FormationCommandInvoker;
    exports["ɵke"] = FormationWarehouse;
    exports["ɵkf"] = RowSelectionTypeArchive;
    exports["ɵkg"] = SummariesFeatureModule;
    exports["ɵkh"] = SummariesApiModule;
    exports["ɵki"] = SummariesCommandInvoker;
    exports["ɵkj"] = SummariesDomainCommandInvoker;
    exports["ɵkk"] = StructureSummariesPanelConfigConverter;
    exports["ɵkl"] = StructureSummariesConfigArchive;
    exports["ɵkm"] = StructureSummariesPanelConfig;
    exports["ɵkn"] = SummariesEventRepository;
    exports["ɵko"] = SummariesDomainEventRepository;
    exports["ɵkp"] = SummariesWarehouse;
    exports["ɵkq"] = SummariesDomainWarehouse;
    exports["ɵkr"] = StructureSummariesPanelComponent;
    exports["ɵks"] = VerticalFormationFeatureModule;
    exports["ɵkt"] = VerticalFormationApiModule;
    exports["ɵku"] = VerticalFormationConverter;
    exports["ɵkv"] = VerticalFormationRepository;
    exports["ɵkw"] = InMemoryStructureReadStore;
    exports["ɵkx"] = StructureReadModelRootConverter;
    exports["ɵky"] = VerticalFormationWarehouse;
    exports["ɵkz"] = VerticalFormationDomainWarehouse;
    exports["ɵl"] = CreateListViewCommandHandler;
    exports["ɵla"] = SchemaFeatureModule;
    exports["ɵlb"] = SchemaApiModule;
    exports["ɵlc"] = schemaKey;
    exports["ɵld"] = SchemaAggregateFactory;
    exports["ɵle"] = InMemorySchemaAggregateRepository;
    exports["ɵlf"] = SchemaAggregateRepository;
    exports["ɵlg"] = InMemorySchemaAggregateStore;
    exports["ɵlh"] = InMemorySchemaStore;
    exports["ɵli"] = CreateSchemaCommandHandler;
    exports["ɵlj"] = SchemaDomainModule;
    exports["ɵlk"] = SetSchemaThemeCommandHandler;
    exports["ɵll"] = SetRowColoringCommandHandler;
    exports["ɵlm"] = SetSchemaHorizontalGridCommandHandler;
    exports["ɵln"] = SetSchemaVerticalGridCommandHandler;
    exports["ɵlo"] = SchemaThemeRepository;
    exports["ɵlp"] = SchemaHorizontalGridRepository;
    exports["ɵlq"] = SchemaRowColoringRepository;
    exports["ɵlr"] = SchemaVerticalGridRepository;
    exports["ɵls"] = SchemaCssClassesEventHandler;
    exports["ɵlt"] = SchemaCssClassesRepository;
    exports["ɵlu"] = SchemaDispatcher;
    exports["ɵlv"] = SchemaCommandInvoker;
    exports["ɵlw"] = SchemaDomainCommandInvoker;
    exports["ɵlx"] = SchemaWarehouse;
    exports["ɵly"] = SchemaDomainWarehouse;
    exports["ɵlz"] = SchemaEventRepository;
    exports["ɵm"] = ListViewDomainModule;
    exports["ɵma"] = SchemaDomainEventRepository;
    exports["ɵmb"] = SchemaRowClassArchive;
    exports["ɵmc"] = SchemaRowStyleArchive;
    exports["ɵmd"] = StructureSharedModule;
    exports["ɵme"] = CssClassModule;
    exports["ɵmf"] = StructureInfoPanelModule;
    exports["ɵmg"] = NumberFormatterModule;
    exports["ɵmh"] = NumberFormatterPipe;
    exports["ɵmi"] = StructureColumnManagerModule;
    exports["ɵmj"] = StructureColumnManagerComponent;
    exports["ɵmk"] = CompositionCommandInvoker;
    exports["ɵml"] = StructureDialogColumnManagerComponent;
    exports["ɵmm"] = StructureMenuColumnManagerComponent;
    exports["ɵmn"] = StructureColumnManagerIconComponent;
    exports["ɵmo"] = StructureDialogColumnManagerService;
    exports["ɵmp"] = StructureThemeConverter;
    exports["ɵmq"] = SchemaManagerModule;
    exports["ɵmr"] = StructureSchemaMangerComponent;
    exports["ɵms"] = StructureDialogSchemaManagerComponent;
    exports["ɵmt"] = StructureSchemaManagerIconComponent;
    exports["ɵmu"] = StructureDialogSchemaManagerService;
    exports["ɵmv"] = SourceCounterFeatureModule;
    exports["ɵmw"] = ActiveFilterMenuTriggerDirective;
    exports["ɵmx"] = ActiveFilterService;
    exports["ɵmy"] = ActiveFilterMenuComponent;
    exports["ɵmz"] = StructureInfoPanelComponent;
    exports["ɵn"] = ListViewDispatcher;
    exports["ɵna"] = StructureInfoPanelArchive;
    exports["ɵnb"] = StructureInfoModalComponent;
    exports["ɵnc"] = StructureInfoIconComponent;
    exports["ɵnd"] = StructureInfoPanelConfigConverter;
    exports["ɵne"] = StructureTopPanelModule;
    exports["ɵnf"] = StructureTopPanelComponent;
    exports["ɵng"] = StructureColumnMenuModule;
    exports["ɵnh"] = UniqueValueListModule;
    exports["ɵni"] = UniqueValueListComponent;
    exports["ɵnj"] = StructureColumnConfigComponent;
    exports["ɵnk"] = StructureColumnMenuConfigArchive;
    exports["ɵnl"] = CellTemplateWithContext;
    exports["ɵnm"] = CellContext;
    exports["ɵno"] = CellValue;
    exports["ɵnp"] = FieldId;
    exports["ɵnq"] = ColumnDefinitionId;
    exports["ɵnt"] = StructureColumnConfigTriggerComponent;
    exports["ɵnu"] = StructureColumnConfigService;
    exports["ɵnv"] = StructureColumnConfigSortComponent;
    exports["ɵnw"] = StructureColumnConfigColumnHideComponent;
    exports["ɵnx"] = StructureColumnConfigColumnMoveComponent;
    exports["ɵny"] = StructureColumnMenuIconComponent;
    exports["ɵnz"] = StructureColumnMenuArrowIconComponent;
    exports["ɵo"] = SetListViewModeCommandHandler;
    exports["ɵoa"] = CompositionFeatureModule;
    exports["ɵob"] = CompositionApiModule;
    exports["ɵoc"] = compositionKey;
    exports["ɵod"] = CompositionAggregateFactory;
    exports["ɵoe"] = ColumnEntityFactory;
    exports["ɵof"] = ColumnPresentationConverter;
    exports["ɵog"] = CompositionGroupFactory;
    exports["ɵoh"] = InMemoryCompositionAggregateRepository;
    exports["ɵoi"] = CompositionAggregateRepository;
    exports["ɵoj"] = InMemoryCompositionAggregateStore;
    exports["ɵok"] = InMemoryCompositionStore;
    exports["ɵol"] = CreateCompositionCommandHandler;
    exports["ɵom"] = CompositionDomainModule;
    exports["ɵon"] = inMemoryCompositionCommandProviders;
    exports["ɵoo"] = inMemoryCompositionReadModelProviders;
    exports["ɵop"] = inMemoryCompositionProviders;
    exports["ɵoq"] = CompositionDispatcher;
    exports["ɵor"] = CompositionEventConverter;
    exports["ɵos"] = ColumnFieldFactory;
    exports["ɵot"] = ColumnHighlightArchive;
    exports["ɵou"] = Override;
    exports["ɵov"] = SetColumnsCommandHandler;
    exports["ɵow"] = SetCompositionWidthCommandHandler;
    exports["ɵox"] = SetCompositionResizeWidthCommandHandler;
    exports["ɵoy"] = SetCompositionContainerWidthCommandHandler;
    exports["ɵoz"] = CompositionSetColumnEnabledCommandHandler;
    exports["ɵp"] = ToggleListViewSelectorCommandHandler;
    exports["ɵpa"] = CompositionChangeSortStatusCommandHandler;
    exports["ɵpb"] = CompositionMoveLeftColumnCommandHandler;
    exports["ɵpc"] = CompositionMoveRightColumnCommandHandler;
    exports["ɵpd"] = SetGroupsCommandHandler;
    exports["ɵpe"] = CompositionChangeSortStatusEventHandler;
    exports["ɵpf"] = InMemoryCompositionReadStore;
    exports["ɵpg"] = CompositionReadModelRootConverter;
    exports["ɵph"] = ColumnDefinitionFactory;
    exports["ɵpi"] = ViewTemplateRepository;
    exports["ɵpj"] = ViewTemplateFactory;
    exports["ɵpk"] = TemplateFactory;
    exports["ɵpl"] = EditTemplateRepository;
    exports["ɵpm"] = EditTemplateFactory;
    exports["ɵpn"] = CompositionReadModelRootRepository;
    exports["ɵpo"] = InMemoryCompositionRepository;
    exports["ɵpp"] = CompositionGroupArchive;
    exports["ɵpq"] = GroupCollection;
    exports["ɵpr"] = Group;
    exports["ɵps"] = GroupId;
    exports["ɵpt"] = CompositionDomainCommandInvoker;
    exports["ɵpu"] = CompositionDomainWarehouse;
    exports["ɵpv"] = CompositionEventRepository;
    exports["ɵpw"] = CompositionDomainEventRepository;
    exports["ɵpx"] = ColumnAutoConfigurator;
    exports["ɵpy"] = DomainColumnAutoConfigurator;
    exports["ɵpz"] = SanitizeModule;
    exports["ɵq"] = ListViewModeSetEventHandler;
    exports["ɵqa"] = SafePipe;
    exports["ɵqb"] = ViewTemplatesComponent;
    exports["ɵqc"] = EditTemplatesComponent;
    exports["ɵqd"] = StringEditTemplateComponent;
    exports["ɵqe"] = InputEditTemplateComponent;
    exports["ɵqf"] = EditCommunicationComponent;
    exports["ɵqg"] = NumberEditTemplateComponent;
    exports["ɵqh"] = BooleanEditTemplateComponent;
    exports["ɵqi"] = DateEditTemplateComponent;
    exports["ɵqj"] = ColumnQueryComponent;
    exports["ɵqk"] = FunctionViewComponent;
    exports["ɵql"] = BarViewComponent;
    exports["ɵqm"] = PercentageViewComponent;
    exports["ɵqn"] = TextViewComponent;
    exports["ɵqo"] = LoggerModule;
    exports["ɵqp"] = ConsoleLogger;
    exports["ɵqq"] = StructureGateway;
    exports["ɵqr"] = StructureEditModeArchive;
    exports["ɵqs"] = StructureInfoPanelConfigService;
    exports["ɵqt"] = StructureCellEditStore;
    exports["ɵqu"] = RowSelectEnabledRepository;
    exports["ɵqv"] = StructureHeaderBottomEnabledArchive;
    exports["ɵqw"] = StructureInitialValuesReadyArchive;
    exports["ɵqx"] = SchemaCssClassManager;
    exports["ɵqy"] = StructureCellEditCloseAllService;
    exports["ɵqz"] = StructureHeaderTopEnabledArchive;
    exports["ɵr"] = ListViewModeArchive;
    exports["ɵra"] = StructureRowDetailConfigArchive;
    exports["ɵrb"] = StructureRowDetailService;
    exports["ɵrc"] = StructureTitlePanelConfigArchive;
    exports["ɵrd"] = StructureFooterPanelConfigArchive;
    exports["ɵre"] = structureComponentToken;
    exports["ɵrf"] = StructureDefinition;
    exports["ɵrg"] = PagingDefinition;
    exports["ɵrh"] = StructureHeaderComponent;
    exports["ɵri"] = StructureHeaderColumnsComponent;
    exports["ɵrj"] = StructureHeaderFiltersComponent;
    exports["ɵrk"] = StructureHeaderGroupsComponent;
    exports["ɵrl"] = StructureHeaderFilterComponent;
    exports["ɵrm"] = SelectAllComponent;
    exports["ɵrn"] = StructureContentComponent;
    exports["ɵro"] = StructureRowComponent;
    exports["ɵrp"] = StructureCellComponent;
    exports["ɵrq"] = StructureCellEditComponent;
    exports["ɵrr"] = StructureCellEditBooleanComponent;
    exports["ɵrs"] = StructureContainerComponent;
    exports["ɵrt"] = structureParentComponent;
    exports["ɵru"] = StructureQuickFiltersComponent;
    exports["ɵrv"] = StructureBlueprintComponent;
    exports["ɵrw"] = STRUCTURE_CSS_CLASS_NAME;
    exports["ɵrx"] = StructureRowDetailViewComponent;
    exports["ɵry"] = DynamicallyCreatedComponent;
    exports["ɵrz"] = structureRowDetailViewItem;
    exports["ɵs"] = ListViewSelectorToggledEventHandler;
    exports["ɵsa"] = structureRowDetailViewTemplate;
    exports["ɵsb"] = SelectedRow;
    exports["ɵsc"] = OriginItemEntity;
    exports["ɵsd"] = OriginId;
    exports["ɵse"] = StructureTitlePanelComponent;
    exports["ɵsf"] = StructureBannerPanel;
    exports["ɵsg"] = StructureFooterPanelComponent;
    exports["ɵsh"] = structureGates;
    exports["ɵsi"] = StructureColumnHeaderGate;
    exports["ɵsj"] = StructurePagingGate;
    exports["ɵsk"] = StructureSearchingGate;
    exports["ɵsl"] = StructureSelectionGate;
    exports["ɵsm"] = SelectionGate;
    exports["ɵsn"] = StructureL10nGate;
    exports["ɵso"] = StructurePanelGate;
    exports["ɵsp"] = StructureRowDetailGate;
    exports["ɵsq"] = StructureColumnMenuGate;
    exports["ɵsr"] = StructureSummariesGate;
    exports["ɵss"] = StructureInfoPanelGate;
    exports["ɵst"] = StructureRowClassGate;
    exports["ɵsu"] = StructureRowStyleGate;
    exports["ɵsv"] = StructureRowColoringGate;
    exports["ɵsw"] = ThemeGridGate;
    exports["ɵsx"] = StructureSortingGate;
    exports["ɵsy"] = SourceLoadingGate;
    exports["ɵsz"] = StructureFilterGate;
    exports["ɵt"] = ListViewSelectorArchive;
    exports["ɵta"] = StructureQuickFiltersGate;
    exports["ɵtb"] = VerticalFormationGate;
    exports["ɵtc"] = ItemEntityFactory;
    exports["ɵtd"] = inMemoryStructureCommandProviders;
    exports["ɵte"] = inMemoryStructureReadProviders;
    exports["ɵtf"] = inMemoryStructureProviders;
    exports["ɵtg"] = InMemoryStructureRepository;
    exports["ɵth"] = StructureDomainCommandInvoker;
    exports["ɵti"] = GuiListGateway;
    exports["ɵtj"] = guiListProviders;
    exports["ɵu"] = ListViewCommandInvoker;
    exports["ɵv"] = ListViewEventRepository;
    exports["ɵw"] = ListViewWarehouse;
    exports["ɵx"] = PagingFeatureModule;
    exports["ɵy"] = PagingApiModule;
    exports["ɵz"] = PagingDomainModule;

    Object.defineProperty(exports, '__esModule', { value: true });

}));
//# sourceMappingURL=generic-ui-ngx-list.umd.js.map
