import { FabricPlacement } from './fabric-placement';
import { FabricGeometry } from './fabric-geometry';
export class FabricCords extends FabricGeometry {
    constructor(window, invokerElementRef, invokedElementRef, containerClassName, placement, offset) {
        super(invokedElementRef, containerClassName);
        this.verticalPosition = 0;
        this.horizontalPosition = 0;
        this.calculateCords(window, invokerElementRef, offset, placement);
    }
    getVerticalPosition() {
        return this.verticalPosition;
    }
    getHorizontalPosition() {
        return this.horizontalPosition;
    }
    calculateCords(window, invokerElementRef, offset, placement) {
        const elementRect = invokerElementRef.nativeElement.getBoundingClientRect(), elementBottom = window.pageYOffset + elementRect.bottom, elementLeft = window.pageXOffset + elementRect.left, elementRight = window.pageXOffset + elementRect.right, elementTop = window.pageYOffset + elementRect.top, topCords = elementTop + offset - this.getHeight();
        switch (placement) {
            case FabricPlacement.BOTTOM:
                this.horizontalPosition = elementLeft;
                this.verticalPosition = elementBottom + offset;
                break;
            case FabricPlacement.TOP:
                this.horizontalPosition = elementLeft;
                this.verticalPosition = topCords;
                break;
            case FabricPlacement.BEFORE:
                this.horizontalPosition = elementRight + offset - this.getWidth();
                this.verticalPosition = elementBottom;
                break;
            case FabricPlacement.AFTER:
                this.horizontalPosition = elementLeft + offset;
                this.verticalPosition = elementBottom;
                break;
            default:
                this.horizontalPosition = elementLeft;
                this.verticalPosition = elementBottom + offset;
        }
        this.calculateDirection(invokerElementRef, window, topCords);
    }
    calculateDirection(invokerElementRef, window, topCords) {
        const windowHeightWithOffset = window.innerHeight + window.pageYOffset, windowWidthWithOffset = window.innerWidth + window.pageXOffset, invokerElementWidth = invokerElementRef.nativeElement.offsetWidth, invokedElementHeight = this.getHeight(), invokedElementWidth = this.getWidth();
        const invokedElementDoesNotFitHorizontally = (windowWidthWithOffset - this.horizontalPosition - invokedElementWidth) < 0, invokedElementDoesNotFitVertically = (windowHeightWithOffset - this.verticalPosition - invokedElementHeight) < 0;
        if (invokedElementDoesNotFitHorizontally) {
            this.horizontalPosition -= invokedElementWidth - invokerElementWidth;
        }
        if (invokedElementDoesNotFitVertically) {
            this.verticalPosition = topCords;
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFicmljLWNvcmRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vYnVpbGQtY2xpL3Byb2plY3RzL2d1aS1mYWJyaWMvc3JjL2NvbW1vbi9tb2RhbC9jb3Jkcy9mYWJyaWMtY29yZHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUVuRCxNQUFNLE9BQWdCLFdBQVksU0FBUSxjQUFjO0lBTXZELFlBQXNCLE1BQWMsRUFDN0IsaUJBQTZCLEVBQzdCLGlCQUE2QixFQUM3QixrQkFBMEIsRUFDMUIsU0FBMkIsRUFDM0IsTUFBZTtRQUNyQixLQUFLLENBQUMsaUJBQWlCLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztRQVZ0QyxxQkFBZ0IsR0FBVyxDQUFDLENBQUM7UUFFN0IsdUJBQWtCLEdBQVcsQ0FBQyxDQUFDO1FBU3RDLElBQUksQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLGlCQUFpQixFQUFFLE1BQU0sRUFBRSxTQUFTLENBQUMsQ0FBQztJQUNuRSxDQUFDO0lBRUQsbUJBQW1CO1FBQ2xCLE9BQU8sSUFBSSxDQUFDLGdCQUFnQixDQUFDO0lBQzlCLENBQUM7SUFFRCxxQkFBcUI7UUFDcEIsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUM7SUFDaEMsQ0FBQztJQUVPLGNBQWMsQ0FBQyxNQUFjLEVBQzdCLGlCQUE2QixFQUM3QixNQUFlLEVBQ2YsU0FBMkI7UUFFbEMsTUFBTSxXQUFXLEdBQUcsaUJBQWlCLENBQUMsYUFBYSxDQUFDLHFCQUFxQixFQUFFLEVBQzFFLGFBQWEsR0FBRyxNQUFNLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQyxNQUFNLEVBQ3ZELFdBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQyxJQUFJLEVBQ25ELFlBQVksR0FBRyxNQUFNLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQyxLQUFLLEVBQ3JELFVBQVUsR0FBRyxNQUFNLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQyxHQUFHLEVBQ2pELFFBQVEsR0FBRyxVQUFVLEdBQUcsTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUVuRCxRQUFRLFNBQVMsRUFBRTtZQUVsQixLQUFLLGVBQWUsQ0FBQyxNQUFNO2dCQUMxQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsV0FBVyxDQUFDO2dCQUN0QyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsYUFBYSxHQUFHLE1BQU0sQ0FBQztnQkFDL0MsTUFBTTtZQUVQLEtBQUssZUFBZSxDQUFDLEdBQUc7Z0JBQ3ZCLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxXQUFXLENBQUM7Z0JBQ3RDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxRQUFRLENBQUM7Z0JBQ2pDLE1BQU07WUFFUCxLQUFLLGVBQWUsQ0FBQyxNQUFNO2dCQUMxQixJQUFJLENBQUMsa0JBQWtCLEdBQUcsWUFBWSxHQUFHLE1BQU0sR0FBRyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQ2xFLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxhQUFhLENBQUM7Z0JBQ3RDLE1BQU07WUFFUCxLQUFLLGVBQWUsQ0FBQyxLQUFLO2dCQUN6QixJQUFJLENBQUMsa0JBQWtCLEdBQUcsV0FBVyxHQUFHLE1BQU0sQ0FBQztnQkFDL0MsSUFBSSxDQUFDLGdCQUFnQixHQUFHLGFBQWEsQ0FBQztnQkFDdEMsTUFBTTtZQUVQO2dCQUNDLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxXQUFXLENBQUM7Z0JBQ3RDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxhQUFhLEdBQUcsTUFBTSxDQUFDO1NBQ2hEO1FBRUQsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGlCQUFpQixFQUFFLE1BQU0sRUFBRSxRQUFRLENBQUMsQ0FBQztJQUM5RCxDQUFDO0lBRU8sa0JBQWtCLENBQUMsaUJBQTZCLEVBQUUsTUFBYyxFQUFFLFFBQWdCO1FBQ3pGLE1BQU0sc0JBQXNCLEdBQUcsTUFBTSxDQUFDLFdBQVcsR0FBRyxNQUFNLENBQUMsV0FBVyxFQUNyRSxxQkFBcUIsR0FBRyxNQUFNLENBQUMsVUFBVSxHQUFHLE1BQU0sQ0FBQyxXQUFXLEVBQzlELG1CQUFtQixHQUFHLGlCQUFpQixDQUFDLGFBQWEsQ0FBQyxXQUFXLEVBQ2pFLG9CQUFvQixHQUFHLElBQUksQ0FBQyxTQUFTLEVBQUUsRUFDdkMsbUJBQW1CLEdBQUcsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBRXZDLE1BQU0sb0NBQW9DLEdBQUcsQ0FBQyxxQkFBcUIsR0FBRyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsbUJBQW1CLENBQUMsR0FBRyxDQUFDLEVBQ3ZILGtDQUFrQyxHQUFHLENBQUMsc0JBQXNCLEdBQUcsSUFBSSxDQUFDLGdCQUFnQixHQUFHLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRWxILElBQUksb0NBQW9DLEVBQUU7WUFDekMsSUFBSSxDQUFDLGtCQUFrQixJQUFJLG1CQUFtQixHQUFHLG1CQUFtQixDQUFDO1NBQ3JFO1FBRUQsSUFBSSxrQ0FBa0MsRUFBRTtZQUN2QyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsUUFBUSxDQUFDO1NBQ2pDO0lBQ0YsQ0FBQztDQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRWxlbWVudFJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgRmFicmljUGxhY2VtZW50IH0gZnJvbSAnLi9mYWJyaWMtcGxhY2VtZW50JztcbmltcG9ydCB7IEZhYnJpY0dlb21ldHJ5IH0gZnJvbSAnLi9mYWJyaWMtZ2VvbWV0cnknO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgRmFicmljQ29yZHMgZXh0ZW5kcyBGYWJyaWNHZW9tZXRyeSB7XG5cblx0cHJpdmF0ZSB2ZXJ0aWNhbFBvc2l0aW9uOiBudW1iZXIgPSAwO1xuXG5cdHByaXZhdGUgaG9yaXpvbnRhbFBvc2l0aW9uOiBudW1iZXIgPSAwO1xuXG5cdHByb3RlY3RlZCBjb25zdHJ1Y3Rvcih3aW5kb3c6IFdpbmRvdyxcblx0XHRcdFx0XHRcdCAgaW52b2tlckVsZW1lbnRSZWY6IEVsZW1lbnRSZWYsXG5cdFx0XHRcdFx0XHQgIGludm9rZWRFbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuXHRcdFx0XHRcdFx0ICBjb250YWluZXJDbGFzc05hbWU6IHN0cmluZyxcblx0XHRcdFx0XHRcdCAgcGxhY2VtZW50PzogRmFicmljUGxhY2VtZW50LFxuXHRcdFx0XHRcdFx0ICBvZmZzZXQ/OiBudW1iZXIpIHtcblx0XHRzdXBlcihpbnZva2VkRWxlbWVudFJlZiwgY29udGFpbmVyQ2xhc3NOYW1lKTtcblx0XHR0aGlzLmNhbGN1bGF0ZUNvcmRzKHdpbmRvdywgaW52b2tlckVsZW1lbnRSZWYsIG9mZnNldCwgcGxhY2VtZW50KTtcblx0fVxuXG5cdGdldFZlcnRpY2FsUG9zaXRpb24oKTogbnVtYmVyIHtcblx0XHRyZXR1cm4gdGhpcy52ZXJ0aWNhbFBvc2l0aW9uO1xuXHR9XG5cblx0Z2V0SG9yaXpvbnRhbFBvc2l0aW9uKCk6IG51bWJlciB7XG5cdFx0cmV0dXJuIHRoaXMuaG9yaXpvbnRhbFBvc2l0aW9uO1xuXHR9XG5cblx0cHJpdmF0ZSBjYWxjdWxhdGVDb3Jkcyh3aW5kb3c6IFdpbmRvdyxcblx0XHRcdFx0XHRcdCAgIGludm9rZXJFbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuXHRcdFx0XHRcdFx0ICAgb2Zmc2V0PzogbnVtYmVyLFxuXHRcdFx0XHRcdFx0ICAgcGxhY2VtZW50PzogRmFicmljUGxhY2VtZW50KTogdm9pZCB7XG5cblx0XHRjb25zdCBlbGVtZW50UmVjdCA9IGludm9rZXJFbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksXG5cdFx0XHRlbGVtZW50Qm90dG9tID0gd2luZG93LnBhZ2VZT2Zmc2V0ICsgZWxlbWVudFJlY3QuYm90dG9tLFxuXHRcdFx0ZWxlbWVudExlZnQgPSB3aW5kb3cucGFnZVhPZmZzZXQgKyBlbGVtZW50UmVjdC5sZWZ0LFxuXHRcdFx0ZWxlbWVudFJpZ2h0ID0gd2luZG93LnBhZ2VYT2Zmc2V0ICsgZWxlbWVudFJlY3QucmlnaHQsXG5cdFx0XHRlbGVtZW50VG9wID0gd2luZG93LnBhZ2VZT2Zmc2V0ICsgZWxlbWVudFJlY3QudG9wLFxuXHRcdFx0dG9wQ29yZHMgPSBlbGVtZW50VG9wICsgb2Zmc2V0IC0gdGhpcy5nZXRIZWlnaHQoKTtcblxuXHRcdHN3aXRjaCAocGxhY2VtZW50KSB7XG5cblx0XHRcdGNhc2UgRmFicmljUGxhY2VtZW50LkJPVFRPTTpcblx0XHRcdFx0dGhpcy5ob3Jpem9udGFsUG9zaXRpb24gPSBlbGVtZW50TGVmdDtcblx0XHRcdFx0dGhpcy52ZXJ0aWNhbFBvc2l0aW9uID0gZWxlbWVudEJvdHRvbSArIG9mZnNldDtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgRmFicmljUGxhY2VtZW50LlRPUDpcblx0XHRcdFx0dGhpcy5ob3Jpem9udGFsUG9zaXRpb24gPSBlbGVtZW50TGVmdDtcblx0XHRcdFx0dGhpcy52ZXJ0aWNhbFBvc2l0aW9uID0gdG9wQ29yZHM7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIEZhYnJpY1BsYWNlbWVudC5CRUZPUkU6XG5cdFx0XHRcdHRoaXMuaG9yaXpvbnRhbFBvc2l0aW9uID0gZWxlbWVudFJpZ2h0ICsgb2Zmc2V0IC0gdGhpcy5nZXRXaWR0aCgpO1xuXHRcdFx0XHR0aGlzLnZlcnRpY2FsUG9zaXRpb24gPSBlbGVtZW50Qm90dG9tO1xuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSBGYWJyaWNQbGFjZW1lbnQuQUZURVI6XG5cdFx0XHRcdHRoaXMuaG9yaXpvbnRhbFBvc2l0aW9uID0gZWxlbWVudExlZnQgKyBvZmZzZXQ7XG5cdFx0XHRcdHRoaXMudmVydGljYWxQb3NpdGlvbiA9IGVsZW1lbnRCb3R0b207XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRkZWZhdWx0IDpcblx0XHRcdFx0dGhpcy5ob3Jpem9udGFsUG9zaXRpb24gPSBlbGVtZW50TGVmdDtcblx0XHRcdFx0dGhpcy52ZXJ0aWNhbFBvc2l0aW9uID0gZWxlbWVudEJvdHRvbSArIG9mZnNldDtcblx0XHR9XG5cblx0XHR0aGlzLmNhbGN1bGF0ZURpcmVjdGlvbihpbnZva2VyRWxlbWVudFJlZiwgd2luZG93LCB0b3BDb3Jkcyk7XG5cdH1cblxuXHRwcml2YXRlIGNhbGN1bGF0ZURpcmVjdGlvbihpbnZva2VyRWxlbWVudFJlZjogRWxlbWVudFJlZiwgd2luZG93OiBXaW5kb3csIHRvcENvcmRzOiBudW1iZXIpOiB2b2lkIHtcblx0XHRjb25zdCB3aW5kb3dIZWlnaHRXaXRoT2Zmc2V0ID0gd2luZG93LmlubmVySGVpZ2h0ICsgd2luZG93LnBhZ2VZT2Zmc2V0LFxuXHRcdFx0d2luZG93V2lkdGhXaXRoT2Zmc2V0ID0gd2luZG93LmlubmVyV2lkdGggKyB3aW5kb3cucGFnZVhPZmZzZXQsXG5cdFx0XHRpbnZva2VyRWxlbWVudFdpZHRoID0gaW52b2tlckVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCxcblx0XHRcdGludm9rZWRFbGVtZW50SGVpZ2h0ID0gdGhpcy5nZXRIZWlnaHQoKSxcblx0XHRcdGludm9rZWRFbGVtZW50V2lkdGggPSB0aGlzLmdldFdpZHRoKCk7XG5cblx0XHRjb25zdCBpbnZva2VkRWxlbWVudERvZXNOb3RGaXRIb3Jpem9udGFsbHkgPSAod2luZG93V2lkdGhXaXRoT2Zmc2V0IC0gdGhpcy5ob3Jpem9udGFsUG9zaXRpb24gLSBpbnZva2VkRWxlbWVudFdpZHRoKSA8IDAsXG5cdFx0XHRpbnZva2VkRWxlbWVudERvZXNOb3RGaXRWZXJ0aWNhbGx5ID0gKHdpbmRvd0hlaWdodFdpdGhPZmZzZXQgLSB0aGlzLnZlcnRpY2FsUG9zaXRpb24gLSBpbnZva2VkRWxlbWVudEhlaWdodCkgPCAwO1xuXG5cdFx0aWYgKGludm9rZWRFbGVtZW50RG9lc05vdEZpdEhvcml6b250YWxseSkge1xuXHRcdFx0dGhpcy5ob3Jpem9udGFsUG9zaXRpb24gLT0gaW52b2tlZEVsZW1lbnRXaWR0aCAtIGludm9rZXJFbGVtZW50V2lkdGg7XG5cdFx0fVxuXG5cdFx0aWYgKGludm9rZWRFbGVtZW50RG9lc05vdEZpdFZlcnRpY2FsbHkpIHtcblx0XHRcdHRoaXMudmVydGljYWxQb3NpdGlvbiA9IHRvcENvcmRzO1xuXHRcdH1cblx0fVxufVxuIl19